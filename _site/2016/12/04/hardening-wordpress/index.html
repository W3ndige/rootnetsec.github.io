<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="RootNetSec is a site about journey through the world of network security, pentesting, Linux administration, programming an networking. View to learn more!">
    <meta name="author" content="W3ndige">
    <title>Hardening WordPress - Root Network Security</title>

    <link rel="canonical" href="http://localhost:4000/2016/12/04/hardening-wordpress/">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//https://fonts.googleapis.com/css?family=Nunito:400,700i" rel="stylesheet">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Root Network Security" />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Root Network Security</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/about/">About</a>
                </li>

                <li>
                    <a href="/archive/">Archive</a>
                </li>

                <li>
                    <a href="/contact/">Contact</a>
                </li>

                <li>
                    <a href="/projects/">Projects</a>
                </li>

                <li>
                    <a href="/resources/">Resources</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/hardening-wordpress-header.png')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Hardening WordPress</h1>
                    
                    <h2 class="subheading">How to secure your WordPress site?</h2>
                    
                    <span class="meta">Posted by W3ndige on December 4, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1>Introduction</h1>

<p>WordPress is the most popular content management system (27.2% of all websites in 2016), bringing an ease in creating websites even for non technical users. Perfect option? Unfortunately not, as WordPress is also the most hacked platform (around 70% of all hacked CMS are WordPress based sites). </p>

<p>Is it because it's so popular? Maybe because many people don't have basic technical knowledge allowing to secure these platforms? Or because people create these websites and then forget about updating? I leave it to your answer. </p>

<p>Today we're going to focus on ways to secure your site, making it harder to get hacked. </p>

<h1>Keep your WordPress up to date</h1>

<p>First and the most important thing is to always keep your site updated, as well as plugins and themes that you're using as developers are working hard to secure all the reported flaws. A lot of sites were hacked by vulnerabilities in code of old plugins, or WordPress core, which were updated in the newer versions. </p>

<p>If you don't want to come back to your website as often, to only check for updates, consider auto update option. You can do this by using one of two methods - by defining constant in wp-config.php or by adding plugins. </p>

<p><b>wp-config.php</b></p>

<p>To enable automatic updates define this constant: </p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">define( 'AUTOMATIC_UPDATER_DISABLED', true );</code></pre></figure>

<ul>
<li>True – Development, minor, and major updates are all enabled</li>
<li>False – Development, minor, and major updates are all disabled</li>
<li>'minor' – Minor updates are enabled, development, and major updates are disabled</li>
</ul>
<p>For plugins: </p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">add_filter( 'auto_update_plugin', '__return_true' );</code></pre></figure>

<p>For themes: </p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">add_filter( 'auto_update_theme', '__return_true' );</code></pre></figure>

<h1>Use strong credentials!</h1>
<ul>
<li><b>Strong passwords.</b></li>
<li><b>Don't use admin as username.</b></li>
</ul>

<p>Not only people will try to attack your site. There are bots that will try to access your <i>wp-admin</i> page and brute force your password, preferably using <i>admin</i> as username. So it's essential to have strong password, but also by changing the username to something less obvious. That way attacker will also have to find it, along with the password.  </p>

<p>For passwords, I can reccomend generators from apps like KeePass or LastPass. Your password have to be <b>CLU</b>: Complex. Long. Unique.</p>

<p>Another security practice is having two accounts - one working as admin and second for publication. Publication account should be used while adding blog posts, content that don't require admin privilages, and while using some public internet access. That way, even if somehow attacker gained access to your password, privilages of publication account won't allow him to do much more harm, than while being logged as admin. </p>

<p>Also - <b>consider two factor authentication!</b></p>

<h1>Think about your plugins!</h1>

<p>If you're not using a plugin, it's deactivated - simply, delete it. It's known to attack a site, by exploiting flaws in the plugin that the developer wasn't even using. But why it happens? After deactivating the plugin - its file are still in the WordPress directory waiting to be used once again. Or maybe waiting to be hacked? </p>

<p>Always download plugins from trustworthy sources. Even if you want a premium plugin, download them from sites like <a href="https://themeforest.net/">Themeforest</a>, or from developer's website. Those free versions may be infected with malware or some backdoor that will make your site very easy to exploit. </p>

<h1>Hide your wp-config.php and .htaccess files</h1>
<p>The wp-config file contains very confidentional information about your website. To protect it from intrusion, you should add the following code to your .htaccess file to deny access to anyone else. </p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">&lt;Files wp-config.php&gt;;
order allow,deny
deny from all
&lt;/Files&gt;</code></pre></figure>

<p>Same for .htaccess file.</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">&lt;Files .htaccess&gt;
order allow,deny
deny from all
&lt;/Files&gt;</code></pre></figure>

<h1>Change your WordPress Security Keys</h1>

<pre>
define('AUTH_KEY',         'VatTc3WfW~dKdE~m=Hf_bvaH-)1+ko=IQ:!oiYW}o1H+[;LgP[QC981U+{K2w0d+');
define('SECURE_AUTH_KEY',  '/@*MX4vaG(:8iMfx(V z$-4b&lt;N;_((cA `nv/~,*tKiO6W}hUf+ t]rL[I9,m^o|');
define('LOGGED_IN_KEY',    'c$Ou*1`?^+(:I4=Lpy6aD-HMl/1Jdg9y-J$1^(V+o&gt;{TyE[q.$)Rtvm:q5j_itG.');
define('NONCE_KEY',        '=+2:9RPE=0x`9!/l}qaYQ`{m)OW|s2I&amp;Hnk=O4/;gwh}I+WGJCk2PmHK{1CIjhDm');
define('AUTH_SALT',        '$5a?Qk1Rzfd{+r_/9XR%2&lt;P+f1^QlQ|pJXMX&gt;1ly-8&lt;n%1J#IaE+O9xy=8(x/AWU');
define('SECURE_AUTH_SALT', 'iehUhOYms(1fQzpacQTrfUR?s;g&gt;9-?(Q=H0s:p!7pT@xmAu/o&gt;90MI2NE1-z-ji');
define('LOGGED_IN_SALT',   '$.[D]&lt;Nm)N[gig#&lt;Dc8|&gt;FXr&amp;+QMmN{sv(AgHM.=*Fdnz-)1YTBAOuJIr94w0Mo3');
define('NONCE_SALT',       'kkv&lt;g?I-JZ+J%xdS!~9vr&gt;F4myL7hdgl++7Q|)I|,=^Jvh=8Ty-iiarrzK)P-sn|');
</pre>

<p>WordPress Security Keys is a set of random variables that improve encryption of information stored in the user’s cookies. You should change them right after installation of your WordPress site. Use <a href="https://api.wordpress.org/secret-key/1.1/salt">this</a> site to get new set of fresh keys and then change them in you wp-config.php file.  </p>

<h1>Change file permissions</h1>

<p>Having secure file permissions may vary from your hosting provider, some may have secure permissions to your files, and some won't bother about this leaving you with default settings. Avoid having directories with 777 permissions, instead opt for 755 or 750. Also set files to 640 or 644 and wp-config.php to 600.</p>

<h1>Limit login attempts</h1>

<p>As I mentioned before, many attackers try to gain access with automated brute force attacks. Easiest way would be to use plugin that will forbid certain IP address from accessing the wp-admin page after certain amounts of failed logins. Plugin such as <a href="https://wordpress.org/plugins/all-in-one-wp-security-and-firewall/">All In One WP Security &amp; Firewall</a> will allow you to change the URL of the login page - bots are programmed to look for wp-admin. </p>

<p>In addition to that use plugin limiting login attempts: </p>
<ul>
<li><a href="https://wordpress.org/plugins/limit-login-attempts-reloaded/">Limit Login Attempts Reloaded</a></li>
<li><a href="https://wordpress.org/plugins/login-lockdown/">Login Lockdown</a></li>
</ul>

<h1>Hide your WordPress version</h1>

<p>FIngerprinting WordPress is a huge issue, since from the attacker point of view - knowing the version will make it easier to find exploits. You can do this by adding this piece of code to your functions.php file. </p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="cm">/* Hide WP version strings from scripts and styles
 * @return {string} $src
 * @filter script_loader_src
 * @filter style_loader_src
 */</span>
<span class="k">function</span> <span class="nf">fjarrett_remove_wp_version_strings</span><span class="p">(</span> <span class="nv">$src</span> <span class="p">)</span> <span class="p">{</span>
     <span class="k">global</span> <span class="nv">$wp_version</span><span class="p">;</span>
     <span class="nb">parse_str</span><span class="p">(</span><span class="nb">parse_url</span><span class="p">(</span><span class="nv">$src</span><span class="p">,</span> <span class="nx">PHP_URL_QUERY</span><span class="p">),</span> <span class="nv">$query</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$query</span><span class="p">[</span><span class="s1">'ver'</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$query</span><span class="p">[</span><span class="s1">'ver'</span><span class="p">]</span> <span class="o">===</span> <span class="nv">$wp_version</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nv">$src</span> <span class="o">=</span> <span class="nx">remove_query_arg</span><span class="p">(</span><span class="s1">'ver'</span><span class="p">,</span> <span class="nv">$src</span><span class="p">);</span>
     <span class="p">}</span>
     <span class="k">return</span> <span class="nv">$src</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">add_filter</span><span class="p">(</span> <span class="s1">'script_loader_src'</span><span class="p">,</span> <span class="s1">'fjarrett_remove_wp_version_strings'</span> <span class="p">);</span>
<span class="nx">add_filter</span><span class="p">(</span> <span class="s1">'style_loader_src'</span><span class="p">,</span> <span class="s1">'fjarrett_remove_wp_version_strings'</span> <span class="p">);</span>

<span class="cm">/* Hide WP version strings from generator meta tag */</span>
<span class="k">function</span> <span class="nf">wpmudev_remove_version</span><span class="p">()</span> <span class="p">{</span>
<span class="k">return</span> <span class="s1">''</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">add_filter</span><span class="p">(</span><span class="s1">'the_generator'</span><span class="p">,</span> <span class="s1">'wpmudev_remove_version'</span><span class="p">);</span>
<span class="cp">?&gt;</span></code></pre></figure>

<p>This will hide your WordPress version from all possible places. </p>

<h1>Last words</h1>

<p>Keeping your WordPress based site is very serious task, but following these tips will make it much safer than it was before, which undoubtedly will save you a lot of time in the future. But remember, there is no unhackable thing so always keep backups of your website, as in case of infection you will save more time than creating your site from scratch.  </p>

<p>I hope you learned something, from this article. As always remember and...</p>

<p>~ Stay safe!</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/11/19/overthewire.org-krypton/" data-toggle="tooltip" data-placement="top" title="Overthewire.org - Krypton">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/12/14/what-has-happened/" data-toggle="tooltip" data-placement="top" title="Summary of 2016">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/w3ndige">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:w3ndige@protonmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; RootNetSec 2016 - 2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
