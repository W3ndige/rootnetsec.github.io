<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="RootNetSec is a site about journey through the world of network security, pentesting, Linux administration, programming an networking. View to learn more!">
    <meta name="author" content="W3ndige">
    <title>Let's Talk Encryption - Root Network Security</title>

    <link rel="canonical" href="http://localhost:4000/2016/08/09/encryption-vigenere-cipher/">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//https://fonts.googleapis.com/css?family=Nunito:400,700i" rel="stylesheet">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Root Network Security" />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Root Network Security</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/about/">About</a>
                </li>

                <li>
                    <a href="/archive/">Archive</a>
                </li>

                <li>
                    <a href="/contact/">Contact</a>
                </li>

                <li>
                    <a href="/projects/">Projects</a>
                </li>

                <li>
                    <a href="/resources/">Resources</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/encryption-vigenere-header.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Let's Talk Encryption</h1>
                    
                    <h2 class="subheading">Part 2 - Vigenère cipher</h2>
                    
                    <span class="meta">Posted by W3ndige on August 9, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1>Vigenère cipher - how it works?</h1>
<p>Vigenère cipher is an method of encrypting message by using series of different Caesar ciphers based on the letters of a keyword. Basically to encrypt a message using the Vigenère cipher you first need to choose a keyword. After that repeat this keyword over and over until it is the same length as your secret message. </p>
<p>Now for each plaintext letter, you find the letter on the left-vertical row of the tabula recta. Then you take the corresponding letter from your keyword, and find it at the top-horizontal row of the table. Where these two lines cross in the table is the ciphertext letter you use.</p>
<p><img src="/img/encryption-vigenere/tabula-recta.png" alt="tabula-recta" class="img-responsive" /></p>
<p><center><i>Tabula Recta</i></center></p>
<p>Let's encrypt message - <b>hello</b> with a keyword <b>boom</b>.</p>
<ul>
<li>Since our message is 5 letters and keyword is only 4 we have to repeat it until it's same length as message - in this example keyword will be <b>boomb</b>.</li>
<li>Now we have to take the first letter from the message and find it on the left-vertical row of the table.</li>
<li>Next get the first letter of the keyword and also get its position, now on the upper-horizontal row.</li>
<li>After that find where lines, in which were those letters cross and write down the letter you get.</li>
<li>Repeat for each letter.</li>
</ul>
<p>When you finish you should get the encrypted message: <b>iszxp</b> </p>
<p>As you now may suspect - decrypting is just reversing the process on encryption - but knowing the ciphertext (places where lines cross) and keyword - upper row of the table.</p>
<ul>
<li>Get the keyword and repeat it until it's same length (boomb) as ciphertext (iszxp).</li>
<li>Get the first letter of a keyword from the upper-horizontal row of the table</li>
<li>Get the first letter of a ciphertext and find it in the same row that the letter from the previous step.</li>
<li>Finally find the letter from the left-vertical row that is in the same line as the letter from the previous step. </li>
<li>Repeat for each letter.</li>
</ul>
<p>And that's it! We can easilly encrypt and decrypt the messages with Vigenère cipher.</p>
<h1>History behind Vigenère cipher </h1>
<p><img src="/img/encryption-vigenere/cipher-disk.png" alt="tabula-recta" class="img-responsive" /></p>
<p><center><i>A reproduction of the Confederacy's cipher disk</i></center></p>
<p>This cipher was originally invented by Giovan Battista Bellaso in 1553, in book called <i>La cifra del. Sig. Giovan Battista Bellaso</i>, but is called after Blaise de Vigenère. Blaise published the stronger version of a cipher in 1586 which was later in 19th century misattributed to Vigenère. This cipher gained the reputation of being strong, even some mathematicians called it 'unbreakable' but in 19th Friedrich Kasiski published a method of deciphering a Vigenère cipher.</p>
<p>Nowadays there are couple of ways of deciphering the cipher.</p>
<ul>
<li>Kasiski examination</li>
<li>Friedman test</li>
<li>Frequency analysis</li>
<li>Key elimination</li>
</ul>
<p><a href="http://practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-vigenere-cipher/" title="Read More">Read More</a></p>

<h1>Programming the Vigenère cipher</h1>
<p>As always, best way to learn ciphers is by programming one. I'm using Python, with itertools and functools.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/python3</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span>
<span class="kn">import</span> <span class="nn">functools</span></code></pre></figure>

<p>Then let's see how the encrypt function works.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">alphabet</span> <span class="o">=</span> <span class="s">'abcdefghijklmnopqrstuvwxyz'</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">):</span>
    <span class="n">pairs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">cycle</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="s">''</span>

    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">alphabet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">alphabet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">pair</span><span class="p">)</span>
        <span class="n">ciphertext</span> <span class="o">+=</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">total</span> <span class="o">%</span> <span class="mi">26</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">ciphertext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></code></pre></figure>

<p>Firstly I define the alphabet that will help me getting character indexes. Then I'm getting the plaintext and the key, and I'm building a list of tuples using <b>zip()</b> function. Next I use <b>cycle()</b> to repeat the letters of my key for the entire length of the plaintext.</p>
<p>After that I use functools.reduce (reduce in python2) so I can get the index of characters to add them. I finally get the new letter after a modulo of 26 and append that to our resulting ciphertext string.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">):</span>
    <span class="n">pairs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">cycle</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="s">''</span>

    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">alphabet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">alphabet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">pair</span><span class="p">)</span>
        <span class="n">plaintext</span> <span class="o">+=</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">total</span> <span class="o">%</span> <span class="mi">26</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">plaintext</span></code></pre></figure>

<p>The decryption function is exactly the same but instead of adding numbers I'm subtracting them.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"[*] Welcome to Vigenere Cipher tool"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"[*] Would you like to encrypt [E] or [D] decrypt the message?"</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"[*] Enter your chooice: "</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">"E"</span><span class="p">:</span>
        <span class="n">plaintext</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"[*] Please enter your message: "</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"[*] Now enter your key: "</span><span class="p">)</span>
        <span class="n">encrypted</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[*] Encrypting..."</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'[*] Encrytped: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">encrypted</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">"D"</span><span class="p">:</span>
        <span class="n">ciphertext</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"[*] Please enter your message: "</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"[*] Now enter your key: "</span><span class="p">)</span>
        <span class="n">decrypted</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[*] Decrypting..."</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'[*] Decrypted: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">decrypted</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      	<span class="k">print</span><span class="p">(</span><span class="s">"[*] Error"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span></code></pre></figure>

<p>Main function is created to get the messages and keywords from the user, as well as a option to encrypt or decrypt the text.</p>
<p>Now let's check how this works!</p>
<p>Firstly encrypt mode, (after entering 'e' or 'E' letter). I'm gonna stick with the word hello and the boom keyword as we may check whether or not it works ;)</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>python3 viegenare.py
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Welcome to Vigenere Cipher tool
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Would you like to encrypt <span class="o">[</span>E] or <span class="o">[</span>D] decrypt the message?
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Enter your chooice: E
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Please enter your message: hello
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Now enter your key: boom
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Encrypting...
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Encrytped: iszxp</code></pre></figure>

<p>Great! Now the decrypt mode.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>python3 viegenare.py
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Welcome to Vigenere Cipher tool
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Would you like to encrypt <span class="o">[</span>E] or <span class="o">[</span>D] decrypt the message?
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Enter your chooice: d
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Please enter your message: iszxp
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Now enter your key: boom
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Decrypting...
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Decrypted: hello</code></pre></figure>

<p>Now we have fully functioning Vigenère cipher tool. I hoped you enjoyed this topic as a part of the <i>Let's talk encryption</i> series. Stay tuned for more updates about encryption as well as other infosec topics. </p>
<p><b>Part of Encryption Tools Project</b></p>
<p><a href="https://github.com/W3ndige/encryption-tools" title="Github">Github</a></p>

<p>~Stay safe!</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/08/04/encryption-caesar-cipher/" data-toggle="tooltip" data-placement="top" title="Let's Talk Encryption">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/08/13/diffie-hellman-and-pgp/" data-toggle="tooltip" data-placement="top" title="Diffie-Hellman and PGP">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/w3ndige">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:w3ndige@protonmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; RootNetSec 2016 - 2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
