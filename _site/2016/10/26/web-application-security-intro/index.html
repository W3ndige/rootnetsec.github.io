<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="RootNetSec is a site about journey through the world of network security, pentesting, Linux administration, programming an networking. View to learn more!">
    <meta name="author" content="W3ndige">
    <title>Web Application Security - Root Network Security</title>

    <link rel="canonical" href="http://localhost:4000/2016/10/26/web-application-security-intro/">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//https://fonts.googleapis.com/css?family=Nunito:400,700i" rel="stylesheet">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Root Network Security" />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Root Network Security</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/about/">About</a>
                </li>

                <li>
                    <a href="/archive/">Archive</a>
                </li>

                <li>
                    <a href="/contact/">Contact</a>
                </li>

                <li>
                    <a href="/projects/">Projects</a>
                </li>

                <li>
                    <a href="/resources/">Resources</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/web-application-security-intro-header.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Web Application Security</h1>
                    
                    <h2 class="subheading">Security Headers</h2>
                    
                    <span class="meta">Posted by W3ndige on October 26, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1>Introduction</h1>

<p>Today we're going to start with Web Security - in particular I want to discuss security headers - small steps to keep your web application more secure. Without wasting your time, let's move to the content.  </p>

<h1>Specify the doctype</h1>

<p>But why is it so important and how can it improve security of my web application? </p>
<p>Answer to this is quite easy, without the specified doctype web browser will try to guess the type of the document based on the content of the website. Sometimes it may guess good, but sometimes, in the worst case, browser can generate our document in so called <a href="https://en.wikipedia.org/wiki/Quirks_mode">Quirks Mode</a>. Goal of quirks mode is to preserve the backwards compatibility with times, where web was just starting. As you may think, this may lead to data leaks, or even make the site vulnerable to XSS (even if it was coded properly). </p>

<p>Also remember that you don't have to write older versions of doctype like in HTML4:  </p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"> <span class="cp">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"&gt;</span></code></pre></figure>

<p>In HTML5 you only have to write: </p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"> <span class="cp">&lt;!DOCTYPE HTML&gt;</span></code></pre></figure>

<p>Easy, right? </p>
<h1>Subresource Integrity</h1>

<p>Lots of web applications are based on the external libraries or frameworks like AngularJS, jQuery, BootStrap etc and loads of web developers instead of downloading them into the server, often link them from CDN's (Content Delivery Network) of creators, from where the script is downloaded and executed during the process of rendering webpage. Here's the example of linking AngularJS framework: </p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></figure>

<p>But what if someone attacks the ajax.googleapis.com and changes the script into more malicious one, for example putting browser exploit? Then our vistiors are also attacked, and it's our goal to make it impossible.  </p>

<p>To prevent these situtations, Subresource Integrity allows us to add additional attribute to the <b>script</b> or <b>link</b> tags, where we should enter encoded in Base64 hash (SHA-256, SHA-384, SHA-512) for the external file. Then when the hash doesn't match the hash of the downloaded script, browser won't run it. In our example SRI script will look like this:  </p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-V6/dyDFv85/V/Ktq3ez5B80/c9ZY7jV9c/319rqwNOz3h9CIPdd2Eve0UQBYMMr/"</span><span class="nt">&gt;&lt;/script&gt;</span>&gt;</code></pre></figure>

<p>Try this site to generate SRI hash: <a href="https://www.srihash.org/">SRI Hash Generator</a></p>

<h1>X-XSS-Protection</h1>

<p>Google Chrome and Internet Explorer have built-in filter preventing Reflected XSS attacks. They work quite easily, checking, if there are HTML tags in the HTTP query, or even different fragments of JavaScript code, and then if this code also shows up in the answer. If yes, then the browser assumes that this is XSS attack, and blocks this piece of code.   </p>

<p>Both in IE and Chrome, you can enable the filters using X-XSS-Protection header. </p>

<ul>
<li>X-XSS-Protection: 0 - XSS filter is disabled and the browser won't try to detect XSS attacks</li>
<li>X-XSS-Protection: 1 - XSS filter is enabled - and this is the default option. It blocks the piece of code suspected for being XSS payload. </li>
<li>X-XSS-Protection: 1; mode=block - XSS filter, which after detecting XSS attack, will stop rendering the web page. </li>
</ul>

<p>The best option to choose would be the last one, since it doesn't only blocks XSS attacks, it also lets us dodge vulnerabilities described in <a href="http://www.slideshare.net/masatokinugawa/xxn-en">X-XSS-Nightmare</a> written by Msato Kinugawy. </p>

<h1>X-Content-Type-Options</h1>
<p>This header disables the guessing  MIME type of the site, by the browser. It also protects us from uploading files different than they should be (JavaScript file as a photo etc). Example: </p>

<p>We have the web application allowing users to upload images. Attacker after uploading malicious .png file, tries to change the source of the script into his malicious script. </p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://www.example.com/uploads/malicious.png‚Äù&gt;&lt;/script&gt;</span></code></pre></figure>

<p>But the X-Content-Type-Options won't allow this operation, since image (MIME type image/png) doesn't match the script type. X-Content-Type-Options has only one possible value: <b>nosniff</b></p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">X-Content-Type-Options: nosniff</code></pre></figure>

<h1>X-Frame-Options</h1>

<p>X-Frame-Options header was introduced as an response to clickjacking attacks, but is also used to protect from many different kinds of attacks. This header reduces the number of domens, where our web application can be put into <b>frame</b>, <b>iframe</b> or <b>object</b> tags. </p>

<ul>
<li>X-Frame-Options: Deny - web page connot be put into frames on any different sites.</li>
<li>X-Frame-Options: SameOrigin - web page can only be put into frames on the the webpages originating from the same domain. </li>
<li>X-Frame-Options: Allow-From url - web page can be put only on specified domain. </li>
</ul>

<p>Best option would be SameOrigin or Deny, unless you want to share any widgets. </p>

<h1>HttpOnly/Secure Flags</h1>

<p>For HTTP cookies we can add 2 flags making them more secure - HttpOnly and Secure. </p>

<p>HttpOnly flag lets us avoid one of the most popular result of XSS attacks - stealing session cookies. Attackers payload can be done using JavaScript <b>document.cookie</b> and sending it to his server, but with HttpOnly cookie will be only sent in queries to server, it won't show up using <b>document.cookie</b></p>

<p>Secure flag guarantees us that, when application works both in HTTP and HTTPS, it will only send cookies using HTTPS. </p>

<p>Here's and example of Set-Cookie, with both flags: </p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">Set-Cookie: PHPSESSID=el4ukv0kqbvoirg7nkp4dncpk3; HttpOnly; Secure</code></pre></figure>

<p>Setting up flags for session cookies depends on used technology, but specific instructions should be presented in documentation. </p>

<h1>Strict-Transport-Security</h1>

<p>Last but not least Strict-Transport-Security header comes handy, when we're building web application, that should never be runned with HTTP. After defining this header, we gain 2 mechanisms protecting us from man in the middle attacks. </p>

<p>We are sure that web browser will never send queries using HTTP protocol.</p>

<p>When negotiation SSL connection results in an error (ex invalid certificate), browser won't let user to accept such certificate. </p>

<p>While implementing Strict-Transport-Security header, it's essential to enter <b>max-age</b> parameter, saying how long should the header be significant (in seconds). After that time there will be possibility to once again perform queries using HTTP protocol. </p>

<p>Example of such header valid for one year: </p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">Strict-Transport-Security: max-age=31536000</code></pre></figure>

<hr />

<p>I hope that after this read, you gained better understanding of secure headers. In the future I'll write about Content-Security-Policy, but it is material for a whole new post, so keep tuned ;)</p>

<p>Thanks for reading and as always...</p>

<p>~Stay safe! </p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/10/15/euler-truncatable-primes/" data-toggle="tooltip" data-placement="top" title="Problem 37 - Truncatable Primes">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/10/29/analyzing-javascript-malware/" data-toggle="tooltip" data-placement="top" title="Analyzing JavaScript Malware">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/w3ndige">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:w3ndige@protonmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; RootNetSec 2016 - 2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
