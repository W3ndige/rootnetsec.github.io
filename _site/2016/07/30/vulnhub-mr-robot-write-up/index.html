<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="RootNetSec is a site about journey through the world of network security, pentesting, Linux administration, programming an networking. View to learn more!">
    <meta name="author" content="W3ndige">
    <title>Vulnhub.com - Mr.Robot 1 - Root Network Security</title>

    <link rel="canonical" href="http://localhost:4000/2016/07/30/vulnhub-mr-robot-write-up/">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//https://fonts.googleapis.com/css?family=Nunito:400,700i" rel="stylesheet">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Root Network Security" />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Root Network Security</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/about/">About</a>
                </li>

                <li>
                    <a href="/archive/">Archive</a>
                </li>

                <li>
                    <a href="/contact/">Contact</a>
                </li>

                <li>
                    <a href="/projects/">Projects</a>
                </li>

                <li>
                    <a href="/resources/">Resources</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/mr-robot-1-header.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Vulnhub.com - Mr.Robot 1</h1>
                    
                    <h2 class="subheading">Write-Up</h2>
                    
                    <span class="meta">Posted by W3ndige on July 30, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1>Introduction</h1>
<p>This VM is a great way to celebrate the upcoming of a season 2 of Mr. Robot. As it's designed for beginners-intermediate it will be fun challenge and opportunity to learn something new. Our task is to find three different keys located somewhere in the machine. </p>
<p>Let's get started!</p>
<h1>How to join the #fsociety?</h1>
<p>Firstly, let's find out what IP address is assigned to this VM using nmap, in addition we can scan for the OS version of this machine, and are there any open ports.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">nmap -Pn -A 10.0.2.0/24</code></pre></figure>

<p>-Pn – will scan hosts even if they ignore us</p>
<p>-A – will determine operating system of the host</p>
<p><img src="/img/mr-robot-1/mr-robot-nmap.png" alt="mr-robot-nmap" class="img-responsive" /></p>
<p>From what we can see, IP of the machine is 10.0.2.4 and has two open ports: port 80 (http) and port 443 (https). What that means, is that it's hosting web site, using Apache web server. Let's check what it is!</p>
<p>After typing the IP address to the web browser, we can see well known interactive commercial for the new season.</p>
<p><img src="/img/mr-robot-1/mr-robot-web-view.png" alt="mr-robot-view" class="img-responsive" /></p>
<p>Always remember to check the robots.txt file as it may be hiding some useful information, which may come handy for us.</p>
<p>In this one we've got a rule dissalowing web crawlers from indexing 2 files: key-1-of-3.txt and fsocity.dic.</p>
<p><img src="/img/mr-robot-1/mr-robot-robotstxt.png" alt="mr-robot-robotstxt" class="img-responsive" /></p>
<p>We can get these files by using wget commands (very useful one!).</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">wget 10.0.2.4/key-1-of-3.txt</code></pre></figure>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">wget 10.0.2.4/fsocity.dic</code></pre></figure>

<p>Yeah! We've got the first key, two more to go!</p>
<p>Second file is a dictionary, and I assume we will have to use it in the future brute force attack.</p>
<p><img src="/img/mr-robot-1/mr-robot-filesfromrobots.png" alt="mr-robot-filesfromrobots" class="img-responsive" /></p>
<p>Now let's use nmap script - http-enum which may reveal some more useful information.</p>
<p><img src="/img/mr-robot-1/mr-robot-http-enum.png" alt="mr-robot-httpenum" class="img-responsive" /></p>
<p>Script showed us a lot more that we've asked for. It's based on WordPress, and we may use this information to preform many attacks. Now let's focus on the readme file and the wp-login.php site.</p>
<p>Readme won't help us :(</p>
<p><img src="/img/mr-robot-1/mr-robot-readme.png" alt="mr-robot-readme" class="img-responsive" /></p>
<p>But will login page help us?</p>
<p>Most common login and passwords pairs like admin:admin haven't worked but remeber that we have the dictionary, to perform an attack. Now, we have to find the username. </p>
<p>And actually, elliot is correct username! I tried it, by simply typing the names of the characters in this show :)</p>
<p><img src="/img/mr-robot-1/mr-robot-elliot.png" alt="mr-robot-elliot" class="img-responsive" /></p>
<p>Our next task is to brute force this page, using provided dictionary and the wpscan tool.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">wpscan -u 10.0.2.4 --wordlist ~/fsocity.dic --username elliot</code></pre></figure>

<p>And after roughly 5 hours, password is ER28-0652 - one of the last ones in the word list.</p>
<p><img src="/img/mr-robot-1/mr-robot-werein.png" alt="mr-robot-werein" class="img-responsive" /></p>
<p>But what to do next?</p>
<p>We can try to upload a reverse shell to gain access to the server.</p>
<p>Simplest way would be to edit some .php file in order to get shell. I’ll try with page.php and use the code from:</p>
<p><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" title="PenTestMonkey">PenTestMonkey</a></p>
<p>Then let’s create blank page.</p>
<p>Last essential step would be setting up listener and after that just the visit our blank page.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">nc -lvp 3344</code></pre></figure>

<p>And we’re in the server, as elliot user. Now let’s see if there’s anything interesting in the home directory.Most promising folder was ‘robot’ containing 2 files: key-2-of-2.txt and password.raw-md5</p>
<p>Unfortunately we don’t have permission to cat the .txt file but let’s look at the m5 file which gives us: robot:<b>c3fcd3d76192e4007dfb496cca67e13b</b> – probable login and password pair . Cracking it with CrackStation, gives us <b>abcdefghijklmnopqrstuvwxyz</b>. In the next step let's try to login in Mr.Robot vulnerable machine.</p>
<p><img src="/img/mr-robot-1/mr-robot-robot.png" alt="mr-robot-robot" class="img-responsive" /></p>
<p>After that we're able to view the second key, one more to go!</p>
<p><img src="/img/mr-robot-1/mr-robot-key-2-of-2.png" alt="mr-robot-key2of2" class="img-responsive" /></p>
<p><b>822c73956184f694993bede3eb39f959</b></p>
<p>One last part - privilage escalation - we have to get to the root account.</p>
<p>We can find any misconfigured executable files that can provide us what we want.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">find / -perm -u<span class="o">=</span>s -type f 2&gt;/dev/null</code></pre></figure>

<p><img src="/img/mr-robot-1/mr-robot-nmapstart.png" alt="mr-robot-nmapstart" class="img-responsive" /></p>
<p>Which gives information that nmap is installed on this server with root privileges. Let’s try to exploit nmap –interactive.</p>
<p><img src="/img/mr-robot-1/mr-robot-key-3-of-3.png" alt="mr-robot-key3of3" class="img-responsive" /></p>
<p>And yes, we've got the last key!</p>
<p>It was great challenge to fulfill my knowledge hungry brain :). Thanks for Jason for creating such a great boot2root machine!</p>
<p><a href="https://www.vulnhub.com/author/jason,292/" title="Jason">Jason</a></p>

<p>~Stay safe!</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/07/25/overthewire.org-leviathan/" data-toggle="tooltip" data-placement="top" title="Overthewire.org - Leviathan">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/08/04/encryption-caesar-cipher/" data-toggle="tooltip" data-placement="top" title="Let's Talk Encryption">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/w3ndige">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:w3ndige@protonmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; RootNetSec 2016 - 2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
