<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="RootNetSec is a site about journey through the world of network security, pentesting, Linux administration, programming an networking. View to learn more!">
    <meta name="author" content="W3ndige">
    <title>Enigma - Root Network Security</title>

    <link rel="canonical" href="http://localhost:4000/2017/02/07/enigma/">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//https://fonts.googleapis.com/css?family=Nunito:400,700i" rel="stylesheet">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Root Network Security" />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Root Network Security</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/about/">About</a>
                </li>

                <li>
                    <a href="/archive/">Archive</a>
                </li>

                <li>
                    <a href="/contact/">Contact</a>
                </li>

                <li>
                    <a href="/projects/">Projects</a>
                </li>

                <li>
                    <a href="/resources/">Resources</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/enigma-header.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Enigma</h1>
                    
                    <h2 class="subheading">Introduction to modern cryptography</h2>
                    
                    <span class="meta">Posted by W3ndige on February 7, 2017</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1>Brief history behind Enigma</h1>

<p>The first Enigma machine was discovered by <b>Arthur Scherbius</b>, German engineer who acquired the patent in 1918. Name of this device originated from Greek word - riddle.  It was used commercially from the early 1920s, and was also adopted by the military and governmental services of a number of nations — most famously German Army. Communication during those days was sent over radio which means that everyone could easily listen. But at that moment no one could spy on Nazi messages - Scherbius' Enigma provided them with the strongest cryptographic cipher of the world. </p>

<p><img src="/img/enigma/scherbius.jpg" alt="Scherbius" class="img-responsive center-block" /></p>
<p class="text-center"><small>Arthur Scherbius</small></p>

<p>Since 1926 English cryptanalysts were eavesdropping German radio messages, unfortunately without being able to extract their meaning. But Polish officials, afraid of German attack started working on analyzing and breaking the cipher in office called Cipher Bureau (Biuro Szyfrów). By 1933 <b>Marian Rejewski</b>, <b>Henryk Zygalski</b> and <b>Jerzy Różycki</b> broke Enigma, by exploiting a fatal flaw of how Enigma operators sent their messages, and were able to determine the daily keys of almost every message that was intercepted. </p>

<p><img src="/img/enigma/polish-crypto-breakers.jpg" alt="Polish-cryptanalysts" class="img-responsive center-block" /></p>
<p class="text-center"><small>From left: Jerzy Różycki, Henryk Zygalski and Marian Rejewski</small></p>

<p> They even developed a machine called the Bombe (Bomba), that made the process of codebreaking much faster. But back then keys were changing only once every few months, while during the war keys were changing at least once a day. In July 1939, just before the start of war Poles decided to inform the British and French about their research, also asking for help.   </p>

<p><img src="/img/enigma/enigma-machine.jpg" alt="Enigma-photo" class="img-responsive center-block" /></p>
<p class="text-center"><small>Enigma</small></p>

<p>At Bletchley Park <b>Alan Turing</b>, together with fellow code-breaker <b>Gordon Welchman</b> invented different version of Bombe. When an Enigma message was intercepted, codebreakers had to search for so-called cribs, which were presumed pieces of plain text within the encrypted message. That way Turing Bombe would search for the enigma settings for a given piece of plain and cipher text. Although the British bombe actually owes little to the Bomba, Poles contributed a lot by supplying the internal wiring of the Enigma's rotors. They also demonstrated that Enigma can be broked using another machine. It has been estimated that the efforts of Turing and his fellow code-breakers shortened the war by several years. What is certain is that they saved countless lives and helped to determine the course and outcome of the conflict.</p>

<p><img src="/img/enigma/bombe.jpeg" alt="British-bombe" class="img-responsive center-block" /></p>
<p class="text-center"><small>British Bombe</small></p>

<p>But let's head back from the history to something more technical. </p>

<h1>Cryptography</h1>

<p>Firstly, let's find out how Enigma has worked. </p>

<p>When sender sends the message, Enigma creates an electrical signal that goes through the wiring of the machine. First step for this signal is plugboard which attempts to get around frequency analysis. Some of the letters on the plugboard would be wired to other letters (plugs). Signal going through one of these plugs change original input into different letter, but also leaving some of the original letters unmoved. </p>

<p><img src="/img/enigma/plugboard.jpg" alt="Enigma-plugboard" class="img-responsive center-block" /></p>
<p class="text-center"><small>View on the plugboard</small></p>

<p>The next step is the static rotor, which simply turns wires into static contacts, making the signal pass only when the contacts touch. But after that, things are getting a little bit more complicated. There are 5 rotors, with the possibility to choose 3 of them, for three positions - left, middle and right. Each rotor has their own set of inner, and outer rings of contacts. The outer ring contacts connect to the next rotor, together with its own inner ring. Purpose of these rings is to even more scramble the signal, resulting in more letter substitutions.  </p>

<p><img src="/img/enigma/rotors.png" alt="Enigma-rotors" class="img-responsive center-block" /></p>
<p class="text-center"><small>Rotor electrical view</small></p>

<p>In addition, as each letter is entered, the rotors rotate by one position, so that the same letters are never connected together in the same message. And even more, each rotor has notches in different positions which, when reached, cause the next rotor to its left to step forward too.</p>

<p>Last step that electrical signal takes before going back to the light board is the reflector. In Enigma machine there are 2 possible reflectors, each wired differently and producing different letter when reflected back. Journey back through the rotors works exactly the same way in reverse. Signal remains the same when passing through the static rotor, then going through the plugboard on the same principles. After that, signal goes to lightboard, where the light, corresponding for each letter, lits up.   </p>

<p><b>But how would you decrypt the message? </b></p>

<p>To decode your message, you would need to know what rotor and plugboard settings were used during encryption. This was possible with use of monthly sheets, containing basic settings for every day of the month. They were in the custody of an officer, responsible for setting up the machine rotors and ringsettings. After setup, he could lock the machine front panel with a key. The operator of Enigma could only select the rotor start position.  </p>

<p><img src="/img/enigma/key-sheets.jpg" alt="Key-sheets" class="img-responsive center-block" /></p>
<p class="text-center"><small>Example of Wehrmacht Enigma key sheet</small></p>

<h1>Mathematical Security of Enigma</h1>

<p>Now, how secure is Enigma? Let's count all of the possibilities. </p>

<p>Enigma has 5 rotors, from which 3 are used. </p>

<p><img src="/img/enigma/equation_1.png" alt="First-equation" class="img-responsive" /></p>

<p>Then all 3 rotors have 26 positions, one for each letter of the alphabet. </p>

<p><img src="/img/enigma/equation_2.png" alt="Second-equation" class="img-responsive" /></p>

<p>Quite a large number, right? Yet, we have to calculate all possibilities with the plug board. </p>

<p><img src="/img/enigma/equation_3.png" alt="Third-equation" class="img-responsive" /></p>

<p>And lastly, multiply them all together. This gives us quite a lot of combinations.  </p>

<p><img src="/img/enigma/possibilities.png" alt="Possibilities" class="img-responsive" /><br /></p>

<h1>Last Words</h1>

<p>Enigma, was without doubt machine with great encryption capabilities. This war could have last much longer, or even end completely different, without hard work of great cryptanalytic minds working together on this operation. </p>

<p>~ Stay safe!</p>

<h1>References</h1>
<p>[1] <a href="https://en.wikipedia.org/wiki/Enigma_machine"><b>Wikipedia</b></a></p>
<p>[2] Singh Simon (2000) <b>The Code Book: The Science of Secrecy from Ancient Egypt to Quantum Cryptography</b></p>
<p>[3] Rejewski Marian (1981) <b>How the Polish Mathematicians Broke the Enigma. Annals of the History of Computing.</b></p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2017/02/03/overthewire.org-narnia-3/" data-toggle="tooltip" data-placement="top" title="Overthewire.org - Narnia 2 -> 3">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2017/02/12/vulnhub-64base-writeup/" data-toggle="tooltip" data-placement="top" title="Vulnhub.com - 64Base 1.0.1">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/w3ndige">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:w3ndige@protonmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; RootNetSec 2016 - 2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
